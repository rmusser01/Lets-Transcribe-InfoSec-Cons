{
  "metadata": {
    "webpage_url": "https://www.youtube.com/watch?v=rPZx1zbKJnI",
    "title": "TROOPERS24: 10 Years of Windows Privilege Escalation with \"Potatoes\"",
    "description": "Talk by Andrea Pierini - June 26th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/cyzbj3/\n\nMore impressions:\nhttps://twitter.com/WEareTROOPERS\nhttps://twitter.com/ERNW_ITSec\nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
    "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
    "duration": 3272,
    "channel": "TROOPERS IT Security Conference",
    "uploader": "TROOPERS IT Security Conference",
    "upload_date": "20240902"
  },
  "segments": {
    "metadata": {
      "webpage_url": "https://www.youtube.com/watch?v=rPZx1zbKJnI",
      "title": "TROOPERS24: 10 Years of Windows Privilege Escalation with \"Potatoes\"",
      "description": "Talk by Andrea Pierini - June 26th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/cyzbj3/\n\nMore impressions:\nhttps://twitter.com/WEareTROOPERS\nhttps://twitter.com/ERNW_ITSec\nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
      "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
      "duration": 3272,
      "channel": "TROOPERS IT Security Conference",
      "uploader": "TROOPERS IT Security Conference",
      "upload_date": "20240902"
    },
    "segments": [
      {
        "Time_Start": 0.0,
        "Time_End": 23.6,
        "Text": "This text was transcribed using whisper model: large-v2\n\n Hello, and first of all, thank you for joining my talk, which will be about the wonderful"
      },
      {
        "Time_Start": 23.6,
        "Time_End": 29.5,
        "Text": " world of the Windows privilege escalations using potatoes."
      },
      {
        "Time_Start": 29.5,
        "Time_End": 35.68,
        "Text": " First of all, you see two names here, myself and Antonio, my friend and partner in crime,"
      },
      {
        "Time_Start": 35.68,
        "Time_End": 40.86,
        "Text": " because most of the researches that I will discuss today, we did them together."
      },
      {
        "Time_Start": 40.86,
        "Time_End": 46.5,
        "Text": " And part of this talk was presented by him last November in Seoul."
      },
      {
        "Time_Start": 46.5,
        "Time_End": 51.5,
        "Text": " But I have some news, so it's not the same talk."
      },
      {
        "Time_Start": 52.5,
        "Time_End": 57.5,
        "Text": " Oh, why doesn't it work?"
      },
      {
        "Time_Start": 61.5,
        "Time_End": 63.5,
        "Text": " It worked."
      },
      {
        "Time_Start": 63.5,
        "Time_End": 66.5,
        "Text": " Oh, good, yeah."
      },
      {
        "Time_Start": 66.5,
        "Time_End": 69.5,
        "Text": " Two words about me."
      },
      {
        "Time_Start": 69.5,
        "Time_End": 70.5,
        "Text": " I am Andrea Pirini."
      },
      {
        "Time_Start": 70.5,
        "Time_End": 75.5,
        "Text": " I am Italian, but I think that's an easy guess just listening to my bad English."
      },
      {
        "Time_Start": 76.5,
        "Time_End": 83.5,
        "Text": " I work for Semperis in the bridge preparedness and incident response team as a senior security"
      },
      {
        "Time_Start": 83.5,
        "Time_End": 87.5,
        "Text": " consultant, senior because I'm old, because I'm not that expert."
      },
      {
        "Time_Start": 87.5,
        "Time_End": 89.5,
        "Text": " But OK, keep on."
      },
      {
        "Time_Start": 89.5,
        "Time_End": 95.5,
        "Text": " During my spare time when I'm not cycling or doing other fun stuff, I like diving into"
      },
      {
        "Time_Start": 95.5,
        "Time_End": 99.5,
        "Text": " the world of the mysterious world of offensive security."
      },
      {
        "Time_Start": 99.5,
        "Time_End": 103.5,
        "Text": " And, of course, I am a potato lover."
      },
      {
        "Time_Start": 103.5,
        "Time_End": 104.5,
        "Text": " These are my handles."
      },
      {
        "Time_Start": 104.5,
        "Time_End": 109.5,
        "Text": " If you want to get in contact with me or read my blog post, here you have it."
      },
      {
        "Time_Start": 111.5,
        "Time_End": 113.5,
        "Text": " Why this talk?"
      },
      {
        "Time_Start": 113.5,
        "Time_End": 123.5,
        "Text": " In very, very short, we wanted to share our journey in trying to find new potatoes technique."
      },
      {
        "Time_Start": 123.5,
        "Time_End": 125.5,
        "Text": " This is what we did."
      },
      {
        "Time_Start": 125.5,
        "Time_End": 129.5,
        "Text": " And we spent a lot of time, endless times, endless nights."
      },
      {
        "Time_Start": 130.5,
        "Time_End": 138.5,
        "Text": " And we used crazy ideas to find always new vulnerabilities in order to exploit what we"
      },
      {
        "Time_Start": 138.5,
        "Time_End": 140.5,
        "Text": " call the potato technique."
      },
      {
        "Time_Start": 140.5,
        "Time_End": 146.5,
        "Text": " So this talk will not go too much in the details, because one, it is boring, and two, it will"
      },
      {
        "Time_Start": 146.5,
        "Time_End": 147.5,
        "Text": " take too much time."
      },
      {
        "Time_Start": 147.5,
        "Time_End": 157.5,
        "Text": " So I will keep it, I hope, interesting and just more simple explanations and not going"
      },
      {
        "Time_Start": 157.5,
        "Time_End": 159.5,
        "Text": " too much deep in the technical details."
      },
      {
        "Time_Start": 161.5,
        "Time_End": 168.5,
        "Text": " The agenda, after a brief introduction on what is considered by Microsoft a privileged"
      },
      {
        "Time_Start": 168.5,
        "Time_End": 175.5,
        "Text": " escalation, so what is a security boundary violation and not, we will delve into the"
      },
      {
        "Time_Start": 175.5,
        "Time_End": 181.5,
        "Text": " RPC Decom trigger, which is the trigger which permitted us to find a lot of vulnerabilities"
      },
      {
        "Time_Start": 181.5,
        "Time_End": 183.5,
        "Text": " via the potato techniques."
      },
      {
        "Time_Start": 184.5,
        "Time_End": 191.5,
        "Text": " And after this, we will analyze how it was possible to break the boundaries, the safety"
      },
      {
        "Time_Start": 191.5,
        "Time_End": 197.5,
        "Text": " boundaries and the security boundaries, local and then also from remote."
      },
      {
        "Time_Start": 197.5,
        "Time_End": 199.5,
        "Text": " You see here three asterisks."
      },
      {
        "Time_Start": 199.5,
        "Time_End": 200.5,
        "Text": " These are the new findings."
      },
      {
        "Time_Start": 200.5,
        "Time_End": 202.5,
        "Text": " This is a total new entry."
      },
      {
        "Time_Start": 202.5,
        "Time_End": 206.5,
        "Text": " So I will, the first time, talk about this in this session."
      },
      {
        "Time_Start": 206.5,
        "Time_End": 208.5,
        "Text": " So I hope you will enjoy it."
      },
      {
        "Time_Start": 208.5,
        "Time_End": 211.5,
        "Text": " And then, obviously, at the end, the conclusions."
      },
      {
        "Time_Start": 212.5,
        "Time_End": 216.5,
        "Text": " So let's start with what is a privileged escalation."
      },
      {
        "Time_Start": 216.5,
        "Time_End": 223.5,
        "Text": " Well, I can say what is not a privileged escalation from Microsoft's point of view."
      },
      {
        "Time_Start": 224.5,
        "Time_End": 230.5,
        "Text": " It's not a privileged escalation from admin to kernel or user account control bypass."
      },
      {
        "Time_Start": 230.5,
        "Time_End": 238.5,
        "Text": " And it is not a privileged escalation when you abuse a service account or you bypass"
      },
      {
        "Time_Start": 238.5,
        "Time_End": 240.5,
        "Text": " the Windows service account hardening."
      },
      {
        "Time_Start": 240.5,
        "Time_End": 246.5,
        "Text": " This is considered a safety boundary and it is not considered a security violation."
      },
      {
        "Time_Start": 246.5,
        "Time_End": 251.5,
        "Text": " Alias, the behavior is by default or the behavior is as expected."
      },
      {
        "Time_Start": 251.5,
        "Time_End": 254.5,
        "Text": " And then sometimes they silently fix, but it's up to them."
      },
      {
        "Time_Start": 254.5,
        "Time_End": 257.5,
        "Text": " What is a security boundary violation?"
      },
      {
        "Time_Start": 257.5,
        "Time_End": 263.5,
        "Text": " Of course, from standard user to admin and the various sandboxes bypasses."
      },
      {
        "Time_Start": 266.5,
        "Time_End": 268.5,
        "Text": " So this is my personal consideration."
      },
      {
        "Time_Start": 268.5,
        "Time_End": 272.5,
        "Text": " I still don't understand the bounty politics of Microsoft."
      },
      {
        "Time_Start": 272.5,
        "Time_End": 277.5,
        "Text": " But probably I'm an old-seasoned legacy on-prem guy."
      },
      {
        "Time_Start": 277.5,
        "Time_End": 281.5,
        "Text": " So it's difficult for me to understand this decision."
      },
      {
        "Time_Start": 281.5,
        "Time_End": 282.5,
        "Text": " I don't know what you think about it."
      },
      {
        "Time_Start": 282.5,
        "Time_End": 284.5,
        "Text": " But yeah, that's my personal opinion."
      },
      {
        "Time_Start": 284.5,
        "Time_End": 286.5,
        "Text": " And I wanted to share it with you."
      },
      {
        "Time_Start": 287.5,
        "Time_End": 289.5,
        "Text": " Okay, where it all began."
      },
      {
        "Time_Start": 289.5,
        "Time_End": 291.5,
        "Text": " It began 10 years ago."
      },
      {
        "Time_Start": 291.5,
        "Time_End": 295.5,
        "Text": " Therefore, 10 years of potatoes exportations with James Forshaw."
      },
      {
        "Time_Start": 295.5,
        "Time_End": 301.5,
        "Text": " You will hear his name several times because he did a lot of fantastic researches."
      },
      {
        "Time_Start": 301.5,
        "Time_End": 305.5,
        "Text": " And which helped us very much in our researches too."
      },
      {
        "Time_Start": 305.5,
        "Time_End": 308.5,
        "Text": " So we hear his name very, very often."
      },
      {
        "Time_Start": 308.5,
        "Time_End": 319.5,
        "Text": " And it started with the local NTLM reflection attack reported in 2014 and fixed in 2015."
      },
      {
        "Time_Start": 319.5,
        "Time_End": 325.5,
        "Text": " This was the very, very first, let's say, potato technique."
      },
      {
        "Time_Start": 325.5,
        "Time_End": 328.5,
        "Text": " Because then the name potato came after."
      },
      {
        "Time_Start": 328.5,
        "Time_End": 332.5,
        "Text": " But this is the very, very first potato technique."
      },
      {
        "Time_Start": 332.5,
        "Time_End": 337.5,
        "Text": " So how does this work?"
      },
      {
        "Time_Start": 337.5,
        "Time_End": 340.5,
        "Text": " I try to keep it very, very simple."
      },
      {
        "Time_Start": 340.5,
        "Time_End": 343.5,
        "Text": " So we have a malicious COM object."
      },
      {
        "Time_Start": 343.5,
        "Time_End": 345.5,
        "Text": " Okay, I have the screen here. Perfect."
      },
      {
        "Time_Start": 345.5,
        "Time_End": 354.5,
        "Text": " We have this malicious COM object, COM client, which tries to trigger a privileged COM server service."
      },
      {
        "Time_Start": 354.5,
        "Time_End": 356.5,
        "Text": " And how does it trigger?"
      },
      {
        "Time_Start": 356.5,
        "Time_End": 360.5,
        "Text": " Using a special call, a DCOM call."
      },
      {
        "Time_Start": 360.5,
        "Time_End": 363.5,
        "Text": " It's COGET instance from my storage, blah, blah, blah."
      },
      {
        "Time_Start": 363.5,
        "Time_End": 365.5,
        "Text": " With a class ID."
      },
      {
        "Time_Start": 365.5,
        "Time_End": 379.5,
        "Text": " By triggering this COM server service, what happens is that the client crafts a controlled Marshall object."
      },
      {
        "Time_Start": 379.5,
        "Time_End": 382.5,
        "Text": " Standard REF Marshall object."
      },
      {
        "Time_Start": 382.5,
        "Time_End": 385.5,
        "Text": " And this object contains some important information."
      },
      {
        "Time_Start": 385.5,
        "Time_End": 390.5,
        "Text": " The auxit resolver address he should connect to."
      },
      {
        "Time_Start": 390.5,
        "Time_End": 393.5,
        "Text": " The auxit resolver port."
      },
      {
        "Time_Start": 393.5,
        "Time_End": 398.5,
        "Text": " And this can be controlled by the malicious user."
      },
      {
        "Time_Start": 398.5,
        "Time_End": 400.5,
        "Text": " And this is very, very important."
      },
      {
        "Time_Start": 400.5,
        "Time_End": 408.5,
        "Text": " Because auxit resolution is needed for locating, for the COM server, to locating the binding information on where to contact the COM server."
      },
      {
        "Time_Start": 408.5,
        "Time_End": 411.5,
        "Text": " So think about it as a DNS for DCOM."
      },
      {
        "Time_Start": 411.5,
        "Time_End": 416.5,
        "Text": " And the other funny thing is that this call is authenticated."
      },
      {
        "Time_Start": 416.5,
        "Time_End": 425.5,
        "Text": " So when we trigger this COM server, what happens is that the privileged COM server will perform a resolve auxit 2 call."
      },
      {
        "Time_Start": 425.5,
        "Time_End": 428.5,
        "Text": " And it is an authenticated call."
      },
      {
        "Time_Start": 428.5,
        "Time_End": 434.5,
        "Text": " So we, as a malicious user, can intercept the authentication."
      },
      {
        "Time_Start": 434.5,
        "Time_End": 436.5,
        "Text": " And then use it."
      },
      {
        "Time_Start": 436.5,
        "Time_End": 438.5,
        "Text": " But we can go further."
      },
      {
        "Time_Start": 438.5,
        "Time_End": 448.5,
        "Text": " We can also send to the privileged COM server service a string binding containing the information about a fake RPC server under our control."
      },
      {
        "Time_Start": 448.5,
        "Time_End": 458.5,
        "Text": " And the COM server, which happily contacts us via the IRAM unknown interface, unknown 2 interface call, will contact us."
      },
      {
        "Time_Start": 458.5,
        "Time_End": 460.5,
        "Text": " And again, it is an authenticated call."
      },
      {
        "Time_Start": 460.5,
        "Time_End": 466.5,
        "Text": " So at the end, we have the possibility to intercept this authentication."
      },
      {
        "Time_Start": 466.5,
        "Time_End": 471.5,
        "Text": " And then, depending on the context, we can reflect or relay this authentication."
      },
      {
        "Time_Start": 471.5,
        "Time_End": 473.5,
        "Text": " And this is the whole magic."
      },
      {
        "Time_Start": 473.5,
        "Time_End": 476.5,
        "Text": " So it's not black magic, but it's a behavior by default."
      },
      {
        "Time_Start": 476.5,
        "Time_End": 482.5,
        "Text": " But as usual, there are a lot of behaviors by default which are most of the time ignored."
      },
      {
        "Time_Start": 482.5,
        "Time_End": 485.5,
        "Text": " And then when someone discovers it, they can order it."
      },
      {
        "Time_Start": 485.5,
        "Time_End": 486.5,
        "Text": " But this can also be abused."
      },
      {
        "Time_Start": 486.5,
        "Time_End": 488.5,
        "Text": " And this is the case."
      },
      {
        "Time_Start": 488.5,
        "Time_End": 492.5,
        "Text": " So we have what I call profit 1 and profit 2."
      },
      {
        "Time_Start": 492.5,
        "Time_End": 494.5,
        "Text": " Remember these two?"
      },
      {
        "Time_Start": 494.5,
        "Time_End": 497.5,
        "Text": " We have two authentications we can intercept and manipulate."
      },
      {
        "Time_Start": 497.5,
        "Time_End": 506.5,
        "Text": " The second one was implemented by us, starting with the raw potato tool, I think three or four years ago."
      },
      {
        "Time_Start": 506.5,
        "Time_End": 513.5,
        "Text": " And this is the first time we implemented a raw oxide resolver so that we could also abuse this second authentication."
      },
      {
        "Time_Start": 513.5,
        "Time_End": 520.5,
        "Text": " So let's start from the very beginning, from service to system."
      },
      {
        "Time_Start": 520.5,
        "Time_End": 522.5,
        "Text": " So a safety boundary violation."
      },
      {
        "Time_Start": 522.5,
        "Time_End": 526.5,
        "Text": " When I say service, I mean abusing the impersonation privileges."
      },
      {
        "Time_Start": 526.5,
        "Time_End": 531.5,
        "Text": " Because normally, services have at least impersonation privilege."
      },
      {
        "Time_Start": 531.5,
        "Time_End": 536.5,
        "Text": " So it's a matter of abusing this privilege."
      },
      {
        "Time_Start": 536.5,
        "Time_End": 539.5,
        "Text": " I think that you know this tool?"
      },
      {
        "Time_Start": 539.5,
        "Time_End": 541.5,
        "Text": " Yes? No?"
      },
      {
        "Time_Start": 541.5,
        "Time_End": 543.5,
        "Text": " Ah, good. Okay."
      },
      {
        "Time_Start": 543.5,
        "Time_End": 546.5,
        "Text": " This was the very first implementation."
      },
      {
        "Time_Start": 546.5,
        "Time_End": 549.5,
        "Text": " It was done in 2016."
      },
      {
        "Time_Start": 549.5,
        "Time_End": 558.5,
        "Text": " And it was the first tool which triggered the DECOM server."
      },
      {
        "Time_Start": 558.5,
        "Time_End": 566.5,
        "Text": " And it was somehow limited because it used only the bits CLSID and used a fixed port, which was 666."
      },
      {
        "Time_Start": 566.5,
        "Time_End": 576.5,
        "Text": " And basically what it did is triggered authentication, intercepted authentication, negotiated a system token,"
      },
      {
        "Time_Start": 576.5,
        "Time_End": 578.5,
        "Text": " and then impersonated the system token."
      },
      {
        "Time_Start": 578.5,
        "Time_End": 584.5,
        "Text": " So once you have impersonation privileges, you impersonate the system token and your system."
      },
      {
        "Time_Start": 584.5,
        "Time_End": 589.5,
        "Text": " And this implementation worked only with Meterpreter, so it was somehow limited."
      },
      {
        "Time_Start": 589.5,
        "Time_End": 593.5,
        "Text": " And then came our juicy potato."
      },
      {
        "Time_Start": 593.5,
        "Time_End": 595.5,
        "Text": " Juicy potato, you know it, yeah?"
      },
      {
        "Time_Start": 595.5,
        "Time_End": 596.5,
        "Text": " Ah, cool."
      },
      {
        "Time_Start": 596.5,
        "Time_End": 602.5,
        "Text": " This was coded by me and my friend Giuseppe in 2018, so many years ago."
      },
      {
        "Time_Start": 602.5,
        "Time_End": 606.5,
        "Text": " And it was what you call the sugared version of raw potato because it permits you."
      },
      {
        "Time_Start": 606.5,
        "Time_End": 611.5,
        "Text": " We found a lot of other interesting CLSID to abuse."
      },
      {
        "Time_Start": 611.5,
        "Time_End": 615.5,
        "Text": " It is possible to specify a port instead of a fixed one."
      },
      {
        "Time_Start": 615.5,
        "Time_End": 619.5,
        "Text": " And also, it is standalone."
      },
      {
        "Time_Start": 619.5,
        "Time_End": 628.5,
        "Text": " So it uses create process as user or create process with logon token to use the token"
      },
      {
        "Time_Start": 628.5,
        "Time_End": 631.5,
        "Text": " and then launch a process under the system identity."
      },
      {
        "Time_Start": 632.5,
        "Time_End": 635.5,
        "Text": " And it was heavily used because it was very simple to use."
      },
      {
        "Time_Start": 635.5,
        "Time_End": 641.5,
        "Text": " And once you compromise the system or an IAS account, an MS SQL service account,"
      },
      {
        "Time_Start": 641.5,
        "Time_End": 646.5,
        "Text": " it was very easy to perform a safety boundary violation."
      },
      {
        "Time_Start": 649.5,
        "Time_End": 651.5,
        "Text": " This was, let's say, fixed."
      },
      {
        "Time_Start": 651.5,
        "Time_End": 655.5,
        "Text": " We're starting from Windows Server 2019."
      },
      {
        "Time_Start": 655.5,
        "Time_End": 660.5,
        "Text": " And with this version, it was no more possible to specify a custom port."
      },
      {
        "Time_Start": 660.5,
        "Time_End": 666.5,
        "Text": " And then this fix was backported in 2022, also in Windows 2016."
      },
      {
        "Time_Start": 666.5,
        "Time_End": 669.5,
        "Text": " So juicy potato stopped working."
      },
      {
        "Time_Start": 669.5,
        "Time_End": 673.5,
        "Text": " How was this performed without going too much in details?"
      },
      {
        "Time_Start": 673.5,
        "Time_End": 677.5,
        "Text": " Simply by escaping the custom port."
      },
      {
        "Time_Start": 677.5,
        "Time_End": 679.5,
        "Text": " Not exactly escaping the custom port."
      },
      {
        "Time_Start": 679.5,
        "Time_End": 681.5,
        "Text": " Escaping the brackets around the custom port."
      },
      {
        "Time_Start": 681.5,
        "Time_End": 686.5,
        "Text": " So once they had escaped, the exploit breaks and it doesn't work anymore."
      },
      {
        "Time_Start": 686.5,
        "Time_End": 689.5,
        "Text": " And so goodbye, definitely, to juicy potato."
      },
      {
        "Time_Start": 689.5,
        "Time_End": 694.5,
        "Text": " But obviously, meantime, we had other ideas."
      },
      {
        "Time_Start": 694.5,
        "Time_End": 699.5,
        "Text": " So we started with raw potato."
      },
      {
        "Time_Start": 699.5,
        "Time_End": 709.5,
        "Text": " In raw potato, instead of using the local port, and we can no more specify a local port,"
      },
      {
        "Time_Start": 709.5,
        "Time_End": 714.5,
        "Text": " we used a redirector on a Linux machine, the socket redirector,"
      },
      {
        "Time_Start": 714.5,
        "Time_End": 719.5,
        "Text": " which then redirects the calls from port 135 to a custom port"
      },
      {
        "Time_Start": 719.5,
        "Time_End": 722.5,
        "Text": " on a service running on our machine."
      },
      {
        "Time_Start": 722.5,
        "Time_End": 725.5,
        "Text": " And this service is the fake auxit resolver."
      },
      {
        "Time_Start": 725.5,
        "Time_End": 728.5,
        "Text": " What does raw potato do?"
      },
      {
        "Time_Start": 728.5,
        "Time_End": 733.5,
        "Text": " First of all, it uses name pipe instead of TCP IP."
      },
      {
        "Time_Start": 733.5,
        "Time_End": 739.5,
        "Text": " And it creates a custom fake port mapper endpoint."
      },
      {
        "Time_Start": 739.5,
        "Time_End": 741.5,
        "Text": " This is very important."
      },
      {
        "Time_Start": 741.5,
        "Time_End": 749.5,
        "Text": " The port mapper endpoint is the equivalent, again, of the DNS for RPC."
      },
      {
        "Time_Start": 749.5,
        "Time_End": 754.5,
        "Text": " And the trick was, because we cannot create another mapper endpoint,"
      },
      {
        "Time_Start": 754.5,
        "Time_End": 756.5,
        "Text": " because it already exists in the name pipes."
      },
      {
        "Time_Start": 756.5,
        "Time_End": 765.5,
        "Text": " But the trick was to escape somehow the checks,"
      },
      {
        "Time_Start": 765.5,
        "Time_End": 772.5,
        "Text": " so that it is possible to create a port mapper under another, let's say, subdirectory."
      },
      {
        "Time_Start": 772.5,
        "Time_End": 775.5,
        "Text": " But because there is a bug, and there is still a bug,"
      },
      {
        "Time_Start": 775.5,
        "Time_End": 778.5,
        "Text": " in converting the slash chart, as you can see."
      },
      {
        "Time_Start": 778.5,
        "Time_End": 781.5,
        "Text": " So if I specify localhost slash pipe slash blah blah blah,"
      },
      {
        "Time_Start": 781.5,
        "Time_End": 785.5,
        "Text": " it converts it in a real name pipe path."
      },
      {
        "Time_Start": 785.5,
        "Time_End": 791.5,
        "Text": " So once we have the name pipe, it is very easy to impersonate the caller,"
      },
      {
        "Time_Start": 791.5,
        "Time_End": 794.5,
        "Text": " which is in this case system."
      },
      {
        "Time_Start": 794.5,
        "Time_End": 797.5,
        "Text": " Once we have impersonated the caller,"
      },
      {
        "Time_Start": 797.5,
        "Time_End": 803.5,
        "Text": " we are network service in this case,"
      },
      {
        "Time_Start": 803.5,
        "Time_End": 807.5,
        "Text": " because the process is the RPSS service."
      },
      {
        "Time_Start": 807.5,
        "Time_End": 810.5,
        "Text": " Network service is not that interesting,"
      },
      {
        "Time_Start": 810.5,
        "Time_End": 814.5,
        "Text": " but in this process, the RPSS service,"
      },
      {
        "Time_Start": 814.5,
        "Time_End": 820.5,
        "Text": " we have the authentication ID of the RPSS,"
      },
      {
        "Time_Start": 820.5,
        "Time_End": 825.5,
        "Text": " which permits us to access a lot of juicy tokens,"
      },
      {
        "Time_Start": 825.5,
        "Time_End": 827.5,
        "Text": " system code tokens, and whatever."
      },
      {
        "Time_Start": 827.5,
        "Time_End": 831.5,
        "Text": " So with a simple token kidnapping,"
      },
      {
        "Time_Start": 831.5,
        "Time_End": 833.5,
        "Text": " once we have access to the process,"
      },
      {
        "Time_Start": 833.5,
        "Time_End": 836.5,
        "Text": " we kidnap the token of the system user,"
      },
      {
        "Time_Start": 836.5,
        "Time_End": 838.5,
        "Text": " and then we authenticate,"
      },
      {
        "Time_Start": 838.5,
        "Time_End": 841.5,
        "Text": " and then we use this token for creating new processes."
      },
      {
        "Time_Start": 841.5,
        "Time_End": 845.5,
        "Text": " This is a simple screenshot on how RockPotato works."
      },
      {
        "Time_Start": 845.5,
        "Time_End": 848.5,
        "Text": " Classic web shell with a CMD."
      },
      {
        "Time_Start": 848.5,
        "Time_End": 851.5,
        "Text": " I am the default IIS user,"
      },
      {
        "Time_Start": 851.5,
        "Time_End": 853.5,
        "Text": " which has impersonation privileges."
      },
      {
        "Time_Start": 853.5,
        "Time_End": 858.5,
        "Text": " I launch my tool, and I get back a system shell."
      },
      {
        "Time_Start": 858.5,
        "Time_End": 861.5,
        "Text": " So again, a safety boundary violation."
      },
      {
        "Time_Start": 864.5,
        "Time_End": 865.5,
        "Text": " With this idea in mind,"
      },
      {
        "Time_Start": 865.5,
        "Time_End": 869.5,
        "Text": " so intercepting the second authentication and abusing profit too,"
      },
      {
        "Time_Start": 869.5,
        "Time_End": 873.5,
        "Text": " we also rewrote part of Juicy Potato"
      },
      {
        "Time_Start": 873.5,
        "Time_End": 877.5,
        "Text": " so that it is possible to intercept the second authentication,"
      },
      {
        "Time_Start": 877.5,
        "Time_End": 881.5,
        "Text": " and in the meantime, using a trick from James Forshaw,"
      },
      {
        "Time_Start": 881.5,
        "Time_End": 884.5,
        "Text": " we could also get rid of the socket redirector,"
      },
      {
        "Time_Start": 884.5,
        "Time_End": 886.5,
        "Text": " because we are no more interested in the first authentication,"
      },
      {
        "Time_Start": 886.5,
        "Time_End": 888.5,
        "Text": " but in the second authentication,"
      },
      {
        "Time_Start": 888.5,
        "Time_End": 890.5,
        "Text": " which is returned via the string bindings"
      },
      {
        "Time_Start": 890.5,
        "Time_End": 893.5,
        "Text": " by our fake auxit resolver."
      },
      {
        "Time_Start": 893.5,
        "Time_End": 897.5,
        "Text": " So we are able to intercept this authentication,"
      },
      {
        "Time_Start": 897.5,
        "Time_End": 899.5,
        "Text": " but sadly, in this case,"
      },
      {
        "Time_Start": 899.5,
        "Time_End": 902.5,
        "Text": " we don't have that much CLS ID to abuse,"
      },
      {
        "Time_Start": 903.5,
        "Time_End": 907.5,
        "Text": " because most of them return you an identification token,"
      },
      {
        "Time_Start": 907.5,
        "Time_End": 909.5,
        "Text": " which is really useless."
      },
      {
        "Time_Start": 909.5,
        "Time_End": 911.5,
        "Text": " Then there was the PrintNotify service,"
      },
      {
        "Time_Start": 911.5,
        "Time_End": 913.5,
        "Text": " which was the perfect candidate,"
      },
      {
        "Time_Start": 913.5,
        "Time_End": 915.5,
        "Text": " because it returned an impersonation token,"
      },
      {
        "Time_Start": 915.5,
        "Time_End": 917.5,
        "Text": " but then it was a problem,"
      },
      {
        "Time_Start": 917.5,
        "Time_End": 919.5,
        "Text": " because it needed the interactive seed."
      },
      {
        "Time_Start": 919.5,
        "Time_End": 922.5,
        "Text": " So we used a trick to recover the interactive seed,"
      },
      {
        "Time_Start": 922.5,
        "Time_End": 929.5,
        "Text": " and we were able to perform the full escalation."
      },
      {
        "Time_Start": 929.5,
        "Time_End": 935.5,
        "Text": " After some months, Microsoft fixed the possibility to use this trick,"
      },
      {
        "Time_Start": 935.5,
        "Time_End": 940.5,
        "Text": " but luckily, starting from Windows 11 and Windows Server 2022,"
      },
      {
        "Time_Start": 940.5,
        "Time_End": 944.5,
        "Text": " we have this other service, the MCP management service,"
      },
      {
        "Time_Start": 944.5,
        "Time_End": 946.5,
        "Text": " which has its own CLS ID,"
      },
      {
        "Time_Start": 946.5,
        "Time_End": 948.5,
        "Text": " and which permits you, again,"
      },
      {
        "Time_Start": 948.5,
        "Time_End": 951.5,
        "Text": " to get an authentication from the system"
      },
      {
        "Time_Start": 951.5,
        "Time_End": 954.5,
        "Text": " with the impersonation token."
      },
      {
        "Time_Start": 954.5,
        "Time_End": 955.5,
        "Text": " So it's okay."
      },
      {
        "Time_Start": 955.5,
        "Time_End": 957.5,
        "Text": " So basically, what we did,"
      },
      {
        "Time_Start": 957.5,
        "Time_End": 960.5,
        "Text": " I called it a juicy potato NG,"
      },
      {
        "Time_Start": 960.5,
        "Time_End": 963.5,
        "Text": " so we gave a second chance to a juicy potato."
      },
      {
        "Time_Start": 963.5,
        "Time_End": 964.5,
        "Text": " And this still works,"
      },
      {
        "Time_Start": 964.5,
        "Time_End": 970.5,
        "Text": " but again, we are always talking about safety boundary violations."
      },
      {
        "Time_Start": 970.5,
        "Time_End": 973.5,
        "Text": " So in this screenshot, you can see very, very easy"
      },
      {
        "Time_Start": 973.5,
        "Time_End": 976.5,
        "Text": " to, once you have an impersonation privilege"
      },
      {
        "Time_Start": 976.5,
        "Time_End": 979.5,
        "Text": " or an assigned primary token privilege,"
      },
      {
        "Time_Start": 979.5,
        "Time_End": 980.5,
        "Text": " escalate to system,"
      },
      {
        "Time_Start": 980.5,
        "Time_End": 984.5,
        "Text": " just launch the tool, and you're done."
      },
      {
        "Time_Start": 985.5,
        "Time_End": 988.5,
        "Text": " Obviously, there are a lot of other contributors"
      },
      {
        "Time_Start": 988.5,
        "Time_End": 991.5,
        "Text": " with a lot of other cool potato techniques."
      },
      {
        "Time_Start": 991.5,
        "Time_End": 992.5,
        "Text": " Here are some of them."
      },
      {
        "Time_Start": 992.5,
        "Time_End": 994.5,
        "Text": " Always safety boundary violations,"
      },
      {
        "Time_Start": 994.5,
        "Time_End": 997.5,
        "Text": " and there are also other new ones,"
      },
      {
        "Time_Start": 997.5,
        "Time_End": 999.5,
        "Text": " so it's up to you."
      },
      {
        "Time_Start": 999.5,
        "Time_End": 1001.5,
        "Text": " But there are a lot of other possibilities"
      },
      {
        "Time_Start": 1001.5,
        "Time_End": 1003.5,
        "Text": " to abuse these potato techniques,"
      },
      {
        "Time_Start": 1003.5,
        "Time_End": 1008.5,
        "Text": " so I only describe the one we found in this case."
      },
      {
        "Time_Start": 1009.5,
        "Time_End": 1017.5,
        "Text": " So let's get it a little bit more interesting."
      },
      {
        "Time_Start": 1017.5,
        "Time_End": 1021.5,
        "Text": " With rock potato, with the technique of rock potato,"
      },
      {
        "Time_Start": 1021.5,
        "Time_End": 1022.5,
        "Text": " so we thought,"
      },
      {
        "Time_Start": 1022.5,
        "Time_End": 1026.5,
        "Text": " but is it possible to perform a real privilege escalation?"
      },
      {
        "Time_Start": 1026.5,
        "Time_End": 1029.5,
        "Text": " Because we have all the elements."
      },
      {
        "Time_Start": 1029.5,
        "Time_End": 1033.5,
        "Text": " We have to understand how we can abuse the authentication,"
      },
      {
        "Time_Start": 1033.5,
        "Time_End": 1036.5,
        "Text": " and if you can get another type of authentication."
      },
      {
        "Time_Start": 1036.5,
        "Time_End": 1039.5,
        "Text": " And here comes remote potato zero,"
      },
      {
        "Time_Start": 1039.5,
        "Time_End": 1044.5,
        "Text": " which is the first security boundary violations."
      },
      {
        "Time_Start": 1044.5,
        "Time_End": 1048.5,
        "Text": " In this case, we are relaying the NTLM authentication."
      },
      {
        "Time_Start": 1048.5,
        "Time_End": 1050.5,
        "Text": " It's a local exploit,"
      },
      {
        "Time_Start": 1050.5,
        "Time_End": 1054.5,
        "Text": " but the relay is performed on a remote server,"
      },
      {
        "Time_Start": 1054.5,
        "Time_End": 1057.5,
        "Text": " and what does the remote potato do?"
      },
      {
        "Time_Start": 1057.5,
        "Time_End": 1059.5,
        "Text": " It abuses some com servers,"
      },
      {
        "Time_Start": 1059.5,
        "Time_End": 1062.5,
        "Text": " which impersonates the logged-in user,"
      },
      {
        "Time_Start": 1062.5,
        "Time_End": 1063.5,
        "Text": " and this is interesting,"
      },
      {
        "Time_Start": 1063.5,
        "Time_End": 1069.5,
        "Text": " because the idea is intercept the authentication"
      },
      {
        "Time_Start": 1069.5,
        "Time_End": 1073.5,
        "Text": " of the user connected on another session,"
      },
      {
        "Time_Start": 1073.5,
        "Time_End": 1076.5,
        "Text": " and relay the authentication to an external server."
      },
      {
        "Time_Start": 1076.5,
        "Time_End": 1080.5,
        "Text": " So imagine that if you have an admin or whatever user"
      },
      {
        "Time_Start": 1080.5,
        "Time_End": 1083.5,
        "Text": " which other privileges connected,"
      },
      {
        "Time_Start": 1083.5,
        "Time_End": 1087.5,
        "Text": " I can trigger his authentication"
      },
      {
        "Time_Start": 1087.5,
        "Time_End": 1091.5,
        "Text": " and forward the authentication via NTLM"
      },
      {
        "Time_Start": 1091.5,
        "Time_End": 1092.5,
        "Text": " to a target server,"
      },
      {
        "Time_Start": 1092.5,
        "Time_End": 1097.5,
        "Text": " where I want to access resources on behalf of this user."
      },
      {
        "Time_Start": 1097.5,
        "Time_End": 1101.5,
        "Text": " We had the problem because by default signing was enabled,"
      },
      {
        "Time_Start": 1101.5,
        "Time_End": 1103.5,
        "Text": " so this limits somehow,"
      },
      {
        "Time_Start": 1103.5,
        "Time_End": 1105.5,
        "Text": " but with another trick,"
      },
      {
        "Time_Start": 1105.5,
        "Time_End": 1108.5,
        "Text": " we were able to downgrade to RPC-level connect,"
      },
      {
        "Time_Start": 1108.5,
        "Time_End": 1111.5,
        "Text": " which means then signing is no more enabled,"
      },
      {
        "Time_Start": 1111.5,
        "Time_End": 1114.5,
        "Text": " via the Resolve Auxit 2 call."
      },
      {
        "Time_Start": 1114.5,
        "Time_End": 1117.5,
        "Text": " So the main scenario is obviously"
      },
      {
        "Time_Start": 1117.5,
        "Time_End": 1120.5,
        "Text": " when you have a privileged user"
      },
      {
        "Time_Start": 1120.5,
        "Time_End": 1122.5,
        "Text": " in a multi-user environment,"
      },
      {
        "Time_Start": 1122.5,
        "Time_End": 1125.5,
        "Text": " imagine a remote desktop,"
      },
      {
        "Time_Start": 1125.5,
        "Time_End": 1126.5,
        "Text": " a privileged user,"
      },
      {
        "Time_Start": 1126.5,
        "Time_End": 1128.5,
        "Text": " I trigger his authentication,"
      },
      {
        "Time_Start": 1128.5,
        "Time_End": 1130.5,
        "Text": " and I relate to LDAP."
      },
      {
        "Time_Start": 1130.5,
        "Time_End": 1131.5,
        "Text": " Imagine a domain admin."
      },
      {
        "Time_Start": 1131.5,
        "Time_End": 1135.5,
        "Text": " I know that domain admin should never log on on non-tier 0,"
      },
      {
        "Time_Start": 1135.5,
        "Time_End": 1138.5,
        "Text": " but who knows, maybe it could be possible."
      },
      {
        "Time_Start": 1138.5,
        "Time_End": 1140.5,
        "Text": " So you can relate,"
      },
      {
        "Time_Start": 1140.5,
        "Time_End": 1143.5,
        "Text": " and at this point,"
      },
      {
        "Time_Start": 1143.5,
        "Time_End": 1146.5,
        "Text": " you relay the authentication,"
      },
      {
        "Time_Start": 1146.5,
        "Time_End": 1148.5,
        "Text": " and depending on the user you are relaying,"
      },
      {
        "Time_Start": 1148.5,
        "Time_End": 1151.5,
        "Text": " you can take over the domain."
      },
      {
        "Time_Start": 1151.5,
        "Time_End": 1153.5,
        "Text": " So in this screenshot,"
      },
      {
        "Time_Start": 1153.5,
        "Time_End": 1155.5,
        "Text": " it's just an example."
      },
      {
        "Time_Start": 1155.5,
        "Time_End": 1157.5,
        "Text": " We have a standard user,"
      },
      {
        "Time_Start": 1157.5,
        "Time_End": 1159.5,
        "Text": " a domain admin user,"
      },
      {
        "Time_Start": 1159.5,
        "Time_End": 1162.5,
        "Text": " which is connected on another session."
      },
      {
        "Time_Start": 1162.5,
        "Time_End": 1164.5,
        "Text": " I launch the Remote Potatoes 0 tool,"
      },
      {
        "Time_Start": 1164.5,
        "Time_End": 1166.5,
        "Text": " specifying the session,"
      },
      {
        "Time_Start": 1166.5,
        "Time_End": 1169.5,
        "Text": " and then I forward."
      },
      {
        "Time_Start": 1169.5,
        "Time_End": 1172.5,
        "Text": " I am able to intercept the NTLMv2 hashes."
      },
      {
        "Time_Start": 1173.5,
        "Time_End": 1177.5,
        "Text": " I forward the NTLMv2 hashes to an external relay,"
      },
      {
        "Time_Start": 1177.5,
        "Time_End": 1179.5,
        "Text": " for example, NTLM relay,"
      },
      {
        "Time_Start": 1179.5,
        "Time_End": 1182.5,
        "Text": " and then I can do whatever I want."
      },
      {
        "Time_Start": 1182.5,
        "Time_End": 1184.5,
        "Text": " What we did in Remote Potatoes"
      },
      {
        "Time_Start": 1184.5,
        "Time_End": 1189.5,
        "Text": " is also to perform before a local relay"
      },
      {
        "Time_Start": 1189.5,
        "Time_End": 1193.5,
        "Text": " from DCOM to HTTP"
      },
      {
        "Time_Start": 1193.5,
        "Time_End": 1196.5,
        "Text": " so that it is more easy to interface"
      },
      {
        "Time_Start": 1196.5,
        "Time_End": 1198.5,
        "Text": " with external relay tools,"
      },
      {
        "Time_Start": 1198.5,
        "Time_End": 1201.5,
        "Text": " just like, for example, NTLM relay."
      },
      {
        "Time_Start": 1203.5,
        "Time_End": 1207.5,
        "Text": " We obviously reported this to Microsoft"
      },
      {
        "Time_Start": 1207.5,
        "Time_End": 1209.5,
        "Text": " before publishing it,"
      },
      {
        "Time_Start": 1209.5,
        "Time_End": 1212.5,
        "Text": " because for us, it's a security boundary violation."
      },
      {
        "Time_Start": 1212.5,
        "Time_End": 1215.5,
        "Text": " And what Microsoft said,"
      },
      {
        "Time_Start": 1215.5,
        "Time_End": 1217.5,
        "Text": " after a long debate,"
      },
      {
        "Time_Start": 1217.5,
        "Time_End": 1219.5,
        "Text": " a long analysis, and so on,"
      },
      {
        "Time_Start": 1219.5,
        "Time_End": 1221.5,
        "Text": " that server must defend themselves"
      },
      {
        "Time_Start": 1221.5,
        "Time_End": 1223.5,
        "Text": " against relay attacks."
      },
      {
        "Time_Start": 1223.5,
        "Time_End": 1225.5,
        "Text": " And for this occasion,"
      },
      {
        "Time_Start": 1225.5,
        "Time_End": 1228.5,
        "Text": " we created a special T-shirt for this."
      },
      {
        "Time_Start": 1228.5,
        "Time_End": 1230.5,
        "Text": " Sadly, I forgot it,"
      },
      {
        "Time_Start": 1230.5,
        "Time_End": 1232.5,
        "Text": " because I wanted to show you this T-shirt,"
      },
      {
        "Time_Start": 1232.5,
        "Time_End": 1234.5,
        "Text": " but I left it at home."
      },
      {
        "Time_Start": 1237.5,
        "Time_End": 1241.5,
        "Text": " But 18 months later,"
      },
      {
        "Time_Start": 1241.5,
        "Time_End": 1244.5,
        "Text": " kind of unintended fix,"
      },
      {
        "Time_Start": 1244.5,
        "Time_End": 1246.5,
        "Text": " broke Remote Potatoes"
      },
      {
        "Time_Start": 1246.5,
        "Time_End": 1248.5,
        "Text": " because it was no more possible"
      },
      {
        "Time_Start": 1248.5,
        "Time_End": 1250.5,
        "Text": " to control the signing."
      },
      {
        "Time_Start": 1250.5,
        "Time_End": 1252.5,
        "Text": " So it is always signed,"
      },
      {
        "Time_Start": 1252.5,
        "Time_End": 1254.5,
        "Text": " so the relay versus LDAP, for example,"
      },
      {
        "Time_Start": 1254.5,
        "Time_End": 1256.5,
        "Text": " won't work anymore."
      },
      {
        "Time_Start": 1256.5,
        "Time_End": 1259.5,
        "Text": " But it still works"
      },
      {
        "Time_Start": 1259.5,
        "Time_End": 1261.5,
        "Text": " where SMB signing is not required."
      },
      {
        "Time_Start": 1261.5,
        "Time_End": 1264.5,
        "Text": " For example, SMB, HTTP,"
      },
      {
        "Time_Start": 1264.5,
        "Time_End": 1266.5,
        "Text": " SMB signing is not required,"
      },
      {
        "Time_Start": 1266.5,
        "Time_End": 1269.5,
        "Text": " but normally the default is on domain controller, yes,"
      },
      {
        "Time_Start": 1269.5,
        "Time_End": 1271.5,
        "Text": " but on file server and so on,"
      },
      {
        "Time_Start": 1271.5,
        "Time_End": 1274.5,
        "Text": " we leave the default, which is not signed."
      },
      {
        "Time_Start": 1274.5,
        "Time_End": 1277.5,
        "Text": " So you can do, a malicious actor"
      },
      {
        "Time_Start": 1277.5,
        "Time_End": 1279.5,
        "Text": " can do a lot of nasty things,"
      },
      {
        "Time_Start": 1279.5,
        "Time_End": 1281.5,
        "Text": " still can do a lot of nasty things"
      },
      {
        "Time_Start": 1281.5,
        "Time_End": 1283.5,
        "Text": " with Remote Potatoes 0."
      },
      {
        "Time_Start": 1287.5,
        "Time_End": 1291.5,
        "Text": " So move on, on Local Potato."
      },
      {
        "Time_Start": 1293.5,
        "Time_End": 1295.5,
        "Text": " This is a curious story,"
      },
      {
        "Time_Start": 1295.5,
        "Time_End": 1299.5,
        "Text": " because it's kind of,"
      },
      {
        "Time_Start": 1299.5,
        "Time_End": 1301.5,
        "Text": " I wouldn't call it a bug,"
      },
      {
        "Time_Start": 1301.5,
        "Time_End": 1304.5,
        "Text": " but again, it's by design."
      },
      {
        "Time_Start": 1304.5,
        "Time_End": 1307.5,
        "Text": " In the local and telemetry authentication,"
      },
      {
        "Time_Start": 1307.5,
        "Time_End": 1309.5,
        "Text": " so we are again speaking about local,"
      },
      {
        "Time_Start": 1309.5,
        "Time_End": 1311.5,
        "Text": " local and telemetry authentication is a particular authentication,"
      },
      {
        "Time_Start": 1311.5,
        "Time_End": 1314.5,
        "Text": " it's a loopback local authentication,"
      },
      {
        "Time_Start": 1315.5,
        "Time_End": 1317.5,
        "Text": " there is a reserved field,"
      },
      {
        "Time_Start": 1317.5,
        "Time_End": 1319.5,
        "Text": " which is called reserved field,"
      },
      {
        "Time_Start": 1319.5,
        "Time_End": 1321.5,
        "Text": " that is very interesting,"
      },
      {
        "Time_Start": 1321.5,
        "Time_End": 1324.5,
        "Text": " and thanks to our friend Ilad Shamir,"
      },
      {
        "Time_Start": 1324.5,
        "Time_End": 1326.5,
        "Text": " which gave us this hint,"
      },
      {
        "Time_Start": 1326.5,
        "Time_End": 1329.5,
        "Text": " we tried to understand if it is possible"
      },
      {
        "Time_Start": 1329.5,
        "Time_End": 1331.5,
        "Text": " somehow to abuse this field,"
      },
      {
        "Time_Start": 1331.5,
        "Time_End": 1334.5,
        "Text": " because we had in mind a kind of swapping,"
      },
      {
        "Time_Start": 1334.5,
        "Time_End": 1337.5,
        "Text": " and this is what we did."
      },
      {
        "Time_Start": 1337.5,
        "Time_End": 1339.5,
        "Text": " So in the local authentication,"
      },
      {
        "Time_Start": 1339.5,
        "Time_End": 1344.5,
        "Text": " the reserved field references the LSAS context,"
      },
      {
        "Time_Start": 1346.5,
        "Time_End": 1348.5,
        "Text": " where the user should,"
      },
      {
        "Time_Start": 1348.5,
        "Time_End": 1351.5,
        "Text": " where the authentication should occur,"
      },
      {
        "Time_Start": 1351.5,
        "Time_End": 1353.5,
        "Text": " associate and occur."
      },
      {
        "Time_Start": 1353.5,
        "Time_End": 1355.5,
        "Text": " So the idea is,"
      },
      {
        "Time_Start": 1357.5,
        "Time_End": 1361.5,
        "Text": " why not triggering the authentication"
      },
      {
        "Time_Start": 1361.5,
        "Time_End": 1363.5,
        "Text": " of a privileged user,"
      },
      {
        "Time_Start": 1363.5,
        "Time_End": 1365.5,
        "Text": " of a system account,"
      },
      {
        "Time_Start": 1365.5,
        "Time_End": 1368.5,
        "Text": " swap the context with a user under our control,"
      },
      {
        "Time_Start": 1368.5,
        "Time_End": 1371.5,
        "Text": " and then authenticate to another server,"
      },
      {
        "Time_Start": 1371.5,
        "Time_End": 1374.5,
        "Text": " to another service running on the same machine,"
      },
      {
        "Time_Start": 1374.5,
        "Time_End": 1377.5,
        "Text": " because it's always a local privilege escalation,"
      },
      {
        "Time_Start": 1377.5,
        "Time_End": 1380.5,
        "Text": " and that was what we had in mind."
      },
      {
        "Time_Start": 1383.5,
        "Time_End": 1386.5,
        "Text": " First of all, we trigger a system authentication,"
      },
      {
        "Time_Start": 1386.5,
        "Time_End": 1388.5,
        "Text": " and we know how to do it."
      },
      {
        "Time_Start": 1388.5,
        "Time_End": 1391.5,
        "Text": " We want to target, for example, the local SMB server,"
      },
      {
        "Time_Start": 1391.5,
        "Time_End": 1394.5,
        "Text": " and perform an arbitrary file write with system privileges,"
      },
      {
        "Time_Start": 1394.5,
        "Time_End": 1397.5,
        "Text": " which is really the key to the kingdom."
      },
      {
        "Time_Start": 1398.5,
        "Time_End": 1401.5,
        "Text": " We had to overcome some anti-reflection mechanisms,"
      },
      {
        "Time_Start": 1401.5,
        "Time_End": 1405.5,
        "Text": " so we have to specify an SPN,"
      },
      {
        "Time_Start": 1405.5,
        "Time_End": 1407.5,
        "Text": " and once everything is set up,"
      },
      {
        "Time_Start": 1407.5,
        "Time_End": 1409.5,
        "Text": " we intercept this authentication,"
      },
      {
        "Time_Start": 1409.5,
        "Time_End": 1411.5,
        "Text": " we magically swap them,"
      },
      {
        "Time_Start": 1411.5,
        "Time_End": 1415.5,
        "Text": " and then what would happen?"
      },
      {
        "Time_Start": 1415.5,
        "Time_End": 1419.5,
        "Text": " That we are able to authenticate as a system"
      },
      {
        "Time_Start": 1419.5,
        "Time_End": 1421.5,
        "Text": " to the SMB server,"
      },
      {
        "Time_Start": 1421.5,
        "Time_End": 1423.5,
        "Text": " and then once you have an arbitrary file write,"
      },
      {
        "Time_Start": 1423.5,
        "Time_End": 1425.5,
        "Text": " it's up to you to understand how you could abuse it."
      },
      {
        "Time_Start": 1425.5,
        "Time_End": 1430.5,
        "Text": " For example, we hijacked the printconfig.dll"
      },
      {
        "Time_Start": 1430.5,
        "Time_End": 1433.5,
        "Text": " in the printer service,"
      },
      {
        "Time_Start": 1433.5,
        "Time_End": 1436.5,
        "Text": " and we were able to use our malicious DLL"
      },
      {
        "Time_Start": 1436.5,
        "Time_End": 1440.5,
        "Text": " to get a shell, for example, as a system."
      },
      {
        "Time_Start": 1440.5,
        "Time_End": 1443.5,
        "Text": " So how does this work?"
      },
      {
        "Time_Start": 1443.5,
        "Time_End": 1449.5,
        "Text": " We have, first of all, our privileged client,"
      },
      {
        "Time_Start": 1449.5,
        "Time_End": 1453.5,
        "Text": " and we trigger the authentication of our privileged client,"
      },
      {
        "Time_Start": 1453.5,
        "Time_End": 1457.5,
        "Text": " and we associate it with context, let's say A."
      },
      {
        "Time_Start": 1457.5,
        "Time_End": 1462.5,
        "Text": " Then we have also a client process under our control,"
      },
      {
        "Time_Start": 1462.5,
        "Time_End": 1467.5,
        "Text": " which tries to authenticate"
      },
      {
        "Time_Start": 1467.5,
        "Time_End": 1470.5,
        "Text": " versus the server service,"
      },
      {
        "Time_Start": 1470.5,
        "Time_End": 1472.5,
        "Text": " for example, the SMB server,"
      },
      {
        "Time_Start": 1472.5,
        "Time_End": 1475.5,
        "Text": " and our client gets back the context B."
      },
      {
        "Time_Start": 1475.5,
        "Time_End": 1477.5,
        "Text": " Then we swap the context,"
      },
      {
        "Time_Start": 1477.5,
        "Time_End": 1481.5,
        "Text": " so that the privileged client"
      },
      {
        "Time_Start": 1481.5,
        "Time_End": 1484.5,
        "Text": " will associate with context B,"
      },
      {
        "Time_Start": 1484.5,
        "Time_End": 1488.5,
        "Text": " and our client contacts with context A."
      },
      {
        "Time_Start": 1488.5,
        "Time_End": 1494.5,
        "Text": " And at the end, if everything works fine,"
      },
      {
        "Time_Start": 1494.5,
        "Time_End": 1497.5,
        "Text": " the privileged client will authenticate"
      },
      {
        "Time_Start": 1497.5,
        "Time_End": 1500.5,
        "Text": " against the server service, SMB in this case,"
      },
      {
        "Time_Start": 1500.5,
        "Time_End": 1503.5,
        "Text": " and the client process"
      },
      {
        "Time_Start": 1503.5,
        "Time_End": 1507.5,
        "Text": " will authenticate against our server service."
      },
      {
        "Time_Start": 1512.5,
        "Time_End": 1517.5,
        "Text": " Okay, I have also a video demonstrating this."
      },
      {
        "Time_Start": 1521.5,
        "Time_End": 1525.5,
        "Text": " You see, I have here a standard user"
      },
      {
        "Time_Start": 1525.5,
        "Time_End": 1528.5,
        "Text": " without particular privileges,"
      },
      {
        "Time_Start": 1528.5,
        "Time_End": 1534.5,
        "Text": " and my goal is to overwrite the printconfig.dll."
      },
      {
        "Time_Start": 1536.5,
        "Time_End": 1539.5,
        "Text": " Okay, I get no output here."
      },
      {
        "Time_Start": 1539.5,
        "Time_End": 1541.5,
        "Text": " Something strange happening."
      },
      {
        "Time_Start": 1543.5,
        "Time_End": 1545.5,
        "Text": " No."
      },
      {
        "Time_Start": 1557.5,
        "Time_End": 1561.5,
        "Text": " Okay, let's do it another way."
      },
      {
        "Time_Start": 1569.5,
        "Time_End": 1571.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 1582.5,
        "Time_End": 1584.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 1584.5,
        "Time_End": 1587.5,
        "Text": " It's not easy now, but..."
      },
      {
        "Time_Start": 1587.5,
        "Time_End": 1589.5,
        "Text": " Ah, sorry."
      },
      {
        "Time_Start": 1591.5,
        "Time_End": 1594.5,
        "Text": " Okay, we skip the video for now, and then we'll see."
      },
      {
        "Time_Start": 1595.5,
        "Time_End": 1600.5,
        "Text": " So, extend this display."
      },
      {
        "Time_Start": 1600.5,
        "Time_End": 1602.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 1602.5,
        "Time_End": 1604.5,
        "Text": " Hmm."
      },
      {
        "Time_Start": 1624.5,
        "Time_End": 1626.5,
        "Text": " It's frozen."
      },
      {
        "Time_Start": 1627.5,
        "Time_End": 1629.5,
        "Text": " Sorry, but..."
      },
      {
        "Time_Start": 1632.5,
        "Time_End": 1635.5,
        "Text": " It's more than the demo effect."
      },
      {
        "Time_Start": 1635.5,
        "Time_End": 1638.5,
        "Text": " It's always Windows, no problem."
      },
      {
        "Time_Start": 1644.5,
        "Time_End": 1646.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 1656.5,
        "Time_End": 1658.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 1672.5,
        "Time_End": 1675.5,
        "Text": " Something is not working because..."
      },
      {
        "Time_Start": 1675.5,
        "Time_End": 1677.5,
        "Text": " I still..."
      },
      {
        "Time_Start": 1678.5,
        "Time_End": 1680.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 1680.5,
        "Time_End": 1683.5,
        "Text": " Okay, without showing the video, but here you get it."
      },
      {
        "Time_Start": 1683.5,
        "Time_End": 1686.5,
        "Text": " I am able, with our local potato exploit,"
      },
      {
        "Time_Start": 1686.5,
        "Time_End": 1688.5,
        "Text": " to overwrite the DLL,"
      },
      {
        "Time_Start": 1688.5,
        "Time_End": 1690.5,
        "Text": " then I instantiate the object,"
      },
      {
        "Time_Start": 1690.5,
        "Time_End": 1693.5,
        "Text": " and I get back a system shell"
      },
      {
        "Time_Start": 1693.5,
        "Time_End": 1695.5,
        "Text": " because in my DLL I put the instruction"
      },
      {
        "Time_Start": 1695.5,
        "Time_End": 1697.5,
        "Text": " for returning a shell."
      },
      {
        "Time_Start": 1697.5,
        "Time_End": 1698.5,
        "Text": " That's all."
      },
      {
        "Time_Start": 1698.5,
        "Time_End": 1700.5,
        "Text": " That's clearly..."
      },
      {
        "Time_Start": 1700.5,
        "Time_End": 1701.5,
        "Text": " No problem."
      },
      {
        "Time_Start": 1701.5,
        "Time_End": 1705.5,
        "Text": " That's clearly a privilege escalation, obviously."
      },
      {
        "Time_Start": 1705.5,
        "Time_End": 1707.5,
        "Text": " And..."
      },
      {
        "Time_Start": 1709.5,
        "Time_End": 1711.5,
        "Text": " If I can get out of this video."
      },
      {
        "Time_Start": 1711.5,
        "Time_End": 1715.5,
        "Text": " And clearly Microsoft fixed it with this CVE."
      },
      {
        "Time_Start": 1715.5,
        "Time_End": 1719.5,
        "Text": " And what Microsoft did is that..."
      },
      {
        "Time_Start": 1719.5,
        "Time_End": 1722.5,
        "Text": " This is the reverse engineering of the fix"
      },
      {
        "Time_Start": 1722.5,
        "Time_End": 1724.5,
        "Text": " which was done in this DLL."
      },
      {
        "Time_Start": 1724.5,
        "Time_End": 1727.5,
        "Text": " If the caller is from an unverified source,"
      },
      {
        "Time_Start": 1727.5,
        "Time_End": 1729.5,
        "Text": " and this flag is set by the TComp client,"
      },
      {
        "Time_Start": 1729.5,
        "Time_End": 1732.5,
        "Text": " and if the SPN set is set,"
      },
      {
        "Time_Start": 1732.5,
        "Time_End": 1735.5,
        "Text": " the SPN is deleted,"
      },
      {
        "Time_Start": 1735.5,
        "Time_End": 1740.5,
        "Text": " so the anti-reflection mechanism won't work,"
      },
      {
        "Time_Start": 1740.5,
        "Time_End": 1742.5,
        "Text": " because I have no SPN,"
      },
      {
        "Time_Start": 1742.5,
        "Time_End": 1744.5,
        "Text": " and the exploit breaks."
      },
      {
        "Time_Start": 1744.5,
        "Time_End": 1746.5,
        "Text": " So, but..."
      },
      {
        "Time_Start": 1746.5,
        "Time_End": 1749.5,
        "Text": " It still works against HTTP."
      },
      {
        "Time_Start": 1749.5,
        "Time_End": 1752.5,
        "Text": " WebDAV, it's a very, very edge case,"
      },
      {
        "Time_Start": 1752.5,
        "Time_End": 1753.5,
        "Text": " but it still works."
      },
      {
        "Time_Start": 1753.5,
        "Time_End": 1756.5,
        "Text": " Or, versus custom authentication,"
      },
      {
        "Time_Start": 1756.5,
        "Time_End": 1760.5,
        "Text": " which uses the security provider."
      },
      {
        "Time_Start": 1761.5,
        "Time_End": 1763.5,
        "Text": " And Microsoft did not want to fix the second one,"
      },
      {
        "Time_Start": 1763.5,
        "Time_End": 1767.5,
        "Text": " because we reported already the second one."
      },
      {
        "Time_Start": 1767.5,
        "Time_End": 1770.5,
        "Text": " They said, no, but this is too complicated,"
      },
      {
        "Time_Start": 1770.5,
        "Time_End": 1771.5,
        "Text": " so it's an edge case,"
      },
      {
        "Time_Start": 1771.5,
        "Time_End": 1774.5,
        "Text": " so you have to protect your endpoint,"
      },
      {
        "Time_Start": 1774.5,
        "Time_End": 1776.5,
        "Text": " you have to use extended protection,"
      },
      {
        "Time_Start": 1776.5,
        "Time_End": 1778.5,
        "Text": " blah, blah, blah, blah, blah, blah,"
      },
      {
        "Time_Start": 1778.5,
        "Time_End": 1779.5,
        "Text": " and it is not fixed."
      },
      {
        "Time_Start": 1779.5,
        "Time_End": 1781.5,
        "Text": " So, if you go on my blog post,"
      },
      {
        "Time_Start": 1781.5,
        "Time_End": 1784.5,
        "Text": " I think I published also the..."
      },
      {
        "Time_Start": 1784.5,
        "Time_End": 1786.5,
        "Text": " No, the latest local potato source code"
      },
      {
        "Time_Start": 1786.5,
        "Time_End": 1787.5,
        "Text": " is also for HTTP,"
      },
      {
        "Time_Start": 1787.5,
        "Time_End": 1788.5,
        "Text": " so you can try it at home,"
      },
      {
        "Time_Start": 1788.5,
        "Time_End": 1790.5,
        "Text": " and see that it still works."
      },
      {
        "Time_Start": 1792.5,
        "Time_End": 1794.5,
        "Text": " Then comes fake potato."
      },
      {
        "Time_Start": 1794.5,
        "Time_End": 1796.5,
        "Text": " Fake potato is the one with the asterisk,"
      },
      {
        "Time_Start": 1796.5,
        "Time_End": 1798.5,
        "Text": " because it was discovered by me"
      },
      {
        "Time_Start": 1800.5,
        "Time_End": 1802.5,
        "Text": " three months ago, let's say so,"
      },
      {
        "Time_Start": 1802.5,
        "Time_End": 1805.5,
        "Text": " and it's a local privilege escalation,"
      },
      {
        "Time_Start": 1808.5,
        "Time_End": 1811.5,
        "Text": " still waiting for Microsoft fix,"
      },
      {
        "Time_Start": 1811.5,
        "Time_End": 1815.5,
        "Text": " so, unfortunately, I cannot spoil that much."
      },
      {
        "Time_Start": 1816.5,
        "Time_End": 1819.5,
        "Text": " It's not exactly a potato technique,"
      },
      {
        "Time_Start": 1819.5,
        "Time_End": 1821.5,
        "Text": " so it's something a little bit different,"
      },
      {
        "Time_Start": 1821.5,
        "Time_End": 1824.5,
        "Text": " and it's cool, because it's logic pack,"
      },
      {
        "Time_Start": 1824.5,
        "Time_End": 1828.5,
        "Text": " I think it was there from Windows 2000,"
      },
      {
        "Time_Start": 1828.5,
        "Time_End": 1830.5,
        "Text": " so it's something that,"
      },
      {
        "Time_Start": 1830.5,
        "Time_End": 1833.5,
        "Text": " I don't know why it was never found,"
      },
      {
        "Time_Start": 1833.5,
        "Time_End": 1836.5,
        "Text": " and because it requires an unexpected prerequisite,"
      },
      {
        "Time_Start": 1836.5,
        "Time_End": 1839.5,
        "Text": " but which is not that strange,"
      },
      {
        "Time_Start": 1839.5,
        "Time_End": 1841.5,
        "Text": " so, and when I discover this,"
      },
      {
        "Time_Start": 1841.5,
        "Time_End": 1842.5,
        "Text": " no, it's not possible,"
      },
      {
        "Time_Start": 1842.5,
        "Time_End": 1846.5,
        "Text": " it's something that fucked up on my machine,"
      },
      {
        "Time_Start": 1846.5,
        "Time_End": 1848.5,
        "Text": " and Microsoft confirmed that"
      },
      {
        "Time_Start": 1848.5,
        "Time_End": 1852.5,
        "Text": " it is a security boundary violation,"
      },
      {
        "Time_Start": 1852.5,
        "Time_End": 1854.5,
        "Text": " so it has to be fixed."
      },
      {
        "Time_Start": 1854.5,
        "Time_End": 1856.5,
        "Text": " I have a video, I don't know,"
      },
      {
        "Time_Start": 1856.5,
        "Time_End": 1859.5,
        "Text": " I pray the God,"
      },
      {
        "Time_Start": 1859.5,
        "Time_End": 1862.5,
        "Text": " but before showing you the video,"
      },
      {
        "Time_Start": 1863.5,
        "Time_End": 1866.5,
        "Text": " I obviously asked to Microsoft,"
      },
      {
        "Time_Start": 1866.5,
        "Time_End": 1867.5,
        "Text": " and they told me,"
      },
      {
        "Time_Start": 1867.5,
        "Time_End": 1868.5,
        "Text": " okay, send us the video,"
      },
      {
        "Time_Start": 1868.5,
        "Time_End": 1871.5,
        "Text": " in order to avoid the usual drama,"
      },
      {
        "Time_Start": 1871.5,
        "Time_End": 1872.5,
        "Text": " so send us the video,"
      },
      {
        "Time_Start": 1872.5,
        "Time_End": 1874.5,
        "Text": " and we will tell you if it's okay or not,"
      },
      {
        "Time_Start": 1874.5,
        "Time_End": 1876.5,
        "Text": " and you can see the mail,"
      },
      {
        "Time_Start": 1876.5,
        "Time_End": 1877.5,
        "Text": " they told me,"
      },
      {
        "Time_Start": 1877.5,
        "Time_End": 1879.5,
        "Text": " okay, you can show the video,"
      },
      {
        "Time_Start": 1879.5,
        "Time_End": 1882.5,
        "Text": " but do not spoil other things,"
      },
      {
        "Time_Start": 1882.5,
        "Time_End": 1884.5,
        "Text": " so I will only show you the video,"
      },
      {
        "Time_Start": 1884.5,
        "Time_End": 1885.5,
        "Text": " and I won't talk."
      },
      {
        "Time_Start": 1886.5,
        "Time_End": 1888.5,
        "Text": " Will it work now?"
      },
      {
        "Time_Start": 1889.5,
        "Time_End": 1891.5,
        "Text": " That's a good question."
      },
      {
        "Time_Start": 1902.5,
        "Time_End": 1903.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 1906.5,
        "Time_End": 1908.5,
        "Text": " Oh, okay, okay, great."
      },
      {
        "Time_Start": 1908.5,
        "Time_End": 1909.5,
        "Text": " Oh, okay."
      },
      {
        "Time_Start": 1912.5,
        "Time_End": 1913.5,
        "Text": " In the first,"
      },
      {
        "Time_Start": 1913.5,
        "Time_End": 1916.5,
        "Text": " I have an administrator connected on a session,"
      },
      {
        "Time_Start": 1916.5,
        "Time_End": 1917.5,
        "Text": " another session,"
      },
      {
        "Time_Start": 1917.5,
        "Time_End": 1920.5,
        "Text": " I have another user, standard user, okay,"
      },
      {
        "Time_Start": 1920.5,
        "Time_End": 1921.5,
        "Text": " you see two sessions,"
      },
      {
        "Time_Start": 1921.5,
        "Time_End": 1923.5,
        "Text": " now I launch my fake potato tool"
      },
      {
        "Time_Start": 1923.5,
        "Time_End": 1925.5,
        "Text": " against the admin session,"
      },
      {
        "Time_Start": 1925.5,
        "Time_End": 1927.5,
        "Text": " and let's see what's happened."
      },
      {
        "Time_Start": 1931.5,
        "Time_End": 1934.5,
        "Text": " Oops, desktop changed."
      },
      {
        "Time_Start": 1935.5,
        "Time_End": 1938.5,
        "Text": " But, okay."
      },
      {
        "Time_Start": 1939.5,
        "Time_End": 1942.5,
        "Text": " Let's get more serious, okay?"
      },
      {
        "Time_Start": 1942.5,
        "Time_End": 1946.5,
        "Text": " So, I relaunch the tool with another mode, okay?"
      },
      {
        "Time_Start": 1955.5,
        "Time_End": 1957.5,
        "Text": " And let's see what happens."
      },
      {
        "Time_Start": 1958.5,
        "Time_End": 1961.5,
        "Text": " I get back a shell of the administrator."
      },
      {
        "Time_Start": 1961.5,
        "Time_End": 1963.5,
        "Text": " This is clearly a privilege escalation."
      },
      {
        "Time_Start": 1965.5,
        "Time_End": 1969.5,
        "Text": " But, don't ask me anything, please."
      },
      {
        "Time_Start": 1971.5,
        "Time_End": 1972.5,
        "Text": " Okay?"
      },
      {
        "Time_Start": 1973.5,
        "Time_End": 1977.5,
        "Text": " So, now the last one,"
      },
      {
        "Time_Start": 1977.5,
        "Time_End": 1982.5,
        "Text": " which is the security boundary evaluation from remote."
      },
      {
        "Time_Start": 1982.5,
        "Time_End": 1985.5,
        "Text": " So, the idea behind is very simple."
      },
      {
        "Time_Start": 1986.5,
        "Time_End": 1990.5,
        "Text": " Instead of triggering a local com server,"
      },
      {
        "Time_Start": 1990.5,
        "Time_End": 1992.5,
        "Text": " why not triggering a remote com server?"
      },
      {
        "Time_Start": 1992.5,
        "Time_End": 1997.5,
        "Text": " This would be a great remote local privilege escalation."
      },
      {
        "Time_Start": 1997.5,
        "Time_End": 1998.5,
        "Text": " Okay?"
      },
      {
        "Time_Start": 1999.5,
        "Time_End": 2000.5,
        "Text": " In fact,"
      },
      {
        "Time_Start": 2002.5,
        "Time_End": 2006.5,
        "Text": " obviously an external auxiliary server is required in this case"
      },
      {
        "Time_Start": 2006.5,
        "Time_End": 2008.5,
        "Text": " for the first authentication."
      },
      {
        "Time_Start": 2008.5,
        "Time_End": 2010.5,
        "Text": " It's very, very simple because"
      },
      {
        "Time_Start": 2010.5,
        "Time_End": 2012.5,
        "Text": " with just a few changes on the code"
      },
      {
        "Time_Start": 2012.5,
        "Time_End": 2017.5,
        "Text": " by specifying the remote server and optional credentials,"
      },
      {
        "Time_Start": 2018.5,
        "Time_End": 2021.5,
        "Text": " I should trigger the authentication of a remote server"
      },
      {
        "Time_Start": 2021.5,
        "Time_End": 2023.5,
        "Text": " because it's in the library."
      },
      {
        "Time_Start": 2023.5,
        "Time_End": 2026.5,
        "Text": " I can specify all the local or the remote server."
      },
      {
        "Time_Start": 2026.5,
        "Time_End": 2028.5,
        "Text": " So, that would be great because"
      },
      {
        "Time_Start": 2028.5,
        "Time_End": 2033.5,
        "Text": " once I have captured the authentication NTLM Kerberos,"
      },
      {
        "Time_Start": 2033.5,
        "Time_End": 2034.5,
        "Text": " I could then relay it."
      },
      {
        "Time_Start": 2034.5,
        "Time_End": 2041.5,
        "Text": " And this is also a great opportunity for Kerberos"
      },
      {
        "Time_Start": 2041.5,
        "Time_End": 2043.5,
        "Text": " because I forgot to tell you that"
      },
      {
        "Time_Start": 2043.5,
        "Time_End": 2047.5,
        "Text": " it is possible to relay Kerberos authentication"
      },
      {
        "Time_Start": 2047.5,
        "Time_End": 2049.5,
        "Text": " under certain conditions."
      },
      {
        "Time_Start": 2049.5,
        "Time_End": 2052.5,
        "Text": " If you have the control of the service principal name,"
      },
      {
        "Time_Start": 2052.5,
        "Time_End": 2055.5,
        "Text": " you can perform a Kerberos relay."
      },
      {
        "Time_Start": 2055.5,
        "Time_End": 2058.5,
        "Text": " And this is the perfect scenario because"
      },
      {
        "Time_Start": 2058.5,
        "Time_End": 2063.5,
        "Text": " I am able in my fake OXID resolver to specify the SPN"
      },
      {
        "Time_Start": 2063.5,
        "Time_End": 2067.5,
        "Text": " and so I can relay also the Kerberos authentication."
      },
      {
        "Time_Start": 2067.5,
        "Time_End": 2069.5,
        "Text": " But there is a great but."
      },
      {
        "Time_Start": 2069.5,
        "Time_End": 2073.5,
        "Text": " Non-admin users generally cannot instantiate remote objects."
      },
      {
        "Time_Start": 2073.5,
        "Time_End": 2077.5,
        "Text": " So, to instantiate, to create a COGET instance on the remote,"
      },
      {
        "Time_Start": 2077.5,
        "Time_End": 2081.5,
        "Text": " you need domain admin or local admin rights."
      },
      {
        "Time_Start": 2081.5,
        "Time_End": 2083.5,
        "Text": " So, any chance?"
      },
      {
        "Time_Start": 2083.5,
        "Time_End": 2087.5,
        "Text": " So, I started looking at the DCOM configurations and so on"
      },
      {
        "Time_Start": 2087.5,
        "Time_End": 2090.5,
        "Text": " in order to find vulnerable DCOM server."
      },
      {
        "Time_Start": 2090.5,
        "Time_End": 2092.5,
        "Text": " And the first one I found,"
      },
      {
        "Time_Start": 2092.5,
        "Time_End": 2095.5,
        "Text": " I called it ADCS Squares Potato,"
      },
      {
        "Time_Start": 2095.5,
        "Time_End": 2100.5,
        "Text": " which is related to the certification service."
      },
      {
        "Time_Start": 2100.5,
        "Time_End": 2105.5,
        "Text": " So, on the server where the ADCS services are installed,"
      },
      {
        "Time_Start": 2105.5,
        "Time_End": 2113.5,
        "Text": " there is this group, the Certificate DCOM Access Group,"
      },
      {
        "Time_Start": 2113.5,
        "Time_End": 2117.5,
        "Text": " which contains the authenticated users, everyone."
      },
      {
        "Time_Start": 2117.5,
        "Time_End": 2122.5,
        "Text": " This is needed because users or computers"
      },
      {
        "Time_Start": 2122.5,
        "Time_End": 2126.5,
        "Text": " should be able to request and enroll certificates via DCOM."
      },
      {
        "Time_Start": 2126.5,
        "Time_End": 2130.5,
        "Text": " So, this is clearly something by default."
      },
      {
        "Time_Start": 2130.5,
        "Time_End": 2135.5,
        "Text": " So, users can activate these applications from remote."
      },
      {
        "Time_Start": 2135.5,
        "Time_End": 2138.5,
        "Text": " As you can see, the Certificate DCOM services"
      },
      {
        "Time_Start": 2138.5,
        "Time_End": 2142.5,
        "Text": " have local and remote activation."
      },
      {
        "Time_Start": 2142.5,
        "Time_End": 2147.5,
        "Text": " The certification service DCOM application"
      },
      {
        "Time_Start": 2147.5,
        "Time_End": 2149.5,
        "Text": " impersonates the system account."
      },
      {
        "Time_Start": 2149.5,
        "Time_End": 2152.5,
        "Text": " So, via the network, it's the computer account"
      },
      {
        "Time_Start": 2152.5,
        "Time_End": 2157.5,
        "Text": " and is activable by everyone, every authenticated user."
      },
      {
        "Time_Start": 2157.5,
        "Time_End": 2160.5,
        "Text": " So, what is the idea behind? Very, very simple again."
      },
      {
        "Time_Start": 2160.5,
        "Time_End": 2165.5,
        "Text": " It's just activating this object via the potato technique"
      },
      {
        "Time_Start": 2165.5,
        "Time_End": 2169.5,
        "Text": " that requires the authentication of the server"
      },
      {
        "Time_Start": 2169.5,
        "Time_End": 2173.5,
        "Text": " and we will relay this authentication."
      },
      {
        "Time_Start": 2173.5,
        "Time_End": 2177.5,
        "Text": " So, what can we do when we have the authentication"
      },
      {
        "Time_Start": 2177.5,
        "Time_End": 2180.5,
        "Text": " of the certificate server?"
      },
      {
        "Time_Start": 2180.5,
        "Time_End": 2183.5,
        "Text": " I think we can do a lot of cool things"
      },
      {
        "Time_Start": 2183.5,
        "Time_End": 2187.5,
        "Text": " because this is a Tier 0 computer account."
      },
      {
        "Time_Start": 2187.5,
        "Time_End": 2191.5,
        "Text": " This one was discovered also before me, some time before,"
      },
      {
        "Time_Start": 2191.5,
        "Time_End": 2193.5,
        "Text": " by another Chinese researcher."
      },
      {
        "Time_Start": 2193.5,
        "Time_End": 2195.5,
        "Text": " Unfortunately, I'm horrible in spelling,"
      },
      {
        "Time_Start": 2195.5,
        "Time_End": 2200.5,
        "Text": " so I just say Chinese researchers."
      },
      {
        "Time_Start": 2200.5,
        "Time_End": 2205.5,
        "Text": " It was partially fixed with this CDA."
      },
      {
        "Time_Start": 2205.5,
        "Time_End": 2209.5,
        "Text": " As you can see, again, the concept is always the same."
      },
      {
        "Time_Start": 2209.5,
        "Time_End": 2212.5,
        "Text": " I have a standard user."
      },
      {
        "Time_Start": 2212.5,
        "Time_End": 2214.5,
        "Text": " I request the authentication."
      },
      {
        "Time_Start": 2214.5,
        "Time_End": 2219.5,
        "Text": " The first IP is the IP address of the certification service."
      },
      {
        "Time_Start": 2219.5,
        "Time_End": 2222.5,
        "Text": " And then I have my redirector"
      },
      {
        "Time_Start": 2222.5,
        "Time_End": 2225.5,
        "Text": " where also NTLM relay is running."
      },
      {
        "Time_Start": 2225.5,
        "Time_End": 2229.5,
        "Text": " I pass my credentials and as you can see,"
      },
      {
        "Time_Start": 2229.5,
        "Time_End": 2231.5,
        "Text": " everything was fine."
      },
      {
        "Time_Start": 2231.5,
        "Time_End": 2233.5,
        "Text": " This is the dump of the NTLM messages"
      },
      {
        "Time_Start": 2233.5,
        "Time_End": 2237.5,
        "Text": " and at the end, I get the authentication"
      },
      {
        "Time_Start": 2237.5,
        "Time_End": 2240.5,
        "Text": " of the certificate server."
      },
      {
        "Time_Start": 2240.5,
        "Time_End": 2246.5,
        "Text": " So, what can I do now? Relay it."
      },
      {
        "Time_Start": 2246.5,
        "Time_End": 2249.5,
        "Text": " We have a problem because signing is now enabled,"
      },
      {
        "Time_Start": 2249.5,
        "Time_End": 2253.5,
        "Text": " so we cannot relay versus LDAP or whatever."
      },
      {
        "Time_Start": 2253.5,
        "Time_End": 2257.5,
        "Text": " And we could relay against the HTTP Web Enroll Service"
      },
      {
        "Time_Start": 2257.5,
        "Time_End": 2263.5,
        "Text": " because we then request a certificate of the ADCS server."
      },
      {
        "Time_Start": 2263.5,
        "Time_End": 2266.5,
        "Text": " And as you can imagine, if I have the client,"
      },
      {
        "Time_Start": 2266.5,
        "Time_End": 2271.5,
        "Text": " the certificate for authenticating as the certificate server service,"
      },
      {
        "Time_Start": 2271.5,
        "Time_End": 2278.5,
        "Text": " I'm done because I can perform code execution"
      },
      {
        "Time_Start": 2278.5,
        "Time_End": 2280.5,
        "Text": " on the certificate server machine,"
      },
      {
        "Time_Start": 2280.5,
        "Time_End": 2282.5,
        "Text": " back up the public and the private key,"
      },
      {
        "Time_Start": 2282.5,
        "Time_End": 2286.5,
        "Text": " forge fake certificates for whatever user I want,"
      },
      {
        "Time_Start": 2286.5,
        "Time_End": 2287.5,
        "Text": " and take over the domain."
      },
      {
        "Time_Start": 2287.5,
        "Time_End": 2295.5,
        "Text": " But unfortunately, you cannot relay back NTLM authentication."
      },
      {
        "Time_Start": 2295.5,
        "Time_End": 2298.5,
        "Text": " So, I cannot relay back the authentication"
      },
      {
        "Time_Start": 2298.5,
        "Time_End": 2301.5,
        "Text": " to the certificate server itself."
      },
      {
        "Time_Start": 2301.5,
        "Time_End": 2303.5,
        "Text": " So, yeah, it's really limited."
      },
      {
        "Time_Start": 2303.5,
        "Time_End": 2309.5,
        "Text": " But wait, there is a great opportunity with K\u00e9beros"
      },
      {
        "Time_Start": 2309.5,
        "Time_End": 2313.5,
        "Text": " because with K\u00e9beros, you can relay back the HTTP."
      },
      {
        "Time_Start": 2313.5,
        "Time_End": 2316.5,
        "Text": " So, the server can relay back the authentication to itself"
      },
      {
        "Time_Start": 2316.5,
        "Time_End": 2319.5,
        "Text": " via the network if I use HTTP."
      },
      {
        "Time_Start": 2319.5,
        "Time_End": 2322.5,
        "Text": " And this is interesting because if I don't have"
      },
      {
        "Time_Start": 2322.5,
        "Time_End": 2327.5,
        "Text": " extended protection enabled or I do not require SSL,"
      },
      {
        "Time_Start": 2327.5,
        "Time_End": 2330.5,
        "Text": " I can request a certificate."
      },
      {
        "Time_Start": 2330.5,
        "Time_End": 2334.5,
        "Text": " And this is the screenshot with my modified version"
      },
      {
        "Time_Start": 2334.5,
        "Time_End": 2337.5,
        "Text": " of the great K\u00e9beros relay tool"
      },
      {
        "Time_Start": 2337.5,
        "Time_End": 2342.5,
        "Text": " where I target the Web Enrollment Service."
      },
      {
        "Time_Start": 2342.5,
        "Time_End": 2346.5,
        "Text": " My DECOM host is, again, the ADCS web server."
      },
      {
        "Time_Start": 2346.5,
        "Time_End": 2349.5,
        "Text": " So, I trigger the authentication, relay it back,"
      },
      {
        "Time_Start": 2349.5,
        "Time_End": 2352.5,
        "Text": " request a certificate, and obtain the certificate"
      },
      {
        "Time_Start": 2352.5,
        "Time_End": 2357.5,
        "Text": " for client authentication of the certificate server."
      },
      {
        "Time_Start": 2357.5,
        "Time_End": 2358.5,
        "Text": " And I'm done."
      },
      {
        "Time_Start": 2358.5,
        "Time_End": 2359.5,
        "Text": " So, yeah."
      },
      {
        "Time_Start": 2359.5,
        "Time_End": 2362.5,
        "Text": " And therefore, we should always use extended protection,"
      },
      {
        "Time_Start": 2362.5,
        "Time_End": 2365.5,
        "Text": " blah, blah, blah, because this still works."
      },
      {
        "Time_Start": 2365.5,
        "Time_End": 2370.5,
        "Text": " So, you know if you don't use these countermeasures,"
      },
      {
        "Time_Start": 2370.5,
        "Time_End": 2373.5,
        "Text": " you are at your own risk."
      },
      {
        "Time_Start": 2373.5,
        "Time_End": 2378.5,
        "Text": " But I didn't stop here because digging further into the DECOM,"
      },
      {
        "Time_Start": 2378.5,
        "Time_End": 2380.5,
        "Text": " I found these two groups."
      },
      {
        "Time_Start": 2380.5,
        "Time_End": 2382.5,
        "Text": " I call them the forgotten groups,"
      },
      {
        "Time_Start": 2382.5,
        "Time_End": 2387.5,
        "Text": " and this leads me to remote silver potato."
      },
      {
        "Time_Start": 2387.5,
        "Time_End": 2390.5,
        "Text": " We have these two groups which are built in,"
      },
      {
        "Time_Start": 2390.5,
        "Time_End": 2392.5,
        "Text": " I say not so well-known groups,"
      },
      {
        "Time_Start": 2392.5,
        "Time_End": 2394.5,
        "Text": " which are the distributed com users group"
      },
      {
        "Time_Start": 2394.5,
        "Time_End": 2397.5,
        "Text": " and the performance com users groups."
      },
      {
        "Time_Start": 2397.5,
        "Time_End": 2399.5,
        "Text": " From Microsoft description, we understand"
      },
      {
        "Time_Start": 2399.5,
        "Time_End": 2402.5,
        "Text": " that they can somehow interact with the DECOM server,"
      },
      {
        "Time_Start": 2402.5,
        "Time_End": 2404.5,
        "Text": " and that is interesting."
      },
      {
        "Time_Start": 2404.5,
        "Time_End": 2408.5,
        "Text": " So, members of these two groups can launch"
      },
      {
        "Time_Start": 2408.5,
        "Time_End": 2413.5,
        "Text": " and activate DECOM services from local and remote."
      },
      {
        "Time_Start": 2413.5,
        "Time_End": 2416.5,
        "Text": " So, not only activate, because activate means"
      },
      {
        "Time_Start": 2416.5,
        "Time_End": 2418.5,
        "Text": " that the service needs to be running,"
      },
      {
        "Time_Start": 2418.5,
        "Time_End": 2422.5,
        "Text": " and launch means that I can start the service from remote."
      },
      {
        "Time_Start": 2422.5,
        "Time_End": 2424.5,
        "Text": " So, the performance local users group"
      },
      {
        "Time_Start": 2424.5,
        "Time_End": 2426.5,
        "Text": " and distributed com users group can do these things."
      },
      {
        "Time_Start": 2426.5,
        "Time_End": 2428.5,
        "Text": " This is cool."
      },
      {
        "Time_Start": 2428.5,
        "Time_End": 2434.5,
        "Text": " Now we have to find a service which can be launched,"
      },
      {
        "Time_Start": 2434.5,
        "Time_End": 2436.5,
        "Text": " activated by these users,"
      },
      {
        "Time_Start": 2436.5,
        "Time_End": 2442.5,
        "Text": " and which has an authentication which could be useful for us."
      },
      {
        "Time_Start": 2442.5,
        "Time_End": 2447.5,
        "Text": " And I found this object, the SPPUI object interactive class."
      },
      {
        "Time_Start": 2447.5,
        "Time_End": 2450.5,
        "Text": " It's related to the Windows license service,"
      },
      {
        "Time_Start": 2450.5,
        "Time_End": 2452.5,
        "Text": " which is the perfect candidate"
      },
      {
        "Time_Start": 2452.5,
        "Time_End": 2458.5,
        "Text": " because it runs as an interactive user,"
      },
      {
        "Time_Start": 2458.5,
        "Time_End": 2463.5,
        "Text": " and it can be activated and launched by everyone."
      },
      {
        "Time_Start": 2463.5,
        "Time_End": 2465.5,
        "Text": " That does not mean that it's by everyone,"
      },
      {
        "Time_Start": 2465.5,
        "Time_End": 2468.5,
        "Text": " because then you have the limits by the DECOM"
      },
      {
        "Time_Start": 2468.5,
        "Time_End": 2471.5,
        "Text": " and the members of the DECOM performance local users group."
      },
      {
        "Time_Start": 2471.5,
        "Time_End": 2474.5,
        "Text": " So, this is a very, very interesting scenario."
      },
      {
        "Time_Start": 2474.5,
        "Time_End": 2478.5,
        "Text": " So, by triggering this service,"
      },
      {
        "Time_Start": 2478.5,
        "Time_End": 2482.5,
        "Text": " we should get back the authentication"
      },
      {
        "Time_Start": 2482.5,
        "Time_End": 2488.5,
        "Text": " of the interactive user connected on some session."
      },
      {
        "Time_Start": 2488.5,
        "Time_End": 2495.5,
        "Text": " If you are a member of this group,"
      },
      {
        "Time_Start": 2495.5,
        "Time_End": 2498.5,
        "Text": " it's not correct to call them domain,"
      },
      {
        "Time_Start": 2498.5,
        "Time_End": 2501.5,
        "Text": " but on the domain controllers built-in group,"
      },
      {
        "Time_Start": 2501.5,
        "Time_End": 2505.5,
        "Text": " you can imagine that this could be very, very dangerous"
      },
      {
        "Time_Start": 2505.5,
        "Time_End": 2508.5,
        "Text": " because normally, on a domain controller,"
      },
      {
        "Time_Start": 2508.5,
        "Time_End": 2510.5,
        "Text": " the domain admin logs in."
      },
      {
        "Time_Start": 2510.5,
        "Time_End": 2513.5,
        "Text": " So, if you could trigger the authentication of the domain admin,"
      },
      {
        "Time_Start": 2513.5,
        "Time_End": 2515.5,
        "Text": " well, that's interesting."
      },
      {
        "Time_Start": 2515.5,
        "Time_End": 2518.5,
        "Text": " So, how does this work?"
      },
      {
        "Time_Start": 2518.5,
        "Time_End": 2520.5,
        "Text": " We have an attacker,"
      },
      {
        "Time_Start": 2520.5,
        "Time_End": 2525.5,
        "Text": " which is a member of the DECOM users or performance log users group,"
      },
      {
        "Time_Start": 2525.5,
        "Time_End": 2529.5,
        "Text": " and then we have a V Team connected on a domain controller."
      },
      {
        "Time_Start": 2529.5,
        "Time_End": 2531.5,
        "Text": " So, again, with the potato technique,"
      },
      {
        "Time_Start": 2532.5,
        "Time_End": 2541.5,
        "Text": " I trigger the authentication with the CLS ID of the SPP UI service,"
      },
      {
        "Time_Start": 2541.5,
        "Time_End": 2547.5,
        "Text": " which triggers the V Team connected on a session"
      },
      {
        "Time_Start": 2547.5,
        "Time_End": 2552.5,
        "Text": " to authenticate to my endpoint."
      },
      {
        "Time_Start": 2552.5,
        "Time_End": 2554.5,
        "Text": " Because, as we saw,"
      },
      {
        "Time_Start": 2554.5,
        "Time_End": 2558.5,
        "Text": " we will perform an authenticated resolve-auxit call."
      },
      {
        "Time_Start": 2558.5,
        "Time_End": 2561.5,
        "Text": " We are able to intercept this authentication,"
      },
      {
        "Time_Start": 2561.5,
        "Time_End": 2563.5,
        "Text": " in this case from the domain admin,"
      },
      {
        "Time_Start": 2563.5,
        "Time_End": 2565.5,
        "Text": " and use it."
      },
      {
        "Time_Start": 2565.5,
        "Time_End": 2568.5,
        "Text": " We can also return a string binding,"
      },
      {
        "Time_Start": 2568.5,
        "Time_End": 2572.5,
        "Text": " which contains the port and an optional SPN"
      },
      {
        "Time_Start": 2572.5,
        "Time_End": 2575.5,
        "Text": " of our fake RPC server,"
      },
      {
        "Time_Start": 2575.5,
        "Time_End": 2577.5,
        "Text": " and we have another authenticated call,"
      },
      {
        "Time_Start": 2577.5,
        "Time_End": 2579.5,
        "Text": " and we have the second profit."
      },
      {
        "Time_Start": 2579.5,
        "Time_End": 2581.5,
        "Text": " So, I did this, I tested this,"
      },
      {
        "Time_Start": 2581.5,
        "Time_End": 2584.5,
        "Text": " and for the first one, it's okay."
      },
      {
        "Time_Start": 2585.5,
        "Time_End": 2588.5,
        "Text": " I was able to perform an NTLM relay attack"
      },
      {
        "Time_Start": 2588.5,
        "Time_End": 2590.5,
        "Text": " with an impersonation level,"
      },
      {
        "Time_Start": 2590.5,
        "Time_End": 2591.5,
        "Text": " which is what we need."
      },
      {
        "Time_Start": 2591.5,
        "Time_End": 2593.5,
        "Text": " In the second one, sadly,"
      },
      {
        "Time_Start": 2593.5,
        "Time_End": 2595.5,
        "Text": " you have an identification level,"
      },
      {
        "Time_Start": 2595.5,
        "Time_End": 2596.5,
        "Text": " which is really useless,"
      },
      {
        "Time_Start": 2596.5,
        "Time_End": 2597.5,
        "Text": " because signing is enabled,"
      },
      {
        "Time_Start": 2597.5,
        "Time_End": 2601.5,
        "Text": " so you can't even relay versus LDAP."
      },
      {
        "Time_Start": 2601.5,
        "Time_End": 2604.5,
        "Text": " I obviously reported this to Microsoft before,"
      },
      {
        "Time_Start": 2604.5,
        "Time_End": 2609.5,
        "Text": " and initially they said it was a critical finding,"
      },
      {
        "Time_Start": 2609.5,
        "Time_End": 2611.5,
        "Text": " but then after some time,"
      },
      {
        "Time_Start": 2611.5,
        "Time_End": 2614.5,
        "Text": " they assessed it as a moderate risk,"
      },
      {
        "Time_Start": 2614.5,
        "Time_End": 2619.5,
        "Text": " and that does not need an immediate servicing."
      },
      {
        "Time_Start": 2619.5,
        "Time_End": 2621.5,
        "Text": " So, I can talk about this, okay?"
      },
      {
        "Time_Start": 2623.5,
        "Time_End": 2625.5,
        "Text": " Okay, I have the video."
      },
      {
        "Time_Start": 2625.5,
        "Time_End": 2626.5,
        "Text": " Finger crossed."
      },
      {
        "Time_Start": 2634.5,
        "Time_End": 2635.5,
        "Text": " It works, great."
      },
      {
        "Time_Start": 2635.5,
        "Time_End": 2637.5,
        "Text": " So, I have my user,"
      },
      {
        "Time_Start": 2637.5,
        "Time_End": 2639.5,
        "Text": " standard user,"
      },
      {
        "Time_Start": 2639.5,
        "Time_End": 2641.5,
        "Text": " and a member of this, let's say,"
      },
      {
        "Time_Start": 2641.5,
        "Time_End": 2644.5,
        "Text": " domain, distributed com users group."
      },
      {
        "Time_Start": 2644.5,
        "Time_End": 2645.5,
        "Text": " On the other,"
      },
      {
        "Time_Start": 2645.5,
        "Time_End": 2648.5,
        "Text": " then I am here in the worst scenario,"
      },
      {
        "Time_Start": 2648.5,
        "Time_End": 2651.5,
        "Text": " because I have NTLM V1 enabled."
      },
      {
        "Time_Start": 2651.5,
        "Time_End": 2652.5,
        "Text": " So, in NTLM relay,"
      },
      {
        "Time_Start": 2652.5,
        "Time_End": 2654.5,
        "Text": " I will remove the message integrity check"
      },
      {
        "Time_Start": 2654.5,
        "Time_End": 2656.5,
        "Text": " and disable signing, okay?"
      },
      {
        "Time_Start": 2656.5,
        "Time_End": 2658.5,
        "Text": " I launch my tool,"
      },
      {
        "Time_Start": 2658.5,
        "Time_End": 2661.5,
        "Text": " where I specify the domain controller address,"
      },
      {
        "Time_Start": 2661.5,
        "Time_End": 2663.5,
        "Text": " again, my redirector and the host"
      },
      {
        "Time_Start": 2663.5,
        "Time_End": 2665.5,
        "Text": " where NTLM relay is running,"
      },
      {
        "Time_Start": 2666.5,
        "Time_End": 2668.5,
        "Text": " and the session, okay?"
      },
      {
        "Time_Start": 2668.5,
        "Time_End": 2669.5,
        "Text": " Once I launch it,"
      },
      {
        "Time_Start": 2669.5,
        "Time_End": 2671.5,
        "Text": " as you can see at the end,"
      },
      {
        "Time_Start": 2671.5,
        "Time_End": 2674.5,
        "Text": " I am able to get authentication administrator."
      },
      {
        "Time_Start": 2674.5,
        "Time_End": 2677.5,
        "Text": " I will forward that indication to NTLM relay,"
      },
      {
        "Time_Start": 2677.5,
        "Time_End": 2679.5,
        "Text": " which will forward it to LDAP,"
      },
      {
        "Time_Start": 2679.5,
        "Time_End": 2682.5,
        "Text": " which will create a user account"
      },
      {
        "Time_Start": 2682.5,
        "Time_End": 2685.5,
        "Text": " with DC sync rights."
      },
      {
        "Time_Start": 2685.5,
        "Time_End": 2687.5,
        "Text": " So, from a standard user,"
      },
      {
        "Time_Start": 2687.5,
        "Time_End": 2689.5,
        "Text": " I took over the domain."
      },
      {
        "Time_Start": 2689.5,
        "Time_End": 2691.5,
        "Text": " That's something that..."
      },
      {
        "Time_Start": 2691.5,
        "Time_End": 2693.5,
        "Text": " I don't know why they did..."
      },
      {
        "Time_Start": 2693.5,
        "Time_End": 2695.5,
        "Text": " They said, no, no, it's not that..."
      },
      {
        "Time_Start": 2696.5,
        "Time_End": 2700.5,
        "Text": " Because in my job,"
      },
      {
        "Time_Start": 2700.5,
        "Time_End": 2701.5,
        "Text": " because this is a hobby,"
      },
      {
        "Time_Start": 2701.5,
        "Time_End": 2704.5,
        "Text": " in my job, I do active directory assessment,"
      },
      {
        "Time_Start": 2704.5,
        "Time_End": 2707.5,
        "Text": " and I found it at least two or three times"
      },
      {
        "Time_Start": 2707.5,
        "Time_End": 2710.5,
        "Text": " that this group was populated by non-tier zero users."
      },
      {
        "Time_Start": 2710.5,
        "Time_End": 2711.5,
        "Text": " So, therefore,"
      },
      {
        "Time_Start": 2711.5,
        "Time_End": 2713.5,
        "Text": " we should consider these two groups"
      },
      {
        "Time_Start": 2713.5,
        "Time_End": 2715.5,
        "Text": " absolutely tier zero,"
      },
      {
        "Time_Start": 2715.5,
        "Time_End": 2718.5,
        "Text": " until Microsoft decides to fix something."
      },
      {
        "Time_Start": 2718.5,
        "Time_End": 2720.5,
        "Text": " This works also on a local group,"
      },
      {
        "Time_Start": 2720.5,
        "Time_End": 2721.5,
        "Text": " on a local server,"
      },
      {
        "Time_Start": 2721.5,
        "Time_End": 2722.5,
        "Text": " but obviously a domain controller"
      },
      {
        "Time_Start": 2722.5,
        "Time_End": 2724.5,
        "Text": " is much more interesting, okay?"
      },
      {
        "Time_Start": 2726.5,
        "Time_End": 2729.5,
        "Text": " So, the next step was Kerberos."
      },
      {
        "Time_Start": 2729.5,
        "Time_End": 2732.5,
        "Text": " Okay, NTLM, I can't relay NTLM."
      },
      {
        "Time_Start": 2732.5,
        "Time_End": 2733.5,
        "Text": " Why not relaying in Kerberos?"
      },
      {
        "Time_Start": 2733.5,
        "Time_End": 2735.5,
        "Text": " Well, here we have two problems."
      },
      {
        "Time_Start": 2735.5,
        "Time_End": 2736.5,
        "Text": " The first one is that"
      },
      {
        "Time_Start": 2736.5,
        "Time_End": 2738.5,
        "Text": " original Kerberos relay tool,"
      },
      {
        "Time_Start": 2738.5,
        "Time_End": 2739.5,
        "Text": " which is a great tool,"
      },
      {
        "Time_Start": 2739.5,
        "Time_End": 2742.5,
        "Text": " only intercepts the first authentication,"
      },
      {
        "Time_Start": 2742.5,
        "Time_End": 2744.5,
        "Text": " the second authentication."
      },
      {
        "Time_Start": 2744.5,
        "Time_End": 2746.5,
        "Text": " And the second prerequisite"
      },
      {
        "Time_Start": 2746.5,
        "Time_End": 2749.5,
        "Text": " for performing Kerberos relay"
      },
      {
        "Time_Start": 2749.5,
        "Time_End": 2751.5,
        "Text": " is that you have to control the SPN."
      },
      {
        "Time_Start": 2751.5,
        "Time_End": 2754.5,
        "Text": " So, for the first problem,"
      },
      {
        "Time_Start": 2755.5,
        "Time_End": 2758.5,
        "Text": " I recorded Kerberos relay."
      },
      {
        "Time_Start": 2758.5,
        "Time_End": 2762.5,
        "Text": " It was really a long, tedious, and boring task"
      },
      {
        "Time_Start": 2762.5,
        "Time_End": 2765.5,
        "Text": " because I had to implement a raw socket server,"
      },
      {
        "Time_Start": 2765.5,
        "Time_End": 2767.5,
        "Text": " intercept the authentication,"
      },
      {
        "Time_Start": 2767.5,
        "Time_End": 2768.5,
        "Text": " extract the Kerberos,"
      },
      {
        "Time_Start": 2768.5,
        "Time_End": 2770.5,
        "Text": " and then move back and forth"
      },
      {
        "Time_Start": 2770.5,
        "Time_End": 2773.5,
        "Text": " between DCOM and SMB."
      },
      {
        "Time_Start": 2773.5,
        "Time_End": 2774.5,
        "Text": " It was really..."
      },
      {
        "Time_Start": 2774.5,
        "Time_End": 2776.5,
        "Text": " I was giving up several times,"
      },
      {
        "Time_Start": 2776.5,
        "Time_End": 2778.5,
        "Text": " but at the end,"
      },
      {
        "Time_Start": 2778.5,
        "Time_End": 2780.5,
        "Text": " I was able to get it working."
      },
      {
        "Time_Start": 2780.5,
        "Time_End": 2782.5,
        "Text": " And then we have the second one, SPN."
      },
      {
        "Time_Start": 2782.5,
        "Time_End": 2784.5,
        "Text": " Sadly, in the first authentication,"
      },
      {
        "Time_Start": 2784.5,
        "Time_End": 2786.5,
        "Text": " when we return the string bindings,"
      },
      {
        "Time_Start": 2786.5,
        "Time_End": 2788.5,
        "Text": " even if you return an SPN,"
      },
      {
        "Time_Start": 2788.5,
        "Time_End": 2791.5,
        "Text": " the SPN will always be rpcss"
      },
      {
        "Time_Start": 2791.5,
        "Time_End": 2793.5,
        "Text": " slash the server"
      },
      {
        "Time_Start": 2793.5,
        "Time_End": 2796.5,
        "Text": " where our socket redirector is listening"
      },
      {
        "Time_Start": 2796.5,
        "Time_End": 2798.5,
        "Text": " because it's from where it's coming from."
      },
      {
        "Time_Start": 2798.5,
        "Time_End": 2800.5,
        "Text": " So, no chance."
      },
      {
        "Time_Start": 2800.5,
        "Time_End": 2802.5,
        "Text": " Then again,"
      },
      {
        "Time_Start": 2802.5,
        "Time_End": 2805.5,
        "Text": " thanks to a trick from James Forshaw,"
      },
      {
        "Time_Start": 2805.5,
        "Time_End": 2808.5,
        "Text": " we can bypass these SPN limitations"
      },
      {
        "Time_Start": 2808.5,
        "Time_End": 2811.5,
        "Text": " by adding a forged DNS name."
      },
      {
        "Time_Start": 2812.5,
        "Time_End": 2817.5,
        "Text": " Because the Kerberos security provider extension"
      },
      {
        "Time_Start": 2817.5,
        "Time_End": 2821.5,
        "Text": " supports a special format for the SPN,"
      },
      {
        "Time_Start": 2821.5,
        "Time_End": 2823.5,
        "Text": " which includes the target info."
      },
      {
        "Time_Start": 2823.5,
        "Time_End": 2826.5,
        "Text": " So, the syntax is the following."
      },
      {
        "Time_Start": 2826.5,
        "Time_End": 2829.5,
        "Text": " Service class slash server,"
      },
      {
        "Time_Start": 2829.5,
        "Time_End": 2831.5,
        "Text": " which is the classic SPN,"
      },
      {
        "Time_Start": 2831.5,
        "Time_End": 2838.5,
        "Text": " plus the base64 encoded target information."
      },
      {
        "Time_Start": 2838.5,
        "Time_End": 2841.5,
        "Text": " And Kerberos will ask for a service ticket"
      },
      {
        "Time_Start": 2841.5,
        "Time_End": 2843.5,
        "Text": " service server class,"
      },
      {
        "Time_Start": 2843.5,
        "Time_End": 2845.5,
        "Text": " server class server."
      },
      {
        "Time_Start": 2845.5,
        "Time_End": 2847.5,
        "Text": " And the auxet resolver will try to contact"
      },
      {
        "Time_Start": 2847.5,
        "Time_End": 2849.5,
        "Text": " a server, which is server"
      },
      {
        "Time_Start": 2849.5,
        "Time_End": 2852.5,
        "Text": " plus the base64 address."
      },
      {
        "Time_Start": 2852.5,
        "Time_End": 2855.5,
        "Text": " And the shortest base64 target info address"
      },
      {
        "Time_Start": 2855.5,
        "Time_End": 2857.5,
        "Text": " is this one,"
      },
      {
        "Time_Start": 2857.5,
        "Time_End": 2861.5,
        "Text": " which corresponds to a completely empty target information."
      },
      {
        "Time_Start": 2861.5,
        "Time_End": 2864.5,
        "Text": " But the security provider will happily accept it."
      },
      {
        "Time_Start": 2864.5,
        "Time_End": 2868.5,
        "Text": " So, what I did is"
      },
      {
        "Time_Start": 2868.5,
        "Time_End": 2870.5,
        "Text": " add the DNS record"
      },
      {
        "Time_Start": 2870.5,
        "Time_End": 2873.5,
        "Text": " with this strange name,"
      },
      {
        "Time_Start": 2873.5,
        "Time_End": 2875.5,
        "Text": " because normally standard domain users"
      },
      {
        "Time_Start": 2875.5,
        "Time_End": 2877.5,
        "Text": " can perform secure DNS updates."
      },
      {
        "Time_Start": 2877.5,
        "Time_End": 2882.5,
        "Text": " And then relay the application request ticket"
      },
      {
        "Time_Start": 2882.5,
        "Time_End": 2884.5,
        "Text": " to a target server"
      },
      {
        "Time_Start": 2884.5,
        "Time_End": 2886.5,
        "Text": " on behalf of the user,"
      },
      {
        "Time_Start": 2886.5,
        "Time_End": 2889.5,
        "Text": " in this case the domain admin."
      },
      {
        "Time_Start": 2889.5,
        "Time_End": 2892.5,
        "Text": " Again, this is the scenario."
      },
      {
        "Time_Start": 2892.5,
        "Time_End": 2894.5,
        "Text": " User, member of these groups."
      },
      {
        "Time_Start": 2894.5,
        "Time_End": 2896.5,
        "Text": " Victim, connected domain controller."
      },
      {
        "Time_Start": 2896.5,
        "Time_End": 2899.5,
        "Text": " And the target server, where I want to access resources"
      },
      {
        "Time_Start": 2899.5,
        "Time_End": 2901.5,
        "Text": " on behalf of the victim."
      },
      {
        "Time_Start": 2901.5,
        "Time_End": 2902.5,
        "Text": " So, what happens?"
      },
      {
        "Time_Start": 2902.5,
        "Time_End": 2904.5,
        "Text": " Again, I perform,"
      },
      {
        "Time_Start": 2904.5,
        "Time_End": 2906.5,
        "Text": " I trigger the authentication"
      },
      {
        "Time_Start": 2906.5,
        "Time_End": 2910.5,
        "Text": " and then in the"
      },
      {
        "Time_Start": 2910.5,
        "Time_End": 2912.5,
        "Text": " socket address I specify"
      },
      {
        "Time_Start": 2912.5,
        "Time_End": 2916.5,
        "Text": " this name, because I created this DNS name."
      },
      {
        "Time_Start": 2918.5,
        "Time_End": 2921.5,
        "Text": " The victim will ask for a service ticket"
      },
      {
        "Time_Start": 2921.5,
        "Time_End": 2924.5,
        "Text": " RPSS slash target."
      },
      {
        "Time_Start": 2926.5,
        "Time_End": 2928.5,
        "Text": " It will try to authenticate against me"
      },
      {
        "Time_Start": 2928.5,
        "Time_End": 2930.5,
        "Text": " with this application request ticket."
      },
      {
        "Time_Start": 2932.5,
        "Time_End": 2936.5,
        "Text": " The attacker will simply forward this ticket"
      },
      {
        "Time_Start": 2936.5,
        "Time_End": 2938.5,
        "Text": " to the destination server."
      },
      {
        "Time_Start": 2940.5,
        "Time_End": 2942.5,
        "Text": " And relay is successful."
      },
      {
        "Time_Start": 2942.5,
        "Time_End": 2944.5,
        "Text": " So, just to demonstrate to you"
      },
      {
        "Time_Start": 2944.5,
        "Time_End": 2947.5,
        "Text": " that it does not only work on PowerPoint,"
      },
      {
        "Time_Start": 2947.5,
        "Time_End": 2949.5,
        "Text": " I have another demo."
      },
      {
        "Time_Start": 2952.5,
        "Time_End": 2954.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 2959.5,
        "Time_End": 2961.5,
        "Text": " Oh, it works, great."
      },
      {
        "Time_Start": 2961.5,
        "Time_End": 2964.5,
        "Text": " So, I create IDCS,"
      },
      {
        "Time_Start": 2964.5,
        "Time_End": 2967.5,
        "Text": " dash MyLab is my IDCS server, okay?"
      },
      {
        "Time_Start": 2967.5,
        "Time_End": 2969.5,
        "Text": " And this is the..."
      },
      {
        "Time_Start": 2969.5,
        "Time_End": 2971.5,
        "Text": " Okay, sorry."
      },
      {
        "Time_Start": 2971.5,
        "Time_End": 2973.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 2980.5,
        "Time_End": 2982.5,
        "Text": " Okay."
      },
      {
        "Time_Start": 2984.5,
        "Time_End": 2987.5,
        "Text": " So, with the Invoke DNS update tool"
      },
      {
        "Time_Start": 2987.5,
        "Time_End": 2989.5,
        "Text": " I create this DNS record."
      },
      {
        "Time_Start": 2989.5,
        "Time_End": 2991.5,
        "Text": " Okay, now I have it."
      },
      {
        "Time_Start": 2993.5,
        "Time_End": 2995.5,
        "Text": " I capture the traffic just to show you that"
      },
      {
        "Time_Start": 2995.5,
        "Time_End": 2998.5,
        "Text": " it is what was expected."
      },
      {
        "Time_Start": 2998.5,
        "Time_End": 3001.5,
        "Text": " I launch my Silver Potato tool"
      },
      {
        "Time_Start": 3001.5,
        "Time_End": 3003.5,
        "Text": " targeting..."
      },
      {
        "Time_Start": 3003.5,
        "Time_End": 3006.5,
        "Text": " In this case, I want to target the SMB server"
      },
      {
        "Time_Start": 3006.5,
        "Time_End": 3009.5,
        "Text": " of the IDCS server."
      },
      {
        "Time_Start": 3009.5,
        "Time_End": 3010.5,
        "Text": " Okay?"
      },
      {
        "Time_Start": 3010.5,
        "Time_End": 3013.5,
        "Text": " With this strange redirect host."
      },
      {
        "Time_Start": 3013.5,
        "Time_End": 3015.5,
        "Text": " And as you can see, I want to dump"
      },
      {
        "Time_Start": 3015.5,
        "Time_End": 3017.5,
        "Text": " the local sum account database"
      },
      {
        "Time_Start": 3017.5,
        "Time_End": 3020.5,
        "Text": " and I was able to dump the admin hash."
      },
      {
        "Time_Start": 3020.5,
        "Time_End": 3022.5,
        "Text": " Okay?"
      },
      {
        "Time_Start": 3022.5,
        "Time_End": 3025.5,
        "Text": " And as you can see, the SPN is the one we expected."
      },
      {
        "Time_Start": 3026.5,
        "Time_End": 3028.5,
        "Text": " And..."
      },
      {
        "Time_Start": 3029.5,
        "Time_End": 3031.5,
        "Text": " This is all the traffic"
      },
      {
        "Time_Start": 3031.5,
        "Time_End": 3033.5,
        "Text": " for the remote registry access,"
      },
      {
        "Time_Start": 3033.5,
        "Time_End": 3035.5,
        "Text": " dumping the sum database, etc."
      },
      {
        "Time_Start": 3035.5,
        "Time_End": 3037.5,
        "Text": " Once you have, again,"
      },
      {
        "Time_Start": 3037.5,
        "Time_End": 3039.5,
        "Text": " the hash of the local administrator,"
      },
      {
        "Time_Start": 3039.5,
        "Time_End": 3041.5,
        "Text": " you can log on, okay?"
      },
      {
        "Time_Start": 3041.5,
        "Time_End": 3045.5,
        "Text": " Again, perform a backup of the private key."
      },
      {
        "Time_Start": 3045.5,
        "Time_End": 3047.5,
        "Text": " Elevate to system, perform the backup"
      },
      {
        "Time_Start": 3047.5,
        "Time_End": 3049.5,
        "Text": " of private key, etc."
      },
      {
        "Time_Start": 3049.5,
        "Time_End": 3050.5,
        "Text": " And you're done."
      },
      {
        "Time_Start": 3050.5,
        "Time_End": 3053.5,
        "Text": " So, you have, again, another possibility."
      },
      {
        "Time_Start": 3053.5,
        "Time_End": 3055.5,
        "Text": " So..."
      },
      {
        "Time_Start": 3055.5,
        "Time_End": 3057.5,
        "Text": " We are at the conclusion."
      },
      {
        "Time_Start": 3057.5,
        "Time_End": 3059.5,
        "Text": " Okay, perfect."
      },
      {
        "Time_Start": 3059.5,
        "Time_End": 3060.5,
        "Text": " What can I say?"
      },
      {
        "Time_Start": 3060.5,
        "Time_End": 3062.5,
        "Text": " First of all, that with Potatoes,"
      },
      {
        "Time_Start": 3062.5,
        "Time_End": 3065.5,
        "Text": " we break safety and security boundaries."
      },
      {
        "Time_Start": 3065.5,
        "Time_End": 3067.5,
        "Text": " Okay?"
      },
      {
        "Time_Start": 3067.5,
        "Time_End": 3069.5,
        "Text": " Most MS fixes were already partial"
      },
      {
        "Time_Start": 3069.5,
        "Time_End": 3071.5,
        "Text": " or even not implemented"
      },
      {
        "Time_Start": 3071.5,
        "Time_End": 3073.5,
        "Text": " because it's by default."
      },
      {
        "Time_Start": 3073.5,
        "Time_End": 3075.5,
        "Text": " Future NTLM disablement"
      },
      {
        "Time_Start": 3075.5,
        "Time_End": 3077.5,
        "Text": " will stop some relay attacks,"
      },
      {
        "Time_Start": 3077.5,
        "Time_End": 3080.5,
        "Text": " but remember that if you have control over SPN,"
      },
      {
        "Time_Start": 3080.5,
        "Time_End": 3082.5,
        "Text": " you can relay cables."
      },
      {
        "Time_Start": 3082.5,
        "Time_End": 3084.5,
        "Text": " The question is,"
      },
      {
        "Time_Start": 3084.5,
        "Time_End": 3086.5,
        "Text": " will Potatoes be still alive and kicking?"
      },
      {
        "Time_Start": 3086.5,
        "Time_End": 3087.5,
        "Text": " Who knows?"
      },
      {
        "Time_Start": 3087.5,
        "Time_End": 3089.5,
        "Text": " Maybe we should find a Potato in the cloud,"
      },
      {
        "Time_Start": 3089.5,
        "Time_End": 3091.5,
        "Text": " but it's not for me."
      },
      {
        "Time_Start": 3091.5,
        "Time_End": 3093.5,
        "Text": " So..."
      },
      {
        "Time_Start": 3093.5,
        "Time_End": 3095.5,
        "Text": " Second conclusion for the defenders."
      },
      {
        "Time_Start": 3095.5,
        "Time_End": 3098.5,
        "Text": " So, because many of these attack paths"
      },
      {
        "Time_Start": 3098.5,
        "Time_End": 3101.5,
        "Text": " at the end lead to relaying the authentication."
      },
      {
        "Time_Start": 3101.5,
        "Time_End": 3103.5,
        "Text": " So, Microsoft always tells us"
      },
      {
        "Time_Start": 3103.5,
        "Time_End": 3105.5,
        "Text": " you have to disable NTLM"
      },
      {
        "Time_Start": 3105.5,
        "Time_End": 3107.5,
        "Text": " because it's dangerous, etc., etc., etc."
      },
      {
        "Time_Start": 3107.5,
        "Time_End": 3109.5,
        "Text": " But, as we can see,"
      },
      {
        "Time_Start": 3109.5,
        "Time_End": 3111.5,
        "Text": " Kerberos can be relayed too."
      },
      {
        "Time_Start": 3111.5,
        "Time_End": 3114.5,
        "Text": " So, the only way is to protect our endpoints."
      },
      {
        "Time_Start": 3114.5,
        "Time_End": 3117.5,
        "Text": " So, I hope you enjoyed my talk."
      },
      {
        "Time_Start": 3117.5,
        "Time_End": 3119.5,
        "Text": " Sadly, I had some problems, but..."
      },
      {
        "Time_Start": 3119.5,
        "Time_End": 3121.5,
        "Text": " And..."
      },
      {
        "Time_Start": 3121.5,
        "Time_End": 3123.5,
        "Text": " Thank you!"
      },
      {
        "Time_Start": 3129.5,
        "Time_End": 3131.5,
        "Text": " Thank you very, very much"
      },
      {
        "Time_Start": 3131.5,
        "Time_End": 3133.5,
        "Text": " for this interesting talk."
      },
      {
        "Time_Start": 3133.5,
        "Time_End": 3136.5,
        "Text": " And I guess there will be questions in the..."
      },
      {
        "Time_Start": 3136.5,
        "Time_End": 3138.5,
        "Text": " Yeah, back there."
      },
      {
        "Time_Start": 3139.5,
        "Time_End": 3141.5,
        "Text": " Some of the..."
      },
      {
        "Time_Start": 3141.5,
        "Time_End": 3143.5,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3143.5,
        "Time_End": 3145.5,
        "Text": " So, some of the attacks"
      },
      {
        "Time_Start": 3145.5,
        "Time_End": 3147.5,
        "Text": " which you were talking about"
      },
      {
        "Time_Start": 3147.5,
        "Time_End": 3149.5,
        "Text": " were using the web dev"
      },
      {
        "Time_Start": 3149.5,
        "Time_End": 3152.5,
        "Text": " or web client service."
      },
      {
        "Time_Start": 3152.5,
        "Time_End": 3155.5,
        "Text": " And, of course, one of the countermeasures"
      },
      {
        "Time_Start": 3155.5,
        "Time_End": 3157.5,
        "Text": " would be to disable this service."
      },
      {
        "Time_Start": 3157.5,
        "Time_End": 3161.5,
        "Text": " Have you seen any dependencies on this service?"
      },
      {
        "Time_Start": 3161.5,
        "Time_End": 3164.5,
        "Text": " Like, what could go wrong if you disable it?"
      },
      {
        "Time_Start": 3164.5,
        "Time_End": 3166.5,
        "Text": " Okay, probably..."
      },
      {
        "Time_Start": 3166.5,
        "Time_End": 3168.5,
        "Text": " The only attack I performed"
      },
      {
        "Time_Start": 3168.5,
        "Time_End": 3170.5,
        "Text": " via local potato expat, via web dev,"
      },
      {
        "Time_Start": 3170.5,
        "Time_End": 3172.5,
        "Text": " was with local potato to demonstrate that"
      },
      {
        "Time_Start": 3172.5,
        "Time_End": 3174.5,
        "Text": " via HTTP, it was not fixed."
      },
      {
        "Time_Start": 3174.5,
        "Time_End": 3176.5,
        "Text": " Obviously, it's an edge case."
      },
      {
        "Time_Start": 3176.5,
        "Time_End": 3178.5,
        "Text": " Via HTTP."
      },
      {
        "Time_Start": 3178.5,
        "Time_End": 3181.5,
        "Text": " So, I configured a web dev server"
      },
      {
        "Time_Start": 3181.5,
        "Time_End": 3183.5,
        "Text": " in order to have an arbitrary write"
      },
      {
        "Time_Start": 3183.5,
        "Time_End": 3185.5,
        "Text": " via web dev HTTP."
      },
      {
        "Time_Start": 3185.5,
        "Time_End": 3187.5,
        "Text": " So, this is..."
      },
      {
        "Time_Start": 3187.5,
        "Time_End": 3190.5,
        "Text": " The other attacks have nothing to do with web dev."
      },
      {
        "Time_Start": 3190.5,
        "Time_End": 3192.5,
        "Text": " It's versus SMB or whatever."
      },
      {
        "Time_Start": 3192.5,
        "Time_End": 3195.5,
        "Text": " Or versus the web enrollment service."
      },
      {
        "Time_Start": 3195.5,
        "Time_End": 3197.5,
        "Text": " This is just to show that"
      },
      {
        "Time_Start": 3197.5,
        "Time_End": 3199.5,
        "Text": " there is still a possibility."
      },
      {
        "Time_Start": 3199.5,
        "Time_End": 3203.5,
        "Text": " Imagine that you have a web application"
      },
      {
        "Time_Start": 3203.5,
        "Time_End": 3206.5,
        "Text": " but you need to have local access"
      },
      {
        "Time_Start": 3206.5,
        "Time_End": 3209.5,
        "Text": " and then you are able to authenticate"
      },
      {
        "Time_Start": 3209.5,
        "Time_End": 3212.5,
        "Text": " on this web application a system account."
      },
      {
        "Time_Start": 3212.5,
        "Time_End": 3214.5,
        "Text": " So, depending on how it is configured,"
      },
      {
        "Time_Start": 3214.5,
        "Time_End": 3216.5,
        "Text": " you could do nasty things."
      },
      {
        "Time_Start": 3216.5,
        "Time_End": 3218.5,
        "Text": " But it's really an edge case."
      },
      {
        "Time_Start": 3218.5,
        "Time_End": 3220.5,
        "Text": " Okay, thanks."
      },
      {
        "Time_Start": 3220.5,
        "Time_End": 3222.5,
        "Text": " But still, have you seen any dependencies"
      },
      {
        "Time_Start": 3222.5,
        "Time_End": 3225.5,
        "Text": " on the web dev service, web dev client?"
      },
      {
        "Time_Start": 3225.5,
        "Time_End": 3228.5,
        "Text": " Like any Windows component"
      },
      {
        "Time_Start": 3228.5,
        "Time_End": 3230.5,
        "Text": " or third-party application actually"
      },
      {
        "Time_Start": 3230.5,
        "Time_End": 3232.5,
        "Text": " using it, requiring it?"
      },
      {
        "Time_Start": 3233.5,
        "Time_End": 3234.5,
        "Text": " No."
      },
      {
        "Time_Start": 3234.5,
        "Time_End": 3235.5,
        "Text": " To be honest, no."
      },
      {
        "Time_Start": 3235.5,
        "Time_End": 3236.5,
        "Text": " Thanks."
      },
      {
        "Time_Start": 3236.5,
        "Time_End": 3239.5,
        "Text": " But maybe it's just limited to my experience."
      },
      {
        "Time_Start": 3239.5,
        "Time_End": 3241.5,
        "Text": " Thanks for a great talk."
      },
      {
        "Time_Start": 3245.5,
        "Time_End": 3247.5,
        "Text": " Are there any other questions?"
      },
      {
        "Time_Start": 3248.5,
        "Time_End": 3250.5,
        "Text": " Okay, then."
      },
      {
        "Time_Start": 3250.5,
        "Time_End": 3251.5,
        "Text": " Thank you again."
      },
      {
        "Time_Start": 3251.5,
        "Time_End": 3254.5,
        "Text": " Or it was too complicated or it was really easy."
      },
      {
        "Time_Start": 3254.5,
        "Time_End": 3255.5,
        "Text": " So, no questions."
      },
      {
        "Time_Start": 3255.5,
        "Time_End": 3257.5,
        "Text": " I go for the second one."
      },
      {
        "Time_Start": 3258.5,
        "Time_End": 3259.5,
        "Text": " Thank you."
      }
    ]
  }
}