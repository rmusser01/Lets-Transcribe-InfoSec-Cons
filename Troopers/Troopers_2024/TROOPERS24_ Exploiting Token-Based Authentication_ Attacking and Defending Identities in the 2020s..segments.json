{
  "metadata": {
    "webpage_url": "https://www.youtube.com/watch?v=-uHNcz3CF8s",
    "title": "TROOPERS24: Exploiting Token-Based Authentication: Attacking and Defending Identities in the 2020s.",
    "description": "Talk by Dr Nestori Syynimaa - June 27th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/lx7rvf/\n\nMore impressions:\n  / wearetroopers  \n  / ernw_itsec  \nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
    "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
    "duration": 3064,
    "channel": "TROOPERS IT Security Conference",
    "uploader": "TROOPERS IT Security Conference",
    "upload_date": "20240909"
  },
  "segments": {
    "metadata": {
      "webpage_url": "https://www.youtube.com/watch?v=-uHNcz3CF8s",
      "title": "TROOPERS24: Exploiting Token-Based Authentication: Attacking and Defending Identities in the 2020s.",
      "description": "Talk by Dr Nestori Syynimaa - June 27th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/lx7rvf/\n\nMore impressions:\n  / wearetroopers  \n  / ernw_itsec  \nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
      "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
      "duration": 3064,
      "channel": "TROOPERS IT Security Conference",
      "uploader": "TROOPERS IT Security Conference",
      "upload_date": "20240909"
    },
    "segments": [
      {
        "Time_Start": 0.0,
        "Time_End": 14.0,
        "Text": "This text was transcribed using whisper model: large-v2\n\n Thank you, thank you. Can you hear me okay? Is this on?"
      },
      {
        "Time_Start": 14.0,
        "Time_End": 17.0,
        "Text": " Yeah, okay, good."
      },
      {
        "Time_Start": 17.0,
        "Time_End": 22.400000000000002,
        "Text": " Yes, so welcome everybody to my talk about exploiting token-based authentication."
      },
      {
        "Time_Start": 22.400000000000002,
        "Time_End": 25.72,
        "Text": " My name is Dr. Nestor Sinema, that's why I'm wearing this doctor gown."
      },
      {
        "Time_Start": 25.72,
        "Time_End": 32.72,
        "Text": " This is my first corporate talk, so I decided that I could at least look funny."
      },
      {
        "Time_Start": 32.72,
        "Time_End": 38.72,
        "Text": " So I work for Microsoft as a principal identity security researcher in an organization called Mystic,"
      },
      {
        "Time_Start": 38.72,
        "Time_End": 45.72,
        "Text": " or Microsoft Threat Intelligence Center. And I've been there like six months now."
      },
      {
        "Time_Start": 45.72,
        "Time_End": 49.72,
        "Text": " And today I'm going to cover these kind of things."
      },
      {
        "Time_Start": 49.72,
        "Time_End": 56.72,
        "Text": " Basically, what is token-based authentication attacks? Why and how?"
      },
      {
        "Time_Start": 56.72,
        "Time_End": 62.72,
        "Text": " This is not that much about any product, so this is like a product agnostic."
      },
      {
        "Time_Start": 62.72,
        "Time_End": 65.72,
        "Text": " So these are more about concepts."
      },
      {
        "Time_Start": 65.72,
        "Time_End": 71.72,
        "Text": " But I'm showing some demos, and obviously because I've got a background on Microsoft identity,"
      },
      {
        "Time_Start": 71.72,
        "Time_End": 77.72,
        "Text": " I'm using Microsoft Cloud Stack here for demos."
      },
      {
        "Time_Start": 77.72,
        "Time_End": 82.72,
        "Text": " So let's start with introduction, and let's start with the very basics."
      },
      {
        "Time_Start": 82.72,
        "Time_End": 88.72,
        "Text": " So usually when you are like authenticating using browser, for instance, we have two things."
      },
      {
        "Time_Start": 88.72,
        "Time_End": 90.72,
        "Text": " We have the client and we have the server."
      },
      {
        "Time_Start": 90.72,
        "Time_End": 97.72,
        "Text": " And when client wants to access some resource from server, it is saying, give me something, okay?"
      },
      {
        "Time_Start": 97.72,
        "Time_End": 102.72,
        "Text": " And now if service notices, okay, you are not authorized, it is sending back a message."
      },
      {
        "Time_Start": 102.72,
        "Time_End": 106.72,
        "Text": " And in the header it says that you are unauthorized."
      },
      {
        "Time_Start": 106.72,
        "Time_End": 109.72,
        "Text": " So you need to authorize with something."
      },
      {
        "Time_Start": 109.72,
        "Time_End": 113.72,
        "Text": " And by the way, I support these kind of schemes, authentication schemes."
      },
      {
        "Time_Start": 113.72,
        "Time_End": 115.72,
        "Text": " So that's all in here."
      },
      {
        "Time_Start": 115.72,
        "Time_End": 121.72,
        "Text": " And then the client does something, ask password from user or do whatever it does."
      },
      {
        "Time_Start": 121.72,
        "Time_End": 127.72,
        "Text": " And it sends again the request to get the thing, but now it includes a header authorization"
      },
      {
        "Time_Start": 127.72,
        "Time_End": 129.72,
        "Text": " with the scheme and then the payload."
      },
      {
        "Time_Start": 129.72,
        "Time_End": 132.72,
        "Text": " And the payload depends on the scheme."
      },
      {
        "Time_Start": 132.72,
        "Time_End": 139.72,
        "Text": " And then the server will return whatever the client was asking, if the authorization is okay."
      },
      {
        "Time_Start": 139.72,
        "Time_End": 145.72,
        "Text": " And here, well, usually after the initial authentication, usually session cookies are used, but it depends."
      },
      {
        "Time_Start": 145.72,
        "Time_End": 150.72,
        "Text": " So because you can do this in many ways, but this is just a basic thing that if I want to access something,"
      },
      {
        "Time_Start": 150.72,
        "Time_End": 152.72,
        "Text": " I need to authenticate."
      },
      {
        "Time_Start": 152.72,
        "Time_End": 154.72,
        "Text": " And here are some schemes."
      },
      {
        "Time_Start": 154.72,
        "Time_End": 157.72,
        "Text": " I'm going to kind of, well, going to cover some of these."
      },
      {
        "Time_Start": 157.72,
        "Time_End": 160.72,
        "Text": " Who remembers the basic scheme?"
      },
      {
        "Time_Start": 160.72,
        "Time_End": 162.72,
        "Text": " That was very nice thing."
      },
      {
        "Time_Start": 162.72,
        "Time_End": 166.72,
        "Text": " So basically it's your plain text username and password."
      },
      {
        "Time_Start": 166.72,
        "Time_End": 170.72,
        "Text": " Encrypted with Base64."
      },
      {
        "Time_Start": 170.72,
        "Time_End": 174.72,
        "Text": " And then we have Bearer and NTLM and that kind of stuff."
      },
      {
        "Time_Start": 174.72,
        "Time_End": 177.72,
        "Text": " But this is the kind of thing what I'm going to talk about today."
      },
      {
        "Time_Start": 177.72,
        "Time_End": 181.72,
        "Text": " How can we do the authorization and stuff?"
      },
      {
        "Time_Start": 181.72,
        "Time_End": 185.72,
        "Text": " Okay, key concepts of the talk."
      },
      {
        "Time_Start": 185.72,
        "Time_End": 188.72,
        "Text": " So we have a user who is consuming services."
      },
      {
        "Time_Start": 188.72,
        "Time_End": 193.72,
        "Text": " So it can be me, you, it can be a client, it can be browser, whatever."
      },
      {
        "Time_Start": 193.72,
        "Time_End": 197.72,
        "Text": " Then we have a service provider who provides the actual services."
      },
      {
        "Time_Start": 197.72,
        "Time_End": 202.72,
        "Text": " And then we have the identity provider who provides identity and access management."
      },
      {
        "Time_Start": 202.72,
        "Time_End": 205.72,
        "Text": " And those are kind of roles and service can have both."
      },
      {
        "Time_Start": 205.72,
        "Time_End": 210.72,
        "Text": " You can have different organizations providing services, one identity services and so on."
      },
      {
        "Time_Start": 210.72,
        "Time_End": 215.72,
        "Text": " But these are the concepts."
      },
      {
        "Time_Start": 215.72,
        "Time_End": 221.72,
        "Text": " And before we deep dive into the current, let's go what was in the past."
      },
      {
        "Time_Start": 221.72,
        "Time_End": 223.72,
        "Text": " So I call that the silo model."
      },
      {
        "Time_Start": 223.72,
        "Time_End": 226.72,
        "Text": " So we had a user who wanted to consume some service."
      },
      {
        "Time_Start": 226.72,
        "Time_End": 231.72,
        "Text": " User had to authenticate and then consume the service."
      },
      {
        "Time_Start": 231.72,
        "Time_End": 236.72,
        "Text": " And then if you want to use another service, you also need to authenticate there."
      },
      {
        "Time_Start": 236.72,
        "Time_End": 242.72,
        "Text": " That means that you have a different username and password in worst case on each of those services."
      },
      {
        "Time_Start": 242.72,
        "Time_End": 247.72,
        "Text": " That also meant that each of the service provider had to implement their own IDP."
      },
      {
        "Time_Start": 247.72,
        "Time_End": 249.72,
        "Text": " What can go wrong?"
      },
      {
        "Time_Start": 249.72,
        "Time_End": 254.72,
        "Text": " So you are basically trusting that the service provider knows how to store password hashes"
      },
      {
        "Time_Start": 254.72,
        "Time_End": 257.72,
        "Text": " or maybe plain text passwords you don't know."
      },
      {
        "Time_Start": 257.72,
        "Time_End": 263.72,
        "Text": " And if the service provider is breach, not only your data or your content is lost,"
      },
      {
        "Time_Start": 263.72,
        "Time_End": 269.72,
        "Text": " also your identity might have been lost, like a username and password."
      },
      {
        "Time_Start": 269.72,
        "Time_End": 274.72,
        "Text": " Who uses the same password in different services?"
      },
      {
        "Time_Start": 274.72,
        "Time_End": 277.72,
        "Text": " I know you do."
      },
      {
        "Time_Start": 277.72,
        "Time_End": 284.72,
        "Text": " So if you compromise that service provider, you compromise the identity."
      },
      {
        "Time_Start": 284.72,
        "Time_End": 287.72,
        "Text": " But now things are better, kind of."
      },
      {
        "Time_Start": 287.72,
        "Time_End": 290.72,
        "Text": " So now we use the federated model."
      },
      {
        "Time_Start": 290.72,
        "Time_End": 294.72,
        "Text": " So you authenticate to identity provider, which is a separate entity."
      },
      {
        "Time_Start": 294.72,
        "Time_End": 297.72,
        "Text": " It could be like, I don't know, Microsoft, Google."
      },
      {
        "Time_Start": 297.72,
        "Time_End": 299.72,
        "Text": " Some use Facebook."
      },
      {
        "Time_Start": 299.72,
        "Time_End": 301.72,
        "Text": " I don't know if that's a good thing."
      },
      {
        "Time_Start": 301.72,
        "Time_End": 307.72,
        "Text": " But you authenticate to identity provider, and then you consume those services using tokens."
      },
      {
        "Time_Start": 307.72,
        "Time_End": 311.72,
        "Text": " So that's why it's called also sometimes single sign-on."
      },
      {
        "Time_Start": 311.72,
        "Time_End": 318.72,
        "Text": " So now if somebody compromises this service provider, you only lose your data, not your identity."
      },
      {
        "Time_Start": 318.72,
        "Time_End": 322.72,
        "Text": " So that's a kind of a good thing."
      },
      {
        "Time_Start": 322.72,
        "Time_End": 324.72,
        "Text": " And this is based on trust."
      },
      {
        "Time_Start": 324.72,
        "Time_End": 330.72,
        "Text": " So as a user, you trust the identity provider, and also the service provider trusts the identity provider."
      },
      {
        "Time_Start": 330.72,
        "Time_End": 333.72,
        "Text": " So who trusts Microsoft?"
      },
      {
        "Time_Start": 333.72,
        "Time_End": 335.72,
        "Text": " Couple."
      },
      {
        "Time_Start": 335.72,
        "Time_End": 338.72,
        "Text": " Who is using Teams?"
      },
      {
        "Time_Start": 338.72,
        "Time_End": 340.72,
        "Text": " Aha!"
      },
      {
        "Time_Start": 340.72,
        "Time_End": 343.72,
        "Text": " So you trust Microsoft, actually."
      },
      {
        "Time_Start": 343.72,
        "Time_End": 349.72,
        "Text": " And that's a good thing. Nothing has ever happened to us."
      },
      {
        "Time_Start": 349.72,
        "Time_End": 358.72,
        "Text": " Yeah, but anyways, if you go back a bit, what happens here is that the token is the one that identifies who you are."
      },
      {
        "Time_Start": 358.72,
        "Time_End": 362.72,
        "Text": " So you don't need to send your passwords to service provider."
      },
      {
        "Time_Start": 362.72,
        "Time_End": 367.72,
        "Text": " Because in the best case, or well, in some cases, identity provider is inside your corporate network,"
      },
      {
        "Time_Start": 367.72,
        "Time_End": 369.72,
        "Text": " and the service providers are outside."
      },
      {
        "Time_Start": 369.72,
        "Time_End": 375.72,
        "Text": " So nothing leaves your on-prem network if you don't want to."
      },
      {
        "Time_Start": 375.72,
        "Time_End": 379.72,
        "Text": " Okay, then some technical stuff."
      },
      {
        "Time_Start": 379.72,
        "Time_End": 385.72,
        "Text": " I had to drink because Andy is sitting in the front row."
      },
      {
        "Time_Start": 385.72,
        "Time_End": 390.72,
        "Text": " This was vodka."
      },
      {
        "Time_Start": 390.72,
        "Time_End": 393.72,
        "Text": " Yeah, so Kerberos, authentication flow."
      },
      {
        "Time_Start": 393.72,
        "Time_End": 396.72,
        "Text": " So just the basic how this works."
      },
      {
        "Time_Start": 396.72,
        "Time_End": 401.72,
        "Text": " And this is used in Windows, and I'm using the roles or concepts I told you earlier."
      },
      {
        "Time_Start": 401.72,
        "Time_End": 404.72,
        "Text": " So we have a user who wants to access something."
      },
      {
        "Time_Start": 404.72,
        "Time_End": 410.72,
        "Text": " So you need to provide your proof of identity to identity provider, which in this case is a domain controller."
      },
      {
        "Time_Start": 410.72,
        "Time_End": 414.72,
        "Text": " Or the service is running a domain controller, right?"
      },
      {
        "Time_Start": 414.72,
        "Time_End": 417.72,
        "Text": " And then you will get a ticket granting ticket."
      },
      {
        "Time_Start": 417.72,
        "Time_End": 423.72,
        "Text": " And with that, you can go back to the ID provider and ask, I want to have a service ticket for this certain service."
      },
      {
        "Time_Start": 423.72,
        "Time_End": 425.72,
        "Text": " And then it will send you a service ticket."
      },
      {
        "Time_Start": 425.72,
        "Time_End": 428.72,
        "Text": " And then with that, you can consume the service."
      },
      {
        "Time_Start": 428.72,
        "Time_End": 435.72,
        "Text": " So this is the token, actually, you are providing to service provider."
      },
      {
        "Time_Start": 435.72,
        "Time_End": 439.72,
        "Text": " So now how this technically works."
      },
      {
        "Time_Start": 439.72,
        "Time_End": 450.72,
        "Text": " So this request here, it contains this kind of a KRB AP request message."
      },
      {
        "Time_Start": 450.72,
        "Time_End": 452.72,
        "Text": " And it's constructed like this."
      },
      {
        "Time_Start": 452.72,
        "Time_End": 458.72,
        "Text": " So here we have a ticket part, and that is encrypted using the server secret."
      },
      {
        "Time_Start": 458.72,
        "Time_End": 462.72,
        "Text": " So the identity provider, in this case domain controller, knows all the secrets."
      },
      {
        "Time_Start": 462.72,
        "Time_End": 467.72,
        "Text": " So when you as a user, you authenticate using your secret, domain controller verifies that."
      },
      {
        "Time_Start": 467.72,
        "Time_End": 470.72,
        "Text": " And it sends you the service ticket."
      },
      {
        "Time_Start": 470.72,
        "Time_End": 476.72,
        "Text": " And because domain controller knows the secret of the server, it can encrypt this."
      },
      {
        "Time_Start": 476.72,
        "Time_End": 481.72,
        "Text": " And then you get the ticket, you send it to the server, and server knows its own secrets."
      },
      {
        "Time_Start": 481.72,
        "Time_End": 483.72,
        "Text": " So it can decrypt this."
      },
      {
        "Time_Start": 483.72,
        "Time_End": 485.72,
        "Text": " So that's how this works."
      },
      {
        "Time_Start": 485.72,
        "Time_End": 487.72,
        "Text": " So we have the ticket."
      },
      {
        "Time_Start": 487.72,
        "Time_End": 489.72,
        "Text": " Then you have the server secret."
      },
      {
        "Time_Start": 489.72,
        "Time_End": 496.72,
        "Text": " You use server secret to calculate the checksum of PAC, which is Privileged Account Certificate."
      },
      {
        "Time_Start": 496.72,
        "Time_End": 502.72,
        "Text": " And then there's another checksum, but we don't care about this this time."
      },
      {
        "Time_Start": 502.72,
        "Time_End": 508.72,
        "Text": " Because usually the server doesn't send the ticket back to TC and confirm that."
      },
      {
        "Time_Start": 508.72,
        "Time_End": 513.72,
        "Text": " And then we have the authorization data, which is encrypted using checksum key, which was in here."
      },
      {
        "Time_Start": 513.72,
        "Time_End": 520.72,
        "Text": " So basically, to be able to use these or create these, you need to have the server secret."
      },
      {
        "Time_Start": 520.72,
        "Time_End": 523.72,
        "Text": " Okay? Does this make any sense?"
      },
      {
        "Time_Start": 523.72,
        "Time_End": 525.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 525.72,
        "Time_End": 527.72,
        "Text": " Then another protocol."
      },
      {
        "Time_Start": 527.72,
        "Time_End": 529.72,
        "Text": " Well, SAML is not actually a protocol."
      },
      {
        "Time_Start": 529.72,
        "Time_End": 532.72,
        "Text": " It's just a format, but anyways."
      },
      {
        "Time_Start": 532.72,
        "Time_End": 537.72,
        "Text": " So the actual protocol is usually SAMLP or WSFED, Federation."
      },
      {
        "Time_Start": 537.72,
        "Time_End": 540.72,
        "Text": " So what happens here is that, again, user..."
      },
      {
        "Time_Start": 540.72,
        "Time_End": 542.72,
        "Text": " Well, now it goes to service provider."
      },
      {
        "Time_Start": 542.72,
        "Time_End": 544.72,
        "Text": " Service provider says, okay, you need to authenticate."
      },
      {
        "Time_Start": 544.72,
        "Time_End": 546.72,
        "Text": " Please go to the ID provider."
      },
      {
        "Time_Start": 546.72,
        "Time_End": 548.72,
        "Text": " And now you go there."
      },
      {
        "Time_Start": 548.72,
        "Time_End": 550.72,
        "Text": " You provide your proof of identity."
      },
      {
        "Time_Start": 550.72,
        "Time_End": 555.72,
        "Text": " It can be, well, username, password, username and password, certificate, whatever."
      },
      {
        "Time_Start": 555.72,
        "Time_End": 559.72,
        "Text": " And then the identity provider gives you back SAML token."
      },
      {
        "Time_Start": 559.72,
        "Time_End": 562.72,
        "Text": " And then it redirects you to the service provider."
      },
      {
        "Time_Start": 562.72,
        "Time_End": 566.72,
        "Text": " And then you go there and you consume the service with that token."
      },
      {
        "Time_Start": 566.72,
        "Time_End": 570.72,
        "Text": " And now, in this case, it's just the SAML token."
      },
      {
        "Time_Start": 570.72,
        "Time_End": 572.72,
        "Text": " And we have two flavors."
      },
      {
        "Time_Start": 572.72,
        "Time_End": 575.72,
        "Text": " So we have the service provider-initiated flow."
      },
      {
        "Time_Start": 575.72,
        "Time_End": 579.72,
        "Text": " Or you can also use the identity provider-initiated flow."
      },
      {
        "Time_Start": 579.72,
        "Time_End": 583.72,
        "Text": " And Golden SAML attack is using this one, actually."
      },
      {
        "Time_Start": 583.72,
        "Time_End": 587.72,
        "Text": " So it makes things easier."
      },
      {
        "Time_Start": 588.72,
        "Time_End": 590.72,
        "Text": " So now, how this works."
      },
      {
        "Time_Start": 590.72,
        "Time_End": 592.72,
        "Text": " So what we have here."
      },
      {
        "Time_Start": 592.72,
        "Time_End": 595.72,
        "Text": " So we have the SAML response inside that assertion."
      },
      {
        "Time_Start": 595.72,
        "Time_End": 601.72,
        "Text": " And there you have your attribute statements, which means properties of you."
      },
      {
        "Time_Start": 601.72,
        "Time_End": 604.72,
        "Text": " What's your name? What's your email? Whatever."
      },
      {
        "Time_Start": 604.72,
        "Time_End": 606.72,
        "Text": " Then you have authentication statement."
      },
      {
        "Time_Start": 606.72,
        "Time_End": 610.72,
        "Text": " Which, if I remember correctly, is about how you did the authentication."
      },
      {
        "Time_Start": 610.72,
        "Time_End": 613.72,
        "Text": " So what's your username, password, or whatever."
      },
      {
        "Time_Start": 613.72,
        "Time_End": 615.72,
        "Text": " Then we have the signature."
      },
      {
        "Time_Start": 615.72,
        "Time_End": 620.72,
        "Text": " And that is signed using private key of IDP for this certain service."
      },
      {
        "Time_Start": 620.72,
        "Time_End": 624.72,
        "Text": " So if you have that secret, you can forge those."
      },
      {
        "Time_Start": 624.72,
        "Time_End": 626.72,
        "Text": " But this is not encrypted."
      },
      {
        "Time_Start": 626.72,
        "Time_End": 628.72,
        "Text": " So this is plain text, usually."
      },
      {
        "Time_Start": 628.72,
        "Time_End": 631.72,
        "Text": " So everything you can see here."
      },
      {
        "Time_Start": 631.72,
        "Time_End": 633.72,
        "Text": " So it's just XML, basically."
      },
      {
        "Time_Start": 633.72,
        "Time_End": 636.72,
        "Text": " So you can open that and see that."
      },
      {
        "Time_Start": 636.72,
        "Time_End": 640.72,
        "Text": " And the signature is that verifies that this is really the thing."
      },
      {
        "Time_Start": 640.72,
        "Time_End": 643.72,
        "Text": " It's like a passport. You can see what text is there."
      },
      {
        "Time_Start": 643.72,
        "Time_End": 645.72,
        "Text": " But it's just stamped by your government."
      },
      {
        "Time_Start": 645.72,
        "Time_End": 648.72,
        "Text": " And you trust that, right?"
      },
      {
        "Time_Start": 648.72,
        "Time_End": 652.72,
        "Text": " And by the way, when was Kerberos invented?"
      },
      {
        "Time_Start": 652.72,
        "Time_End": 654.72,
        "Text": " Anyone?"
      },
      {
        "Time_Start": 654.72,
        "Time_End": 658.72,
        "Text": " 1998, yeah. So I'm older than Kerberos."
      },
      {
        "Time_Start": 658.72,
        "Time_End": 662.72,
        "Text": " And this? SAML, roughly."
      },
      {
        "Time_Start": 662.72,
        "Time_End": 665.72,
        "Text": " 2002 or something like that."
      },
      {
        "Time_Start": 665.72,
        "Time_End": 670.72,
        "Text": " And this one, OAuth, roughly 2007."
      },
      {
        "Time_Start": 670.72,
        "Time_End": 672.72,
        "Text": " And this is kind of what we use."
      },
      {
        "Time_Start": 672.72,
        "Time_End": 674.72,
        "Text": " So it's JSON Web Signature."
      },
      {
        "Time_Start": 674.72,
        "Time_End": 676.72,
        "Text": " Somebody called it JSON Web Token."
      },
      {
        "Time_Start": 676.72,
        "Time_End": 679.72,
        "Text": " It's a type of JSON Web Token."
      },
      {
        "Time_Start": 679.72,
        "Time_End": 681.72,
        "Text": " But we just do the signature."
      },
      {
        "Time_Start": 681.72,
        "Time_End": 683.72,
        "Text": " So basically it's pretty much the same as SAML."
      },
      {
        "Time_Start": 683.72,
        "Time_End": 685.72,
        "Text": " But it's in a different format."
      },
      {
        "Time_Start": 685.72,
        "Time_End": 686.72,
        "Text": " So it's in JSON."
      },
      {
        "Time_Start": 686.72,
        "Time_End": 688.72,
        "Text": " So first we have a header which says,"
      },
      {
        "Time_Start": 688.72,
        "Time_End": 691.72,
        "Text": " okay, which kind of key we use to sign this."
      },
      {
        "Time_Start": 691.72,
        "Time_End": 694.72,
        "Text": " And what kind of token this is."
      },
      {
        "Time_Start": 694.72,
        "Time_End": 697.72,
        "Text": " Then we have the payload, which has claims."
      },
      {
        "Time_Start": 697.72,
        "Time_End": 701.72,
        "Text": " Again, like attribute statements for who you are."
      },
      {
        "Time_Start": 701.72,
        "Time_End": 703.72,
        "Text": " What is your email address and so on."
      },
      {
        "Time_Start": 703.72,
        "Time_End": 707.72,
        "Text": " Depending on the service, whatever you put out there."
      },
      {
        "Time_Start": 707.72,
        "Time_End": 709.72,
        "Text": " And then we have the signature."
      },
      {
        "Time_Start": 709.72,
        "Time_End": 712.72,
        "Text": " And that is signed, again, using the IDP secret key."
      },
      {
        "Time_Start": 712.72,
        "Time_End": 716.72,
        "Text": " So that's how you can verify that."
      },
      {
        "Time_Start": 716.72,
        "Time_End": 722.72,
        "Text": " And in Entra, and also in other OAuth providers,"
      },
      {
        "Time_Start": 722.72,
        "Time_End": 726.72,
        "Text": " there are certain, let's say, flows."
      },
      {
        "Time_Start": 726.72,
        "Time_End": 728.72,
        "Text": " How to get access token."
      },
      {
        "Time_Start": 728.72,
        "Time_End": 730.72,
        "Text": " This is one ROTC."
      },
      {
        "Time_Start": 730.72,
        "Time_End": 732.72,
        "Text": " Resource Owner Password Credentials."
      },
      {
        "Time_Start": 732.72,
        "Time_End": 734.72,
        "Text": " So here you just provide your credentials"
      },
      {
        "Time_Start": 734.72,
        "Time_End": 737.72,
        "Text": " to identity provider, like Entra ID."
      },
      {
        "Time_Start": 737.72,
        "Time_End": 740.72,
        "Text": " You will get back access token and refresh token, usually."
      },
      {
        "Time_Start": 740.72,
        "Time_End": 742.72,
        "Text": " And then with those, you can go and consume service."
      },
      {
        "Time_Start": 742.72,
        "Time_End": 745.72,
        "Text": " Whatever that is."
      },
      {
        "Time_Start": 745.72,
        "Time_End": 748.72,
        "Text": " In case of Entra ID, it can be Entra ID itself."
      },
      {
        "Time_Start": 748.72,
        "Time_End": 749.72,
        "Text": " Because that's also service."
      },
      {
        "Time_Start": 753.72,
        "Time_End": 757.72,
        "Text": " But usually, we are using thing called"
      },
      {
        "Time_Start": 757.72,
        "Time_End": 759.72,
        "Text": " Authorization Code Flow."
      },
      {
        "Time_Start": 759.72,
        "Time_End": 763.72,
        "Text": " That's OAuth Authorization Code Flow,"
      },
      {
        "Time_Start": 763.72,
        "Time_End": 767.72,
        "Text": " where you are using a certain client application."
      },
      {
        "Time_Start": 767.72,
        "Time_End": 770.72,
        "Text": " So you, as a user, you provide your proof of identity"
      },
      {
        "Time_Start": 770.72,
        "Time_End": 772.72,
        "Text": " to identity provider."
      },
      {
        "Time_Start": 772.72,
        "Time_End": 777.72,
        "Text": " Then you will get back SP."
      },
      {
        "Time_Start": 777.72,
        "Time_End": 782.72,
        "Text": " Well, redirect to service provider and the code."
      },
      {
        "Time_Start": 782.72,
        "Time_End": 783.72,
        "Text": " Authorization code."
      },
      {
        "Time_Start": 783.72,
        "Time_End": 789.72,
        "Text": " And now that code proves who user is."
      },
      {
        "Time_Start": 789.72,
        "Time_End": 791.72,
        "Text": " So technically, we don't know what's inside that,"
      },
      {
        "Time_Start": 791.72,
        "Time_End": 793.72,
        "Text": " because it's encrypted stuff."
      },
      {
        "Time_Start": 793.72,
        "Time_End": 795.72,
        "Text": " Well, I might know. You don't."
      },
      {
        "Time_Start": 795.72,
        "Time_End": 799.72,
        "Text": " And then you are going to consume the service"
      },
      {
        "Time_Start": 799.72,
        "Time_End": 801.72,
        "Text": " with that code."
      },
      {
        "Time_Start": 801.72,
        "Time_End": 805.72,
        "Text": " And then the service provider adds the client credentials"
      },
      {
        "Time_Start": 805.72,
        "Time_End": 808.72,
        "Text": " to that request and sends that to IDP."
      },
      {
        "Time_Start": 808.72,
        "Time_End": 811.72,
        "Text": " And finally, you will get back access token and refresh token."
      },
      {
        "Time_Start": 811.72,
        "Time_End": 815.72,
        "Text": " Now, depending on how you have implemented the web application,"
      },
      {
        "Time_Start": 815.72,
        "Time_End": 819.72,
        "Text": " it may or may not send you the access token to the browser."
      },
      {
        "Time_Start": 819.72,
        "Time_End": 820.72,
        "Text": " But it depends."
      },
      {
        "Time_Start": 820.72,
        "Time_End": 822.72,
        "Text": " But anyway, after that, you can consume the service"
      },
      {
        "Time_Start": 822.72,
        "Time_End": 826.72,
        "Text": " with access token."
      },
      {
        "Time_Start": 826.72,
        "Time_End": 832.72,
        "Text": " Yeah, this is very hot here."
      },
      {
        "Time_Start": 832.72,
        "Time_End": 833.72,
        "Text": " OK."
      },
      {
        "Time_Start": 833.72,
        "Time_End": 835.72,
        "Text": " Then Enter ID hybrid authentication flow."
      },
      {
        "Time_Start": 835.72,
        "Time_End": 837.72,
        "Text": " So this is a conceptual flow."
      },
      {
        "Time_Start": 837.72,
        "Time_End": 840.72,
        "Text": " So basically, as a user, you try to consume service."
      },
      {
        "Time_Start": 840.72,
        "Time_End": 842.72,
        "Text": " Enter ID is OK."
      },
      {
        "Time_Start": 842.72,
        "Time_End": 843.72,
        "Text": " You need to go to identity provider."
      },
      {
        "Time_Start": 843.72,
        "Time_End": 845.72,
        "Text": " It could be your ADFS."
      },
      {
        "Time_Start": 845.72,
        "Time_End": 846.72,
        "Text": " It could be Okta."
      },
      {
        "Time_Start": 846.72,
        "Time_End": 847.72,
        "Text": " It could be Ping."
      },
      {
        "Time_Start": 847.72,
        "Time_End": 849.72,
        "Text": " It doesn't matter."
      },
      {
        "Time_Start": 849.72,
        "Time_End": 851.72,
        "Text": " You need to prove your identity to the identity provider."
      },
      {
        "Time_Start": 851.72,
        "Time_End": 856.72,
        "Text": " Then you will get back redirect to service provider"
      },
      {
        "Time_Start": 856.72,
        "Time_End": 858.72,
        "Text": " and then some proof of identity."
      },
      {
        "Time_Start": 858.72,
        "Time_End": 860.72,
        "Text": " So it can be that SAML token."
      },
      {
        "Time_Start": 860.72,
        "Time_End": 863.72,
        "Text": " It can be JWT."
      },
      {
        "Time_Start": 863.72,
        "Time_End": 865.72,
        "Text": " But you provide that to provider."
      },
      {
        "Time_Start": 865.72,
        "Time_End": 868.72,
        "Text": " And now it checks the identity or signature or whatever,"
      },
      {
        "Time_Start": 868.72,
        "Time_End": 871.72,
        "Text": " depending on what you are using."
      },
      {
        "Time_Start": 871.72,
        "Time_End": 878.72,
        "Text": " And then you will have an access token and refresh token."
      },
      {
        "Time_Start": 878.72,
        "Time_End": 880.72,
        "Text": " Token types in Enter ID."
      },
      {
        "Time_Start": 880.72,
        "Time_End": 882.72,
        "Text": " So we have ID tokens, access tokens."
      },
      {
        "Time_Start": 882.72,
        "Time_End": 885.72,
        "Text": " They are alive, like, one hour."
      },
      {
        "Time_Start": 885.72,
        "Time_End": 891.72,
        "Text": " We have refresh tokens, which are valid for 90 days or so."
      },
      {
        "Time_Start": 891.72,
        "Time_End": 898.72,
        "Text": " So these kind of things is that the bad guys want to steal."
      },
      {
        "Time_Start": 898.72,
        "Time_End": 900.72,
        "Text": " Yeah, so sum up the FerroEdit method."
      },
      {
        "Time_Start": 900.72,
        "Time_End": 902.72,
        "Text": " So we have the Kerberos."
      },
      {
        "Time_Start": 902.72,
        "Time_End": 904.72,
        "Text": " It's been there since 1989."
      },
      {
        "Time_Start": 904.72,
        "Time_End": 907.72,
        "Text": " And I think the first public version came out, like, 93"
      },
      {
        "Time_Start": 907.72,
        "Time_End": 909.72,
        "Text": " or something like that."
      },
      {
        "Time_Start": 909.72,
        "Time_End": 910.72,
        "Text": " Then we have the SAML."
      },
      {
        "Time_Start": 910.72,
        "Time_End": 916.72,
        "Text": " And then we have the OAuth."
      },
      {
        "Time_Start": 916.72,
        "Time_End": 917.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 917.72,
        "Time_End": 920.72,
        "Text": " Then to the beef of the talk."
      },
      {
        "Time_Start": 920.72,
        "Time_End": 926.72,
        "Text": " So we're going to talk about attacks."
      },
      {
        "Time_Start": 926.72,
        "Time_End": 929.72,
        "Text": " And talent with these tokens, which are called bearer tokens,"
      },
      {
        "Time_Start": 929.72,
        "Time_End": 934.72,
        "Text": " means that whoever has that token can use it as that person"
      },
      {
        "Time_Start": 934.72,
        "Time_End": 938.72,
        "Text": " who that token was, like, created for."
      },
      {
        "Time_Start": 938.72,
        "Time_End": 944.72,
        "Text": " Without providing proof of possession of any cryptographic keys"
      },
      {
        "Time_Start": 944.72,
        "Time_End": 945.72,
        "Text": " or anything like that."
      },
      {
        "Time_Start": 945.72,
        "Time_End": 949.72,
        "Text": " And as the RFC said, that to prevent misuse,"
      },
      {
        "Time_Start": 949.72,
        "Time_End": 953.72,
        "Text": " bearer tokens need to be protected from disclosure in storage"
      },
      {
        "Time_Start": 953.72,
        "Time_End": 956.72,
        "Text": " and in transport."
      },
      {
        "Time_Start": 956.72,
        "Time_End": 962.72,
        "Text": " And just to prove my point, I found a token yesterday"
      },
      {
        "Time_Start": 962.72,
        "Time_End": 967.72,
        "Text": " that you shouldn't share, because that's bound to me,"
      },
      {
        "Time_Start": 967.72,
        "Time_End": 972.72,
        "Text": " but you never know what happens."
      },
      {
        "Time_Start": 972.72,
        "Time_End": 973.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 973.72,
        "Time_End": 977.72,
        "Text": " So I made up a graph about token-based authentication attacks."
      },
      {
        "Time_Start": 977.72,
        "Time_End": 979.72,
        "Text": " So we have, like, two parts here."
      },
      {
        "Time_Start": 979.72,
        "Time_End": 984.72,
        "Text": " The first is that do you have access to secrets to create those tokens?"
      },
      {
        "Time_Start": 984.72,
        "Time_End": 990.72,
        "Text": " If you don't, only option you have is to steal the tokens, right?"
      },
      {
        "Time_Start": 990.72,
        "Time_End": 993.72,
        "Text": " So that's the only option in that case."
      },
      {
        "Time_Start": 994.72,
        "Time_End": 1001.72,
        "Text": " But if you are a very, very bad guy, like from Russia, China, Iran,"
      },
      {
        "Time_Start": 1001.72,
        "Time_End": 1004.72,
        "Text": " you might be able to steal the secrets."
      },
      {
        "Time_Start": 1004.72,
        "Time_End": 1007.72,
        "Text": " And then you can forge tokens."
      },
      {
        "Time_Start": 1007.72,
        "Time_End": 1012.72,
        "Text": " And then you finally use tokens."
      },
      {
        "Time_Start": 1012.72,
        "Time_End": 1018.72,
        "Text": " And the format here is BBMN 2.0, if you are wondering why it looks like that."
      },
      {
        "Time_Start": 1018.72,
        "Time_End": 1022.72,
        "Text": " But that's just a notation."
      },
      {
        "Time_Start": 1022.72,
        "Time_End": 1023.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1023.72,
        "Time_End": 1032.72,
        "Text": " So if we want to steal secrets for Kerberos, what do we need?"
      },
      {
        "Time_Start": 1032.72,
        "Time_End": 1037.72,
        "Text": " What do we need to steal?"
      },
      {
        "Time_Start": 1037.72,
        "Time_End": 1040.72,
        "Text": " Secret of what?"
      },
      {
        "Time_Start": 1040.72,
        "Time_End": 1042.72,
        "Text": " The service, what we want to use."
      },
      {
        "Time_Start": 1042.72,
        "Time_End": 1045.72,
        "Text": " Or KB, RTP, whatever that was."
      },
      {
        "Time_Start": 1045.72,
        "Time_End": 1048.72,
        "Text": " Then you can be whoever you want to."
      },
      {
        "Time_Start": 1048.72,
        "Time_End": 1051.72,
        "Text": " And for SAML?"
      },
      {
        "Time_Start": 1051.72,
        "Time_End": 1053.72,
        "Text": " Certificate, right?"
      },
      {
        "Time_Start": 1053.72,
        "Time_End": 1057.72,
        "Text": " And also for JSON or OAuth, you need to have a certificate."
      },
      {
        "Time_Start": 1057.72,
        "Time_End": 1065.72,
        "Text": " So let's map this, like, to MITRE ATT&CK techniques."
      },
      {
        "Time_Start": 1065.72,
        "Time_End": 1073.72,
        "Text": " So we have a T1552.004, which is unsecured credentials for private keys."
      },
      {
        "Time_Start": 1073.72,
        "Time_End": 1078.72,
        "Text": " So it can be the service secret or the certificates."
      },
      {
        "Time_Start": 1078.72,
        "Time_End": 1080.72,
        "Text": " And then we have forged web credentials,"
      },
      {
        "Time_Start": 1080.72,
        "Time_End": 1083.72,
        "Text": " so where you use those secrets to create those web credentials,"
      },
      {
        "Time_Start": 1083.72,
        "Time_End": 1090.72,
        "Text": " like SAML tokens or JSON tokens or Kerberos tickets."
      },
      {
        "Time_Start": 1090.72,
        "Time_End": 1094.72,
        "Text": " Then we have this access token manipulation,"
      },
      {
        "Time_Start": 1094.72,
        "Time_End": 1098.72,
        "Text": " so you do the token theft thing."
      },
      {
        "Time_Start": 1099.72,
        "Time_End": 1105.72,
        "Text": " And then we have the profit part, where you can actually use those tokens."
      },
      {
        "Time_Start": 1105.72,
        "Time_End": 1106.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1106.72,
        "Time_End": 1109.72,
        "Text": " Then I put these in kind of realms."
      },
      {
        "Time_Start": 1109.72,
        "Time_End": 1113.72,
        "Text": " So we have the endpoints where the stealing happens."
      },
      {
        "Time_Start": 1113.72,
        "Time_End": 1118.72,
        "Text": " So it can be either your users' computers or devices,"
      },
      {
        "Time_Start": 1118.72,
        "Time_End": 1122.72,
        "Text": " or it can be your servers, where you run your IDPs."
      },
      {
        "Time_Start": 1122.72,
        "Time_End": 1123.72,
        "Text": " And then we have cloud."
      },
      {
        "Time_Start": 1123.72,
        "Time_End": 1127.72,
        "Text": " And cloud just means that it's outside of the endpoints."
      },
      {
        "Time_Start": 1127.72,
        "Time_End": 1130.72,
        "Text": " So everything starts here."
      },
      {
        "Time_Start": 1130.72,
        "Time_End": 1133.72,
        "Text": " And these are the only things that we can actually control."
      },
      {
        "Time_Start": 1133.72,
        "Time_End": 1137.72,
        "Text": " So we can put some restrictions, firewalls,"
      },
      {
        "Time_Start": 1137.72,
        "Time_End": 1142.72,
        "Text": " and configure your laptops to be more safe and so on."
      },
      {
        "Time_Start": 1142.72,
        "Time_End": 1147.72,
        "Text": " And what happens there in cloud, we can't really do anything."
      },
      {
        "Time_Start": 1147.72,
        "Time_End": 1153.72,
        "Text": " Well, we can. You can't."
      },
      {
        "Time_Start": 1153.72,
        "Time_End": 1156.72,
        "Text": " And, yeah, so the stealing happens here,"
      },
      {
        "Time_Start": 1156.72,
        "Time_End": 1160.72,
        "Text": " but what happens after that, it's out there."
      },
      {
        "Time_Start": 1160.72,
        "Time_End": 1164.72,
        "Text": " For instance, you forge tokens outside your endpoints."
      },
      {
        "Time_Start": 1164.72,
        "Time_End": 1166.72,
        "Text": " So after you have stolen those secrets,"
      },
      {
        "Time_Start": 1166.72,
        "Time_End": 1169.72,
        "Text": " you don't need to be in your on-prem anymore or the endpoints."
      },
      {
        "Time_Start": 1169.72,
        "Time_End": 1172.72,
        "Text": " You can forge those outside, and we can detect that."
      },
      {
        "Time_Start": 1172.72,
        "Time_End": 1174.72,
        "Text": " Nobody can detect forging the tokens,"
      },
      {
        "Time_Start": 1174.72,
        "Time_End": 1178.72,
        "Text": " but you can detect when they are used, if you understand what I mean."
      },
      {
        "Time_Start": 1178.72,
        "Time_End": 1181.72,
        "Text": " Because that forging happens in a very dark place"
      },
      {
        "Time_Start": 1181.72,
        "Time_End": 1182.72,
        "Text": " where nobody can access."
      },
      {
        "Time_Start": 1182.72,
        "Time_End": 1185.72,
        "Text": " You just then take the result or the token"
      },
      {
        "Time_Start": 1185.72,
        "Time_End": 1189.72,
        "Text": " and then use that somewhere else."
      },
      {
        "Time_Start": 1189.72,
        "Time_End": 1192.72,
        "Text": " Okay, now then put the roles in the map."
      },
      {
        "Time_Start": 1192.72,
        "Time_End": 1196.72,
        "Text": " So you steal tokens from users."
      },
      {
        "Time_Start": 1196.72,
        "Time_End": 1198.72,
        "Text": " You steal secrets from IDP."
      },
      {
        "Time_Start": 1198.72,
        "Time_End": 1204.72,
        "Text": " And then you use those tokens in service provider."
      },
      {
        "Time_Start": 1204.72,
        "Time_End": 1209.72,
        "Text": " And what do you think is more hard to steal?"
      },
      {
        "Time_Start": 1209.72,
        "Time_End": 1214.72,
        "Text": " User tokens or the secrets, IDP secrets?"
      },
      {
        "Time_Start": 1214.72,
        "Time_End": 1217.72,
        "Text": " Which ones? Yeah."
      },
      {
        "Time_Start": 1217.72,
        "Time_End": 1222.72,
        "Text": " And that's usually done by those very, very bad actors."
      },
      {
        "Time_Start": 1222.72,
        "Time_End": 1225.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1225.72,
        "Time_End": 1228.72,
        "Text": " So let's show some demos at this point."
      },
      {
        "Time_Start": 1228.72,
        "Time_End": 1232.72,
        "Text": " So I was planning to do something nice,"
      },
      {
        "Time_Start": 1232.72,
        "Time_End": 1234.72,
        "Text": " like using evil things for this,"
      },
      {
        "Time_Start": 1234.72,
        "Time_End": 1237.72,
        "Text": " but Tirkan already did that in his conference talk"
      },
      {
        "Time_Start": 1237.72,
        "Time_End": 1239.72,
        "Text": " in Area 41 conference, right?"
      },
      {
        "Time_Start": 1239.72,
        "Time_End": 1242.72,
        "Text": " So there's a video on that, so go see that."
      },
      {
        "Time_Start": 1242.72,
        "Time_End": 1247.72,
        "Text": " So I'm just going to do this in a boring way."
      },
      {
        "Time_Start": 1247.72,
        "Time_End": 1252.72,
        "Text": " So I'm now logged in as an admin to my tenant."
      },
      {
        "Time_Start": 1252.72,
        "Time_End": 1259.72,
        "Text": " Now I open or press the hacking button or F12."
      },
      {
        "Time_Start": 1259.72,
        "Time_End": 1263.72,
        "Text": " And then I go and refresh."
      },
      {
        "Time_Start": 1263.72,
        "Time_End": 1266.72,
        "Text": " And then go to this view here."
      },
      {
        "Time_Start": 1266.72,
        "Time_End": 1271.72,
        "Text": " And then I'm going to hit that button."
      },
      {
        "Time_Start": 1271.72,
        "Time_End": 1275.72,
        "Text": " E-Y-J-T-J."
      },
      {
        "Time_Start": 1275.72,
        "Time_End": 1278.72,
        "Text": " Nothing. Okay. Now it's better."
      },
      {
        "Time_Start": 1278.72,
        "Time_End": 1282.72,
        "Text": " So now we have token here."
      },
      {
        "Time_Start": 1282.72,
        "Time_End": 1285.72,
        "Text": " So I'll just copy that."
      },
      {
        "Time_Start": 1285.72,
        "Time_End": 1291.72,
        "Text": " Then I go back here and go to, let's say, JWT.ms."
      },
      {
        "Time_Start": 1291.72,
        "Time_End": 1294.72,
        "Text": " That service provided by us."
      },
      {
        "Time_Start": 1294.72,
        "Time_End": 1298.72,
        "Text": " You can paste it here, and then you can see what's inside the token."
      },
      {
        "Time_Start": 1298.72,
        "Time_End": 1301.72,
        "Text": " So this is actually the JSON access token."
      },
      {
        "Time_Start": 1301.72,
        "Time_End": 1303.72,
        "Text": " So it's for graph.microsoft.com."
      },
      {
        "Time_Start": 1303.72,
        "Time_End": 1308.72,
        "Text": " It has nice scopes, so you can do a lot of things."
      },
      {
        "Time_Start": 1308.72,
        "Time_End": 1311.72,
        "Text": " So you just basically copy that."
      },
      {
        "Time_Start": 1311.72,
        "Time_End": 1314.72,
        "Text": " And then you can see that, and you can also use that."
      },
      {
        "Time_Start": 1314.72,
        "Time_End": 1317.72,
        "Text": " So I have my toolkit somewhere here."
      },
      {
        "Time_Start": 1317.72,
        "Time_End": 1321.72,
        "Text": " AD internals."
      },
      {
        "Time_Start": 1321.72,
        "Time_End": 1324.72,
        "Text": " Where's my mouse there?"
      },
      {
        "Time_Start": 1324.72,
        "Time_End": 1328.72,
        "Text": " So I'm just going to show it to you."
      },
      {
        "Time_Start": 1328.72,
        "Time_End": 1332.72,
        "Text": " So get AD int tenant."
      },
      {
        "Time_Start": 1332.72,
        "Time_End": 1336.72,
        "Text": " I think that is using graph. Yeah."
      },
      {
        "Time_Start": 1336.72,
        "Time_End": 1339.72,
        "Text": " Access token."
      },
      {
        "Time_Start": 1339.72,
        "Time_End": 1341.72,
        "Text": " And that's it."
      },
      {
        "Time_Start": 1341.72,
        "Time_End": 1346.72,
        "Text": " So you can use the token as well."
      },
      {
        "Time_Start": 1346.72,
        "Time_End": 1351.72,
        "Text": " So that was like a very short demonstration of how you can steal tokens"
      },
      {
        "Time_Start": 1351.72,
        "Time_End": 1353.72,
        "Text": " and how you can use them."
      },
      {
        "Time_Start": 1353.72,
        "Time_End": 1358.72,
        "Text": " So basically, if bad actors have access to users' computers,"
      },
      {
        "Time_Start": 1358.72,
        "Time_End": 1360.72,
        "Text": " they can get the tokens."
      },
      {
        "Time_Start": 1360.72,
        "Time_End": 1362.72,
        "Text": " And that was just access token."
      },
      {
        "Time_Start": 1362.72,
        "Time_End": 1365.72,
        "Text": " You can also get the refresh token, which is valid for 90 days and so on."
      },
      {
        "Time_Start": 1365.72,
        "Time_End": 1370.72,
        "Text": " And you can use them also outside that computer."
      },
      {
        "Time_Start": 1370.72,
        "Time_End": 1372.72,
        "Text": " Because it's a bearer token."
      },
      {
        "Time_Start": 1372.72,
        "Time_End": 1380.72,
        "Text": " If you bear that token, you are the one who the bearer token says you are."
      },
      {
        "Time_Start": 1380.72,
        "Time_End": 1382.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1382.72,
        "Time_End": 1385.72,
        "Text": " Then another demo."
      },
      {
        "Time_Start": 1385.72,
        "Time_End": 1386.72,
        "Text": " Yes."
      },
      {
        "Time_Start": 1386.72,
        "Time_End": 1389.72,
        "Text": " So stealing and forging tokens."
      },
      {
        "Time_Start": 1389.72,
        "Time_End": 1391.72,
        "Text": " Now I have a little bit of limited time,"
      },
      {
        "Time_Start": 1391.72,
        "Time_End": 1394.72,
        "Text": " so I'm not going to show all the ways how you can steal tokens."
      },
      {
        "Time_Start": 1394.72,
        "Time_End": 1397.72,
        "Text": " So if you want to see my talk from 2022,"
      },
      {
        "Time_Start": 1397.72,
        "Time_End": 1401.72,
        "Text": " I show eight ways how you can do that with AD FS."
      },
      {
        "Time_Start": 1401.72,
        "Time_End": 1403.72,
        "Text": " And there's a lot of other talk out there"
      },
      {
        "Time_Start": 1403.72,
        "Time_End": 1406.72,
        "Text": " who can show you how you can steal those secrets."
      },
      {
        "Time_Start": 1406.72,
        "Time_End": 1408.72,
        "Text": " So I'm just going to show you how you can use them."
      },
      {
        "Time_Start": 1408.72,
        "Time_End": 1414.72,
        "Text": " So let's go back to my toolkit here."
      },
      {
        "Time_Start": 1414.72,
        "Time_End": 1419.72,
        "Text": " And I haven't done that stealing part already."
      },
      {
        "Time_Start": 1419.72,
        "Time_End": 1421.72,
        "Text": " So the first one is for Kerberos tickets."
      },
      {
        "Time_Start": 1421.72,
        "Time_End": 1425.72,
        "Text": " So I have a secret for the service."
      },
      {
        "Time_Start": 1425.72,
        "Time_End": 1428.72,
        "Text": " And in this case, it's enter ID,"
      },
      {
        "Time_Start": 1428.72,
        "Time_End": 1431.72,
        "Text": " and it's configured to use desktop single sign-on"
      },
      {
        "Time_Start": 1431.72,
        "Time_End": 1433.72,
        "Text": " or seamless single sign-on."
      },
      {
        "Time_Start": 1433.72,
        "Time_End": 1436.72,
        "Text": " And I'm just going to forge a Kerberos ticket."
      },
      {
        "Time_Start": 1436.72,
        "Time_End": 1439.72,
        "Text": " So it's the first row here."
      },
      {
        "Time_Start": 1439.72,
        "Time_End": 1448.72,
        "Text": " And now in the variable KT, we have the ticket."
      },
      {
        "Time_Start": 1448.72,
        "Time_End": 1451.72,
        "Text": " And I just copy that to clipboard."
      },
      {
        "Time_Start": 1451.72,
        "Time_End": 1453.72,
        "Text": " Set clipboard."
      },
      {
        "Time_Start": 1453.72,
        "Time_End": 1454.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1454.72,
        "Time_End": 1459.72,
        "Text": " And I go to browser."
      },
      {
        "Time_Start": 1459.72,
        "Time_End": 1461.72,
        "Text": " And there's a great tool created,"
      },
      {
        "Time_Start": 1461.72,
        "Time_End": 1465.72,
        "Text": " who was the guy, Lapo or something."
      },
      {
        "Time_Start": 1465.72,
        "Time_End": 1467.72,
        "Text": " Lapo Lucini."
      },
      {
        "Time_Start": 1467.72,
        "Time_End": 1472.72,
        "Text": " And he has a tool which can decrypt ASN.1"
      },
      {
        "Time_Start": 1472.72,
        "Time_End": 1475.72,
        "Text": " or there or there or whatever."
      },
      {
        "Time_Start": 1475.72,
        "Time_End": 1480.72,
        "Text": " So you just paste it there and you hit decode."
      },
      {
        "Time_Start": 1481.72,
        "Time_End": 1483.72,
        "Text": " And what we have here is..."
      },
      {
        "Time_Start": 1483.72,
        "Time_End": 1485.72,
        "Text": " Can I zoom this? Yes."
      },
      {
        "Time_Start": 1485.72,
        "Time_End": 1490.72,
        "Text": " So here we have first the realm,"
      },
      {
        "Time_Start": 1490.72,
        "Time_End": 1492.72,
        "Text": " if you remember from the Kerberos ticket."
      },
      {
        "Time_Start": 1492.72,
        "Time_End": 1494.72,
        "Text": " And then we have encrypted stuff."
      },
      {
        "Time_Start": 1494.72,
        "Time_End": 1497.72,
        "Text": " So this was the ticket, I suppose."
      },
      {
        "Time_Start": 1497.72,
        "Time_End": 1500.72,
        "Text": " And this was the realm or whatever that was called."
      },
      {
        "Time_Start": 1500.72,
        "Time_End": 1501.72,
        "Text": " So it's all encrypted."
      },
      {
        "Time_Start": 1501.72,
        "Time_End": 1504.72,
        "Text": " But I can't see that because I don't have those things in here."
      },
      {
        "Time_Start": 1504.72,
        "Time_End": 1507.72,
        "Text": " But just to show you that it is there."
      },
      {
        "Time_Start": 1507.72,
        "Time_End": 1511.72,
        "Text": " And just to make sure, I'm going to run this again."
      },
      {
        "Time_Start": 1511.72,
        "Time_End": 1513.72,
        "Text": " Because the Kerberos ticket had a lifetime."
      },
      {
        "Time_Start": 1513.72,
        "Time_End": 1517.72,
        "Text": " And then I'm going to exchange that Kerberos ticket to access token."
      },
      {
        "Time_Start": 1517.72,
        "Time_End": 1518.72,
        "Text": " And then I'm going to dump the token."
      },
      {
        "Time_Start": 1518.72,
        "Time_End": 1520.72,
        "Text": " So I'm just going to hit this."
      },
      {
        "Time_Start": 1520.72,
        "Time_End": 1522.72,
        "Text": " And now it shows you the token."
      },
      {
        "Time_Start": 1522.72,
        "Time_End": 1526.72,
        "Text": " So I had a secret to Kerberos service,"
      },
      {
        "Time_Start": 1526.72,
        "Time_End": 1529.72,
        "Text": " which in this case is Android ID."
      },
      {
        "Time_Start": 1529.72,
        "Time_End": 1532.72,
        "Text": " I stole that from the domain controller of that environment."
      },
      {
        "Time_Start": 1532.72,
        "Time_End": 1535.72,
        "Text": " And then I was able to use that to create Kerberos ticket"
      },
      {
        "Time_Start": 1535.72,
        "Time_End": 1539.72,
        "Text": " and then exchange that to access token."
      },
      {
        "Time_Start": 1539.72,
        "Time_End": 1547.72,
        "Text": " Okay, and the second one, I created a backdoor to my environment."
      },
      {
        "Time_Start": 1547.72,
        "Time_End": 1551.72,
        "Text": " And I gave the backdoor information about my certificate,"
      },
      {
        "Time_Start": 1551.72,
        "Time_End": 1553.72,
        "Text": " the public part of that."
      },
      {
        "Time_Start": 1553.72,
        "Time_End": 1558.72,
        "Text": " And then, yeah, the public part."
      },
      {
        "Time_Start": 1558.72,
        "Time_End": 1561.72,
        "Text": " And then I have the private key myself."
      },
      {
        "Time_Start": 1561.72,
        "Time_End": 1565.72,
        "Text": " So I can now craft SAML tokens and sign that."
      },
      {
        "Time_Start": 1565.72,
        "Time_End": 1569.72,
        "Text": " So let's do that now."
      },
      {
        "Time_Start": 1569.72,
        "Time_End": 1570.72,
        "Text": " I'll do that."
      },
      {
        "Time_Start": 1570.72,
        "Time_End": 1575.72,
        "Text": " And now we have the service ticket here again."
      },
      {
        "Time_Start": 1575.72,
        "Time_End": 1577.72,
        "Text": " Like this."
      },
      {
        "Time_Start": 1577.72,
        "Time_End": 1581.72,
        "Text": " Looks nice."
      },
      {
        "Time_Start": 1581.72,
        "Time_End": 1586.72,
        "Text": " And I copy that to clipboard, and I can show you what it looks like."
      },
      {
        "Time_Start": 1591.72,
        "Time_End": 1594.72,
        "Text": " Nice, right?"
      },
      {
        "Time_Start": 1594.72,
        "Time_End": 1596.72,
        "Text": " Let's format that a bit."
      },
      {
        "Time_Start": 1596.72,
        "Time_End": 1598.72,
        "Text": " So that's how it looks like."
      },
      {
        "Time_Start": 1598.72,
        "Time_End": 1600.72,
        "Text": " So we have the attribute statement,"
      },
      {
        "Time_Start": 1600.72,
        "Time_End": 1602.72,
        "Text": " and then we have the authentication statement,"
      },
      {
        "Time_Start": 1602.72,
        "Time_End": 1605.72,
        "Text": " and then we finally have the signature."
      },
      {
        "Time_Start": 1605.72,
        "Time_End": 1608.72,
        "Text": " And actually what is funny, I found out this a couple of years ago."
      },
      {
        "Time_Start": 1608.72,
        "Time_End": 1611.72,
        "Text": " So when you craft SAML tokens for EntroID,"
      },
      {
        "Time_Start": 1611.72,
        "Time_End": 1615.72,
        "Text": " the only thing that it cares about is the immutable ID."
      },
      {
        "Time_Start": 1615.72,
        "Time_End": 1617.72,
        "Text": " Is there anybody from Finland here?"
      },
      {
        "Time_Start": 1617.72,
        "Time_End": 1619.72,
        "Text": " Nobody?"
      },
      {
        "Time_Start": 1619.72,
        "Time_End": 1621.72,
        "Text": " Well, my wife is, yeah."
      },
      {
        "Time_Start": 1621.72,
        "Time_End": 1625.72,
        "Text": " Well, you can see the UPN I'm using here."
      },
      {
        "Time_Start": 1625.72,
        "Time_End": 1630.72,
        "Text": " So that's Santa Claus at NorthPole.fi, basically."
      },
      {
        "Time_Start": 1630.72,
        "Time_End": 1633.72,
        "Text": " So that's actually one tip for detection."
      },
      {
        "Time_Start": 1633.72,
        "Time_End": 1637.72,
        "Text": " If you can see this kind of token, you know it's made by eight internals."
      },
      {
        "Time_Start": 1638.72,
        "Time_End": 1640.72,
        "Text": " But anyway, that's the structure."
      },
      {
        "Time_Start": 1640.72,
        "Time_End": 1642.72,
        "Text": " All you need to have then is the secret,"
      },
      {
        "Time_Start": 1642.72,
        "Time_End": 1644.72,
        "Text": " which in this case is a certificate,"
      },
      {
        "Time_Start": 1644.72,
        "Time_End": 1648.72,
        "Text": " and you can sign that."
      },
      {
        "Time_Start": 1648.72,
        "Time_End": 1650.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1650.72,
        "Time_End": 1654.72,
        "Text": " So then let's move forward."
      },
      {
        "Time_Start": 1654.72,
        "Time_End": 1657.72,
        "Text": " So detecting and preventing."
      },
      {
        "Time_Start": 1657.72,
        "Time_End": 1662.72,
        "Text": " So detection sources, where can we detect stuff?"
      },
      {
        "Time_Start": 1662.72,
        "Time_End": 1664.72,
        "Text": " Stealing the secret."
      },
      {
        "Time_Start": 1664.72,
        "Time_End": 1668.72,
        "Text": " You can detect that only on IDP, right?"
      },
      {
        "Time_Start": 1668.72,
        "Time_End": 1670.72,
        "Text": " So that's the only place where you can see that,"
      },
      {
        "Time_Start": 1670.72,
        "Time_End": 1673.72,
        "Text": " the actual action of stealing something."
      },
      {
        "Time_Start": 1673.72,
        "Time_End": 1675.72,
        "Text": " Somebody accesses your computer."
      },
      {
        "Time_Start": 1675.72,
        "Time_End": 1678.72,
        "Text": " They are accessing some storages where your secrets are stored."
      },
      {
        "Time_Start": 1678.72,
        "Time_End": 1682.72,
        "Text": " So that can only happen on the IDP side."
      },
      {
        "Time_Start": 1682.72,
        "Time_End": 1683.72,
        "Text": " Same with the users."
      },
      {
        "Time_Start": 1683.72,
        "Time_End": 1685.72,
        "Text": " Like if you steal tokens,"
      },
      {
        "Time_Start": 1685.72,
        "Time_End": 1691.72,
        "Text": " you can detect them from the user's devices or endpoints."
      },
      {
        "Time_Start": 1691.72,
        "Time_End": 1696.72,
        "Text": " When using tokens, you need to have locks from service provider."
      },
      {
        "Time_Start": 1696.72,
        "Time_End": 1701.72,
        "Text": " Why there's IDP also is that if you want to detect,"
      },
      {
        "Time_Start": 1701.72,
        "Time_End": 1707.72,
        "Text": " like using stolen secrets,"
      },
      {
        "Time_Start": 1707.72,
        "Time_End": 1710.72,
        "Text": " sorry, if you want to detect that somebody is using secrets"
      },
      {
        "Time_Start": 1710.72,
        "Time_End": 1714.72,
        "Text": " that are forged using stolen secrets,"
      },
      {
        "Time_Start": 1714.72,
        "Time_End": 1717.72,
        "Text": " you need to have also locks from the IDP."
      },
      {
        "Time_Start": 1717.72,
        "Time_End": 1720.72,
        "Text": " Because that's the only way you can compare that."
      },
      {
        "Time_Start": 1720.72,
        "Time_End": 1723.72,
        "Text": " Somebody locks in IDP, there's always lock event."
      },
      {
        "Time_Start": 1723.72,
        "Time_End": 1726.72,
        "Text": " And if there is no corresponding lock event there,"
      },
      {
        "Time_Start": 1726.72,
        "Time_End": 1731.72,
        "Text": " you can be quite sure that somebody has forged that token."
      },
      {
        "Time_Start": 1731.72,
        "Time_End": 1735.72,
        "Text": " I'll show some scenarios for that."
      },
      {
        "Time_Start": 1735.72,
        "Time_End": 1739.72,
        "Text": " So for instance, in your on-prem identity,"
      },
      {
        "Time_Start": 1739.72,
        "Time_End": 1743.72,
        "Text": " you have your logon events in your on-prem domain controller."
      },
      {
        "Time_Start": 1743.72,
        "Time_End": 1745.72,
        "Text": " And then you have your on-prem web server."
      },
      {
        "Time_Start": 1745.72,
        "Time_End": 1747.72,
        "Text": " They are usage locks."
      },
      {
        "Time_Start": 1747.72,
        "Time_End": 1749.72,
        "Text": " So whenever there's some entry here"
      },
      {
        "Time_Start": 1749.72,
        "Time_End": 1751.72,
        "Text": " that Nestor used something,"
      },
      {
        "Time_Start": 1751.72,
        "Time_End": 1755.72,
        "Text": " there has to be corresponding logon event somewhere here."
      },
      {
        "Time_Start": 1755.72,
        "Time_End": 1757.72,
        "Text": " Does it make any sense?"
      },
      {
        "Time_Start": 1757.72,
        "Time_End": 1760.72,
        "Text": " So you need to have these two kinds of sources for telemetry"
      },
      {
        "Time_Start": 1760.72,
        "Time_End": 1764.72,
        "Text": " for this to work."
      },
      {
        "Time_Start": 1764.72,
        "Time_End": 1768.72,
        "Text": " Okay, now if you are using hybrid identity."
      },
      {
        "Time_Start": 1768.72,
        "Time_End": 1770.72,
        "Text": " So you have your on-prem AD."
      },
      {
        "Time_Start": 1770.72,
        "Time_End": 1772.72,
        "Text": " There's logon events."
      },
      {
        "Time_Start": 1772.72,
        "Time_End": 1776.72,
        "Text": " If you are using ADFS, you may have ADFS audit events."
      },
      {
        "Time_Start": 1776.72,
        "Time_End": 1778.72,
        "Text": " You need to enable those."
      },
      {
        "Time_Start": 1778.72,
        "Time_End": 1783.72,
        "Text": " Then in EntroID, you have sign-in locks."
      },
      {
        "Time_Start": 1783.72,
        "Time_End": 1786.72,
        "Text": " The challenge here is that this is not like in real time."
      },
      {
        "Time_Start": 1786.72,
        "Time_End": 1788.72,
        "Text": " It takes about 15 minutes or so."
      },
      {
        "Time_Start": 1788.72,
        "Time_End": 1791.72,
        "Text": " It depends for things to appear there."
      },
      {
        "Time_Start": 1791.72,
        "Time_End": 1794.72,
        "Text": " But anyways, if there is sign-in event here,"
      },
      {
        "Time_Start": 1794.72,
        "Time_End": 1800.72,
        "Text": " there has to be corresponding event here and here."
      },
      {
        "Time_Start": 1800.72,
        "Time_End": 1804.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1804.72,
        "Time_End": 1808.72,
        "Text": " And then next scenario, we have even like a demo for this."
      },
      {
        "Time_Start": 1808.72,
        "Time_End": 1812.72,
        "Text": " So if you are using cloud-only identity."
      },
      {
        "Time_Start": 1812.72,
        "Time_End": 1814.72,
        "Text": " Oh, let's go back here."
      },
      {
        "Time_Start": 1814.72,
        "Time_End": 1817.72,
        "Text": " So this here is like if you steal ADFS certificate."
      },
      {
        "Time_Start": 1817.72,
        "Time_End": 1819.72,
        "Text": " So this is for that scenario."
      },
      {
        "Time_Start": 1819.72,
        "Time_End": 1821.72,
        "Text": " If somebody is now forging those tokens,"
      },
      {
        "Time_Start": 1821.72,
        "Time_End": 1826.72,
        "Text": " there has to be a sign-in event here too."
      },
      {
        "Time_Start": 1826.72,
        "Time_End": 1829.72,
        "Text": " And this is like for if you have a cloud-only identity."
      },
      {
        "Time_Start": 1829.72,
        "Time_End": 1831.72,
        "Text": " Well, also hybrid, but usually cloud-only identity."
      },
      {
        "Time_Start": 1832.72,
        "Time_End": 1835.72,
        "Text": " So from EntroID, you have the sign-in locks."
      },
      {
        "Time_Start": 1835.72,
        "Time_End": 1837.72,
        "Text": " Okay, that's by default."
      },
      {
        "Time_Start": 1837.72,
        "Time_End": 1841.72,
        "Text": " But then if you are running your own Azure web app,"
      },
      {
        "Time_Start": 1841.72,
        "Time_End": 1846.72,
        "Text": " the locks doesn't have anything about the identity."
      },
      {
        "Time_Start": 1846.72,
        "Time_End": 1850.72,
        "Text": " There's only locks which you can enable easily."
      },
      {
        "Time_Start": 1850.72,
        "Time_End": 1853.72,
        "Text": " That, okay, somebody accessed from this IP address and so on."
      },
      {
        "Time_Start": 1853.72,
        "Time_End": 1857.72,
        "Text": " So there's no identity information per se."
      },
      {
        "Time_Start": 1857.72,
        "Time_End": 1863.72,
        "Text": " But that's why I made a little example about that."
      },
      {
        "Time_Start": 1863.72,
        "Time_End": 1868.72,
        "Text": " So I have a..."
      },
      {
        "Time_Start": 1868.72,
        "Time_End": 1872.72,
        "Text": " Oh, how does this work?"
      },
      {
        "Time_Start": 1872.72,
        "Time_End": 1874.72,
        "Text": " That's better. Okay."
      },
      {
        "Time_Start": 1874.72,
        "Time_End": 1878.72,
        "Text": " So what you are seeing here is Visual Studio."
      },
      {
        "Time_Start": 1878.72,
        "Time_End": 1880.72,
        "Text": " It's a C-sharp application here."
      },
      {
        "Time_Start": 1880.72,
        "Time_End": 1883.72,
        "Text": " And I did a little bit of research,"
      },
      {
        "Time_Start": 1883.72,
        "Time_End": 1886.72,
        "Text": " and I found out that whenever..."
      },
      {
        "Time_Start": 1886.72,
        "Time_End": 1889.72,
        "Text": " Well, this application is using EntroID for authentication."
      },
      {
        "Time_Start": 1889.72,
        "Time_End": 1892.72,
        "Text": " And whenever you are receiving ticket for this app,"
      },
      {
        "Time_Start": 1892.72,
        "Time_End": 1895.72,
        "Text": " this callback function is called."
      },
      {
        "Time_Start": 1895.72,
        "Time_End": 1897.72,
        "Text": " And I made a little bit of things there."
      },
      {
        "Time_Start": 1897.72,
        "Time_End": 1901.72,
        "Text": " So first of all, I'm going to extract the ID token."
      },
      {
        "Time_Start": 1901.72,
        "Time_End": 1905.72,
        "Text": " Then I'm going to extract the IP address where the request comes from."
      },
      {
        "Time_Start": 1905.72,
        "Time_End": 1908.72,
        "Text": " And then I'm going to log that."
      },
      {
        "Time_Start": 1908.72,
        "Time_End": 1911.72,
        "Text": " Certain parts from the ID token."
      },
      {
        "Time_Start": 1911.72,
        "Time_End": 1915.72,
        "Text": " And then, well, I'll show the next one after this."
      },
      {
        "Time_Start": 1915.72,
        "Time_End": 1919.72,
        "Text": " So I'll just show the app first."
      },
      {
        "Time_Start": 1919.72,
        "Time_End": 1924.72,
        "Text": " So I go to..."
      },
      {
        "Time_Start": 1924.72,
        "Time_End": 1928.72,
        "Text": " Yeah."
      },
      {
        "Time_Start": 1928.72,
        "Time_End": 1930.72,
        "Text": " Let's go here."
      },
      {
        "Time_Start": 1930.72,
        "Time_End": 1932.72,
        "Text": " EntroID."
      },
      {
        "Time_Start": 1932.72,
        "Time_End": 1934.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1934.72,
        "Time_End": 1936.72,
        "Text": " Oh, yeah, this is like a..."
      },
      {
        "Time_Start": 1936.72,
        "Time_End": 1938.72,
        "Text": " Now it's better."
      },
      {
        "Time_Start": 1938.72,
        "Time_End": 1941.72,
        "Text": " So we should have apps here."
      },
      {
        "Time_Start": 1941.72,
        "Time_End": 1943.72,
        "Text": " Yep."
      },
      {
        "Time_Start": 1943.72,
        "Time_End": 1946.72,
        "Text": " We have a token test application."
      },
      {
        "Time_Start": 1946.72,
        "Time_End": 1949.72,
        "Text": " Let's zoom a bit."
      },
      {
        "Time_Start": 1949.72,
        "Time_End": 1952.72,
        "Text": " And..."
      },
      {
        "Time_Start": 1952.72,
        "Time_End": 1954.72,
        "Text": " Okay."
      },
      {
        "Time_Start": 1954.72,
        "Time_End": 1956.72,
        "Text": " Go back. Go back."
      },
      {
        "Time_Start": 1956.72,
        "Time_End": 1958.72,
        "Text": " Manage."
      },
      {
        "Time_Start": 1958.72,
        "Time_End": 1960.72,
        "Text": " And authentication."
      },
      {
        "Time_Start": 1960.72,
        "Time_End": 1965.72,
        "Text": " Just wanted to show you that this is configured to use ID tokens."
      },
      {
        "Time_Start": 1965.72,
        "Time_End": 1968.72,
        "Text": " So when I try to access the application,"
      },
      {
        "Time_Start": 1968.72,
        "Time_End": 1971.72,
        "Text": " it redirects me to my EntroID."
      },
      {
        "Time_Start": 1971.72,
        "Time_End": 1973.72,
        "Text": " I log in."
      },
      {
        "Time_Start": 1973.72,
        "Time_End": 1977.72,
        "Text": " And then I send the access token back to the application."
      },
      {
        "Time_Start": 1977.72,
        "Time_End": 1979.72,
        "Text": " So that happens when I click this."
      },
      {
        "Time_Start": 1979.72,
        "Time_End": 1985.72,
        "Text": " And because the user is already logged in, it happens automatically."
      },
      {
        "Time_Start": 1985.72,
        "Time_End": 1988.72,
        "Text": " So I'm logged in as Diego."
      },
      {
        "Time_Start": 1988.72,
        "Time_End": 1992.72,
        "Text": " And now I will go here to logs."
      },
      {
        "Time_Start": 1992.72,
        "Time_End": 1994.72,
        "Text": " I update that."
      },
      {
        "Time_Start": 1994.72,
        "Time_End": 1996.72,
        "Text": " I can see that there's a log event."
      },
      {
        "Time_Start": 1996.72,
        "Time_End": 1998.72,
        "Text": " Let's zoom that a bit."
      },
      {
        "Time_Start": 1999.72,
        "Time_End": 2003.72,
        "Text": " Not before, not after of the ID token."
      },
      {
        "Time_Start": 2003.72,
        "Time_End": 2005.72,
        "Text": " Then we have the user principal name."
      },
      {
        "Time_Start": 2005.72,
        "Time_End": 2008.72,
        "Text": " Then we have the..."
      },
      {
        "Time_Start": 2008.72,
        "Time_End": 2010.72,
        "Text": " Well, it's empty now."
      },
      {
        "Time_Start": 2010.72,
        "Time_End": 2012.72,
        "Text": " Then we have the source, where the request came from."
      },
      {
        "Time_Start": 2012.72,
        "Time_End": 2015.72,
        "Text": " Then we have a user object ID."
      },
      {
        "Time_Start": 2015.72,
        "Time_End": 2018.72,
        "Text": " And finally, this was a..."
      },
      {
        "Time_Start": 2018.72,
        "Time_End": 2020.72,
        "Text": " What was it called?"
      },
      {
        "Time_Start": 2020.72,
        "Time_End": 2024.72,
        "Text": " Well, it's a logging event identity."
      },
      {
        "Time_Start": 2024.72,
        "Time_End": 2027.72,
        "Text": " Well, I'll check the name, whatever that is, in just a second."
      },
      {
        "Time_Start": 2027.72,
        "Time_End": 2029.72,
        "Text": " So I'm just going to copy these."
      },
      {
        "Time_Start": 2029.72,
        "Time_End": 2035.72,
        "Text": " Because I'm going to emulate that I have integrated my web app to Log Analytics,"
      },
      {
        "Time_Start": 2035.72,
        "Time_End": 2037.72,
        "Text": " which I have not done here."
      },
      {
        "Time_Start": 2037.72,
        "Time_End": 2040.72,
        "Text": " I didn't have that much time."
      },
      {
        "Time_Start": 2040.72,
        "Time_End": 2043.72,
        "Text": " So I go to..."
      },
      {
        "Time_Start": 2043.72,
        "Time_End": 2047.72,
        "Text": " There it is. Log Analytics."
      },
      {
        "Time_Start": 2047.72,
        "Time_End": 2051.7200000000003,
        "Text": " I have a query here."
      },
      {
        "Time_Start": 2051.7200000000003,
        "Time_End": 2054.7200000000003,
        "Text": " Test token."
      },
      {
        "Time_Start": 2054.7200000000003,
        "Time_End": 2057.7200000000003,
        "Text": " No, it's token test."
      },
      {
        "Time_Start": 2057.7200000000003,
        "Time_End": 2059.7200000000003,
        "Text": " Yeah."
      },
      {
        "Time_Start": 2059.7200000000003,
        "Time_End": 2063.7200000000003,
        "Text": " I'm just going to double-click here, and it should appear."
      },
      {
        "Time_Start": 2063.7200000000003,
        "Time_End": 2065.7200000000003,
        "Text": " Yes."
      },
      {
        "Time_Start": 2065.7200000000003,
        "Time_End": 2069.7200000000003,
        "Text": " So now I'm just going to paste my log here, so I can emulate that."
      },
      {
        "Time_Start": 2069.7200000000003,
        "Time_End": 2073.7200000000003,
        "Text": " So basically what I'm now doing is that I have now web logs."
      },
      {
        "Time_Start": 2073.7200000000003,
        "Time_End": 2075.7200000000003,
        "Text": " And then I have access to signing logs."
      },
      {
        "Time_Start": 2075.7200000000003,
        "Time_End": 2081.7200000000003,
        "Text": " And then I'm going to find events from my usage log"
      },
      {
        "Time_Start": 2081.7200000000003,
        "Time_End": 2085.7200000000003,
        "Text": " that has no corresponding event in signing logs."
      },
      {
        "Time_Start": 2085.7200000000003,
        "Time_End": 2087.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2087.7200000000003,
        "Time_End": 2090.7200000000003,
        "Text": " So I'm just going to run this."
      },
      {
        "Time_Start": 2090.7200000000003,
        "Time_End": 2095.7200000000003,
        "Text": " And it's showing a lot of events, because I need to change this to one hour."
      },
      {
        "Time_Start": 2095.7200000000003,
        "Time_End": 2099.7200000000003,
        "Text": " Or seven days. That's better."
      },
      {
        "Time_Start": 2099.7200000000003,
        "Time_End": 2104.7200000000003,
        "Text": " So let's see if I can make it any bigger."
      },
      {
        "Time_Start": 2104.7200000000003,
        "Time_End": 2106.7200000000003,
        "Text": " So it found out two events."
      },
      {
        "Time_Start": 2106.7200000000003,
        "Time_End": 2110.7200000000003,
        "Text": " So one is like what I did a couple of minutes ago."
      },
      {
        "Time_Start": 2110.7200000000003,
        "Time_End": 2112.7200000000003,
        "Text": " And why is that?"
      },
      {
        "Time_Start": 2112.7200000000003,
        "Time_End": 2116.7200000000003,
        "Text": " Because that signing event is not yet populated to EntriD signing logs."
      },
      {
        "Time_Start": 2116.7200000000003,
        "Time_End": 2118.7200000000003,
        "Text": " But here I found another one."
      },
      {
        "Time_Start": 2118.7200000000003,
        "Time_End": 2123.7200000000003,
        "Text": " So this means that somebody has been able to craft a token."
      },
      {
        "Time_Start": 2123.7200000000003,
        "Time_End": 2127.7200000000003,
        "Text": " So somebody has stolen my token signing secret from EntriD."
      },
      {
        "Time_Start": 2127.7200000000003,
        "Time_End": 2131.7200000000003,
        "Text": " But that doesn't happen, as you know."
      },
      {
        "Time_Start": 2131.7200000000003,
        "Time_End": 2133.7200000000003,
        "Text": " So, yeah."
      },
      {
        "Time_Start": 2133.7200000000003,
        "Time_End": 2135.7200000000003,
        "Text": " And then I made another thing here."
      },
      {
        "Time_Start": 2135.7200000000003,
        "Time_End": 2140.7200000000003,
        "Text": " So this is like a demo of how you can detect if somebody has stolen the signing key."
      },
      {
        "Time_Start": 2140.7200000000003,
        "Time_End": 2142.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2142.7200000000003,
        "Time_End": 2146.7200000000003,
        "Text": " And another thing is that I go back to apps."
      },
      {
        "Time_Start": 2146.7200000000003,
        "Time_End": 2149.7200000000003,
        "Text": " Where are my apps?"
      },
      {
        "Time_Start": 2149.7200000000003,
        "Time_End": 2152.7200000000003,
        "Text": " Apps, apps, apps."
      },
      {
        "Time_Start": 2152.7200000000003,
        "Time_End": 2157.7200000000003,
        "Text": " There."
      },
      {
        "Time_Start": 2157.7200000000003,
        "Time_End": 2158.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2158.7200000000003,
        "Time_End": 2160.7200000000003,
        "Text": " I go to token configuration."
      },
      {
        "Time_Start": 2160.7200000000003,
        "Time_End": 2164.7200000000003,
        "Text": " I'm going to add an optional claim to my ID token."
      },
      {
        "Time_Start": 2165.7200000000003,
        "Time_End": 2168.7200000000003,
        "Text": " And that is going to be IP address."
      },
      {
        "Time_Start": 2168.7200000000003,
        "Time_End": 2172.7200000000003,
        "Text": " So if I want to, I can add different information that access token that EntriD has."
      },
      {
        "Time_Start": 2172.7200000000003,
        "Time_End": 2180.7200000000003,
        "Text": " And this one is like the IP address where the user created or authenticated."
      },
      {
        "Time_Start": 2180.7200000000003,
        "Time_End": 2184.7200000000003,
        "Text": " So now that is included in the access token."
      },
      {
        "Time_Start": 2184.7200000000003,
        "Time_End": 2186.7200000000003,
        "Text": " Sorry, the ID token in this case."
      },
      {
        "Time_Start": 2186.7200000000003,
        "Time_End": 2190.7200000000003,
        "Text": " So now I go back to my application."
      },
      {
        "Time_Start": 2190.7200000000003,
        "Time_End": 2197.7200000000003,
        "Text": " And if you can see here, I am actually now comparing that if the token IP is different than the request IP."
      },
      {
        "Time_Start": 2197.7200000000003,
        "Time_End": 2205.7200000000003,
        "Text": " Which means that now somebody is logging in from different IP where that token was first created."
      },
      {
        "Time_Start": 2205.7200000000003,
        "Time_End": 2208.7200000000003,
        "Text": " It's going to throw an exception."
      },
      {
        "Time_Start": 2208.7200000000003,
        "Time_End": 2215.7200000000003,
        "Text": " So now when I run this, it authenticates automatically, but there should be an exception."
      },
      {
        "Time_Start": 2215.7200000000003,
        "Time_End": 2217.7200000000003,
        "Text": " Yeah."
      },
      {
        "Time_Start": 2217.7200000000003,
        "Time_End": 2222.7200000000003,
        "Text": " So it says that the IP address doesn't match the request IP address."
      },
      {
        "Time_Start": 2222.7200000000003,
        "Time_End": 2225.7200000000003,
        "Text": " So this way you can detect that."
      },
      {
        "Time_Start": 2225.7200000000003,
        "Time_End": 2228.7200000000003,
        "Text": " Is this token stolen from a user?"
      },
      {
        "Time_Start": 2228.7200000000003,
        "Time_End": 2231.7200000000003,
        "Text": " Now, if you are running your own web app, that's quite easy."
      },
      {
        "Time_Start": 2231.7200000000003,
        "Time_End": 2235.7200000000003,
        "Text": " But if you are running a service like, let's say, Microsoft EntriD, it's not that easy."
      },
      {
        "Time_Start": 2235.7200000000003,
        "Time_End": 2239.7200000000003,
        "Text": " Because people might be traveling in trains, so the IP address might change all the time."
      },
      {
        "Time_Start": 2239.7200000000003,
        "Time_End": 2245.7200000000003,
        "Text": " So it wouldn't be that nice to always send an exception if that happens."
      },
      {
        "Time_Start": 2245.7200000000003,
        "Time_End": 2248.7200000000003,
        "Text": " But I just wanted you to know that this is possible."
      },
      {
        "Time_Start": 2248.7200000000003,
        "Time_End": 2253.7200000000003,
        "Text": " There are techniques that you can use to make sure that nobody can use this."
      },
      {
        "Time_Start": 2253.7200000000003,
        "Time_End": 2260.7200000000003,
        "Text": " Or you can detect, at least, those stolen tokens."
      },
      {
        "Time_Start": 2260.7200000000003,
        "Time_End": 2266.7200000000003,
        "Text": " Okay. So that was that."
      },
      {
        "Time_Start": 2266.7200000000003,
        "Time_End": 2272.7200000000003,
        "Text": " And then let's go to Cloud Owner Identity 2."
      },
      {
        "Time_Start": 2272.7200000000003,
        "Time_End": 2275.7200000000003,
        "Text": " So that was if you have, like, your own apps."
      },
      {
        "Time_Start": 2275.7200000000003,
        "Time_End": 2277.7200000000003,
        "Text": " But what about if you don't have your own apps?"
      },
      {
        "Time_Start": 2277.7200000000003,
        "Time_End": 2280.7200000000003,
        "Text": " You are using third-party apps, like, let's say, Microsoft 365."
      },
      {
        "Time_Start": 2280.7200000000003,
        "Time_End": 2281.7200000000003,
        "Text": " What you can do?"
      },
      {
        "Time_Start": 2281.7200000000003,
        "Time_End": 2284.7200000000003,
        "Text": " So you have the..."
      },
      {
        "Time_Start": 2284.7200000000003,
        "Time_End": 2287.7200000000003,
        "Text": " No. That's better."
      },
      {
        "Time_Start": 2287.7200000000003,
        "Time_End": 2290.7200000000003,
        "Text": " So you have the sign-in logs. You can access those, obviously."
      },
      {
        "Time_Start": 2290.7200000000003,
        "Time_End": 2292.7200000000003,
        "Text": " But what about if you are using Microsoft 365?"
      },
      {
        "Time_Start": 2292.7200000000003,
        "Time_End": 2297.7200000000003,
        "Text": " Is there anything that you can see somebody's using something?"
      },
      {
        "Time_Start": 2297.7200000000003,
        "Time_End": 2300.7200000000003,
        "Text": " Anybody?"
      },
      {
        "Time_Start": 2300.7200000000003,
        "Time_End": 2304.7200000000003,
        "Text": " Audit logs shows you if somebody is doing something. So yes."
      },
      {
        "Time_Start": 2304.7200000000003,
        "Time_End": 2308.7200000000003,
        "Text": " So if you can see some audit event happening, yes."
      },
      {
        "Time_Start": 2308.7200000000003,
        "Time_End": 2311.7200000000003,
        "Text": " So unified audit log is one good way."
      },
      {
        "Time_Start": 2311.7200000000003,
        "Time_End": 2316.7200000000003,
        "Text": " But there's a new one. This isn't relatively new."
      },
      {
        "Time_Start": 2316.7200000000003,
        "Time_End": 2318.7200000000003,
        "Text": " But it happens at least within a year."
      },
      {
        "Time_Start": 2318.7200000000003,
        "Time_End": 2321.7200000000003,
        "Text": " So there's another log source."
      },
      {
        "Time_Start": 2321.7200000000003,
        "Time_End": 2323.7200000000003,
        "Text": " Yeah."
      },
      {
        "Time_Start": 2323.7200000000003,
        "Time_End": 2326.7200000000003,
        "Text": " So if you can see, like, a graph activity,"
      },
      {
        "Time_Start": 2326.7200000000003,
        "Time_End": 2329.7200000000003,
        "Text": " and there's no corresponding sign-in event,"
      },
      {
        "Time_Start": 2329.7200000000003,
        "Time_End": 2334.7200000000003,
        "Text": " you can be pretty sure that somebody has stolen our key."
      },
      {
        "Time_Start": 2334.7200000000003,
        "Time_End": 2341.7200000000003,
        "Text": " But that doesn't happen, as you know."
      },
      {
        "Time_Start": 2341.7200000000003,
        "Time_End": 2345.7200000000003,
        "Text": " Okay. Well, it happened, actually."
      },
      {
        "Time_Start": 2345.7200000000003,
        "Time_End": 2351.7200000000003,
        "Text": " So China-based threat actor Storm0558."
      },
      {
        "Time_Start": 2351.7200000000003,
        "Time_End": 2355.7200000000003,
        "Text": " So it was about a year ago, April, July last year."
      },
      {
        "Time_Start": 2355.7200000000003,
        "Time_End": 2362.7200000000003,
        "Text": " So they actually were able to steal a secret token sign-in key"
      },
      {
        "Time_Start": 2362.7200000000003,
        "Time_End": 2365.7200000000003,
        "Text": " for an expired Microsoft account."
      },
      {
        "Time_Start": 2365.7200000000003,
        "Time_End": 2370.7200000000003,
        "Text": " Not for, like, Android or the business side."
      },
      {
        "Time_Start": 2370.7200000000003,
        "Time_End": 2372.7200000000003,
        "Text": " How they stole that, we don't know."
      },
      {
        "Time_Start": 2372.7200000000003,
        "Time_End": 2374.7200000000003,
        "Text": " But we know that it was stolen."
      },
      {
        "Time_Start": 2374.7200000000003,
        "Time_End": 2380.7200000000003,
        "Text": " And then there were some misconfiguration incidents online."
      },
      {
        "Time_Start": 2380.7200000000003,
        "Time_End": 2388.7200000000003,
        "Text": " Which allowed them to use tokens signed with this expired key."
      },
      {
        "Time_Start": 2388.7200000000003,
        "Time_End": 2393.7200000000003,
        "Text": " So they were able to access about emails of 25 organizations or something like that."
      },
      {
        "Time_Start": 2393.7200000000003,
        "Time_End": 2395.7200000000003,
        "Text": " So it can happen."
      },
      {
        "Time_Start": 2395.7200000000003,
        "Time_End": 2398.7200000000003,
        "Text": " We are doing our best that it won't happen again."
      },
      {
        "Time_Start": 2398.7200000000003,
        "Time_End": 2400.7200000000003,
        "Text": " But it can happen."
      },
      {
        "Time_Start": 2400.7200000000003,
        "Time_End": 2405.7200000000003,
        "Text": " And if I understood correctly by reading those blog posts,"
      },
      {
        "Time_Start": 2405.7200000000003,
        "Time_End": 2410.7200000000003,
        "Text": " some customers noticed that there's some activity in their exchange."
      },
      {
        "Time_Start": 2410.7200000000003,
        "Time_End": 2413.7200000000003,
        "Text": " But there's no corresponding sign-in events."
      },
      {
        "Time_Start": 2413.7200000000003,
        "Time_End": 2417.7200000000003,
        "Text": " So it was actually, I think it was this case."
      },
      {
        "Time_Start": 2417.7200000000003,
        "Time_End": 2422.7200000000003,
        "Text": " So they see or saw something in Unified Audit Log that shouldn't be there."
      },
      {
        "Time_Start": 2422.7200000000003,
        "Time_End": 2430.7200000000003,
        "Text": " And that's how we were able to detect that also and mitigate."
      },
      {
        "Time_Start": 2430.7200000000003,
        "Time_End": 2435.7200000000003,
        "Text": " How much time do I have?"
      },
      {
        "Time_Start": 2435.7200000000003,
        "Time_End": 2437.7200000000003,
        "Text": " A little bit more than 10 minutes."
      },
      {
        "Time_Start": 2437.7200000000003,
        "Time_End": 2438.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2438.7200000000003,
        "Time_End": 2443.7200000000003,
        "Text": " So we're going to end up a little bit early so we can get lunch."
      },
      {
        "Time_Start": 2443.7200000000003,
        "Time_End": 2444.7200000000003,
        "Text": " Faster."
      },
      {
        "Time_Start": 2444.7200000000003,
        "Time_End": 2445.7200000000003,
        "Text": " So preventing."
      },
      {
        "Time_Start": 2445.7200000000003,
        "Time_End": 2447.7200000000003,
        "Text": " How, in theory, you can prevent stuff?"
      },
      {
        "Time_Start": 2447.7200000000003,
        "Time_End": 2448.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2448.7200000000003,
        "Time_End": 2450.7200000000003,
        "Text": " How you can prevent stealing tokens?"
      },
      {
        "Time_Start": 2450.7200000000003,
        "Time_End": 2455.7200000000003,
        "Text": " Well, you need to harden those components that are having those secrets."
      },
      {
        "Time_Start": 2455.7200000000003,
        "Time_End": 2457.7200000000003,
        "Text": " Like, they should be tier 0."
      },
      {
        "Time_Start": 2457.7200000000003,
        "Time_End": 2460.7200000000003,
        "Text": " For ADFS, you should use your custom certificates"
      },
      {
        "Time_Start": 2460.7200000000003,
        "Time_End": 2467.7200000000003,
        "Text": " and store the private keys in HSM or hardware security module."
      },
      {
        "Time_Start": 2467.7200000000003,
        "Time_End": 2470.7200000000003,
        "Text": " So nobody can get access to those then."
      },
      {
        "Time_Start": 2470.7200000000003,
        "Time_End": 2476.7200000000003,
        "Text": " On tokens theft side, from your user endpoints,"
      },
      {
        "Time_Start": 2476.7200000000003,
        "Time_End": 2479.7200000000003,
        "Text": " you should always use the zero trust."
      },
      {
        "Time_Start": 2479.7200000000003,
        "Time_End": 2480.7200000000003,
        "Text": " Well, that means a lot of things."
      },
      {
        "Time_Start": 2480.7200000000003,
        "Time_End": 2484.7200000000003,
        "Text": " But what I'm meaning here is that you should not allow access"
      },
      {
        "Time_Start": 2484.7200000000003,
        "Time_End": 2487.7200000000003,
        "Text": " to your corporate network from bringing your own devices."
      },
      {
        "Time_Start": 2487.7200000000003,
        "Time_End": 2491.7200000000003,
        "Text": " So only from managed, compliant devices,"
      },
      {
        "Time_Start": 2491.7200000000003,
        "Time_End": 2493.7200000000003,
        "Text": " if you want to prevent that token theft."
      },
      {
        "Time_Start": 2493.7200000000003,
        "Time_End": 2499.7200000000003,
        "Text": " If you don't, well, there's nothing you can do."
      },
      {
        "Time_Start": 2499.7200000000003,
        "Time_End": 2501.7200000000003,
        "Text": " And then in using side,"
      },
      {
        "Time_Start": 2501.7200000000003,
        "Time_End": 2504.7200000000003,
        "Text": " so if you are writing your web applications, always verify."
      },
      {
        "Time_Start": 2504.7200000000003,
        "Time_End": 2509.7200000000003,
        "Text": " So if there's an IP address stamp in your access token or ID token,"
      },
      {
        "Time_Start": 2509.7200000000003,
        "Time_End": 2512.7200000000003,
        "Text": " compare that to where the request actually comes from."
      },
      {
        "Time_Start": 2512.7200000000003,
        "Time_End": 2517.7200000000003,
        "Text": " Also, because you can access, not in all cases,"
      },
      {
        "Time_Start": 2517.7200000000003,
        "Time_End": 2520.7200000000003,
        "Text": " live data from your sign-in logs,"
      },
      {
        "Time_Start": 2520.7200000000003,
        "Time_End": 2525.7200000000003,
        "Text": " whatever the source is, EntroID, your on-prem AD, whatever,"
      },
      {
        "Time_Start": 2525.7200000000003,
        "Time_End": 2528.7200000000003,
        "Text": " compare still those logs every now and then,"
      },
      {
        "Time_Start": 2528.7200000000003,
        "Time_End": 2530.7200000000003,
        "Text": " like once a day or something,"
      },
      {
        "Time_Start": 2530.7200000000003,
        "Time_End": 2534.7200000000003,
        "Text": " so that you can see that if there are that kind of things happening,"
      },
      {
        "Time_Start": 2534.7200000000003,
        "Time_End": 2539.7200000000003,
        "Text": " like somebody's using your stealing secrets to vote stokers."
      },
      {
        "Time_Start": 2539.7200000000003,
        "Time_End": 2542.7200000000003,
        "Text": " Okay, so to sum up,"
      },
      {
        "Time_Start": 2542.7200000000003,
        "Time_End": 2547.7200000000003,
        "Text": " stealing tokens gives temporary access as a one person."
      },
      {
        "Time_Start": 2547.7200000000003,
        "Time_End": 2549.7200000000003,
        "Text": " So if you steal something from one user,"
      },
      {
        "Time_Start": 2549.7200000000003,
        "Time_End": 2553.7200000000003,
        "Text": " you can be that person for an hour or 90 days or forever,"
      },
      {
        "Time_Start": 2553.7200000000003,
        "Time_End": 2555.7200000000003,
        "Text": " depending what you are stealing."
      },
      {
        "Time_Start": 2555.7200000000003,
        "Time_End": 2558.7200000000003,
        "Text": " And then if you steal a secret, you can be anybody,"
      },
      {
        "Time_Start": 2558.7200000000003,
        "Time_End": 2562.7200000000003,
        "Text": " and usually quite a long time."
      },
      {
        "Time_Start": 2562.7200000000003,
        "Time_End": 2566.7200000000003,
        "Text": " So they are more valuable, they are more persistent."
      },
      {
        "Time_Start": 2567.7200000000003,
        "Time_End": 2570.7200000000003,
        "Text": " And detecting and preventing this is a team sport."
      },
      {
        "Time_Start": 2570.7200000000003,
        "Time_End": 2575.7200000000003,
        "Text": " So as an admin, you can detect anything,"
      },
      {
        "Time_Start": 2575.7200000000003,
        "Time_End": 2580.7200000000003,
        "Text": " unless your developers are providing you"
      },
      {
        "Time_Start": 2580.7200000000003,
        "Time_End": 2582.7200000000003,
        "Text": " something where you can detect stuff."
      },
      {
        "Time_Start": 2582.7200000000003,
        "Time_End": 2585.7200000000003,
        "Text": " So you need to have logs."
      },
      {
        "Time_Start": 2585.7200000000003,
        "Time_End": 2588.7200000000003,
        "Text": " And also you need to protect your different parts,"
      },
      {
        "Time_Start": 2588.7200000000003,
        "Time_End": 2592.7200000000003,
        "Text": " like your endpoints and then your secret also."
      },
      {
        "Time_Start": 2592.7200000000003,
        "Time_End": 2595.7200000000003,
        "Text": " And with that, thank you."
      },
      {
        "Time_Start": 2595.7200000000003,
        "Time_End": 2597.7200000000003,
        "Text": " That was all."
      },
      {
        "Time_Start": 2602.7200000000003,
        "Time_End": 2604.7200000000003,
        "Text": " Oh dear."
      },
      {
        "Time_Start": 2604.7200000000003,
        "Time_End": 2606.7200000000003,
        "Text": " Great, great presentation. I have three questions."
      },
      {
        "Time_Start": 2606.7200000000003,
        "Time_End": 2607.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2607.7200000000003,
        "Time_End": 2610.7200000000003,
        "Text": " So can you go to the slide where it showed the Chinese theft"
      },
      {
        "Time_Start": 2610.7200000000003,
        "Time_End": 2612.7200000000003,
        "Text": " of the Microsoft private keys?"
      },
      {
        "Time_Start": 2612.7200000000003,
        "Time_End": 2613.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2613.7200000000003,
        "Time_End": 2619.7200000000003,
        "Text": " So my first question is, the scope of what those keys cover,"
      },
      {
        "Time_Start": 2619.7200000000003,
        "Time_End": 2622.7200000000003,
        "Text": " is that per tenant, is it per geography,"
      },
      {
        "Time_Start": 2622.7200000000003,
        "Time_End": 2625.7200000000003,
        "Text": " is it the entire Azure platform?"
      },
      {
        "Time_Start": 2625.7200000000003,
        "Time_End": 2627.7200000000003,
        "Text": " Per entire Azure platform."
      },
      {
        "Time_Start": 2627.7200000000003,
        "Time_End": 2630.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2630.7200000000003,
        "Time_End": 2631.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2631.7200000000003,
        "Time_End": 2634.7200000000003,
        "Text": " My second question is, if we don't work at Microsoft,"
      },
      {
        "Time_Start": 2634.7200000000003,
        "Time_End": 2637.7200000000003,
        "Text": " is there a way that somebody can tell whether Microsoft"
      },
      {
        "Time_Start": 2637.7200000000003,
        "Time_End": 2640.7200000000003,
        "Text": " has cycled these keys?"
      },
      {
        "Time_Start": 2640.7200000000003,
        "Time_End": 2643.7200000000003,
        "Text": " According to those blocks, we have recycled them."
      },
      {
        "Time_Start": 2643.7200000000003,
        "Time_End": 2646.7200000000003,
        "Text": " Is there a technical way to tell that?"
      },
      {
        "Time_Start": 2646.7200000000003,
        "Time_End": 2647.7200000000003,
        "Text": " Click the link."
      },
      {
        "Time_Start": 2647.7200000000003,
        "Time_End": 2649.7200000000003,
        "Text": " Okay."
      },
      {
        "Time_Start": 2649.7200000000003,
        "Time_End": 2653.7200000000003,
        "Text": " My final question is, do you know whether Microsoft currently"
      },
      {
        "Time_Start": 2653.7200000000003,
        "Time_End": 2657.7200000000003,
        "Text": " or plans to support bring your own key?"
      },
      {
        "Time_Start": 2657.7200000000003,
        "Time_End": 2659.7200000000003,
        "Text": " You mean like for Android?"
      },
      {
        "Time_Start": 2659.7200000000003,
        "Time_End": 2661.7200000000003,
        "Text": " Yeah, for like the security tokens."
      },
      {
        "Time_Start": 2661.7200000000003,
        "Time_End": 2663.7200000000003,
        "Text": " There is this concept called external identity,"
      },
      {
        "Time_Start": 2663.7200000000003,
        "Time_End": 2665.7200000000003,
        "Text": " but I haven't researched or studied that."
      },
      {
        "Time_Start": 2665.7200000000003,
        "Time_End": 2669.7200000000003,
        "Text": " But probably is my answer."
      },
      {
        "Time_Start": 2672.7200000000003,
        "Time_End": 2675.7200000000003,
        "Text": " Any more questions?"
      },
      {
        "Time_Start": 2680.7200000000003,
        "Time_End": 2683.7200000000003,
        "Text": " I have a question about the detection part,"
      },
      {
        "Time_Start": 2683.7200000000003,
        "Time_End": 2688.7200000000003,
        "Text": " because it seems like the mapping, like the query mapping,"
      },
      {
        "Time_Start": 2688.7200000000003,
        "Time_End": 2692.7200000000003,
        "Text": " maybe you're missing one in the identity provider"
      },
      {
        "Time_Start": 2692.7200000000003,
        "Time_End": 2694.7200000000003,
        "Text": " or service provider."
      },
      {
        "Time_Start": 2694.7200000000003,
        "Time_End": 2700.7200000000003,
        "Text": " The complete login log can find maybe there's an attack"
      },
      {
        "Time_Start": 2700.7200000000003,
        "Time_End": 2707.7200000000003,
        "Text": " has been occurred, happened."
      },
      {
        "Time_Start": 2707.7200000000003,
        "Time_End": 2711.7200000000003,
        "Text": " There's a challenging about when we implement this kind"
      },
      {
        "Time_Start": 2711.7200000000003,
        "Time_End": 2715.7200000000003,
        "Text": " of a detection, any kind we need to consider,"
      },
      {
        "Time_Start": 2715.7200000000003,
        "Time_End": 2722.7200000000003,
        "Text": " like maybe there's some trick or some user scenario"
      },
      {
        "Time_Start": 2722.7200000000003,
        "Time_End": 2728.7200000000003,
        "Text": " we might have overlooked."
      },
      {
        "Time_Start": 2728.7200000000003,
        "Time_End": 2733.7200000000003,
        "Text": " Yeah."
      },
      {
        "Time_Start": 2733.7200000000003,
        "Time_End": 2735.7200000000003,
        "Text": " So what was the actual question part?"
      },
      {
        "Time_Start": 2736.7200000000003,
        "Time_End": 2740.7200000000003,
        "Text": " I mean, if we implement the detection,"
      },
      {
        "Time_Start": 2740.7200000000003,
        "Time_End": 2746.7200000000003,
        "Text": " do any point or we need to consider if maybe there,"
      },
      {
        "Time_Start": 2746.7200000000003,
        "Time_End": 2751.7200000000003,
        "Text": " because you mentioned based on the IP detection,"
      },
      {
        "Time_Start": 2751.7200000000003,
        "Time_End": 2755.7200000000003,
        "Text": " then maybe IP will be changing."
      },
      {
        "Time_Start": 2755.7200000000003,
        "Time_End": 2759.7200000000003,
        "Text": " There's other scenario will happen if you query detection,"
      },
      {
        "Time_Start": 2759.7200000000003,
        "Time_End": 2764.7200000000003,
        "Text": " do we need to consider about other point?"
      },
      {
        "Time_Start": 2765.7200000000003,
        "Time_End": 2767.7200000000003,
        "Text": " Well, if I understood correctly,"
      },
      {
        "Time_Start": 2767.7200000000003,
        "Time_End": 2769.7200000000003,
        "Text": " so you were asking about there's an IP,"
      },
      {
        "Time_Start": 2769.7200000000003,
        "Time_End": 2771.7200000000003,
        "Text": " you can detect if it comes from different IP,"
      },
      {
        "Time_Start": 2771.7200000000003,
        "Time_End": 2773.7200000000003,
        "Text": " what else there is."
      },
      {
        "Time_Start": 2773.7200000000003,
        "Time_End": 2775.7200000000003,
        "Text": " Well, it could be, for instance,"
      },
      {
        "Time_Start": 2775.7200000000003,
        "Time_End": 2779.7200000000003,
        "Text": " it is using different, let's say, user agent."
      },
      {
        "Time_Start": 2779.7200000000003,
        "Time_End": 2782.7200000000003,
        "Text": " So in your web app logs, you can see that it is using,"
      },
      {
        "Time_Start": 2782.7200000000003,
        "Time_End": 2785.7200000000003,
        "Text": " let's say, Internet Explorer."
      },
      {
        "Time_Start": 2785.7200000000003,
        "Time_End": 2790.7200000000003,
        "Text": " But usually when the user signed in,"
      },
      {
        "Time_Start": 2790.7200000000003,
        "Time_End": 2793.7200000000003,
        "Text": " they were using like Edge or something like that."
      },
      {
        "Time_Start": 2793.7200000000003,
        "Time_End": 2795.7200000000003,
        "Text": " So you can compare different things."
      },
      {
        "Time_Start": 2795.7200000000003,
        "Time_End": 2798.7200000000003,
        "Text": " So whatever you can look in both sites, you can compare those."
      },
      {
        "Time_Start": 2798.7200000000003,
        "Time_End": 2800.7200000000003,
        "Text": " So there's a lot of other things, not just IP,"
      },
      {
        "Time_Start": 2800.7200000000003,
        "Time_End": 2802.7200000000003,
        "Text": " but other things."
      },
      {
        "Time_Start": 2802.7200000000003,
        "Time_End": 2805.7200000000003,
        "Text": " So it's still near time to tune in the role."
      },
      {
        "Time_Start": 2805.7200000000003,
        "Time_End": 2807.7200000000003,
        "Text": " Yeah, you need to have a look."
      },
      {
        "Time_Start": 2807.7200000000003,
        "Time_End": 2818.7200000000003,
        "Text": " Okay, thank you."
      },
      {
        "Time_Start": 2818.7200000000003,
        "Time_End": 2821.7200000000003,
        "Text": " I was wondering what about protocol improvements?"
      },
      {
        "Time_Start": 2821.7200000000003,
        "Time_End": 2823.7200000000003,
        "Text": " I think you're working on it."
      },
      {
        "Time_Start": 2823.7200000000003,
        "Time_End": 2825.7200000000003,
        "Text": " What's that, protocol?"
      },
      {
        "Time_Start": 2825.7200000000003,
        "Time_End": 2828.7200000000003,
        "Text": " Yeah, the protocol improvements, token binding or other."
      },
      {
        "Time_Start": 2828.7200000000003,
        "Time_End": 2831.7200000000003,
        "Text": " Yeah, well, yes, those are like a new technical stuff,"
      },
      {
        "Time_Start": 2831.7200000000003,
        "Time_End": 2834.7200000000003,
        "Text": " and I didn't cover those, but they are things like token binding."
      },
      {
        "Time_Start": 2834.7200000000003,
        "Time_End": 2839.7200000000003,
        "Text": " And there was last year a good talk in this same space"
      },
      {
        "Time_Start": 2839.7200000000003,
        "Time_End": 2841.7200000000003,
        "Text": " about token binding."
      },
      {
        "Time_Start": 2841.7200000000003,
        "Time_End": 2843.7200000000003,
        "Text": " And we have also some token binding."
      },
      {
        "Time_Start": 2843.7200000000003,
        "Time_End": 2847.7200000000003,
        "Text": " And then we have this thing called continuous access evaluation."
      },
      {
        "Time_Start": 2847.7200000000003,
        "Time_End": 2849.7200000000003,
        "Text": " We also help on that."
      },
      {
        "Time_Start": 2849.7200000000003,
        "Time_End": 2851.7200000000003,
        "Text": " But my talk was more like generic stuff."
      },
      {
        "Time_Start": 2851.7200000000003,
        "Time_End": 2853.7200000000003,
        "Text": " But they are things."
      },
      {
        "Time_Start": 2853.7200000000003,
        "Time_End": 2856.7200000000003,
        "Text": " But they are not like standards yet."
      },
      {
        "Time_Start": 2856.7200000000003,
        "Time_End": 2859.7200000000003,
        "Text": " It's not good that everybody has their own standard."
      },
      {
        "Time_Start": 2859.7200000000003,
        "Time_End": 2860.7200000000003,
        "Text": " That's a bad thing."
      },
      {
        "Time_Start": 2860.7200000000003,
        "Time_End": 2862.7200000000003,
        "Text": " Hopefully there will be a standard for that."
      },
      {
        "Time_Start": 2862.7200000000003,
        "Time_End": 2864.7200000000003,
        "Text": " Well, actually, PRT is kind of that."
      },
      {
        "Time_Start": 2864.7200000000003,
        "Time_End": 2867.7200000000003,
        "Text": " So it's bind on your computer."
      },
      {
        "Time_Start": 2867.7200000000003,
        "Time_End": 2870.7200000000003,
        "Text": " Or basically, actually, to certificate which is on your computer."
      },
      {
        "Time_Start": 2870.7200000000003,
        "Time_End": 2876.7200000000003,
        "Text": " But yeah, good point."
      },
      {
        "Time_Start": 2876.7200000000003,
        "Time_End": 2883.7200000000003,
        "Text": " Are there any plans to protect primary refresh tokens via VBS, for example?"
      },
      {
        "Time_Start": 2883.7200000000003,
        "Time_End": 2885.7200000000003,
        "Text": " I don't know what is VBS."
      },
      {
        "Time_Start": 2885.7200000000003,
        "Time_End": 2888.7200000000003,
        "Text": " Virtualization-based security."
      },
      {
        "Time_Start": 2888.7200000000003,
        "Time_End": 2889.7200000000003,
        "Text": " I have no idea."
      },
      {
        "Time_Start": 2889.7200000000003,
        "Time_End": 2893.7200000000003,
        "Text": " But PRTs, well, they are kind of stored."
      },
      {
        "Time_Start": 2893.7200000000003,
        "Time_End": 2896.7200000000003,
        "Text": " Well, you saw one of the talks yesterday,"
      },
      {
        "Time_Start": 2896.7200000000003,
        "Time_End": 2899.7200000000003,
        "Text": " so you know where the PRTs are stored in your disk."
      },
      {
        "Time_Start": 2899.7200000000003,
        "Time_End": 2903.7200000000003,
        "Text": " But I don't have any knowledge about that."
      },
      {
        "Time_Start": 2907.7200000000003,
        "Time_End": 2910.7200000000003,
        "Text": " Thank you."
      },
      {
        "Time_Start": 2910.7200000000003,
        "Time_End": 2911.7200000000003,
        "Text": " Hi."
      },
      {
        "Time_Start": 2911.7200000000003,
        "Time_End": 2912.7200000000003,
        "Text": " Thanks for the talk."
      },
      {
        "Time_Start": 2912.7200000000003,
        "Time_End": 2913.7200000000003,
        "Text": " It was great."
      },
      {
        "Time_Start": 2913.7200000000003,
        "Time_End": 2914.7200000000003,
        "Text": " I just have a question."
      },
      {
        "Time_Start": 2914.7200000000003,
        "Time_End": 2918.7200000000003,
        "Text": " Like, if an attacker has taken access to the IDP,"
      },
      {
        "Time_Start": 2918.7200000000003,
        "Time_End": 2924.7200000000003,
        "Text": " I would assume that it has elevated privileges in order to seal the secret."
      },
      {
        "Time_Start": 2924.7200000000003,
        "Time_End": 2927.7200000000003,
        "Text": " So at that point, they can inject a memory."
      },
      {
        "Time_Start": 2927.7200000000003,
        "Time_End": 2932.7200000000003,
        "Text": " So my question is, if an attacker has access to the IDP anyway,"
      },
      {
        "Time_Start": 2932.7200000000003,
        "Time_End": 2939.7200000000003,
        "Text": " they might be able to just intercept request and response flow from and to the IDP."
      },
      {
        "Time_Start": 2939.7200000000003,
        "Time_End": 2942.7200000000003,
        "Text": " At that point, they can do something that happens naturally."
      },
      {
        "Time_Start": 2942.7200000000003,
        "Time_End": 2948.7200000000003,
        "Text": " So they can just block the request, steal the token that is generated for any user,"
      },
      {
        "Time_Start": 2948.7200000000003,
        "Time_End": 2953.7200000000003,
        "Text": " and then just decide if give them back a token or not."
      },
      {
        "Time_Start": 2953.7200000000003,
        "Time_End": 2959.7200000000003,
        "Text": " At that point, the user can just take and do another authentication to get a new token."
      },
      {
        "Time_Start": 2959.7200000000003,
        "Time_End": 2961.7200000000003,
        "Text": " So now you have two valid tokens."
      },
      {
        "Time_Start": 2961.7200000000003,
        "Time_End": 2963.7200000000003,
        "Text": " And one is of the attacker."
      },
      {
        "Time_Start": 2963.7200000000003,
        "Time_End": 2966.7200000000003,
        "Text": " The other one goes to the user."
      },
      {
        "Time_Start": 2966.7200000000003,
        "Time_End": 2968.7200000000003,
        "Text": " Now, in that case, you have just a duplicate."
      },
      {
        "Time_Start": 2968.7200000000003,
        "Time_End": 2973.7200000000003,
        "Text": " It's not duplicated, but you just have two tokens for two clients, two different clients."
      },
      {
        "Time_Start": 2973.7200000000003,
        "Time_End": 2980.7200000000003,
        "Text": " At that point, there is any kind of detection strategies we can use in that case."
      },
      {
        "Time_Start": 2980.7200000000003,
        "Time_End": 2990.7200000000003,
        "Text": " And the second question is, do the token binding that is in development would be enough to detect this kind of attack?"
      },
      {
        "Time_Start": 2991.7200000000003,
        "Time_End": 2997.7200000000003,
        "Text": " Token binding would help you to make sure that the token comes from the correct person."
      },
      {
        "Time_Start": 2997.7200000000003,
        "Time_End": 2999.7200000000003,
        "Text": " So it would solve that."
      },
      {
        "Time_Start": 2999.7200000000003,
        "Time_End": 3003.7200000000003,
        "Text": " But for the other thing, I don't know if there's anything to do with that."
      },
      {
        "Time_Start": 3003.7200000000003,
        "Time_End": 3005.7200000000003,
        "Text": " I don't know."
      },
      {
        "Time_Start": 3005.7200000000003,
        "Time_End": 3012.7200000000003,
        "Text": " But I remember there was one threat actor that was able to access the IDP,"
      },
      {
        "Time_Start": 3012.7200000000003,
        "Time_End": 3014.7200000000003,
        "Text": " though they didn't steal anything."
      },
      {
        "Time_Start": 3014.7200000000003,
        "Time_End": 3017.7200000000003,
        "Text": " They just injected a DLL that did stuff."
      },
      {
        "Time_Start": 3017.7200000000003,
        "Time_End": 3028.7200000000003,
        "Text": " So if you used a certain username, they always gave you admin rights or added the domain admins to the ticket and so on."
      },
      {
        "Time_Start": 3030.7200000000003,
        "Time_End": 3034.7200000000003,
        "Text": " I don't know if I answered your question, but I said something."
      },
      {
        "Time_Start": 3038.7200000000003,
        "Time_End": 3040.7200000000003,
        "Text": " Okay. Anybody else?"
      },
      {
        "Time_Start": 3045.7200000000003,
        "Time_End": 3046.7200000000003,
        "Text": " Okay. That's it."
      },
      {
        "Time_Start": 3046.7200000000003,
        "Time_End": 3047.7200000000003,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3047.7200000000003,
        "Time_End": 3048.7200000000003,
        "Text": " Thank you."
      }
    ]
  }
}