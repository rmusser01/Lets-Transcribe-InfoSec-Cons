{
  "metadata": {
    "webpage_url": "https://www.youtube.com/watch?v=EzKOWIeC-54",
    "title": "TROOPERS24: Deep Dive into Windows Defender: Smart App Control and ETW",
    "description": "Talk by Tillmann O\u00dfwald and Dr. Baptiste David - June 27th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/msxp97/\n\nMore impressions:\n  / wearetroopers  \n  / ernw_itsec  \nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
    "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
    "duration": 3654,
    "channel": "TROOPERS IT Security Conference",
    "uploader": "TROOPERS IT Security Conference",
    "upload_date": "20240909"
  },
  "segments": {
    "metadata": {
      "webpage_url": "https://www.youtube.com/watch?v=EzKOWIeC-54",
      "title": "TROOPERS24: Deep Dive into Windows Defender: Smart App Control and ETW",
      "description": "Talk by Tillmann O\u00dfwald and Dr. Baptiste David - June 27th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/msxp97/\n\nMore impressions:\n  / wearetroopers  \n  / ernw_itsec  \nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
      "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
      "duration": 3654,
      "channel": "TROOPERS IT Security Conference",
      "uploader": "TROOPERS IT Security Conference",
      "upload_date": "20240909"
    },
    "segments": [
      {
        "Time_Start": 0.0,
        "Time_End": 16.76,
        "Text": "This text was transcribed using whisper model: large-v2\n\n Hello Troopers, so it's still a great pleasure to be in front of you today."
      },
      {
        "Time_Start": 16.76,
        "Time_End": 20.76,
        "Text": " So as Daniel said, we are supposed to be two, but one of my colleagues is sick today, so"
      },
      {
        "Time_Start": 20.76,
        "Time_End": 21.76,
        "Text": " please excuse him."
      },
      {
        "Time_Start": 21.76,
        "Time_End": 27.1,
        "Text": " He has tried his best to be back, but unfortunately, sometimes we cannot."
      },
      {
        "Time_Start": 27.1,
        "Time_End": 34.14,
        "Text": " So the topic of this talk is to go on a journey inside a new feature of Windows, which is"
      },
      {
        "Time_Start": 34.14,
        "Time_End": 42.78,
        "Text": " called Smart App Control, and for that, Dr. David Baptiste, I'm French, which explains"
      },
      {
        "Time_Start": 42.78,
        "Time_End": 45.58,
        "Text": " my weird English accent, I would say."
      },
      {
        "Time_Start": 45.58,
        "Time_End": 52.660000000000004,
        "Text": " I'm working since two years for ENVE, which is the host of the conference, and I'm a security"
      },
      {
        "Time_Start": 52.660000000000004,
        "Time_End": 54.980000000000004,
        "Text": " researcher over there."
      },
      {
        "Time_Start": 55.06,
        "Time_End": 58.78,
        "Text": " I make a couple of conferences, including Troopers, so it's always a great pleasure"
      },
      {
        "Time_Start": 58.78,
        "Time_End": 61.38,
        "Text": " to be with you today."
      },
      {
        "Time_Start": 61.38,
        "Time_End": 67.46000000000001,
        "Text": " As we said for Thiel, he cannot be here present today, but a very great guy, and also another"
      },
      {
        "Time_Start": 67.46000000000001,
        "Time_End": 71.58000000000001,
        "Text": " person works for us on this topic, which is Dominic Phillips, he works for many years"
      },
      {
        "Time_Start": 71.58000000000001,
        "Time_End": 76.14,
        "Text": " in ENVE, and he should be mentioned in this talk also."
      },
      {
        "Time_Start": 76.14,
        "Time_End": 81.66,
        "Text": " So Smart App Control."
      },
      {
        "Time_Start": 81.66,
        "Time_End": 88.38,
        "Text": " With Windows 11, especially the version 22572, a new security feature has been introduced,"
      },
      {
        "Time_Start": 88.38,
        "Time_End": 94.66,
        "Text": " first in Windows Preview, and then in other operating system versions of Windows 11, which"
      },
      {
        "Time_Start": 94.66,
        "Time_End": 97.3,
        "Text": " is called Smart App Control."
      },
      {
        "Time_Start": 97.3,
        "Time_End": 102.74,
        "Text": " And the main idea of this feature, which was new, as announced by Microsoft, is to block"
      },
      {
        "Time_Start": 102.74,
        "Time_End": 105.62,
        "Text": " what they consider as unsafe applications."
      },
      {
        "Time_Start": 105.62,
        "Time_End": 110.82,
        "Text": " So more directly, it's just going to focus on what is considered to be safe on your laptop"
      },
      {
        "Time_Start": 110.82000000000001,
        "Time_End": 113.7,
        "Text": " or your machine, and remove everything else."
      },
      {
        "Time_Start": 113.7,
        "Time_End": 115.82000000000001,
        "Text": " Nothing else can be launched except that."
      },
      {
        "Time_Start": 115.82000000000001,
        "Time_End": 121.94000000000001,
        "Text": " But the point, of course, of such a feature is to be able to define what means a safe"
      },
      {
        "Time_Start": 121.94000000000001,
        "Time_End": 123.82000000000001,
        "Text": " application."
      },
      {
        "Time_Start": 123.82000000000001,
        "Time_End": 129.58,
        "Text": " And it's exactly how it's going to work, because from Microsoft documentation, some people"
      },
      {
        "Time_Start": 129.58,
        "Time_End": 135.06,
        "Text": " will say marketing stuff, it's written to be the decision of checking which application"
      },
      {
        "Time_Start": 135.06,
        "Time_End": 136.06,
        "Text": " is safe or not."
      },
      {
        "Time_Start": 136.06,
        "Time_End": 141.7,
        "Text": " It's an intelligent cloud-powered security service, which is not so meaningful from my"
      },
      {
        "Time_Start": 141.7,
        "Time_End": 142.7,
        "Text": " point of view."
      },
      {
        "Time_Start": 142.7,
        "Time_End": 149.94,
        "Text": " So BSC in Germany asked us to study these features and to document how it works to make"
      },
      {
        "Time_Start": 149.94,
        "Time_End": 153.42000000000002,
        "Text": " an evaluation of what is real behind the stage."
      },
      {
        "Time_Start": 153.42000000000002,
        "Time_End": 157.94,
        "Text": " So today we are going to check what is behind the stage of Smart App Control and Windows"
      },
      {
        "Time_Start": 157.94,
        "Time_End": 162.42000000000002,
        "Text": " Defender, because both are really connected."
      },
      {
        "Time_Start": 162.42000000000002,
        "Time_End": 165.1,
        "Text": " A bit of documentation before, just for announcements."
      },
      {
        "Time_Start": 165.14,
        "Time_End": 168.38,
        "Text": " Smart App Control, so it's literally from Microsoft Doc."
      },
      {
        "Time_Start": 168.38,
        "Time_End": 174.34,
        "Text": " Smart App Control works alongside your other security software, such as Microsoft Defender"
      },
      {
        "Time_Start": 174.34,
        "Time_End": 178.54,
        "Text": " or non-Microsoft antivirus tools."
      },
      {
        "Time_Start": 178.54,
        "Time_End": 182.1,
        "Text": " Smart App Control is based on a technology which is called WDAC."
      },
      {
        "Time_Start": 182.1,
        "Time_End": 186.06,
        "Text": " WDAC stands for Windows Defender Application Control."
      },
      {
        "Time_Start": 186.06,
        "Time_End": 193.1,
        "Text": " As a notion of application control, it's defined also in the documentation like a feature to"
      },
      {
        "Time_Start": 193.1,
        "Time_End": 198.57999999999998,
        "Text": " help to mitigate this type of security threat by restricting the application which are allowed"
      },
      {
        "Time_Start": 198.57999999999998,
        "Time_End": 202.01999999999998,
        "Text": " to run on your system or not."
      },
      {
        "Time_Start": 202.01999999999998,
        "Time_End": 208.78,
        "Text": " And as it's correctly written, application control is a crucial line of defense, okay?"
      },
      {
        "Time_Start": 208.78,
        "Time_End": 213.66,
        "Text": " Which takes inherent advantage of a traditional antivirus solution, so it's not an antivirus"
      },
      {
        "Time_Start": 213.66,
        "Time_End": 220.54,
        "Text": " solution, which moves away from the trust model, which is based on applications which"
      },
      {
        "Time_Start": 220.54,
        "Time_End": 223.01999999999998,
        "Text": " are assumed to be trustworthy or not."
      },
      {
        "Time_Start": 223.02,
        "Time_End": 227.14000000000001,
        "Text": " And that's the idea of application control, only to execute the application which are"
      },
      {
        "Time_Start": 227.14000000000001,
        "Time_End": 230.14000000000001,
        "Text": " defined to be safe."
      },
      {
        "Time_Start": 230.14000000000001,
        "Time_End": 234.58,
        "Text": " And as an important note, still from Microsoft documentation, they always recommend you to"
      },
      {
        "Time_Start": 234.58,
        "Time_End": 236.74,
        "Text": " maintain an antivirus."
      },
      {
        "Time_Start": 236.74,
        "Time_End": 242.38,
        "Text": " So for short, Smart App Control is not an antivirus, just based on what we read in the"
      },
      {
        "Time_Start": 242.38,
        "Time_End": 243.38,
        "Text": " documentation."
      },
      {
        "Time_Start": 243.38,
        "Time_End": 249.76000000000002,
        "Text": " It's based on WDAC, and it's more or less an involvement of this technology."
      },
      {
        "Time_Start": 249.76000000000002,
        "Time_End": 253.68,
        "Text": " And WDAC is used, as we say, to block applications."
      },
      {
        "Time_Start": 253.68,
        "Time_End": 259.44,
        "Text": " A relevant point concerning Smart App Control, this one is only available on Windows 11,"
      },
      {
        "Time_Start": 259.44,
        "Time_End": 264.12,
        "Text": " and it's active by definition directly out of the box of Windows."
      },
      {
        "Time_Start": 264.12,
        "Time_End": 267.48,
        "Text": " So the first time you install Windows, it's there."
      },
      {
        "Time_Start": 267.48,
        "Time_End": 271.68,
        "Text": " You can decide if you want to switch it off, say, okay, I don't want Smart App Control,"
      },
      {
        "Time_Start": 271.68,
        "Time_End": 272.68,
        "Text": " I want to disable it."
      },
      {
        "Time_Start": 272.68,
        "Time_End": 273.68,
        "Text": " Fine."
      },
      {
        "Time_Start": 273.68,
        "Time_End": 280.8,
        "Text": " But the point is that once you turn these features over, you cannot turn it back."
      },
      {
        "Time_Start": 280.8,
        "Time_End": 281.8,
        "Text": " It's once for all."
      },
      {
        "Time_Start": 281.8,
        "Time_End": 285.04,
        "Text": " Once you have deactivated, it's forever, forever."
      },
      {
        "Time_Start": 285.04,
        "Time_End": 289.28000000000003,
        "Text": " You can always reinstall Windows, but it's a clean reinstall of Windows."
      },
      {
        "Time_Start": 289.28000000000003,
        "Time_End": 296.6,
        "Text": " This feature is defined by Microsoft so that Smart App Control can only work on the system"
      },
      {
        "Time_Start": 296.6,
        "Time_End": 301.2,
        "Text": " if the system is considered as safe, which means, with other words, that there is no"
      },
      {
        "Time_Start": 301.2,
        "Time_End": 304.56,
        "Text": " thing before which has already run on your system."
      },
      {
        "Time_Start": 304.56,
        "Time_End": 309.96,
        "Text": " So we can trust the system if it starts from a clean state."
      },
      {
        "Time_Start": 309.96,
        "Time_End": 313.64,
        "Text": " So to do that, Smart App Control has three different stages."
      },
      {
        "Time_Start": 313.64,
        "Time_End": 317.32,
        "Text": " So at the beginning, when Smart App Control is launched, is what we call the evaluation"
      },
      {
        "Time_Start": 317.32,
        "Time_End": 318.32,
        "Text": " mode."
      },
      {
        "Time_Start": 318.32,
        "Time_End": 322.03999999999996,
        "Text": " So literally, you observe what's happened on your system, which applications are launched,"
      },
      {
        "Time_Start": 322.03999999999996,
        "Time_End": 326.52,
        "Text": " when do you launch them, is it safe or not, and it makes an evaluation."
      },
      {
        "Time_Start": 326.52,
        "Time_End": 331.88,
        "Text": " Will this application be considered as safe if I will be on, or will it be not considered"
      },
      {
        "Time_Start": 331.88,
        "Time_End": 332.88,
        "Text": " as safe?"
      },
      {
        "Time_Start": 332.88,
        "Time_End": 337.47999999999996,
        "Text": " And it gives you sometimes some feedback just to tell you that maybe you should not use"
      },
      {
        "Time_Start": 337.47999999999996,
        "Time_End": 339.59999999999997,
        "Text": " that application."
      },
      {
        "Time_Start": 339.59999999999997,
        "Time_End": 344.12,
        "Text": " So that it tries to educate yourself to use safe application, or what Microsoft considers"
      },
      {
        "Time_Start": 344.12,
        "Time_End": 349.15999999999997,
        "Text": " a safe application, to be honest, instead of using unsafe one."
      },
      {
        "Time_Start": 349.15999999999997,
        "Time_End": 355.52,
        "Text": " And then after 20 days in average, but it can be more or less, that stuff is dependent"
      },
      {
        "Time_Start": 355.52,
        "Time_End": 360.24,
        "Text": " of Microsoft because it's based on feedback from Microsoft, SAC can be switched in two"
      },
      {
        "Time_Start": 360.24,
        "Time_End": 361.24,
        "Text": " different modes."
      },
      {
        "Time_Start": 361.24,
        "Time_End": 363.08,
        "Text": " The first one is enforcement mode."
      },
      {
        "Time_Start": 363.08,
        "Time_End": 365.76,
        "Text": " So it means that Smart App Control is now active."
      },
      {
        "Time_Start": 365.76,
        "Time_End": 369.88,
        "Text": " Now when you see an application which is launched and considered as unsafe, this application"
      },
      {
        "Time_Start": 369.88,
        "Time_End": 370.88,
        "Text": " will be blocked."
      },
      {
        "Time_Start": 370.88,
        "Time_End": 371.88,
        "Text": " And no discussion."
      },
      {
        "Time_Start": 371.88,
        "Time_End": 372.88,
        "Text": " You cannot say, ah, I want this exception."
      },
      {
        "Time_Start": 372.88,
        "Time_End": 373.88,
        "Text": " No, no, no."
      },
      {
        "Time_Start": 373.88,
        "Time_End": 375.91999999999996,
        "Text": " There is no exception in this context."
      },
      {
        "Time_Start": 375.91999999999996,
        "Time_End": 380.52,
        "Text": " Only untrusted applications are going to be blocked, and all user applications will be"
      },
      {
        "Time_Start": 380.52,
        "Time_End": 381.52,
        "Text": " executable."
      },
      {
        "Time_Start": 382.52,
        "Time_End": 388.88,
        "Text": " Or, if Smart App Control considers it cannot help you to define your system, no problem."
      },
      {
        "Time_Start": 388.88,
        "Time_End": 389.88,
        "Text": " It switches off."
      },
      {
        "Time_Start": 389.88,
        "Time_End": 395.0,
        "Text": " And in this situation, it does nothing, it observes nothing else, and it's literally"
      },
      {
        "Time_Start": 395.0,
        "Time_End": 396.0,
        "Text": " not here."
      },
      {
        "Time_Start": 396.0,
        "Time_End": 398.32,
        "Text": " But the point is, you cannot turn it back."
      },
      {
        "Time_Start": 398.32,
        "Time_End": 402.12,
        "Text": " You cannot say, okay, but maybe I changed my mind, I would like another evaluation."
      },
      {
        "Time_Start": 402.12,
        "Time_End": 403.12,
        "Text": " You cannot."
      },
      {
        "Time_Start": 403.12,
        "Time_End": 404.12,
        "Text": " It's once for all."
      },
      {
        "Time_Start": 404.12,
        "Time_End": 410.52,
        "Text": " If you want to turn it back to evaluation mode, you need to reinstall Windows."
      },
      {
        "Time_Start": 410.52,
        "Time_End": 414.4,
        "Text": " The interface is very simple, three buttons, on, evaluation, off."
      },
      {
        "Time_Start": 414.4,
        "Time_End": 418.91999999999996,
        "Text": " Of course, you can decide by yourself to turn it on, but it's on your own risk."
      },
      {
        "Time_Start": 418.91999999999996,
        "Time_End": 419.91999999999996,
        "Text": " It's by yourself."
      },
      {
        "Time_Start": 419.91999999999996,
        "Time_End": 422.79999999999995,
        "Text": " You decide you want to do it, you do it."
      },
      {
        "Time_Start": 422.79999999999995,
        "Time_End": 427.64,
        "Text": " But in this context, if your machine cannot be useful because some applications are blocked,"
      },
      {
        "Time_Start": 427.64,
        "Time_End": 429.59999999999997,
        "Text": " that's for you."
      },
      {
        "Time_Start": 429.59999999999997,
        "Time_End": 434.2,
        "Text": " Okay, that's what is Smart App Control."
      },
      {
        "Time_Start": 434.2,
        "Time_End": 438.59999999999997,
        "Text": " So Smart App Control just selects applications which can run or not, based on what they call"
      },
      {
        "Time_Start": 438.6,
        "Time_End": 441.20000000000005,
        "Text": " an intelligent cloud-powered security service."
      },
      {
        "Time_Start": 441.20000000000005,
        "Time_End": 445.8,
        "Text": " Well, cloud analysis, it's just giving samples to the cloud, and the cloud answers you yes"
      },
      {
        "Time_Start": 445.8,
        "Time_End": 447.68,
        "Text": " or no."
      },
      {
        "Time_Start": 447.68,
        "Time_End": 449.0,
        "Text": " Just a question."
      },
      {
        "Time_Start": 449.0,
        "Time_End": 452.44,
        "Text": " If you do not have internet connection, what happens?"
      },
      {
        "Time_Start": 452.44,
        "Time_End": 455.36,
        "Text": " In this context, the documentation is very clear."
      },
      {
        "Time_Start": 455.36,
        "Time_End": 460.08000000000004,
        "Text": " By default, applications are blocked when Smart App Control is not able to make the"
      },
      {
        "Time_Start": 460.08000000000004,
        "Time_End": 462.84000000000003,
        "Text": " disclosure to the cloud analysis."
      },
      {
        "Time_Start": 462.84000000000003,
        "Time_End": 468.20000000000005,
        "Text": " So Smart App Control is a feature which really requires hard requirements, which means internet"
      },
      {
        "Time_Start": 468.2,
        "Time_End": 473.15999999999997,
        "Text": " connection, evaluation from the beginning, the evaluation period should be fine so that"
      },
      {
        "Time_Start": 473.15999999999997,
        "Time_End": 475.47999999999996,
        "Text": " it turns on, and so on."
      },
      {
        "Time_Start": 475.47999999999996,
        "Time_End": 477.52,
        "Text": " Well, it's big stuff."
      },
      {
        "Time_Start": 477.52,
        "Time_End": 480.59999999999997,
        "Text": " There is one exception, which is very meaningful."
      },
      {
        "Time_Start": 480.59999999999997,
        "Time_End": 485.2,
        "Text": " If one application is signed with a certificate issued by a certificate authority within the"
      },
      {
        "Time_Start": 485.2,
        "Time_End": 492.64,
        "Text": " trusted programs, so VeriSign, Bogo, and so on, so a certificate you can buy from different"
      },
      {
        "Time_Start": 492.64,
        "Time_End": 495.32,
        "Text": " providers and trusted by Microsoft."
      },
      {
        "Time_Start": 495.32,
        "Time_End": 501.15999999999997,
        "Text": " In this case, applications are executable, and of course, Microsoft applications are"
      },
      {
        "Time_Start": 501.15999999999997,
        "Time_End": 504.64,
        "Text": " signed, all of them on the system, so your system is safe."
      },
      {
        "Time_Start": 504.64,
        "Time_End": 506.68,
        "Text": " So that's how it works."
      },
      {
        "Time_Start": 506.68,
        "Time_End": 511.36,
        "Text": " So Smart App Control is nothing else than an automatic and optionless security feature."
      },
      {
        "Time_Start": 511.36,
        "Time_End": 513.96,
        "Text": " You can deactivate it, but it's forever."
      },
      {
        "Time_Start": 513.96,
        "Time_End": 514.96,
        "Text": " That's all."
      },
      {
        "Time_Start": 514.96,
        "Time_End": 520.04,
        "Text": " So that's, in a nutshell, what we can have from the documentation."
      },
      {
        "Time_Start": 520.04,
        "Time_End": 524.48,
        "Text": " Now let's make a little journey inside."
      },
      {
        "Time_Start": 524.48,
        "Time_End": 529.28,
        "Text": " At the beginning, from explorer.exe, when you execute an application, the application"
      },
      {
        "Time_Start": 529.28,
        "Time_End": 535.44,
        "Text": " has a long path over the system, and it goes to the kernel, so to create a new process."
      },
      {
        "Time_Start": 535.44,
        "Time_End": 540.04,
        "Text": " In the kernel, there is a notification which is performed to a DLL which is called ci.dll,"
      },
      {
        "Time_Start": 540.04,
        "Time_End": 546.72,
        "Text": " code integrity.dll, to check if your application could be allowed to run on the system or not."
      },
      {
        "Time_Start": 546.72,
        "Time_End": 550.96,
        "Text": " In other words, that's literally the home of WDAC features."
      },
      {
        "Time_Start": 550.96,
        "Time_End": 556.5600000000001,
        "Text": " Then ci.dll checks on Windows policies, which define which application can run or not."
      },
      {
        "Time_Start": 556.5600000000001,
        "Time_End": 560.32,
        "Text": " Windows policies is just something like, it can be used on command line, of course, but"
      },
      {
        "Time_Start": 560.32,
        "Time_End": 564.9200000000001,
        "Text": " in the end, it's just an XML file which defines which application can do what based on signature,"
      },
      {
        "Time_Start": 564.9200000000001,
        "Time_End": 567.76,
        "Text": " metadata, and so on."
      },
      {
        "Time_Start": 567.76,
        "Time_End": 571.6800000000001,
        "Text": " Windows policies say yes or no to ci.dll, and then the kernel allows the execution or"
      },
      {
        "Time_Start": 571.6800000000001,
        "Time_End": 573.32,
        "Text": " refuses it."
      },
      {
        "Time_Start": 573.32,
        "Time_End": 575.64,
        "Text": " Very simple."
      },
      {
        "Time_Start": 575.64,
        "Time_End": 582.92,
        "Text": " As we said on the documentation, WDAC, sorry, smart app control is based on WDAC, so it's"
      },
      {
        "Time_Start": 582.92,
        "Time_End": 586.96,
        "Text": " based on ci.dll, so let's dive in ci.dll."
      },
      {
        "Time_Start": 586.96,
        "Time_End": 592.12,
        "Text": " At the beginning, when you have an application which is notified to smart app control from"
      },
      {
        "Time_Start": 592.12,
        "Time_End": 597.4,
        "Text": " kernel point of view, it's going to match this function, ci.validate image header."
      },
      {
        "Time_Start": 597.4,
        "Time_End": 602.04,
        "Text": " The first thing it's going to do is to check if your application is going to be analysed"
      },
      {
        "Time_Start": 602.04,
        "Time_End": 604.2,
        "Text": " by smart app control or not."
      },
      {
        "Time_Start": 604.2,
        "Time_End": 610.24,
        "Text": " In this table, I represent all applications which are notified to ci.dll, regular executable"
      },
      {
        "Time_Start": 610.24,
        "Time_End": 614.8000000000001,
        "Text": " file, installer, and so on, script, they take another path."
      },
      {
        "Time_Start": 614.8000000000001,
        "Time_End": 619.5200000000001,
        "Text": " Drivers and installer, msi or setup.exe, if you prefer."
      },
      {
        "Time_Start": 619.5200000000001,
        "Time_End": 625.6,
        "Text": " That's what goes in ci.dll, but when we check later what goes really in the analysis process"
      },
      {
        "Time_Start": 625.6,
        "Time_End": 630.2,
        "Text": " of smart app control, we have a slightly difference."
      },
      {
        "Time_Start": 630.2,
        "Time_End": 632.72,
        "Text": " First, all the driver line has disappeared."
      },
      {
        "Time_Start": 633.24,
        "Time_End": 637.8000000000001,
        "Text": " It makes sense because it's technically kernel mode code signing requirements, so this check"
      },
      {
        "Time_Start": 637.8000000000001,
        "Time_End": 644.84,
        "Text": " is only done in ci.dll, and more exactly, it can be done on the VTL1, the virtual base"
      },
      {
        "Time_Start": 644.84,
        "Time_End": 652.72,
        "Text": " security system of Windows where trusted code is executed in a parallel environment, so"
      },
      {
        "Time_Start": 652.72,
        "Time_End": 660.0,
        "Text": " that makes sense that we do not need to come back in another system analysis, but the application"
      },
      {
        "Time_Start": 660.0,
        "Time_End": 666.92,
        "Text": " from Microsoft sign are also never notified to ci.dll, probably for optimization purposes,"
      },
      {
        "Time_Start": 666.92,
        "Time_End": 670.4,
        "Text": " or also if you want something done, do it yourself."
      },
      {
        "Time_Start": 670.4,
        "Time_End": 674.72,
        "Text": " That's a good way to escape their own security."
      },
      {
        "Time_Start": 674.72,
        "Time_End": 680.64,
        "Text": " So we are going to focus on sub-party signatures, untrusted sub-party signatures when you sign"
      },
      {
        "Time_Start": 680.64,
        "Time_End": 688.28,
        "Text": " yourself your application, and un-signaled application and installer software."
      },
      {
        "Time_Start": 688.28,
        "Time_End": 695.52,
        "Text": " Once we have selected which image or which kind of image are concerned by SAC, smart"
      },
      {
        "Time_Start": 695.52,
        "Time_End": 701.56,
        "Text": " app control SAC, that's a shortcut, signature check and get hash image."
      },
      {
        "Time_Start": 701.56,
        "Time_End": 707.0799999999999,
        "Text": " So the goal is to extract from your binary any signatures, and the system is quite simple."
      },
      {
        "Time_Start": 707.0799999999999,
        "Time_End": 709.72,
        "Text": " First, you have an indication of signing level."
      },
      {
        "Time_Start": 709.72,
        "Time_End": 711.92,
        "Text": " We are always in ci.dll."
      },
      {
        "Time_Start": 711.92,
        "Time_End": 714.6999999999999,
        "Text": " Validate page hash or file hash."
      },
      {
        "Time_Start": 714.7,
        "Time_End": 721.1,
        "Text": " We take the hash page of memory per page of memory, or we take the hash per file."
      },
      {
        "Time_Start": 721.1,
        "Time_End": 723.26,
        "Text": " Then we select which algorithm we want."
      },
      {
        "Time_Start": 723.26,
        "Time_End": 733.34,
        "Text": " Usually, it's SHA256, but for legacy and backward compatibility, you have SSR1."
      },
      {
        "Time_Start": 733.34,
        "Time_End": 737.4200000000001,
        "Text": " Then you've got the embedded signature and first match, so it's literally extracting"
      },
      {
        "Time_Start": 737.4200000000001,
        "Time_End": 739.3000000000001,
        "Text": " all the signatures from your binary."
      },
      {
        "Time_Start": 739.3000000000001,
        "Time_End": 742.34,
        "Text": " One match, we stop, and it doesn't match anything."
      },
      {
        "Time_Start": 742.34,
        "Time_End": 745.6600000000001,
        "Text": " We continue if there is another signature in your binary."
      },
      {
        "Time_Start": 745.6600000000001,
        "Time_End": 750.6600000000001,
        "Text": " We calculate the image hash, and we find a matching hash, and in the end, you have a"
      },
      {
        "Time_Start": 750.6600000000001,
        "Time_End": 754.94,
        "Text": " couple of possibilities, different functions, I would say, but you have something which"
      },
      {
        "Time_Start": 754.94,
        "Time_End": 757.3000000000001,
        "Text": " is usually linked to the notion of catalogues."
      },
      {
        "Time_Start": 757.3000000000001,
        "Time_End": 762.38,
        "Text": " Catalogues is a kind of file on Windows which regroups all the signatures of different binaries"
      },
      {
        "Time_Start": 762.38,
        "Time_End": 766.74,
        "Text": " so that your binary doesn't hold the signatures, but it's all in another file."
      },
      {
        "Time_Start": 766.74,
        "Time_End": 770.82,
        "Text": " This verification is performed by a sub-party component of Windows which is a service in"
      },
      {
        "Time_Start": 770.82,
        "Time_End": 772.3000000000001,
        "Text": " user mode."
      },
      {
        "Time_Start": 772.3000000000001,
        "Time_End": 775.1800000000001,
        "Text": " That's a regular process, I would say, of CI.dll."
      },
      {
        "Time_Start": 775.1800000000001,
        "Time_End": 778.1400000000001,
        "Text": " Until now, we are not exactly in smart app control."
      },
      {
        "Time_Start": 778.1400000000001,
        "Time_End": 781.4200000000001,
        "Text": " It's regular WDAC stuff."
      },
      {
        "Time_Start": 781.4200000000001,
        "Time_End": 784.58,
        "Text": " Then we are going to apply the WDAC policy matching."
      },
      {
        "Time_Start": 784.58,
        "Time_End": 789.1400000000001,
        "Text": " The first thing that the kernel does is to check the system of cache."
      },
      {
        "Time_Start": 789.1400000000001,
        "Time_End": 794.22,
        "Text": " In fact, if the application has already been analysed and nothing has changed from that,"
      },
      {
        "Time_Start": 794.22,
        "Time_End": 796.1,
        "Text": " no need to remake a verification."
      },
      {
        "Time_Start": 796.1,
        "Time_End": 799.1800000000001,
        "Text": " Nothing has changed, so it should be the same result every time."
      },
      {
        "Time_Start": 799.1800000000001,
        "Time_End": 803.82,
        "Text": " To do that, the system has what we call a kernel extended attribute, so it's a sort"
      },
      {
        "Time_Start": 803.82,
        "Time_End": 810.7800000000001,
        "Text": " of metadata which is added to your file via the file system to know that there is already"
      },
      {
        "Time_Start": 810.7800000000001,
        "Time_End": 814.7800000000001,
        "Text": " something which has been analysed, there is a cryptosystem inside, signature stuff, to"
      },
      {
        "Time_Start": 814.7800000000001,
        "Time_End": 820.3000000000001,
        "Text": " be accurate, and the goal is to say it has been checked, it could be launched."
      },
      {
        "Time_Start": 820.3000000000001,
        "Time_End": 824.7,
        "Text": " So that's a cache system, file per file for optimisation purpose."
      },
      {
        "Time_Start": 824.7,
        "Time_End": 828.74,
        "Text": " If you do not have anything like that, if you do not have a cache system, or by the"
      },
      {
        "Time_Start": 828.74,
        "Time_End": 834.14,
        "Text": " way, just talking about the cache system, this kind of extended attributes starting"
      },
      {
        "Time_Start": 834.14,
        "Time_End": 837.5,
        "Text": " by $kernel, it means it's a kernel extended attribute."
      },
      {
        "Time_Start": 837.5,
        "Time_End": 840.7,
        "Text": " You can only modify it if you are a driver."
      },
      {
        "Time_Start": 840.7,
        "Time_End": 844.42,
        "Text": " Administrator is not enough, so you really need to be the kernel."
      },
      {
        "Time_Start": 844.42,
        "Time_End": 853.34,
        "Text": " So if you do not have any cache, we are going to call the function cipapplysipolicyexit."
      },
      {
        "Time_Start": 853.34,
        "Time_End": 855.82,
        "Text": " This function takes many elements."
      },
      {
        "Time_Start": 855.82,
        "Time_End": 857.78,
        "Text": " First, the validation context."
      },
      {
        "Time_Start": 857.78,
        "Time_End": 863.14,
        "Text": " The validation context literally provides all the detail you need concerning your application."
      },
      {
        "Time_Start": 863.14,
        "Time_End": 867.1,
        "Text": " The path of your application, the signature, et cetera, everything which concerns what"
      },
      {
        "Time_Start": 867.1,
        "Time_End": 868.9,
        "Text": " you want to execute."
      },
      {
        "Time_Start": 868.9,
        "Time_End": 870.14,
        "Text": " Then you have policy objects."
      },
      {
        "Time_Start": 870.14,
        "Time_End": 874.38,
        "Text": " That's the number of policies you have in the system regarding WDAC."
      },
      {
        "Time_Start": 874.38,
        "Time_End": 878.98,
        "Text": " And then you have a validation procedure, so linked to every policy, if there is a special"
      },
      {
        "Time_Start": 878.98,
        "Time_End": 883.22,
        "Text": " treatment for this policy, we can execute a specific callback doing a specific feature"
      },
      {
        "Time_Start": 883.22,
        "Time_End": 885.5799999999999,
        "Text": " for that policy."
      },
      {
        "Time_Start": 885.58,
        "Time_End": 886.58,
        "Text": " What is SAC?"
      },
      {
        "Time_Start": 886.58,
        "Time_End": 893.86,
        "Text": " Technically speaking, it's just, well, after the policy, we have a yes or no, of course,"
      },
      {
        "Time_Start": 893.86,
        "Time_End": 895.74,
        "Text": " but SAC is only that."
      },
      {
        "Time_Start": 895.74,
        "Time_End": 901.3000000000001,
        "Text": " One specific procedure which is called CIP, external authorization callback, and the SAC"
      },
      {
        "Time_Start": 901.3000000000001,
        "Time_End": 906.4200000000001,
        "Text": " policy which says to the system, use SAC or not."
      },
      {
        "Time_Start": 906.4200000000001,
        "Time_End": 908.7,
        "Text": " That's what is technically SAC."
      },
      {
        "Time_Start": 908.7,
        "Time_End": 910.5,
        "Text": " At least from the kernel point of view."
      },
      {
        "Time_Start": 910.5,
        "Time_End": 911.5,
        "Text": " Okay?"
      },
      {
        "Time_Start": 912.5,
        "Time_End": 915.74,
        "Text": " Let's check what does this callback have to work."
      },
      {
        "Time_Start": 915.74,
        "Time_End": 917.26,
        "Text": " This callback is not so complex."
      },
      {
        "Time_Start": 917.26,
        "Time_End": 920.22,
        "Text": " First, it checks what they call a security attribute token."
      },
      {
        "Time_Start": 920.22,
        "Time_End": 926.86,
        "Text": " It's also for optimization purpose and cache system, but it's not so relevant for what"
      },
      {
        "Time_Start": 926.86,
        "Time_End": 927.86,
        "Text": " we want to see."
      },
      {
        "Time_Start": 927.86,
        "Time_End": 932.64,
        "Text": " Then it's going to check if the extension of the file you want to check or you want"
      },
      {
        "Time_Start": 932.64,
        "Time_End": 936.26,
        "Text": " to use is considered as dangerous."
      },
      {
        "Time_Start": 936.26,
        "Time_End": 938.5,
        "Text": " So we have a lot in this list of extensions."
      },
      {
        "Time_Start": 938.5,
        "Time_End": 941.78,
        "Text": " Of course, executable is by default included."
      },
      {
        "Time_Start": 941.78,
        "Time_End": 942.78,
        "Text": " Makes sense."
      },
      {
        "Time_Start": 942.78,
        "Time_End": 945.02,
        "Text": " You started to execute an executable file."
      },
      {
        "Time_Start": 945.02,
        "Time_End": 950.3,
        "Text": " And also installer, MSI, in this list."
      },
      {
        "Time_Start": 950.3,
        "Time_End": 956.86,
        "Text": " And then, once the callback has performed this check, it's going to do a little bit"
      },
      {
        "Time_Start": 956.86,
        "Time_End": 957.86,
        "Text": " more."
      },
      {
        "Time_Start": 957.86,
        "Time_End": 962.38,
        "Text": " The goal is to make the transition from the kernel to the user mode where the analysis"
      },
      {
        "Time_Start": 962.38,
        "Time_End": 963.98,
        "Text": " will apply."
      },
      {
        "Time_Start": 963.98,
        "Time_End": 968.3000000000001,
        "Text": " So as I said, first, file check extension, and then there is a call to a function which"
      },
      {
        "Time_Start": 968.3000000000001,
        "Time_End": 972.54,
        "Text": " is called CI cat DB smart locker defender check."
      },
      {
        "Time_Start": 972.54,
        "Time_End": 974.74,
        "Text": " We have this notion of smart locker."
      },
      {
        "Time_Start": 974.74,
        "Time_End": 976.26,
        "Text": " Smart app control."
      },
      {
        "Time_Start": 976.26,
        "Time_End": 981.3000000000001,
        "Text": " So inside, when we reverse Windows, we have access to symbols in this context."
      },
      {
        "Time_Start": 981.3000000000001,
        "Time_End": 982.3000000000001,
        "Text": " And we have different names."
      },
      {
        "Time_Start": 982.3000000000001,
        "Time_End": 986.46,
        "Text": " Probably all code names used by the project during the development."
      },
      {
        "Time_Start": 986.46,
        "Time_End": 989.1,
        "Text": " So smart locker was one of the code names."
      },
      {
        "Time_Start": 989.1,
        "Time_End": 993.5400000000001,
        "Text": " Also another one is night wash, was another code name used by Microsoft regarding this"
      },
      {
        "Time_Start": 993.5400000000001,
        "Time_End": 994.5400000000001,
        "Text": " feature."
      },
      {
        "Time_Start": 994.5400000000001,
        "Time_End": 1001.4200000000001,
        "Text": " It's going to ask to the rest of the system what to do with the file."
      },
      {
        "Time_Start": 1001.4200000000001,
        "Time_End": 1002.4200000000001,
        "Text": " Manage the answer."
      },
      {
        "Time_Start": 1002.4200000000001,
        "Time_End": 1006.78,
        "Text": " And if the answer is positive or negative, put something in the cache file system we"
      },
      {
        "Time_Start": 1006.78,
        "Time_End": 1009.26,
        "Text": " mentioned just before."
      },
      {
        "Time_Start": 1009.26,
        "Time_End": 1015.4200000000001,
        "Text": " So we are going to dive in the procedures of smart locker."
      },
      {
        "Time_Start": 1015.4200000000001,
        "Time_End": 1019.22,
        "Text": " This one first starts by making a connection, RPC connection."
      },
      {
        "Time_Start": 1019.22,
        "Time_End": 1023.8600000000001,
        "Text": " So RPC, remote procedure call, is just a way to make interprocess communication, a very"
      },
      {
        "Time_Start": 1023.8600000000001,
        "Time_End": 1030.28,
        "Text": " convenient way to execute function in another process, which is used for decades by Microsoft."
      },
      {
        "Time_Start": 1030.28,
        "Time_End": 1033.98,
        "Text": " So the goal is to make an interface which is called key SVC."
      },
      {
        "Time_Start": 1033.98,
        "Time_End": 1036.6200000000001,
        "Text": " And that's the UID of this RPC interface."
      },
      {
        "Time_Start": 1036.6200000000001,
        "Time_End": 1041.5800000000002,
        "Text": " And when we look for in the system which process is that, it's a service which is called Krip"
      },
      {
        "Time_Start": 1041.5800000000002,
        "Time_End": 1042.5800000000002,
        "Text": " cat service."
      },
      {
        "Time_Start": 1042.5800000000002,
        "Time_End": 1043.5800000000002,
        "Text": " Okay?"
      },
      {
        "Time_Start": 1043.5800000000002,
        "Time_End": 1044.5800000000002,
        "Text": " Good."
      },
      {
        "Time_Start": 1044.74,
        "Time_End": 1048.58,
        "Text": " So the first is to make the connection."
      },
      {
        "Time_Start": 1048.58,
        "Time_End": 1050.58,
        "Text": " Then there is a way for synchronization."
      },
      {
        "Time_Start": 1050.58,
        "Time_End": 1055.34,
        "Text": " It checks that the service is there and the RPC connection is correct."
      },
      {
        "Time_Start": 1055.34,
        "Time_End": 1057.1399999999999,
        "Text": " And then it tries to call this function."
      },
      {
        "Time_Start": 1057.1399999999999,
        "Time_End": 1059.58,
        "Text": " Really, the names are very long."
      },
      {
        "Time_Start": 1059.58,
        "Time_End": 1064.54,
        "Text": " SS, cat, DB, smart locker, check two."
      },
      {
        "Time_Start": 1064.54,
        "Time_End": 1065.54,
        "Text": " The two is important."
      },
      {
        "Time_Start": 1065.54,
        "Time_End": 1067.5,
        "Text": " Apparently there was a one before."
      },
      {
        "Time_Start": 1067.5,
        "Time_End": 1069.1,
        "Text": " Why not?"
      },
      {
        "Time_Start": 1069.1,
        "Time_End": 1073.86,
        "Text": " And when this function has been called, it is going to pass the answer, which means more"
      },
      {
        "Time_Start": 1073.8600000000001,
        "Time_End": 1076.14,
        "Text": " or less manage the answer, and so on."
      },
      {
        "Time_Start": 1076.14,
        "Time_End": 1078.98,
        "Text": " So all the heavy stuff is performed in this function."
      },
      {
        "Time_Start": 1078.98,
        "Time_End": 1079.98,
        "Text": " And what does this function?"
      },
      {
        "Time_Start": 1079.98,
        "Time_End": 1080.98,
        "Text": " It's very simple."
      },
      {
        "Time_Start": 1080.98,
        "Time_End": 1085.22,
        "Text": " It directly makes an RPC call to a function inside this service."
      },
      {
        "Time_Start": 1085.22,
        "Time_End": 1091.22,
        "Text": " So this is how the WDAC makes the transition for smart app control between the kernel and"
      },
      {
        "Time_Start": 1091.22,
        "Time_End": 1094.8600000000001,
        "Text": " the user mode in Windows."
      },
      {
        "Time_Start": 1094.8600000000001,
        "Time_End": 1095.8600000000001,
        "Text": " Krip cat service."
      },
      {
        "Time_Start": 1095.8600000000001,
        "Time_End": 1101.8600000000001,
        "Text": " Krip cat service is literally launched at the execution of Windows, at booting time,"
      },
      {
        "Time_Start": 1101.8600000000001,
        "Time_End": 1102.8600000000001,
        "Text": " to be correct."
      },
      {
        "Time_Start": 1102.8600000000001,
        "Time_End": 1108.7800000000002,
        "Text": " So you see Windows system 32 is in svcos.exe, and its codename from argument point of view"
      },
      {
        "Time_Start": 1108.7800000000002,
        "Time_End": 1110.3400000000001,
        "Text": " is Krip service."
      },
      {
        "Time_Start": 1110.3400000000001,
        "Time_End": 1116.0600000000002,
        "Text": " But it really mostly relies on that DLL, Krip cat service, and the name of the service internally"
      },
      {
        "Time_Start": 1116.0600000000002,
        "Time_End": 1119.8200000000002,
        "Text": " registered is this one, Krip cat service."
      },
      {
        "Time_Start": 1119.8200000000002,
        "Time_End": 1123.7400000000002,
        "Text": " This service, when we reverse it, is quite simple in a way."
      },
      {
        "Time_Start": 1123.7400000000002,
        "Time_End": 1126.0200000000002,
        "Text": " It's literally there to manage catalog file."
      },
      {
        "Time_Start": 1126.0200000000002,
        "Time_End": 1129.66,
        "Text": " You remember the catalog file where all the signatures of all binaries in Windows are"
      },
      {
        "Time_Start": 1129.66,
        "Time_End": 1133.9,
        "Text": " drivers are present so that we know which one is signed and how it's signed."
      },
      {
        "Time_Start": 1133.9,
        "Time_End": 1138.5800000000002,
        "Text": " So that service is literally responsible to check all the chain of certificates when a"
      },
      {
        "Time_Start": 1138.5800000000002,
        "Time_End": 1141.74,
        "Text": " binary is signed on Windows."
      },
      {
        "Time_Start": 1141.74,
        "Time_End": 1147.6000000000001,
        "Text": " Makes sense when you think about CI.DLL is there to check signatures and policy, actually."
      },
      {
        "Time_Start": 1147.6000000000001,
        "Time_End": 1155.8200000000002,
        "Text": " So in this RPC interface, you have the old function used usually by this Krip cat services."
      },
      {
        "Time_Start": 1155.82,
        "Time_End": 1161.54,
        "Text": " But you have four more functions which are definitively related to smart app control."
      },
      {
        "Time_Start": 1161.54,
        "Time_End": 1165.46,
        "Text": " So it's very interesting to see the mix between the service which was clearly identified before"
      },
      {
        "Time_Start": 1165.46,
        "Time_End": 1171.46,
        "Text": " to make interaction, I would say, with only signature and catalog file, and now, in between,"
      },
      {
        "Time_Start": 1171.46,
        "Time_End": 1174.1799999999998,
        "Text": " you have smart app control."
      },
      {
        "Time_Start": 1174.1799999999998,
        "Time_End": 1175.8999999999999,
        "Text": " You have two kinds of functions."
      },
      {
        "Time_Start": 1175.8999999999999,
        "Time_End": 1180.98,
        "Text": " The two last is about app control block toaster, switch on for a small post."
      },
      {
        "Time_Start": 1180.98,
        "Time_End": 1183.82,
        "Text": " It's more or less to display something to user eyes."
      },
      {
        "Time_Start": 1183.82,
        "Time_End": 1184.82,
        "Text": " So it's green interface."
      },
      {
        "Time_Start": 1184.82,
        "Time_End": 1185.82,
        "Text": " It's so important."
      },
      {
        "Time_Start": 1185.82,
        "Time_End": 1188.62,
        "Text": " But the two most important are this one."
      },
      {
        "Time_Start": 1188.62,
        "Time_End": 1191.7,
        "Text": " Cat DB smart blocker defender check one and two."
      },
      {
        "Time_Start": 1191.7,
        "Time_End": 1193.3799999999999,
        "Text": " One is not written, but it's like that."
      },
      {
        "Time_Start": 1193.3799999999999,
        "Time_End": 1197.6599999999999,
        "Text": " But in the end, both functions rely on the same function, which is this big function,"
      },
      {
        "Time_Start": 1197.6599999999999,
        "Time_End": 1203.4199999999998,
        "Text": " which always has smart app blocker defender check helper."
      },
      {
        "Time_Start": 1203.4199999999998,
        "Time_End": 1208.46,
        "Text": " This function is literally responsible to make the transition from the Krip cat service"
      },
      {
        "Time_Start": 1208.46,
        "Time_End": 1210.54,
        "Text": " to Windows Defender."
      },
      {
        "Time_Start": 1210.54,
        "Time_End": 1215.62,
        "Text": " So it's just a proxy, if you want, between the catalog services analysis and Windows"
      },
      {
        "Time_Start": 1215.62,
        "Time_End": 1216.62,
        "Text": " Defender."
      },
      {
        "Time_Start": 1216.62,
        "Time_End": 1220.82,
        "Text": " WD, sometimes I miss some size in my presentation."
      },
      {
        "Time_Start": 1220.82,
        "Time_End": 1223.94,
        "Text": " So WD is a shortcut I use."
      },
      {
        "Time_Start": 1223.94,
        "Time_End": 1229.1399999999999,
        "Text": " To proceed, Krip cat service is going to load a DLL, which is called MP client from .DLL."
      },
      {
        "Time_Start": 1229.1399999999999,
        "Time_End": 1236.82,
        "Text": " This DLL is the interface that any application can use to interface with Windows Defender."
      },
      {
        "Time_Start": 1236.82,
        "Time_End": 1242.02,
        "Text": " When I say any application, I will say Microsoft application, because it's undocumented stuff."
      },
      {
        "Time_Start": 1242.02,
        "Time_End": 1245.1799999999998,
        "Text": " So you are not supposed to use it."
      },
      {
        "Time_Start": 1245.1799999999998,
        "Time_End": 1249.26,
        "Text": " It is going to find the DLL based on the registry key."
      },
      {
        "Time_Start": 1249.26,
        "Time_End": 1251.8999999999999,
        "Text": " And once the DLL is loaded, it's loaded once for all."
      },
      {
        "Time_Start": 1251.8999999999999,
        "Time_End": 1256.5,
        "Text": " The first time it's loaded, you have a specific initialization which is performed by the service,"
      },
      {
        "Time_Start": 1256.5,
        "Time_End": 1261.46,
        "Text": " which is called MP smart blocker enable, just to enable smart app control."
      },
      {
        "Time_Start": 1261.46,
        "Time_End": 1266.62,
        "Text": " Otherwise, it's just stored in memory."
      },
      {
        "Time_Start": 1267.42,
        "Time_End": 1269.9,
        "Text": " You remember you have function two, function one."
      },
      {
        "Time_Start": 1269.9,
        "Time_End": 1272.5800000000002,
        "Text": " So they are going to follow their path in parallel."
      },
      {
        "Time_Start": 1272.5800000000002,
        "Time_End": 1278.14,
        "Text": " But when the function two doesn't work, it always tries a legacy function."
      },
      {
        "Time_Start": 1278.14,
        "Time_End": 1285.14,
        "Text": " So invoke MP query trust by .DLL is going to call MP query file trust by .DLL, and so on."
      },
      {
        "Time_Start": 1285.14,
        "Time_End": 1288.38,
        "Text": " These functions are responsible to do two things."
      },
      {
        "Time_Start": 1288.38,
        "Time_End": 1294.0600000000002,
        "Text": " The first thing is to load the targeted file in memory, because at the beginning, the target"
      },
      {
        "Time_Start": 1294.0600000000002,
        "Time_End": 1295.3400000000001,
        "Text": " file is on your disk."
      },
      {
        "Time_Start": 1295.34,
        "Time_End": 1298.1799999999998,
        "Text": " And to be analyzed, it needs to be put in memory somewhere."
      },
      {
        "Time_Start": 1298.1799999999998,
        "Time_End": 1302.58,
        "Text": " So this is a service, which is going to load it in memory."
      },
      {
        "Time_Start": 1302.58,
        "Time_End": 1306.62,
        "Text": " Interesting, because it's not that service which is going to analyze it."
      },
      {
        "Time_Start": 1306.62,
        "Time_End": 1312.6599999999999,
        "Text": " And then it's definitely making the transition with Windows Defender via its RPC interface."
      },
      {
        "Time_Start": 1312.6599999999999,
        "Time_End": 1318.62,
        "Text": " The RPC interface of Windows Defender is totally undocumented, but it's very, very interesting"
      },
      {
        "Time_Start": 1318.62,
        "Time_End": 1320.26,
        "Text": " from my point of view."
      },
      {
        "Time_Start": 1320.26,
        "Time_End": 1322.54,
        "Text": " The function which is responsible to do it is this one."
      },
      {
        "Time_Start": 1322.54,
        "Time_End": 1327.62,
        "Text": " I give you the name for people who are interested to check how it's possible to interface directly"
      },
      {
        "Time_Start": 1327.62,
        "Time_End": 1329.62,
        "Text": " with Windows Defender."
      },
      {
        "Time_Start": 1329.62,
        "Time_End": 1334.46,
        "Text": " As any RPC interface, you have a UID, which is provided over there."
      },
      {
        "Time_Start": 1334.46,
        "Time_End": 1337.6599999999999,
        "Text": " And the access to this RPC interface is more or less controlled."
      },
      {
        "Time_Start": 1337.6599999999999,
        "Time_End": 1341.1,
        "Text": " First you need to make the interface via MP client .DLL."
      },
      {
        "Time_Start": 1341.1,
        "Time_End": 1344.94,
        "Text": " Well, technically you could try without, but there is some check."
      },
      {
        "Time_Start": 1344.94,
        "Time_End": 1350.06,
        "Text": " So when you call some API, sometimes Windows Defender goes in your memory space and checks"
      },
      {
        "Time_Start": 1350.06,
        "Time_End": 1351.78,
        "Text": " who is really calling you."
      },
      {
        "Time_Start": 1351.78,
        "Time_End": 1355.26,
        "Text": " To check if the code is using regular stuff or not."
      },
      {
        "Time_Start": 1355.26,
        "Time_End": 1357.54,
        "Text": " Also, there is RPC impersonation."
      },
      {
        "Time_Start": 1357.54,
        "Time_End": 1361.86,
        "Text": " So technically, Windows Defender is full power on the system."
      },
      {
        "Time_Start": 1361.86,
        "Time_End": 1368.78,
        "Text": " And to avoid to do bad things, it's going to behave with the same privilege as the calling"
      },
      {
        "Time_Start": 1368.78,
        "Time_End": 1369.78,
        "Text": " process."
      },
      {
        "Time_Start": 1369.78,
        "Time_End": 1375.74,
        "Text": " So that it avoids when it tries to reduce privilege escalation."
      },
      {
        "Time_Start": 1375.74,
        "Time_End": 1376.74,
        "Text": " So that's the interface."
      },
      {
        "Time_Start": 1376.74,
        "Time_End": 1379.54,
        "Text": " You have a lot of functions, but some are very interesting."
      },
      {
        "Time_Start": 1379.78,
        "Time_End": 1380.78,
        "Text": " Query statute."
      },
      {
        "Time_Start": 1380.78,
        "Time_End": 1381.78,
        "Text": " Disable feature."
      },
      {
        "Time_Start": 1381.78,
        "Time_End": 1383.42,
        "Text": " I like disable feature a lot."
      },
      {
        "Time_Start": 1383.42,
        "Time_End": 1385.18,
        "Text": " Demand start scan."
      },
      {
        "Time_Start": 1385.18,
        "Time_End": 1387.02,
        "Text": " You've got demand thread open."
      },
      {
        "Time_Start": 1387.02,
        "Time_End": 1390.02,
        "Text": " You have RPC control."
      },
      {
        "Time_Start": 1390.02,
        "Time_End": 1392.58,
        "Text": " You have quarantine control."
      },
      {
        "Time_Start": 1392.58,
        "Time_End": 1395.8999999999999,
        "Text": " You have elevation on DLL open, signature thread open."
      },
      {
        "Time_Start": 1395.8999999999999,
        "Time_End": 1396.8999999999999,
        "Text": " You have Spinet."
      },
      {
        "Time_Start": 1396.8999999999999,
        "Time_End": 1401.22,
        "Text": " Spinet is used to make reports to Microsoft Cloud to ask the cloud of Microsoft to give"
      },
      {
        "Time_Start": 1401.22,
        "Time_End": 1404.58,
        "Text": " you feedback."
      },
      {
        "Time_Start": 1404.58,
        "Time_End": 1411.1399999999999,
        "Text": " We have also thread close, production checklist, fast memory scan, if you want to make a scan"
      },
      {
        "Time_Start": 1411.1399999999999,
        "Time_End": 1414.82,
        "Text": " which is faster than the usual memory scan start."
      },
      {
        "Time_Start": 1414.82,
        "Time_End": 1419.86,
        "Text": " And you have literally the remote control over all the features of Windows Defender."
      },
      {
        "Time_Start": 1419.86,
        "Time_End": 1423.6399999999999,
        "Text": " You have the possibility to update the signature the way you like."
      },
      {
        "Time_Start": 1423.6399999999999,
        "Time_End": 1424.6399999999999,
        "Text": " Everything is there."
      },
      {
        "Time_Start": 1424.6399999999999,
        "Time_End": 1427.6999999999998,
        "Text": " Check for drag and drop operation."
      },
      {
        "Time_Start": 1427.6999999999998,
        "Time_End": 1431.1399999999999,
        "Text": " You have also one for IMSI in the list somewhere."
      },
      {
        "Time_Start": 1431.1399999999999,
        "Time_End": 1434.1,
        "Text": " Well, you have a lot of stuff over there."
      },
      {
        "Time_Start": 1435.1000000000001,
        "Time_End": 1437.0200000000002,
        "Text": " That's the interface of Windows Defender."
      },
      {
        "Time_Start": 1437.0200000000002,
        "Time_End": 1440.66,
        "Text": " That's the remote control of Windows Defender."
      },
      {
        "Time_Start": 1440.66,
        "Time_End": 1444.5800000000002,
        "Text": " Make a short parenthesis, just trying to explain how it works, Windows Defender, in a very"
      },
      {
        "Time_Start": 1444.5800000000002,
        "Time_End": 1449.6200000000001,
        "Text": " simplified way, because Windows Defender is a big antivirus, big software, and it involves"
      },
      {
        "Time_Start": 1449.6200000000001,
        "Time_End": 1452.0200000000002,
        "Text": " a lot of components."
      },
      {
        "Time_Start": 1452.0200000000002,
        "Time_End": 1456.8200000000002,
        "Text": " At the beginning, the service is launched from that registry key, hklm, Microsoft, Windows"
      },
      {
        "Time_Start": 1456.8200000000002,
        "Time_End": 1457.8200000000002,
        "Text": " Defender."
      },
      {
        "Time_Start": 1457.8200000000002,
        "Time_End": 1463.9800000000002,
        "Text": " If the service is not found directly in that registry key, the system tries Microsoft anti-malware."
      },
      {
        "Time_Start": 1463.98,
        "Time_End": 1475.26,
        "Text": " Then we try to execute the most recent version of Windows Defender."
      },
      {
        "Time_Start": 1475.26,
        "Time_End": 1479.18,
        "Text": " So that's why the path of Windows Defender includes a version number over there."
      },
      {
        "Time_Start": 1479.18,
        "Time_End": 1482.5,
        "Text": " If by default you cannot find the most recent version of Windows, no problem."
      },
      {
        "Time_Start": 1482.5,
        "Time_End": 1485.74,
        "Text": " We take back the last version known to be correctly executed."
      },
      {
        "Time_Start": 1485.74,
        "Time_End": 1493.7,
        "Text": " So that way, Windows Defender has also a mechanism of, I would say, which tries to avoid any"
      },
      {
        "Time_Start": 1493.7,
        "Time_End": 1494.7,
        "Text": " mistakes."
      },
      {
        "Time_Start": 1494.7,
        "Time_End": 1498.8600000000001,
        "Text": " In case of mistakes, it can always roll back from the beginning."
      },
      {
        "Time_Start": 1498.8600000000001,
        "Time_End": 1503.14,
        "Text": " So we start with the executable msmp-engine.exe."
      },
      {
        "Time_Start": 1503.14,
        "Time_End": 1508.74,
        "Text": " It's literally more or less like svcost, which is a process which is going to host the service"
      },
      {
        "Time_Start": 1508.74,
        "Time_End": 1509.74,
        "Text": " of Windows Defender."
      },
      {
        "Time_Start": 1509.74,
        "Time_End": 1513.14,
        "Text": " The name of the engine inside is called Asimov."
      },
      {
        "Time_Start": 1513.14,
        "Time_End": 1517.18,
        "Text": " That's the code name for the analysis engine of Windows Defender."
      },
      {
        "Time_Start": 1517.18,
        "Time_End": 1522.42,
        "Text": " And the first thing it's going to do is going to load the DLL, which is called mpsvc.dll,"
      },
      {
        "Time_Start": 1522.42,
        "Time_End": 1526.6200000000001,
        "Text": " which is literally the service which has a service CRT main function."
      },
      {
        "Time_Start": 1526.6200000000001,
        "Time_End": 1530.6200000000001,
        "Text": " This one is going to check which is the last drop location and if there is any update in"
      },
      {
        "Time_Start": 1530.6200000000001,
        "Time_End": 1532.74,
        "Text": " the system to use."
      },
      {
        "Time_Start": 1532.74,
        "Time_End": 1536.8600000000001,
        "Text": " If not, the service is going to create the regular stuff for service."
      },
      {
        "Time_Start": 1536.8600000000001,
        "Time_End": 1540.98,
        "Text": " So it has an on startup procedures, on asynchronous startup procedures."
      },
      {
        "Time_Start": 1540.98,
        "Time_End": 1544.14,
        "Text": " This one is very interesting from my point of view because it creates what we call a"
      },
      {
        "Time_Start": 1544.14,
        "Time_End": 1545.14,
        "Text": " thread pool."
      },
      {
        "Time_Start": 1545.14,
        "Time_End": 1550.5,
        "Text": " A thread pool is literally a set of threads which are waiting for works and tasks to do."
      },
      {
        "Time_Start": 1550.58,
        "Time_End": 1552.58,
        "Text": " So that everything is asynchronous."
      },
      {
        "Time_Start": 1552.58,
        "Time_End": 1557.22,
        "Text": " So you can have a module dedicated to, I would say, memory analysis, for instance, which"
      },
      {
        "Time_Start": 1557.22,
        "Time_End": 1561.46,
        "Text": " are waiting for tasks to do, and you have another module, I don't know which is for"
      },
      {
        "Time_Start": 1561.46,
        "Time_End": 1564.58,
        "Text": " network analysis, which has another thread pool."
      },
      {
        "Time_Start": 1564.58,
        "Time_End": 1568.18,
        "Text": " And that way, when you ask for something to Windows Defender, it's going to push a task"
      },
      {
        "Time_Start": 1568.18,
        "Time_End": 1572.22,
        "Text": " to one thread pool or another thread pool, and everything is performed in parallel in"
      },
      {
        "Time_Start": 1572.22,
        "Time_End": 1574.14,
        "Text": " a more or less optimal way."
      },
      {
        "Time_Start": 1574.14,
        "Time_End": 1576.58,
        "Text": " Well, it's quite optimal, actually."
      },
      {
        "Time_Start": 1576.58,
        "Time_End": 1579.26,
        "Text": " You have also a service dispatcher for any service."
      },
      {
        "Time_Start": 1579.26,
        "Time_End": 1580.94,
        "Text": " It's always the same."
      },
      {
        "Time_Start": 1580.94,
        "Time_End": 1585.62,
        "Text": " And then the service main function is going to call initmp service, which is a real initialization"
      },
      {
        "Time_Start": 1585.62,
        "Time_End": 1586.62,
        "Text": " of Windows Defender."
      },
      {
        "Time_Start": 1586.62,
        "Time_End": 1591.1,
        "Text": " This is where you can have all the information you like on Windows Defender."
      },
      {
        "Time_Start": 1591.1,
        "Time_End": 1592.1,
        "Text": " Everything it does."
      },
      {
        "Time_Start": 1592.1,
        "Time_End": 1594.66,
        "Text": " The capability to make network scanning is there."
      },
      {
        "Time_Start": 1594.66,
        "Time_End": 1596.02,
        "Text": " It's how it's initialized."
      },
      {
        "Time_Start": 1596.02,
        "Time_End": 1600.62,
        "Text": " The capability how it makes an update of the system, an update of the signatures, how it's"
      },
      {
        "Time_Start": 1600.62,
        "Time_End": 1604.66,
        "Text": " going to initialize the scan memory, engine, et cetera."
      },
      {
        "Time_Start": 1604.66,
        "Time_End": 1606.74,
        "Text": " Everything is there."
      },
      {
        "Time_Start": 1606.74,
        "Time_End": 1614.3,
        "Text": " And in the end, it's going to load the DLL, which is called mpclient.dll, which is used"
      },
      {
        "Time_Start": 1614.3,
        "Time_End": 1616.58,
        "Text": " by the service."
      },
      {
        "Time_Start": 1616.58,
        "Time_End": 1623.54,
        "Text": " So it's also used internally by Windows Defender, but more or less for support purpose, to under"
      },
      {
        "Time_Start": 1623.54,
        "Time_End": 1625.42,
        "Text": " thread pool, for instance."
      },
      {
        "Time_Start": 1625.42,
        "Time_End": 1628.02,
        "Text": " It's a good way to do that."
      },
      {
        "Time_Start": 1628.02,
        "Time_End": 1629.74,
        "Text": " Then you have mpengine.dll."
      },
      {
        "Time_Start": 1629.74,
        "Time_End": 1634.86,
        "Text": " So this is exactly the analysis engine of Windows where all the heavy work from analysis"
      },
      {
        "Time_Start": 1634.86,
        "Time_End": 1636.7,
        "Text": " point of view is performed."
      },
      {
        "Time_Start": 1636.7,
        "Time_End": 1642.6200000000001,
        "Text": " You have also mpcommu.dll for communication, to communicate with the cloud of Microsoft."
      },
      {
        "Time_Start": 1642.6200000000001,
        "Time_End": 1648.1000000000001,
        "Text": " You have mpoiv.dll for everything which is linked to Office document."
      },
      {
        "Time_Start": 1648.1000000000001,
        "Time_End": 1651.54,
        "Text": " And you have also mprtp, real time protection."
      },
      {
        "Time_Start": 1651.54,
        "Time_End": 1657.78,
        "Text": " This is the DLL which is in connection to the drivers of Windows Defender, wdfilter.sys,"
      },
      {
        "Time_Start": 1657.78,
        "Time_End": 1666.5,
        "Text": " from my memory, which is supposed to hold all the system events in real time."
      },
      {
        "Time_Start": 1667.3,
        "Time_End": 1670.14,
        "Text": " And then, when you want to interface with, as a reminder, you always need to have the"
      },
      {
        "Time_Start": 1670.14,
        "Time_End": 1674.5,
        "Text": " mpclient, which is in connection to mpsvc.dll."
      },
      {
        "Time_Start": 1674.5,
        "Time_End": 1680.1,
        "Text": " That's the architecture of Windows Defender, at least a simplified one."
      },
      {
        "Time_Start": 1680.1,
        "Time_End": 1688.22,
        "Text": " Well, let's come back to the transition between prep cap service and smart app control within"
      },
      {
        "Time_Start": 1688.22,
        "Time_End": 1689.5,
        "Text": " Windows Defender."
      },
      {
        "Time_Start": 1689.5,
        "Time_End": 1695.02,
        "Text": " So we have that function, which is called mpcheckmapitfiltrust, which is going to call"
      },
      {
        "Time_Start": 1695.02,
        "Time_End": 1701.98,
        "Text": " that number in the hexadecimal RPC function from Windows Defender."
      },
      {
        "Time_Start": 1701.98,
        "Time_End": 1706.22,
        "Text": " And the function which is targeted is server mprpcmemoriescanstart."
      },
      {
        "Time_Start": 1706.22,
        "Time_End": 1709.7,
        "Text": " So you see, we have removed the notion of smart, we have removed the notion of local,"
      },
      {
        "Time_Start": 1709.7,
        "Time_End": 1711.46,
        "Text": " we have removed the notion of Defender."
      },
      {
        "Time_Start": 1711.46,
        "Time_End": 1713.5,
        "Text": " Now it's regular scanstart."
      },
      {
        "Time_Start": 1713.5,
        "Time_End": 1714.5,
        "Text": " Interesting."
      },
      {
        "Time_Start": 1714.5,
        "Time_End": 1719.3,
        "Text": " The analysis is performed asynchronously, as we have said, with thread pool."
      },
      {
        "Time_Start": 1720.1,
        "Time_End": 1724.1,
        "Text": " It's interesting because all the operations are performed asynchronously, and in the end,"
      },
      {
        "Time_Start": 1724.1,
        "Time_End": 1727.22,
        "Text": " the client which asks for the analysis needs to have a return."
      },
      {
        "Time_Start": 1727.22,
        "Time_End": 1731.5,
        "Text": " And because it's asynchronous, you need to synchronize to know when the answer will be"
      },
      {
        "Time_Start": 1731.5,
        "Time_End": 1732.5,
        "Text": " provided."
      },
      {
        "Time_Start": 1732.5,
        "Time_End": 1738.3,
        "Text": " And to do that, Windows Defender uses a global event, which is named with a grid."
      },
      {
        "Time_Start": 1738.3,
        "Time_End": 1741.82,
        "Text": " That's interesting, in fact, because grids are designed to be unique, not random."
      },
      {
        "Time_Start": 1741.82,
        "Time_End": 1746.34,
        "Text": " So I think, in a way, if we are a bit smart, we could try to make a denial of service."
      },
      {
        "Time_Start": 1746.8600000000001,
        "Time_End": 1747.8600000000001,
        "Text": " You are attacking yourself."
      },
      {
        "Time_Start": 1747.8600000000001,
        "Time_End": 1749.3400000000001,
        "Text": " It's not so interesting."
      },
      {
        "Time_Start": 1749.3400000000001,
        "Time_End": 1752.1000000000001,
        "Text": " But that could be a possibility."
      },
      {
        "Time_Start": 1752.1000000000001,
        "Time_End": 1755.1000000000001,
        "Text": " Duplicate handle in memory would have been a better approach from my point of view."
      },
      {
        "Time_Start": 1755.1000000000001,
        "Time_End": 1757.94,
        "Text": " But that's literally a side note."
      },
      {
        "Time_Start": 1757.94,
        "Time_End": 1760.0200000000002,
        "Text": " So how was the evaluation?"
      },
      {
        "Time_Start": 1760.0200000000002,
        "Time_End": 1761.0200000000002,
        "Text": " Let's make the journey."
      },
      {
        "Time_Start": 1761.0200000000002,
        "Time_End": 1767.14,
        "Text": " We are only going to focus on the main relevant function, and you will see there are a lot."
      },
      {
        "Time_Start": 1767.14,
        "Time_End": 1774.0200000000002,
        "Text": " First of all, we are in the service DLL, which is about to create some stuff with C++ programming"
      },
      {
        "Time_Start": 1774.1,
        "Time_End": 1778.66,
        "Text": " to create an object, which is called a CMP memscan context memory."
      },
      {
        "Time_Start": 1778.66,
        "Time_End": 1780.06,
        "Text": " And we are going to initialize it."
      },
      {
        "Time_Start": 1780.06,
        "Time_End": 1784.26,
        "Text": " And when we are doing the initialization, we are literally doing the analysis."
      },
      {
        "Time_Start": 1784.26,
        "Time_End": 1785.58,
        "Text": " We are switching to mpClient."
      },
      {
        "Time_Start": 1785.58,
        "Time_End": 1788.66,
        "Text": " It's just a call of function, and there is no mystery in between."
      },
      {
        "Time_Start": 1788.66,
        "Time_End": 1791.82,
        "Text": " It's just a function call to another function call."
      },
      {
        "Time_Start": 1791.82,
        "Time_End": 1794.3799999999999,
        "Text": " And we have the submit process."
      },
      {
        "Time_Start": 1794.3799999999999,
        "Time_End": 1797.1399999999999,
        "Text": " I like this word, provider, vista."
      },
      {
        "Time_Start": 1797.1399999999999,
        "Time_End": 1803.3,
        "Text": " It gives all the literature and history concerning Windows Defender."
      },
      {
        "Time_Start": 1803.3,
        "Time_End": 1806.06,
        "Text": " In fact, it's just pushing something in a thread pool."
      },
      {
        "Time_Start": 1806.06,
        "Time_End": 1810.52,
        "Text": " But we know this thread pool from the initialization, and we know it's going to be back."
      },
      {
        "Time_Start": 1810.52,
        "Time_End": 1814.06,
        "Text": " So that's still mpClient, which manages the thread pool at the beginning just to dequeue"
      },
      {
        "Time_Start": 1814.06,
        "Time_End": 1816.3,
        "Text": " the task to do from the thread pool."
      },
      {
        "Time_Start": 1816.3,
        "Time_End": 1821.58,
        "Text": " And then back in mpService, doAction, onAction, doScan."
      },
      {
        "Time_Start": 1821.58,
        "Time_End": 1823.8799999999999,
        "Text": " We will talk about doScan in a few seconds."
      },
      {
        "Time_Start": 1823.8799999999999,
        "Time_End": 1825.3799999999999,
        "Text": " And then we have rSignalWrapper."
      },
      {
        "Time_Start": 1825.3799999999999,
        "Time_End": 1832.12,
        "Text": " rSignalWrapper is a function to communicate asynchronously, again, with mpEngine."
      },
      {
        "Time_Start": 1832.1200000000001,
        "Time_End": 1838.6000000000001,
        "Text": " And we give this special value, rcScanStreamBuffer, in rSignal."
      },
      {
        "Time_Start": 1838.6000000000001,
        "Time_End": 1842.5200000000002,
        "Text": " And then the engine is going to continue to process that signal."
      },
      {
        "Time_Start": 1842.5200000000002,
        "Time_End": 1848.5600000000002,
        "Text": " CastSignal is the important function, which makes a translation from that value to this"
      },
      {
        "Time_Start": 1848.5600000000002,
        "Time_End": 1850.64,
        "Text": " function, scanStreamBuffer."
      },
      {
        "Time_Start": 1850.64,
        "Time_End": 1853.44,
        "Text": " Makes sense because the buffer is in memory."
      },
      {
        "Time_Start": 1853.44,
        "Time_End": 1856.0000000000002,
        "Text": " So we are going to scan the file in memory."
      },
      {
        "Time_Start": 1856.0000000000002,
        "Time_End": 1860.0400000000002,
        "Text": " And then the most important function in all this scanning operation from our point of"
      },
      {
        "Time_Start": 1860.04,
        "Time_End": 1865.76,
        "Text": " view, because it does a lot, really a lot, is this function, generateBMSpyNetReport,"
      },
      {
        "Time_Start": 1865.76,
        "Time_End": 1869.48,
        "Text": " which is communicating with mpCommu.dll."
      },
      {
        "Time_Start": 1869.48,
        "Time_End": 1873.0,
        "Text": " So literally, it's a code notification to Microsoft."
      },
      {
        "Time_Start": 1873.0,
        "Time_End": 1875.68,
        "Text": " As a side note, I have a couple of minutes, so it's okay."
      },
      {
        "Time_Start": 1875.68,
        "Time_End": 1881.74,
        "Text": " For the record, coming back to this doScan function, this function is a C++ function,"
      },
      {
        "Time_Start": 1881.74,
        "Time_End": 1887.76,
        "Text": " so it literally holds a set of methods in the object from where it has been called."
      },
      {
        "Time_Start": 1887.76,
        "Time_End": 1893.56,
        "Text": " And in the set of functions, I would like just to focus on vfzRead operation."
      },
      {
        "Time_Start": 1893.56,
        "Time_End": 1897.96,
        "Text": " And inside this one, you have a call to that function, readProcessMemory."
      },
      {
        "Time_Start": 1897.96,
        "Time_End": 1898.96,
        "Text": " What does it mean?"
      },
      {
        "Time_Start": 1898.96,
        "Time_End": 1905.08,
        "Text": " It means that when Windows defenders like to scan a file in memory, it doesn't load"
      },
      {
        "Time_Start": 1905.08,
        "Time_End": 1906.56,
        "Text": " it by the file by itself."
      },
      {
        "Time_Start": 1906.56,
        "Time_End": 1908.36,
        "Text": " It's going to act as a debugger."
      },
      {
        "Time_Start": 1908.36,
        "Time_End": 1914.84,
        "Text": " It's literally reading in your memory space of the calling process your file."
      },
      {
        "Time_Start": 1914.8400000000001,
        "Time_End": 1919.0800000000002,
        "Text": " I think it's maybe for optimization purpose not to reload twice the same file in memory,"
      },
      {
        "Time_Start": 1919.0800000000002,
        "Time_End": 1920.68,
        "Text": " but actually, that's quite odd."
      },
      {
        "Time_Start": 1920.68,
        "Time_End": 1925.5600000000002,
        "Text": " That's original, I would say, to act as a debugger for an antivirus, but why not?"
      },
      {
        "Time_Start": 1925.5600000000002,
        "Time_End": 1926.5600000000002,
        "Text": " So it's how it works."
      },
      {
        "Time_Start": 1926.5600000000002,
        "Time_End": 1930.4800000000002,
        "Text": " So when you want to submit a file to Windows defender, don't send him the path of the file,"
      },
      {
        "Time_Start": 1930.4800000000002,
        "Time_End": 1934.96,
        "Text": " just load it in memory, call the right function, and Windows defender will take it by himself."
      },
      {
        "Time_Start": 1934.96,
        "Time_End": 1938.4,
        "Text": " Okay, that was a parenthesis."
      },
      {
        "Time_Start": 1938.4,
        "Time_End": 1942.4,
        "Text": " Let's come back to the communication, because it's very interesting for us."
      },
      {
        "Time_Start": 1942.96,
        "Time_End": 1945.44,
        "Text": " MPCom is going to generate a spy net report."
      },
      {
        "Time_Start": 1945.44,
        "Time_End": 1950.24,
        "Text": " Spy net report is the name of the kind of report which are used internally by Windows"
      },
      {
        "Time_Start": 1950.24,
        "Time_End": 1956.8400000000001,
        "Text": " defender to make submission literally to the rest of the code of Microsoft."
      },
      {
        "Time_Start": 1956.8400000000001,
        "Time_End": 1959.0,
        "Text": " This is the name of the function which is doing it."
      },
      {
        "Time_Start": 1959.0,
        "Time_End": 1963.1200000000001,
        "Text": " It's very, very long, but submit report is the most important stuff."
      },
      {
        "Time_Start": 1963.1200000000001,
        "Time_End": 1968.8000000000002,
        "Text": " And this request is made to that domain, wdcp.microsoft.com."
      },
      {
        "Time_Start": 1968.8000000000002,
        "Time_End": 1972.1200000000001,
        "Text": " That's that IP from us in Germany."
      },
      {
        "Time_Start": 1972.1200000000001,
        "Time_End": 1975.44,
        "Text": " The full URL is given there, boom, submit report."
      },
      {
        "Time_Start": 1975.44,
        "Time_End": 1980.24,
        "Text": " You have the user agent, MP communication, you have the version of the operating system,"
      },
      {
        "Time_Start": 1980.24,
        "Time_End": 1983.72,
        "Text": " the platform version, and the online version of Windows defender."
      },
      {
        "Time_Start": 1983.72,
        "Time_End": 1987.2800000000002,
        "Text": " That's all you need to provide to make the communication with the server, and you accept"
      },
      {
        "Time_Start": 1987.2800000000002,
        "Time_End": 1988.2800000000002,
        "Text": " it very fine."
      },
      {
        "Time_Start": 1988.2800000000002,
        "Time_End": 1993.0000000000002,
        "Text": " So security is present, there is a way to prevent man in the middle, it's just regular"
      },
      {
        "Time_Start": 1993.0000000000002,
        "Time_End": 1997.8400000000001,
        "Text": " certificate pinning inside this function, check certificate Microsoft root, based on"
      },
      {
        "Time_Start": 1998.8400000000001,
        "Time_End": 2003.7600000000002,
        "Text": " query option, so it's correctly done."
      },
      {
        "Time_Start": 2003.7600000000002,
        "Time_End": 2010.8000000000002,
        "Text": " So you cannot too easily intercept the communication if you are not already on the machine at least."
      },
      {
        "Time_Start": 2010.8000000000002,
        "Time_End": 2015.92,
        "Text": " The content of the spy net request is packed, so it means it's not easily readable."
      },
      {
        "Time_Start": 2015.92,
        "Time_End": 2020.88,
        "Text": " Well, with reverse engineering, it becomes readable."
      },
      {
        "Time_Start": 2020.88,
        "Time_End": 2026.16,
        "Text": " So we have the possibility to extract all the information from a spy net report, and"
      },
      {
        "Time_Start": 2026.16,
        "Time_End": 2028.0400000000002,
        "Text": " we have very interesting information."
      },
      {
        "Time_Start": 2028.0400000000002,
        "Time_End": 2033.5600000000002,
        "Text": " When you make a smart app control request, at least Windows defender does it for you,"
      },
      {
        "Time_Start": 2033.5600000000002,
        "Time_End": 2038.92,
        "Text": " it provides the machine information, engine report with machine and product with platform,"
      },
      {
        "Time_Start": 2038.92,
        "Time_End": 2042.3600000000001,
        "Text": " a lot of information about your current machine."
      },
      {
        "Time_Start": 2042.3600000000001,
        "Time_End": 2048.4,
        "Text": " Also in Windows defender information, it provides all the defenders version number, signature,"
      },
      {
        "Time_Start": 2048.4,
        "Time_End": 2053.28,
        "Text": " engine, database of signatures, quarantine, and so on, everything is provided."
      },
      {
        "Time_Start": 2053.48,
        "Time_End": 2057.6800000000003,
        "Text": " Windows defender configuration value, how the services start, tamper protection state,"
      },
      {
        "Time_Start": 2057.6800000000003,
        "Time_End": 2062.6000000000004,
        "Text": " all the configuration and policy for Windows defender is sent automatically and every time."
      },
      {
        "Time_Start": 2062.6000000000004,
        "Time_End": 2067.32,
        "Text": " Trust mode state, if there is different sub-mode in Windows defender which is included or not."
      },
      {
        "Time_Start": 2067.32,
        "Time_End": 2073.2000000000003,
        "Text": " So literally, every time you disclose something for malware analysis, Microsoft knows exactly"
      },
      {
        "Time_Start": 2073.2000000000003,
        "Time_End": 2076.5600000000004,
        "Text": " how it's configured in Windows defender."
      },
      {
        "Time_Start": 2076.5600000000004,
        "Time_End": 2080.8,
        "Text": " You have a signature request, from my point of view, it's just to track the request we"
      },
      {
        "Time_Start": 2080.8,
        "Time_End": 2085.44,
        "Text": " are going to send, but it's very interesting to have a history so that it gives information"
      },
      {
        "Time_Start": 2085.44,
        "Time_End": 2089.88,
        "Text": " to the previous submission you could have done by yourself."
      },
      {
        "Time_Start": 2089.88,
        "Time_End": 2092.1600000000003,
        "Text": " And of course, you have the file content query."
      },
      {
        "Time_Start": 2092.1600000000003,
        "Time_End": 2100.2000000000003,
        "Text": " So you have the real path, the hash of that path, the file name, SHR1, SHR256, MD5 also,"
      },
      {
        "Time_Start": 2100.2000000000003,
        "Time_End": 2107.1200000000003,
        "Text": " why not, CRC, the file size, PE attributes, file tip settings, imp hash, name, original"
      },
      {
        "Time_Start": 2107.12,
        "Time_End": 2113.2799999999997,
        "Text": " name, version of the software, that's unknown hash for us, it's hash more or less of some"
      },
      {
        "Time_Start": 2113.2799999999997,
        "Time_End": 2115.7999999999997,
        "Text": " section I would say."
      },
      {
        "Time_Start": 2115.7999999999997,
        "Time_End": 2121.88,
        "Text": " I like this one, modwrefurl, it's when you download the file, Microsoft keeps track of"
      },
      {
        "Time_Start": 2121.88,
        "Time_End": 2125.88,
        "Text": " from which website it has been downloaded, or if you have extracted the file to a zip"
      },
      {
        "Time_Start": 2125.88,
        "Time_End": 2130.3199999999997,
        "Text": " archive, it keeps track to the archive where the file is from."
      },
      {
        "Time_Start": 2130.3199999999997,
        "Time_End": 2133.24,
        "Text": " Kind, isn't it?"
      },
      {
        "Time_Start": 2133.2400000000002,
        "Time_End": 2137.0800000000004,
        "Text": " And then you have the mark of the web and so on, this is exactly the NTFS attribute"
      },
      {
        "Time_Start": 2137.0800000000004,
        "Time_End": 2142.0400000000004,
        "Text": " which is used in download directory when you download something to Windows and you execute"
      },
      {
        "Time_Start": 2142.0400000000004,
        "Time_End": 2143.0400000000004,
        "Text": " from download directory."
      },
      {
        "Time_Start": 2143.0400000000004,
        "Time_End": 2146.32,
        "Text": " That's exactly the same stuff, same logic at least."
      },
      {
        "Time_Start": 2146.32,
        "Time_End": 2149.28,
        "Text": " Mostly this is metadata concerning the file."
      },
      {
        "Time_Start": 2149.28,
        "Time_End": 2153.0000000000005,
        "Text": " At the best of our knowledge, this is not directly the content of the file."
      },
      {
        "Time_Start": 2153.0000000000005,
        "Time_End": 2157.1200000000003,
        "Text": " The only stuff from the content of the file is PE attributes, but it's more from compilation"
      },
      {
        "Time_Start": 2157.1200000000003,
        "Time_End": 2161.0400000000004,
        "Text": " point of view interesting than what really your executable does."
      },
      {
        "Time_Start": 2161.04,
        "Time_End": 2164.7599999999998,
        "Text": " So you don't have any disclosure like that."
      },
      {
        "Time_Start": 2164.7599999999998,
        "Time_End": 2169.36,
        "Text": " If you want to have another see of how it looks like after reverse engineering and parsing"
      },
      {
        "Time_Start": 2169.36,
        "Time_End": 2175.84,
        "Text": " the content, so it's literally a lot of values I would say, and you can see the path, the"
      },
      {
        "Time_Start": 2175.84,
        "Time_End": 2180.56,
        "Text": " name of the application, and so on, and you have also the name of the zip application"
      },
      {
        "Time_Start": 2180.56,
        "Time_End": 2185.44,
        "Text": " which was a zip archive where we have extracted the software which has been used for test"
      },
      {
        "Time_Start": 2185.44,
        "Time_End": 2186.44,
        "Text": " purpose."
      },
      {
        "Time_Start": 2186.44,
        "Time_End": 2192.44,
        "Text": " So everything is not everything, but at least from file query you have more or less everything."
      },
      {
        "Time_Start": 2192.44,
        "Time_End": 2197.7200000000003,
        "Text": " So the answer from Microsoft, so we send information to Microsoft, Microsoft answers us, nice."
      },
      {
        "Time_Start": 2197.7200000000003,
        "Time_End": 2201.7200000000003,
        "Text": " Once the answer is received, this one is parsed by this very long name function."
      },
      {
        "Time_Start": 2201.7200000000003,
        "Time_End": 2205.56,
        "Text": " The goal of this function is to extract all the information provided by Microsoft to know"
      },
      {
        "Time_Start": 2205.56,
        "Time_End": 2209.84,
        "Text": " what to do with that executable because in the end, Smart App Control is going to say"
      },
      {
        "Time_Start": 2209.84,
        "Time_End": 2215.28,
        "Text": " that this app is trusted by Microsoft, you can execute it, this app is untrusted by Microsoft,"
      },
      {
        "Time_Start": 2215.28,
        "Time_End": 2216.28,
        "Text": " it's blocked."
      },
      {
        "Time_Start": 2216.28,
        "Time_End": 2218.36,
        "Text": " So it's exactly the stuff which it's going to do."
      },
      {
        "Time_Start": 2218.36,
        "Time_End": 2223.1600000000003,
        "Text": " So a feedback about the analysed file, and also the potential information, so it's not"
      },
      {
        "Time_Start": 2223.1600000000003,
        "Time_End": 2228.1200000000003,
        "Text": " always present but it can be present, about the current mode in which Smart App Control"
      },
      {
        "Time_Start": 2228.1200000000003,
        "Time_End": 2229.28,
        "Text": " is running."
      },
      {
        "Time_Start": 2229.28,
        "Time_End": 2234.0800000000004,
        "Text": " So you remember at the beginning, Smart App Control has three states, evaluation, which"
      },
      {
        "Time_Start": 2234.0800000000004,
        "Time_End": 2242.32,
        "Text": " was Smart App Control observes the system, enforcement, where Smart App Control really"
      },
      {
        "Time_Start": 2242.32,
        "Time_End": 2245.3,
        "Text": " blocked or not application, and off."
      },
      {
        "Time_Start": 2245.3,
        "Time_End": 2249.94,
        "Text": " So the transition, the way to switch from one state to another state, is driven remotely"
      },
      {
        "Time_Start": 2249.94,
        "Time_End": 2253.6200000000003,
        "Text": " by Microsoft from every answer it provides to you."
      },
      {
        "Time_Start": 2253.6200000000003,
        "Time_End": 2258.54,
        "Text": " So that's Microsoft which can decide, yes or no, you are going to do it or not."
      },
      {
        "Time_Start": 2258.54,
        "Time_End": 2262.88,
        "Text": " So we do not have the logic because the logic of this choice is on server side."
      },
      {
        "Time_Start": 2262.88,
        "Time_End": 2268.42,
        "Text": " And for obvious reason, we don't have access to the server where this algorithm of choice"
      },
      {
        "Time_Start": 2268.42,
        "Time_End": 2269.42,
        "Text": " is performed."
      },
      {
        "Time_Start": 2269.42,
        "Time_End": 2272.6200000000003,
        "Text": " But it's driven remotely."
      },
      {
        "Time_Start": 2272.6200000000003,
        "Time_End": 2275.1800000000003,
        "Text": " The answer is personalised for Smart App Control."
      },
      {
        "Time_Start": 2276.06,
        "Time_End": 2280.46,
        "Text": " Despite the fact that Spidenet is used as a very generic stuff for all the application"
      },
      {
        "Time_Start": 2280.46,
        "Time_End": 2287.62,
        "Text": " and everything where my Windows Defender needs to disclose something to Microsoft Cloud Analysis,"
      },
      {
        "Time_Start": 2287.62,
        "Time_End": 2291.54,
        "Text": " Smart App Control has specific attributes so that the answer is personalised for Smart"
      },
      {
        "Time_Start": 2291.54,
        "Time_End": 2294.3399999999997,
        "Text": " App Control analysis."
      },
      {
        "Time_Start": 2294.3399999999997,
        "Time_End": 2298.06,
        "Text": " So that's how it works, at least from the feedback."
      },
      {
        "Time_Start": 2298.06,
        "Time_End": 2302.18,
        "Text": " If you really want to have a deep look on the feedback, so it's still packed, so we"
      },
      {
        "Time_Start": 2302.18,
        "Time_End": 2303.5,
        "Text": " need to unpack it."
      },
      {
        "Time_Start": 2303.5,
        "Time_End": 2306.4199999999996,
        "Text": " And then you have many blobs in the answer."
      },
      {
        "Time_Start": 2306.4199999999996,
        "Time_End": 2310.4199999999996,
        "Text": " One blob is a signature so that the answer is correctly signed and we know that it's"
      },
      {
        "Time_Start": 2310.4199999999996,
        "Time_End": 2311.4199999999996,
        "Text": " going from Microsoft."
      },
      {
        "Time_Start": 2311.4199999999996,
        "Time_End": 2312.4199999999996,
        "Text": " You see?"
      },
      {
        "Time_Start": 2312.4199999999996,
        "Time_End": 2316.18,
        "Text": " You have the man in the middle protection and also a signature of the answer."
      },
      {
        "Time_Start": 2316.18,
        "Time_End": 2318.7799999999997,
        "Text": " The goal is always to improve the security."
      },
      {
        "Time_Start": 2318.7799999999997,
        "Time_End": 2320.3399999999997,
        "Text": " So the message is signed."
      },
      {
        "Time_Start": 2320.3399999999997,
        "Time_End": 2323.94,
        "Text": " The message contains information related to the original request so that we have a track"
      },
      {
        "Time_Start": 2323.94,
        "Time_End": 2324.94,
        "Text": " down."
      },
      {
        "Time_Start": 2324.94,
        "Time_End": 2328.66,
        "Text": " We know from which request we have the answer because everything is asynchronous."
      },
      {
        "Time_Start": 2328.66,
        "Time_End": 2334.22,
        "Text": " In practice, we have also very three interesting blobs which all start by a magic number which"
      },
      {
        "Time_Start": 2334.22,
        "Time_End": 2339.18,
        "Text": " are provided over there and which gives a decision to do."
      },
      {
        "Time_Start": 2339.18,
        "Time_End": 2344.3799999999997,
        "Text": " If SAC is in enforcement mode, so it means it's going to block or not, or it's going"
      },
      {
        "Time_Start": 2344.3799999999997,
        "Time_End": 2347.1,
        "Text": " to allow your application or block your application."
      },
      {
        "Time_Start": 2347.1,
        "Time_End": 2352.7799999999997,
        "Text": " If SAC is in evaluation mode, you have just a notification sort of WNF toast."
      },
      {
        "Time_Start": 2352.7799999999997,
        "Time_End": 2355.94,
        "Text": " Sometimes when you receive a mail, you have a pop-up which comes from the bottom right"
      },
      {
        "Time_Start": 2355.94,
        "Time_End": 2357.8999999999996,
        "Text": " of your screen in Windows."
      },
      {
        "Time_Start": 2357.9,
        "Time_End": 2361.06,
        "Text": " It's exactly the same kind of notification."
      },
      {
        "Time_Start": 2361.06,
        "Time_End": 2365.58,
        "Text": " And it can change the status case of SAC, enforcement mode, on, off."
      },
      {
        "Time_Start": 2365.58,
        "Time_End": 2368.42,
        "Text": " That's how it works."
      },
      {
        "Time_Start": 2368.42,
        "Time_End": 2375.5,
        "Text": " The changing procedures is more we can describe it for short, very for short."
      },
      {
        "Time_Start": 2375.5,
        "Time_End": 2379.6600000000003,
        "Text": " So that Microsoft Defender Antivirus which receives the information is going to disclose"
      },
      {
        "Time_Start": 2379.6600000000003,
        "Time_End": 2384.1,
        "Text": " it with CI.dll which has a specific procedure for that."
      },
      {
        "Time_Start": 2384.1,
        "Time_End": 2389.02,
        "Text": " The first is to change the configuration because it's impact CI.dll which doesn't need"
      },
      {
        "Time_Start": 2389.02,
        "Time_End": 2392.2999999999997,
        "Text": " any more to notify services."
      },
      {
        "Time_Start": 2392.2999999999997,
        "Time_End": 2398.14,
        "Text": " We are going to update policy in SAC and WDAC to stop it correctly."
      },
      {
        "Time_Start": 2398.14,
        "Time_End": 2400.74,
        "Text": " And then we have two kind of procedures."
      },
      {
        "Time_Start": 2400.74,
        "Time_End": 2406.8199999999997,
        "Text": " On the one side, we have an RPC toast notification, so we are going to talk with RPCSVC, and if"
      },
      {
        "Time_Start": 2406.8199999999997,
        "Time_End": 2412.74,
        "Text": " you remember in the RPC interface of service, you have the regular service features for"
      },
      {
        "Time_Start": 2412.7400000000002,
        "Time_End": 2418.5800000000004,
        "Text": " catalog file, but you have also four features, four functions for smart app controls."
      },
      {
        "Time_Start": 2418.5800000000004,
        "Time_End": 2424.42,
        "Text": " The two first are for notification, analysis, and the two last are for display control,"
      },
      {
        "Time_Start": 2424.42,
        "Time_End": 2425.42,
        "Text": " GUI."
      },
      {
        "Time_Start": 2425.42,
        "Time_End": 2428.38,
        "Text": " That's exactly these two functions which are going to be called here to inform you that"
      },
      {
        "Time_Start": 2428.38,
        "Time_End": 2433.26,
        "Text": " something has changed concerning SAC, or the application would have been blocked if SAC"
      },
      {
        "Time_Start": 2433.26,
        "Time_End": 2436.1400000000003,
        "Text": " would have been in enforcement mode."
      },
      {
        "Time_Start": 2436.1400000000003,
        "Time_End": 2440.6600000000003,
        "Text": " And the other one, it doesn't use any more RPCs, so the notification is performed via"
      },
      {
        "Time_Start": 2440.66,
        "Time_End": 2445.18,
        "Text": " WNF notification, which is another kind of inter-process communication from kernel mode"
      },
      {
        "Time_Start": 2445.18,
        "Time_End": 2448.74,
        "Text": " to user mode, and user mode to user mode also."
      },
      {
        "Time_Start": 2448.74,
        "Time_End": 2454.14,
        "Text": " Which seems to inform to Microsoft Defender on T-Virus that, okay, I've correctly taken"
      },
      {
        "Time_Start": 2454.14,
        "Time_End": 2458.7799999999997,
        "Text": " it into account, the fact that SAC is now in that mode or in the other mode."
      },
      {
        "Time_Start": 2458.7799999999997,
        "Time_End": 2462.62,
        "Text": " Now you, your turn, you can switch your configuration also."
      },
      {
        "Time_Start": 2462.62,
        "Time_End": 2467.7799999999997,
        "Text": " So it's not Microsoft Defender which changed it before, it's really CI.dll which changed"
      },
      {
        "Time_Start": 2467.82,
        "Time_End": 2473.42,
        "Text": " it before, and then it informs Microsoft Defender on T-Virus, so Windows Defender, to do it"
      },
      {
        "Time_Start": 2473.42,
        "Time_End": 2474.42,
        "Text": " by itself."
      },
      {
        "Time_Start": 2474.42,
        "Time_End": 2477.38,
        "Text": " So that's sort of ping pong."
      },
      {
        "Time_Start": 2477.38,
        "Time_End": 2482.0600000000004,
        "Text": " Okay, so we have seen how works smart app control."
      },
      {
        "Time_Start": 2482.0600000000004,
        "Time_End": 2486.5800000000004,
        "Text": " For those we are interested by, we have the possibility also to have a tracking of what"
      },
      {
        "Time_Start": 2486.5800000000004,
        "Time_End": 2491.9,
        "Text": " happens in Windows Defender, a sort of printf, but for Windows Defender to check what are"
      },
      {
        "Time_Start": 2491.9,
        "Time_End": 2493.7400000000002,
        "Text": " the logs inside."
      },
      {
        "Time_Start": 2493.7400000000002,
        "Time_End": 2496.9,
        "Text": " Windows Defender has two kinds of logs internally."
      },
      {
        "Time_Start": 2496.9,
        "Time_End": 2499.94,
        "Text": " The first one is a regular log txt file."
      },
      {
        "Time_Start": 2499.94,
        "Time_End": 2503.26,
        "Text": " It's very old school, but it's very convenient."
      },
      {
        "Time_Start": 2503.26,
        "Time_End": 2507.14,
        "Text": " By default, they are generated all in the same place, C, Program Data, Microsoft, Windows"
      },
      {
        "Time_Start": 2507.14,
        "Time_End": 2510.86,
        "Text": " Defender, Support, prefix log file, and the date."
      },
      {
        "Time_Start": 2510.86,
        "Time_End": 2514.2200000000003,
        "Text": " The date describes the date and time where the file has been generated, and the prefix"
      },
      {
        "Time_Start": 2514.2200000000003,
        "Time_End": 2519.38,
        "Text": " can be mplog, mpsomething, and so on and so on, depending on the different features."
      },
      {
        "Time_Start": 2519.38,
        "Time_End": 2522.9,
        "Text": " I really advise you to check it, because it's very interesting."
      },
      {
        "Time_Start": 2522.9,
        "Time_End": 2527.58,
        "Text": " For those we are interested by, it's initialized by this function, which is called at the end"
      },
      {
        "Time_Start": 2527.58,
        "Time_End": 2532.14,
        "Text": " of init mpservice function, you remember, at the end of the initialization of Windows"
      },
      {
        "Time_Start": 2532.14,
        "Time_End": 2533.14,
        "Text": " Defender."
      },
      {
        "Time_Start": 2533.14,
        "Time_End": 2540.34,
        "Text": " And also, Windows Defender, in not all of these functions, but in a lot of its functions,"
      },
      {
        "Time_Start": 2540.34,
        "Time_End": 2546.62,
        "Text": " has ETW or WPP tracing within the code, and it's a very gold mine if you want to track"
      },
      {
        "Time_Start": 2546.62,
        "Time_End": 2551.1800000000003,
        "Text": " what this function does without having to reverse engineering everything."
      },
      {
        "Time_Start": 2551.18,
        "Time_End": 2553.98,
        "Text": " But there is a little problem concerning it."
      },
      {
        "Time_Start": 2553.98,
        "Time_End": 2559.8199999999997,
        "Text": " First of all, regarding Smart App Control, we do not have a specific ETW provider."
      },
      {
        "Time_Start": 2559.8199999999997,
        "Time_End": 2564.3399999999997,
        "Text": " So it means that we need to deal with all the Windows Defender stuff, which is a very"
      },
      {
        "Time_Start": 2564.3399999999997,
        "Time_End": 2569.3399999999997,
        "Text": " interesting clue, because it says, without saying it, that Smart App Control is just"
      },
      {
        "Time_Start": 2569.3399999999997,
        "Time_End": 2572.46,
        "Text": " a feature which is a lego of different existing components."
      },
      {
        "Time_Start": 2572.46,
        "Time_End": 2575.62,
        "Text": " It's not something by itself, you see?"
      },
      {
        "Time_Start": 2575.62,
        "Time_End": 2582.18,
        "Text": " When I say in the kernel that it's only about the notification and the change in the policy"
      },
      {
        "Time_Start": 2582.18,
        "Time_End": 2586.74,
        "Text": " and the specific procedure callback which is provided for that policy, I mean it."
      },
      {
        "Time_Start": 2586.74,
        "Time_End": 2587.74,
        "Text": " That sucks."
      },
      {
        "Time_Start": 2587.74,
        "Time_End": 2589.7,
        "Text": " What is really Smart App Control?"
      },
      {
        "Time_Start": 2589.7,
        "Time_End": 2593.22,
        "Text": " But in Windows Defender, it doesn't make a huge difference."
      },
      {
        "Time_Start": 2593.22,
        "Time_End": 2598.22,
        "Text": " It's not big enough to have their own ETW provider."
      },
      {
        "Time_Start": 2598.22,
        "Time_End": 2603.74,
        "Text": " And in ETW provider, talking about it, Windows Defender uses it for getting information and"
      },
      {
        "Time_Start": 2603.82,
        "Time_End": 2605.82,
        "Text": " providing information."
      },
      {
        "Time_Start": 2605.82,
        "Time_End": 2610.26,
        "Text": " So providing information, as I said, is a printf of the process."
      },
      {
        "Time_Start": 2610.26,
        "Time_End": 2611.26,
        "Text": " So it's very cool."
      },
      {
        "Time_Start": 2611.26,
        "Time_End": 2614.34,
        "Text": " We have literally line by line what does it do."
      },
      {
        "Time_Start": 2614.34,
        "Time_End": 2622.5400000000004,
        "Text": " And for information retrieving, so that ETW is also used by the kernel to say that this"
      },
      {
        "Time_Start": 2622.5400000000004,
        "Time_End": 2627.6600000000003,
        "Text": " function has been called, this stuff has been created, this event is now a trigger, that"
      },
      {
        "Time_Start": 2627.6600000000003,
        "Time_End": 2629.0600000000004,
        "Text": " file is accessed, and so on."
      },
      {
        "Time_Start": 2629.0600000000004,
        "Time_End": 2632.1000000000004,
        "Text": " So it's a very good way to track what's happening in the system."
      },
      {
        "Time_Start": 2632.1,
        "Time_End": 2636.22,
        "Text": " And Windows Defender uses it as a source of information."
      },
      {
        "Time_Start": 2636.22,
        "Time_End": 2641.74,
        "Text": " The problem is that this source of information, which is very interesting, is protected."
      },
      {
        "Time_Start": 2641.74,
        "Time_End": 2642.74,
        "Text": " Of course."
      },
      {
        "Time_Start": 2642.74,
        "Time_End": 2644.7,
        "Text": " If it's interesting, it's protected."
      },
      {
        "Time_Start": 2644.7,
        "Time_End": 2648.02,
        "Text": " So we would like to access it."
      },
      {
        "Time_Start": 2648.02,
        "Time_End": 2653.54,
        "Text": " And we are going to share with you how to disable the security to access it."
      },
      {
        "Time_Start": 2653.54,
        "Time_End": 2658.66,
        "Text": " We need to be with a debugger, Winbag debugger, in kernel debug."
      },
      {
        "Time_Start": 2658.66,
        "Time_End": 2659.66,
        "Text": " It's not a hack."
      },
      {
        "Time_Start": 2659.66,
        "Time_End": 2661.9,
        "Text": " So you are already full power on the machine to do it."
      },
      {
        "Time_Start": 2662.7000000000003,
        "Time_End": 2663.7000000000003,
        "Text": " But the goal is to track what happens, right?"
      },
      {
        "Time_Start": 2663.7000000000003,
        "Time_End": 2666.1800000000003,
        "Text": " It's not to break the system."
      },
      {
        "Time_Start": 2666.1800000000003,
        "Time_End": 2671.7000000000003,
        "Text": " So the first thing to do is to use this command line in Winbag, wmi-trust-str-dump."
      },
      {
        "Time_Start": 2671.7000000000003,
        "Time_End": 2678.06,
        "Text": " It's going to list for you all the logger contexts which are related to ETW provider"
      },
      {
        "Time_Start": 2678.06,
        "Time_End": 2679.06,
        "Text": " in the system."
      },
      {
        "Time_Start": 2679.06,
        "Time_End": 2684.1800000000003,
        "Text": " And the one which is interesting to know what's happening in the system is Defender API logger."
      },
      {
        "Time_Start": 2684.1800000000003,
        "Time_End": 2685.1800000000003,
        "Text": " Okay?"
      },
      {
        "Time_Start": 2685.1800000000003,
        "Time_End": 2686.46,
        "Text": " We select it."
      },
      {
        "Time_Start": 2686.46,
        "Time_End": 2691.86,
        "Text": " And we know by a previous study we did for the CZspoos project, which was also on the"
      },
      {
        "Time_Start": 2691.86,
        "Time_End": 2695.02,
        "Text": " behalf of the BSE, how it works."
      },
      {
        "Time_Start": 2695.02,
        "Time_End": 2699.3,
        "Text": " So internally, it's a wmi-logger-context structure."
      },
      {
        "Time_Start": 2699.3,
        "Time_End": 2704.2400000000002,
        "Text": " So I just shot some part of the structure because it's a very big structure."
      },
      {
        "Time_Start": 2704.2400000000002,
        "Time_End": 2707.2400000000002,
        "Text": " We have the name of the logger."
      },
      {
        "Time_Start": 2707.2400000000002,
        "Time_End": 2712.78,
        "Text": " We have also a file where it contains all the ETL events."
      },
      {
        "Time_Start": 2713.1000000000004,
        "Time_End": 2718.34,
        "Text": " You have the protection, which is stored in a very specific variable, which is a flag."
      },
      {
        "Time_Start": 2718.34,
        "Time_End": 2725.1800000000003,
        "Text": " And the flag is just a four-byte value, integer value, for those who like to see, which is"
      },
      {
        "Time_Start": 2725.1800000000003,
        "Time_End": 2730.1400000000003,
        "Text": " an hexadecimal value, 4000F."
      },
      {
        "Time_Start": 2730.1400000000003,
        "Time_End": 2731.5800000000004,
        "Text": " And if you check, it's documented."
      },
      {
        "Time_Start": 2731.5800000000004,
        "Time_End": 2733.86,
        "Text": " It's very kind at Microsoft."
      },
      {
        "Time_Start": 2733.86,
        "Time_End": 2737.5,
        "Text": " They provide all the information from symbols."
      },
      {
        "Time_Start": 2737.5,
        "Time_End": 2740.94,
        "Text": " You have the persistent, autologger, FS3D, real-time."
      },
      {
        "Time_Start": 2740.94,
        "Time_End": 2741.94,
        "Text": " You have all the information."
      },
      {
        "Time_Start": 2742.1,
        "Time_End": 2748.3,
        "Text": " And you have one flag, one bit in that four-byte value, which is called security trace and"
      },
      {
        "Time_Start": 2748.3,
        "Time_End": 2749.78,
        "Text": " is set to one."
      },
      {
        "Time_Start": 2749.78,
        "Time_End": 2753.14,
        "Text": " And all the security matters for it."
      },
      {
        "Time_Start": 2753.14,
        "Time_End": 2755.46,
        "Text": " Let's remove it."
      },
      {
        "Time_Start": 2755.46,
        "Time_End": 2759.2200000000003,
        "Text": " So for those who don't want to use directly the full structure, which provides two verbose"
      },
      {
        "Time_Start": 2759.2200000000003,
        "Time_End": 2761.14,
        "Text": " texts, you can directly use DX."
      },
      {
        "Time_Start": 2761.14,
        "Time_End": 2762.54,
        "Text": " I provide also the slide."
      },
      {
        "Time_Start": 2762.54,
        "Time_End": 2766.42,
        "Text": " We will share it so that you will get access to this command line."
      },
      {
        "Time_Start": 2766.42,
        "Time_End": 2771.34,
        "Text": " And then what you can do is to transform this flag and remove the four, because that's the"
      },
      {
        "Time_Start": 2771.34,
        "Time_End": 2774.5,
        "Text": " bit equivalent to be removed."
      },
      {
        "Time_Start": 2774.5,
        "Time_End": 2776.26,
        "Text": " So we need literally to remove it."
      },
      {
        "Time_Start": 2776.26,
        "Time_End": 2782.82,
        "Text": " So with the debugger, we have ED, E for edit, D for DWORD, for integer value in Windows"
      },
      {
        "Time_Start": 2782.82,
        "Time_End": 2783.82,
        "Text": " Word."
      },
      {
        "Time_Start": 2783.82,
        "Time_End": 2788.86,
        "Text": " You have the address of your ETW context."
      },
      {
        "Time_Start": 2788.86,
        "Time_End": 2791.1800000000003,
        "Text": " That stuff is a bit quirky, to be honest."
      },
      {
        "Time_Start": 2791.1800000000003,
        "Time_End": 2797.7000000000003,
        "Text": " It's just to have something which is independent of the structures and the offset in the structures."
      },
      {
        "Time_Start": 2797.7000000000003,
        "Time_End": 2802.5800000000004,
        "Text": " In the end, it will provide exactly the offset where the flag value is."
      },
      {
        "Time_Start": 2802.5800000000004,
        "Time_End": 2806.5000000000005,
        "Text": " But I don't want to compute it every time I'm using this stuff."
      },
      {
        "Time_Start": 2806.5000000000005,
        "Time_End": 2812.5000000000005,
        "Text": " So I'm using directly the structures from the symbol."
      },
      {
        "Time_Start": 2812.5000000000005,
        "Time_End": 2817.6600000000003,
        "Text": " We are just going to keep the last part of that value, removing by definition the bit"
      },
      {
        "Time_Start": 2817.6600000000003,
        "Time_End": 2822.82,
        "Text": " which was about the security, and ta-da!"
      },
      {
        "Time_Start": 2822.82,
        "Time_End": 2824.1800000000003,
        "Text": " The security is gone."
      },
      {
        "Time_Start": 2824.18,
        "Time_End": 2828.7799999999997,
        "Text": " So let's take a DLL injection attack just to check how Windows Defender detectives step"
      },
      {
        "Time_Start": 2828.7799999999997,
        "Time_End": 2829.7799999999997,
        "Text": " by step."
      },
      {
        "Time_Start": 2829.7799999999997,
        "Time_End": 2834.94,
        "Text": " So we have open process, virtual log, process memory, remote thread, everything classic"
      },
      {
        "Time_Start": 2834.94,
        "Time_End": 2835.94,
        "Text": " I will say."
      },
      {
        "Time_Start": 2835.94,
        "Time_End": 2837.2999999999997,
        "Text": " Let's go."
      },
      {
        "Time_Start": 2837.2999999999997,
        "Time_End": 2844.18,
        "Text": " So we have our own tool for the display, but you can use any ETL or WPP, ETW reader."
      },
      {
        "Time_Start": 2844.18,
        "Time_End": 2847.2,
        "Text": " This will be exactly the same."
      },
      {
        "Time_Start": 2847.2,
        "Time_End": 2848.3799999999997,
        "Text": " You have the provider width."
      },
      {
        "Time_Start": 2848.3799999999997,
        "Time_End": 2850.2999999999997,
        "Text": " So which one is providing information?"
      },
      {
        "Time_Start": 2850.2999999999997,
        "Time_End": 2853.3799999999997,
        "Text": " That's the one we have targeted from the beginning."
      },
      {
        "Time_Start": 2853.38,
        "Time_End": 2858.7400000000002,
        "Text": " And then you have the name of our process, the command line of our process, relevant"
      },
      {
        "Time_Start": 2858.7400000000002,
        "Time_End": 2861.94,
        "Text": " arguments for that process, and even ID."
      },
      {
        "Time_Start": 2861.94,
        "Time_End": 2867.42,
        "Text": " And the even ID tells us in this context it's an open process action."
      },
      {
        "Time_Start": 2867.42,
        "Time_End": 2872.58,
        "Text": " After open process, we have the allocation of memory with page execute read-write, because"
      },
      {
        "Time_Start": 2872.58,
        "Time_End": 2873.96,
        "Text": " we have everything over there."
      },
      {
        "Time_Start": 2873.96,
        "Time_End": 2877.08,
        "Text": " We have also the name of the process."
      },
      {
        "Time_Start": 2877.08,
        "Time_End": 2881.1600000000003,
        "Text": " Then we have the write into a remote process."
      },
      {
        "Time_Start": 2881.16,
        "Time_End": 2885.3999999999996,
        "Text": " So write process memory to write remotely."
      },
      {
        "Time_Start": 2885.3999999999996,
        "Time_End": 2889.04,
        "Text": " Then we have the create a thread in the target process."
      },
      {
        "Time_Start": 2889.04,
        "Time_End": 2893.44,
        "Text": " So you have the thread ID and process ID of the target process."
      },
      {
        "Time_Start": 2893.44,
        "Time_End": 2897.6,
        "Text": " Then we have the load the DLL, which is a DLL injection."
      },
      {
        "Time_Start": 2897.6,
        "Time_End": 2899.04,
        "Text": " So it's going to load it."
      },
      {
        "Time_Start": 2899.04,
        "Time_End": 2900.16,
        "Text": " So perfect."
      },
      {
        "Time_Start": 2900.16,
        "Time_End": 2902.7999999999997,
        "Text": " And we have from somewhere the name of the DLL."
      },
      {
        "Time_Start": 2902.7999999999997,
        "Time_End": 2905.6,
        "Text": " You see the payload, device, R volume 2, user."
      },
      {
        "Time_Start": 2905.6,
        "Time_End": 2910.3199999999997,
        "Text": " We see that device R volume 2 is managed by the kernel, because that's the way the kernel"
      },
      {
        "Time_Start": 2910.36,
        "Time_End": 2912.36,
        "Text": " likes to use the file."
      },
      {
        "Time_Start": 2912.36,
        "Time_End": 2917.6000000000004,
        "Text": " And the desktop, run command from DLL, and DLL for command execute."
      },
      {
        "Time_Start": 2917.6000000000004,
        "Time_End": 2921.52,
        "Text": " Process ID, mesh size, all the information we like."
      },
      {
        "Time_Start": 2921.52,
        "Time_End": 2926.36,
        "Text": " And in the end, we have the detection, Microsoft Defender antivirus reports and authorizes access"
      },
      {
        "Time_Start": 2926.36,
        "Time_End": 2927.92,
        "Text": " to local security system."
      },
      {
        "Time_Start": 2927.92,
        "Time_End": 2931.0,
        "Text": " We have tried to make the injection in LSS.exe to be accurate."
      },
      {
        "Time_Start": 2931.0,
        "Time_End": 2934.6400000000003,
        "Text": " And you see, platform, HTTPS detection, and so on."
      },
      {
        "Time_Start": 2934.6400000000003,
        "Time_End": 2939.6000000000004,
        "Text": " So we have all the step-by-step detection of Windows Defender."
      },
      {
        "Time_Start": 2939.6,
        "Time_End": 2944.3199999999997,
        "Text": " Sometimes reverse engineering is cool."
      },
      {
        "Time_Start": 2944.3199999999997,
        "Time_End": 2949.64,
        "Text": " It's time for conclusion, so that normally everything will be on time."
      },
      {
        "Time_Start": 2949.64,
        "Time_End": 2953.7999999999997,
        "Text": " The big picture of our work is smart app control."
      },
      {
        "Time_Start": 2953.7999999999997,
        "Time_End": 2958.6,
        "Text": " Just as a reminder, first we check which kind of image are relevant or not, reminding you"
      },
      {
        "Time_Start": 2958.6,
        "Time_End": 2961.72,
        "Text": " that not all images are relevant."
      },
      {
        "Time_Start": 2961.72,
        "Time_End": 2965.04,
        "Text": " And by the way, from the documentation of Microsoft, if you are correctly signed, it"
      },
      {
        "Time_Start": 2965.04,
        "Time_End": 2966.04,
        "Text": " will be okay."
      },
      {
        "Time_Start": 2966.04,
        "Time_End": 2967.04,
        "Text": " So, well."
      },
      {
        "Time_Start": 2967.56,
        "Time_End": 2970.12,
        "Text": " Signature check and get image is still WDAG."
      },
      {
        "Time_Start": 2970.12,
        "Time_End": 2974.84,
        "Text": " WDAG policy matching, which has a specific policy, which makes an external authorization."
      },
      {
        "Time_Start": 2974.84,
        "Time_End": 2978.04,
        "Text": " That's the name from the Windows symbols."
      },
      {
        "Time_Start": 2978.04,
        "Time_End": 2983.2799999999997,
        "Text": " The external authorization is actually Kripket service, which makes the interface."
      },
      {
        "Time_Start": 2983.2799999999997,
        "Time_End": 2987.16,
        "Text": " It's going to start if it's not already done, the smart locker enable."
      },
      {
        "Time_Start": 2987.16,
        "Time_End": 2992.24,
        "Text": " Then it's going to open a file so that Windows Defender can read it remotely from Kripket"
      },
      {
        "Time_Start": 2992.24,
        "Time_End": 2995.32,
        "Text": " service, but that's implementation detail."
      },
      {
        "Time_Start": 2995.32,
        "Time_End": 2999.84,
        "Text": " Then we are going to scan this file in memory, more or less parse it to extract all the information"
      },
      {
        "Time_Start": 2999.84,
        "Time_End": 3004.2400000000002,
        "Text": " which are going to be sent via the Spinet communication to Microsoft."
      },
      {
        "Time_Start": 3004.2400000000002,
        "Time_End": 3006.6000000000004,
        "Text": " Microsoft provides us a feedback."
      },
      {
        "Time_Start": 3006.6000000000004,
        "Time_End": 3008.28,
        "Text": " We parse the information from the feedback."
      },
      {
        "Time_Start": 3008.28,
        "Time_End": 3011.7200000000003,
        "Text": " We close the handle, and we take a decision in CI.dll."
      },
      {
        "Time_Start": 3011.7200000000003,
        "Time_End": 3015.88,
        "Text": " That's all."
      },
      {
        "Time_Start": 3015.88,
        "Time_End": 3017.36,
        "Text": " What does it mean?"
      },
      {
        "Time_Start": 3017.36,
        "Time_End": 3024.0,
        "Text": " Well, you remember that we talked at the beginning of what is SAC and what is not SAC."
      },
      {
        "Time_Start": 3024.0,
        "Time_End": 3029.64,
        "Text": " If I take a picture of a very simplified version of SAC, it's just CI.dll, notify Kripket"
      },
      {
        "Time_Start": 3029.64,
        "Time_End": 3035.12,
        "Text": " service, notify Windows Defender, notifying Microsoft."
      },
      {
        "Time_Start": 3035.12,
        "Time_End": 3042.0,
        "Text": " Now let's consider the case where I take a regular antivirus, for instance, Windows Defender."
      },
      {
        "Time_Start": 3042.0,
        "Time_End": 3048.48,
        "Text": " You see, it's making directly the notification to Windows Defender, and it goes to Microsoft."
      },
      {
        "Time_Start": 3048.48,
        "Time_End": 3057.92,
        "Text": " That part, comparing to what it already had before, it's really an open question from"
      },
      {
        "Time_Start": 3057.92,
        "Time_End": 3058.92,
        "Text": " my point of view."
      },
      {
        "Time_Start": 3058.92,
        "Time_End": 3059.92,
        "Text": " Why doing that?"
      },
      {
        "Time_Start": 3059.92,
        "Time_End": 3062.48,
        "Text": " It's so complex, actually."
      },
      {
        "Time_Start": 3062.48,
        "Time_End": 3067.04,
        "Text": " Because from an antivirus point of view, we have this routine, ps set load image notify"
      },
      {
        "Time_Start": 3067.04,
        "Time_End": 3072.68,
        "Text": " routine, which means that a driver-supplied callback is provided every time an image,"
      },
      {
        "Time_Start": 3072.68,
        "Time_End": 3075.68,
        "Text": " DLL executable, is loaded into memory."
      },
      {
        "Time_Start": 3075.6800000000003,
        "Time_End": 3080.4400000000005,
        "Text": " And if it's not enough, you have mini-filter driver, which are able to notify you every"
      },
      {
        "Time_Start": 3080.4400000000005,
        "Time_End": 3082.4,
        "Text": " time a file is accessed on the disk."
      },
      {
        "Time_Start": 3082.4,
        "Time_End": 3085.32,
        "Text": " So everything was already there from an antivirus point of view."
      },
      {
        "Time_Start": 3085.32,
        "Time_End": 3088.84,
        "Text": " But remember, SAC is not an antivirus."
      },
      {
        "Time_Start": 3088.84,
        "Time_End": 3093.5200000000004,
        "Text": " It's not because it behaves like an antivirus, it has almost the same architecture, a bit"
      },
      {
        "Time_Start": 3093.5200000000004,
        "Time_End": 3098.0000000000005,
        "Text": " more complex, but it has the same architecture from a physical point of view of an antivirus,"
      },
      {
        "Time_Start": 3098.0000000000005,
        "Time_End": 3102.2000000000003,
        "Text": " and it blocks applications like antivirus or not, that it is an antivirus."
      },
      {
        "Time_Start": 3102.7200000000003,
        "Time_End": 3105.88,
        "Text": " Well, at least in Microsoft logic, I would say."
      },
      {
        "Time_Start": 3105.88,
        "Time_End": 3110.1200000000003,
        "Text": " So it has everything to do it, and the best argument to say that smart app control is"
      },
      {
        "Time_Start": 3110.1200000000003,
        "Time_End": 3114.0400000000004,
        "Text": " in a way an antivirus, that is literally rely on Windows Defender."
      },
      {
        "Time_Start": 3114.0400000000004,
        "Time_End": 3118.0400000000004,
        "Text": " At the end, in Windows Defender, when the scan analysis really starts, you don't have"
      },
      {
        "Time_Start": 3118.0400000000004,
        "Time_End": 3121.9600000000005,
        "Text": " any more the name of smart app control or smart locker and so on, it's just regular"
      },
      {
        "Time_Start": 3121.9600000000005,
        "Time_End": 3125.1200000000003,
        "Text": " notification stuff."
      },
      {
        "Time_Start": 3125.1200000000003,
        "Time_End": 3129.6400000000003,
        "Text": " And the difference relies, in fact, between antivirus and smart app control in the fact"
      },
      {
        "Time_Start": 3129.64,
        "Time_End": 3135.6,
        "Text": " that smart app control doesn't block known applications to be malicious."
      },
      {
        "Time_Start": 3135.6,
        "Time_End": 3139.3199999999997,
        "Text": " It blocks unknown applications that it doesn't trust."
      },
      {
        "Time_Start": 3139.3199999999997,
        "Time_End": 3145.08,
        "Text": " Well, Microsoft just replaced the notion of exclusion list, blacklist, in a more direct"
      },
      {
        "Time_Start": 3145.08,
        "Time_End": 3148.68,
        "Text": " language, to inclusion list, whitelist."
      },
      {
        "Time_Start": 3148.68,
        "Time_End": 3156.64,
        "Text": " The antivirus made whitelisting, smart app control made whitelisting, blacklisting, whitelisting."
      },
      {
        "Time_Start": 3156.64,
        "Time_End": 3159.8399999999997,
        "Text": " The cloud analysis mostly relied on executable signatures."
      },
      {
        "Time_Start": 3159.8399999999997,
        "Time_End": 3164.0,
        "Text": " As I remember from the documentation, smart app control will block unless those files"
      },
      {
        "Time_Start": 3164.0,
        "Time_End": 3168.3599999999997,
        "Text": " are code-signed with a certificate issued by a certificate authority within the trusted"
      },
      {
        "Time_Start": 3168.3599999999997,
        "Time_End": 3169.8399999999997,
        "Text": " root program."
      },
      {
        "Time_Start": 3169.8399999999997,
        "Time_End": 3173.3199999999997,
        "Text": " Nothing new."
      },
      {
        "Time_Start": 3173.3199999999997,
        "Time_End": 3179.7999999999997,
        "Text": " That's literally a sack which doesn't allow applications which are unsigned to be executed,"
      },
      {
        "Time_Start": 3179.7999999999997,
        "Time_End": 3182.8799999999997,
        "Text": " more or less, if they are not trusted by Microsoft."
      },
      {
        "Time_Start": 3182.88,
        "Time_End": 3187.1600000000003,
        "Text": " The learning phase, technically speaking, is more or less about to check how many applications"
      },
      {
        "Time_Start": 3187.1600000000003,
        "Time_End": 3189.92,
        "Text": " with an unknown reputation from Microsoft you use."
      },
      {
        "Time_Start": 3189.92,
        "Time_End": 3195.32,
        "Text": " That's why they call the cloud analysis intelligent blah, blah, blah."
      },
      {
        "Time_Start": 3195.32,
        "Time_End": 3196.84,
        "Text": " It's literally like that."
      },
      {
        "Time_Start": 3196.84,
        "Time_End": 3202.88,
        "Text": " But we can have also another point of view on this stuff, because it just, I mean, it's"
      },
      {
        "Time_Start": 3202.88,
        "Time_End": 3209.96,
        "Text": " one point of view, but we can try to fit in the shoes of Microsoft for a couple of seconds."
      },
      {
        "Time_Start": 3210.04,
        "Time_End": 3213.44,
        "Text": " The architecture of smart app control is unnecessarily complex."
      },
      {
        "Time_Start": 3213.44,
        "Time_End": 3215.16,
        "Text": " But why is it unnecessary complex?"
      },
      {
        "Time_Start": 3215.16,
        "Time_End": 3217.36,
        "Text": " Because it relies on WDAC."
      },
      {
        "Time_Start": 3217.36,
        "Time_End": 3222.92,
        "Text": " And maybe we should think that smart app control is just an involvement of WDAC."
      },
      {
        "Time_Start": 3222.92,
        "Time_End": 3228.4,
        "Text": " I mean by that, that WDAC is supposed to protect your system by applying policy on what kind"
      },
      {
        "Time_Start": 3228.4,
        "Time_End": 3233.0,
        "Text": " of application can be executed and which application cannot be executed on your system."
      },
      {
        "Time_Start": 3233.0,
        "Time_End": 3236.48,
        "Text": " But to be able to define the policy to say, ah, that application will be blocked, ah,"
      },
      {
        "Time_Start": 3236.48,
        "Time_End": 3239.12,
        "Text": " not this application, this one, not this one, ah, we have the update now."
      },
      {
        "Time_Start": 3240.12,
        "Time_End": 3245.16,
        "Text": " It's a huge and complex process to do it, especially in very big organizations."
      },
      {
        "Time_Start": 3245.16,
        "Time_End": 3251.04,
        "Text": " And maybe Microsoft, it's just a guess, might have thought about the fact that we have the"
      },
      {
        "Time_Start": 3251.04,
        "Time_End": 3256.96,
        "Text": " feature which is called cloud intelligent reputation, and maybe we can make a mix between"
      },
      {
        "Time_Start": 3256.96,
        "Time_End": 3262.2,
        "Text": " all this automatic reputation we already have for application and WDAC, so that WDAC is"
      },
      {
        "Time_Start": 3262.2,
        "Time_End": 3265.3199999999997,
        "Text": " automatically configured for anyone."
      },
      {
        "Time_Start": 3265.3199999999997,
        "Time_End": 3268.4,
        "Text": " So that we don't have to define policy and per application and so on."
      },
      {
        "Time_Start": 3268.6800000000003,
        "Time_End": 3272.44,
        "Text": " So that could have been the idea and explaining what smart app control relies on WDAC and"
      },
      {
        "Time_Start": 3272.44,
        "Time_End": 3275.7200000000003,
        "Text": " not directly on the antivirus because it's from the antivirus."
      },
      {
        "Time_Start": 3275.7200000000003,
        "Time_End": 3281.12,
        "Text": " But in the end, it's white listing, sign-in, globally shared application execution policy."
      },
      {
        "Time_Start": 3281.12,
        "Time_End": 3285.08,
        "Text": " And it should be done, and it should be seen from an evolution from Windows Vista with"
      },
      {
        "Time_Start": 3285.08,
        "Time_End": 3290.96,
        "Text": " code integrity, patch guard for those who prefer, and kernel mode application signing."
      },
      {
        "Time_Start": 3290.96,
        "Time_End": 3296.44,
        "Text": " AppLocker in Windows 7, which has disappeared to become something else."
      },
      {
        "Time_Start": 3296.44,
        "Time_End": 3308.16,
        "Text": " We have WDAC in Windows 10, ESG, Intelligent Secure Graph from Windows 10 also to check"
      },
      {
        "Time_Start": 3308.16,
        "Time_End": 3312.44,
        "Text": " the application reputation, and in Windows 11, you have SAC."
      },
      {
        "Time_Start": 3312.44,
        "Time_End": 3318.16,
        "Text": " So you have the evolution, step-by-step, of this technology."
      },
      {
        "Time_Start": 3318.16,
        "Time_End": 3323.08,
        "Text": " But the main conclusion I would like to share with you is maybe that smart app control raises"
      },
      {
        "Time_Start": 3323.08,
        "Time_End": 3324.08,
        "Text": " questions."
      },
      {
        "Time_Start": 3324.08,
        "Time_End": 3326.52,
        "Text": " One is that the notification is about HTTPS request."
      },
      {
        "Time_Start": 3326.52,
        "Time_End": 3327.52,
        "Text": " Okay."
      },
      {
        "Time_Start": 3327.52,
        "Time_End": 3331.92,
        "Text": " To be able to make it correctly, we will need to have access to the victim's machine to"
      },
      {
        "Time_Start": 3331.92,
        "Time_End": 3333.72,
        "Text": " get all the serial number and so on."
      },
      {
        "Time_Start": 3333.72,
        "Time_End": 3340.7599999999998,
        "Text": " But nothing prevents us to take the request from the machine and spoofing it or spamming"
      },
      {
        "Time_Start": 3340.7599999999998,
        "Time_End": 3345.08,
        "Text": " it to another machine, pretending that you are the other machine to deactivate SAC on"
      },
      {
        "Time_Start": 3345.08,
        "Time_End": 3349.52,
        "Text": " the other machine by pretending you launched a lot of untrusted applications."
      },
      {
        "Time_Start": 3349.52,
        "Time_End": 3353.16,
        "Text": " That could be an idea to deactivate remotely SAC on another machine."
      },
      {
        "Time_Start": 3353.24,
        "Time_End": 3356.0,
        "Text": " And it's just HTTPS requests coming from everywhere."
      },
      {
        "Time_Start": 3356.0,
        "Time_End": 3359.44,
        "Text": " So it's very hard to control from Microsoft point of view."
      },
      {
        "Time_Start": 3359.44,
        "Time_End": 3363.2,
        "Text": " But there is another question."
      },
      {
        "Time_Start": 3363.2,
        "Time_End": 3367.6,
        "Text": " As I said, antivirus, if you remember, they have a dedicated driver or service and they"
      },
      {
        "Time_Start": 3367.6,
        "Time_End": 3368.7799999999997,
        "Text": " communicate and so on."
      },
      {
        "Time_Start": 3368.7799999999997,
        "Time_End": 3370.92,
        "Text": " But it's a standalone element."
      },
      {
        "Time_Start": 3370.92,
        "Time_End": 3374.46,
        "Text": " If you want to remove an antivirus, right-click and install."
      },
      {
        "Time_Start": 3374.46,
        "Time_End": 3375.8399999999997,
        "Text": " You can remove it."
      },
      {
        "Time_Start": 3375.8399999999997,
        "Time_End": 3381.16,
        "Text": " But now that SAC is literally embedded on CI.dll, which is a key component feature of"
      },
      {
        "Time_Start": 3381.16,
        "Time_End": 3384.72,
        "Text": " Windows, which cannot be removed, otherwise Windows will not work."
      },
      {
        "Time_Start": 3384.72,
        "Time_End": 3388.68,
        "Text": " That's why the question concerning the position of Windows Defender in the system."
      },
      {
        "Time_Start": 3388.68,
        "Time_End": 3394.3599999999997,
        "Text": " Because even if Windows Defender is in passive or side-by-side passive mode, Windows Defender"
      },
      {
        "Time_Start": 3394.3599999999997,
        "Time_End": 3396.64,
        "Text": " can always be notified by SAC."
      },
      {
        "Time_Start": 3396.64,
        "Time_End": 3400.72,
        "Text": " So even if you have another antivirus installed or even if you say to Windows Defender being"
      },
      {
        "Time_Start": 3400.72,
        "Time_End": 3404.08,
        "Text": " passive mode does nothing, it does something."
      },
      {
        "Time_Start": 3404.08,
        "Time_End": 3408.6,
        "Text": " And that's why the question of the control of the application and the antivirus which"
      },
      {
        "Time_Start": 3408.6,
        "Time_End": 3410.2,
        "Text": " are running on your system."
      },
      {
        "Time_Start": 3410.2400000000002,
        "Time_End": 3412.4,
        "Text": " And it's not just blocking something."
      },
      {
        "Time_Start": 3412.4,
        "Time_End": 3415.28,
        "Text": " It's also disclosure information to Microsoft."
      },
      {
        "Time_Start": 3415.28,
        "Time_End": 3419.9600000000005,
        "Text": " So if you wanted to disable Windows Defender, well, it's not so disabled with smart app"
      },
      {
        "Time_Start": 3419.9600000000005,
        "Time_End": 3420.9600000000005,
        "Text": " control."
      },
      {
        "Time_Start": 3420.9600000000005,
        "Time_End": 3425.5000000000005,
        "Text": " And also it shortcuts other antivirus products because it's not the regular path of notification"
      },
      {
        "Time_Start": 3425.5000000000005,
        "Time_End": 3429.8,
        "Text": " from antivirus to antivirus with different altitude, all of them correctly defined."
      },
      {
        "Time_Start": 3429.8,
        "Time_End": 3431.7200000000003,
        "Text": " It's literally another path."
      },
      {
        "Time_Start": 3431.7200000000003,
        "Time_End": 3433.32,
        "Text": " So that's why the question."
      },
      {
        "Time_Start": 3433.32,
        "Time_End": 3438.1600000000003,
        "Text": " And there is also no documented possibility until now for third party to interface with"
      },
      {
        "Time_Start": 3438.1600000000003,
        "Time_End": 3439.32,
        "Text": " smart app control."
      },
      {
        "Time_Start": 3439.32,
        "Time_End": 3442.52,
        "Text": " It's always Windows Defender and no one else."
      },
      {
        "Time_Start": 3442.52,
        "Time_End": 3448.6000000000004,
        "Text": " So that raises a real question for our point of view concerning the position of Windows"
      },
      {
        "Time_Start": 3448.6000000000004,
        "Time_End": 3451.7200000000003,
        "Text": " Defender in the system."
      },
      {
        "Time_Start": 3451.7200000000003,
        "Time_End": 3458.34,
        "Text": " And on that word, I need to mention some reference, especially the work from N4R1B blogs, which"
      },
      {
        "Time_Start": 3458.34,
        "Time_End": 3464.52,
        "Text": " has made a very good analysis of what happens in the kernel for CI.dll for smart app control."
      },
      {
        "Time_Start": 3464.52,
        "Time_End": 3469.36,
        "Text": " We reversed it another time by ourself on our own just to check that nothing had changed."
      },
      {
        "Time_Start": 3469.36,
        "Time_End": 3473.0,
        "Text": " Some very small detail change, but the logic is always the same."
      },
      {
        "Time_Start": 3473.0,
        "Time_End": 3474.8,
        "Text": " It stopped before Windows Defender."
      },
      {
        "Time_Start": 3474.8,
        "Time_End": 3477.12,
        "Text": " We have continued for Windows Defender."
      },
      {
        "Time_Start": 3477.12,
        "Time_End": 3482.2,
        "Text": " A detailed report of smart app control is present on the BSC website."
      },
      {
        "Time_Start": 3482.2,
        "Time_End": 3486.72,
        "Text": " And for those interested by OTW, there is another one also from BSC."
      },
      {
        "Time_Start": 3486.72,
        "Time_End": 3489.64,
        "Text": " We have written for them."
      },
      {
        "Time_Start": 3489.64,
        "Time_End": 3491.84,
        "Text": " And all these words, thank you for your attention."
      },
      {
        "Time_Start": 3491.84,
        "Time_End": 3494.44,
        "Text": " It was my pleasure to be with you today."
      },
      {
        "Time_Start": 3495.2400000000002,
        "Time_End": 3496.2400000000002,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3496.2400000000002,
        "Time_End": 3497.2400000000002,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3497.2400000000002,
        "Time_End": 3498.2400000000002,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3498.2400000000002,
        "Time_End": 3499.2400000000002,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3507.2400000000002,
        "Time_End": 3508.2400000000002,
        "Text": " Should be okay."
      },
      {
        "Time_Start": 3514.2400000000002,
        "Time_End": 3519.04,
        "Text": " We have a little battery issue, but I suppose if there is any question in the room, maybe"
      },
      {
        "Time_Start": 3519.04,
        "Time_End": 3520.84,
        "Text": " we can hold one or two."
      },
      {
        "Time_Start": 3524.44,
        "Time_End": 3535.4,
        "Text": " All right, now that works."
      },
      {
        "Time_Start": 3535.4,
        "Time_End": 3538.08,
        "Text": " Well, thank you for the talk."
      },
      {
        "Time_Start": 3538.08,
        "Time_End": 3539.28,
        "Text": " Very interesting."
      },
      {
        "Time_Start": 3539.28,
        "Time_End": 3540.8,
        "Text": " Do we have any questions?"
      },
      {
        "Time_Start": 3540.8,
        "Time_End": 3545.64,
        "Text": " Right, I come down because the other mic is also empty."
      },
      {
        "Time_Start": 3545.64,
        "Time_End": 3548.8,
        "Text": " Yeah, thanks for the talk."
      },
      {
        "Time_Start": 3548.8,
        "Time_End": 3555.28,
        "Text": " You mentioned that if you turn SAC off, then you cannot turn back on, right?"
      },
      {
        "Time_Start": 3555.28,
        "Time_End": 3558.96,
        "Text": " But can you switch between the enforcement mode and the learning mode?"
      },
      {
        "Time_Start": 3558.96,
        "Time_End": 3561.92,
        "Text": " I'm not sure about the exact names."
      },
      {
        "Time_Start": 3561.92,
        "Time_End": 3568.7200000000003,
        "Text": " Yeah, when you are in learning mode, evolution mode, but that's the same stuff."
      },
      {
        "Time_Start": 3568.7200000000003,
        "Time_End": 3574.2400000000002,
        "Text": " When you are in this context, you can only go to two directions, off or on faucet."
      },
      {
        "Time_Start": 3574.2400000000002,
        "Time_End": 3576.48,
        "Text": " So active mode, if you prefer."
      },
      {
        "Time_Start": 3576.48,
        "Time_End": 3579.84,
        "Text": " But once you are active, you cannot come back to learning mode."
      },
      {
        "Time_Start": 3579.84,
        "Time_End": 3580.84,
        "Text": " It's one way."
      },
      {
        "Time_Start": 3580.84,
        "Time_End": 3584.92,
        "Text": " At the same, when you are off, you cannot come back to learning mode, and you cannot"
      },
      {
        "Time_Start": 3584.92,
        "Time_End": 3588.36,
        "Text": " go also to direct active mode."
      },
      {
        "Time_Start": 3588.36,
        "Time_End": 3593.48,
        "Text": " If it's off, you cannot say, okay, but just put it on, the evaluation doesn't matter."
      },
      {
        "Time_Start": 3593.48,
        "Time_End": 3596.66,
        "Text": " So which is a bit risky."
      },
      {
        "Time_Start": 3596.66,
        "Time_End": 3600.72,
        "Text": " We are losing control with this kind of application, because it's Microsoft which provides us a"
      },
      {
        "Time_Start": 3600.72,
        "Time_End": 3602.2400000000002,
        "Text": " feedback, yes or no."
      },
      {
        "Time_Start": 3602.2400000000002,
        "Time_End": 3605.0,
        "Text": " We have just a toast notification, and that's all."
      },
      {
        "Time_Start": 3605.0,
        "Time_End": 3608.6,
        "Text": " You cannot say, ah, no, I want to change my mind or give me an extra time."
      },
      {
        "Time_Start": 3608.6,
        "Time_End": 3609.6,
        "Text": " No, no, no."
      },
      {
        "Time_Start": 3609.6,
        "Time_End": 3612.04,
        "Text": " It's choose, and that's all."
      },
      {
        "Time_Start": 3612.04,
        "Time_End": 3616.88,
        "Text": " And if you want to retry, retest, or change your behavior, it's too late."
      },
      {
        "Time_Start": 3616.88,
        "Time_End": 3619.2,
        "Text": " You need to reinstall your Windows."
      },
      {
        "Time_Start": 3619.2,
        "Time_End": 3621.92,
        "Text": " Nice perspective."
      },
      {
        "Time_Start": 3621.92,
        "Time_End": 3624.04,
        "Text": " That's also the point with SAG."
      },
      {
        "Time_Start": 3624.04,
        "Time_End": 3626.64,
        "Text": " It's more and more everything and nothing software."
      },
      {
        "Time_Start": 3626.64,
        "Time_End": 3628.16,
        "Text": " You use it, you've got everything."
      },
      {
        "Time_Start": 3628.16,
        "Time_End": 3632.56,
        "Text": " You don't use it, you have nothing."
      },
      {
        "Time_Start": 3633.56,
        "Time_End": 3635.56,
        "Text": " All right, any more questions?"
      },
      {
        "Time_Start": 3641.56,
        "Time_End": 3643.56,
        "Text": " Well then, thank the speaker again."
      },
      {
        "Time_Start": 3643.56,
        "Time_End": 3645.56,
        "Text": " Thank you."
      }
    ]
  }
}