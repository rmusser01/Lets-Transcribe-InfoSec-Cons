{
  "webpage_url": "https://www.youtube.com/watch?v=CjJsySNiVvE",
  "title": "TROOPERS24: Insert coin: Hacking arcades for fun",
  "description": "Talk by Ignacio Navarro - June 27th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/zsrhcx/\n\nMore impressions:\n  / wearetroopers  \n  / ernw_itsec  \nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
  "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
  "duration": 1587,
  "channel": "TROOPERS IT Security Conference",
  "uploader": "TROOPERS IT Security Conference",
  "upload_date": "20240909"
}

This text was transcribed using whisper model: large-v2

 Good afternoon, everyone. It's the last talk. All of us are a little bit tired, I think.  At least I'm so tired right now. So, I will try to do this stuff quickly. So, I'm from  Cordoba, Argentina. It's quite far from here. I work in application security and insurance  company and also in my free time I do some ethical hacking stuff. That's it. And a fun  fact, as I told you yesterday, if you went to a storytelling, I love sneakers and also  I made clothes. So, I agree with that shit. What we're going to see today, first of all,  a little introduction, how I found this system, the Argentinian company in charge of the entire  production of the stuff. So, my doors, broker authorizations, a little bit about the Android  application that they have. I can take over risk conditions. There was a web server using  for bookings. I mean, you can book different arcade or amusement parks. Some say server  who I found using shooting and that. And a little bit about the NFC. I divide the talk  in different stages, like ten stages, plus the stage number zero. So, that's it. But  first of all, a little disclaimer, because maybe some techniques and procedures are not  completely legal, so please don't do that stuff at your home. If you found something,  just report that immediately. Just don't be an asshole. That's the facing website and  the stuff. In Argentina, some people are facing some universities or libraries, so why are  you doing that shit? So, last December, I went to Sao Paulo for Hackers to Hackers,  a really, really nice conference. So, technical and that, but also they have a lot of parties  over there. I mean, there's parties from Friday to Sunday. So, I really loved the conference.  And in one of those parties, I met a girl from Brazil, and the next day we went to take  some drinks, and after some beers, we were walking, and we found an arcade place into  the mall, and after some beers, it's so funny, they play some stuff. So, there was that totem  used by the car to reach them and check the money and that. When I saw that, I stand in  front of the machine for, like, five minutes, and thinking, okay, this is an old, old Windows.  Maybe there is something interesting here. So, stage number one. As I told you, we bought  the car. That one was the car, just a normal one with the name of the company. They have  the some I Googled the application for the stuff, so I ran a little bit faster over that  one with a normal dictionary. There was not so much data. There was just a PHP running  in Drupal, and they had spoke the info.php. They were running an old version of PHP, like  from 2019, and there's interesting research from Redmond, there's a QR code. If they had  the file uploads, and you have LFI, you can get some access to that one, because the file  is saved on the TMP folder and that. But we need the LFI. At the moment, we don't have  anything about it. So, I ran a sub funder, IDNSX, just to check the different subdomains  and that, and I found another one more interesting for the application who they use for check  your salary and charge some money to the car, and you can check the history where you play  and that, but I tried to work the stuff too, and they had a middleware, so you can't do  any exploitation or something like that. You can just check the credits and the last movement,  so I say, okay, maybe there is not this way, maybe there is no talk this year. So I spent  like one week or two weeks trying to work the application without any luck. So I turned  the car, and I see at the bottom they have some URLs from another company, so I Googled  that one, and that was an Argentinian company. I read a little bit more, and they say, okay,  we provide systems for cashless stuff, so we are not also just okay, we have amusement  park, we have bowling, we have skate parks. So, at that moment, I say, okay, I want to  read a little bit more, and they have on the web page published all the customers around  the world, and that was in more than seven countries, more than 2,000 installations around  the world. So now I say, yes, I want to try to hack this user right now. So, thank you.  I run another DNS stuff, and I found the documentation for the API version number 2, and they use  the application secrets, but they encode that stuff, which I want, and they encode  again. I don't know why. But you need to generate the token, so that's fine. If we want to try  to the API, without any token or something, we get status 200, the response, but the JSON  says status success, success false, and status code 403, so access denied. That was fine,  but we need the API key and the API secret for that. But what happens if we delete the  version number 2 on the path? It's not supposed to work, but in this case, when we check,  we have all the access for the stuff because they don't have any type of validation in  that end point. That happened with all the end points in the API version number 1, so  you can get a lot of 200 okay with data, without data, and a lot of 400 errors. Also, the same  structure like status success, success false, and random stuff. So, stage number 3, the  IDOS and the authorization, I check what is IDOS when you can get access to different  objects, if they are yours or not, because there's not any validation for the user supplies,  so I check my car, I say this is your number, this is your credit and your money, but if  I check another car, I get that access too without any token or something. So, that happened  with the customer too. Also, that was a sequential ID, so you can check the customer number 1,  the customer number 2, and you can get the address, the phone, the email, the last movement,  the car they used, where they used the car, and that with all the customer in the more  than seven countries. So, after that stuff, I was this guy, because it's just normal stuff,  super simple. I wrote a script just to forget the cars and the customer who have some money  into the account, and we can say, okay, maybe this one has 100, 200, and that, just for  check that. And there was a 2,000 installation with the same one. I came back to the website  and started to check a little bit more, and I said, okay, we have this stuff in Spain,  we have some in Prague, UK, Saudi Arabia, a lot of stuff. And also, one of them is so  interesting because there's a big arcade in one of those hotels, and there's a big roller  coaster too. I don't want to say the name, but I think you know what I'm talking about,  and they use the same system for that stuff. So, that was a really, really big shit. I  was checking a little bit more about the API, and I found another interesting thing, you  can get the car from the kiosk, and also you can check the salary and the amount in the  mobile application. So, I opened the store and tried to find it, and I didn't find it  because that was a Brazilian arcade. So, I went to the APK for check the different  stuff, and I found a lot of applications. So, I don't know that one. I had to compile  that stuff with the APK tool or Java compilers. We get the code because that was in a fuscator  so you can read the entire code for the entire application. I get some, well, in this case,  I run JS beautifier just to make the code more pretty, and now we can get access to  the API key, API secrets, the booking URLs, the account code, and that. I get more applications  just for checking if that was the same stuff, and, yes, all of them was on a fuscator, and  they have a code that is a different number. That was kind of complicated to guess which  one is for each company. With that account code, and the end point was the same one for  everyone because it's the same API, you can get the company. But you have the list of  the customers, so you can Google it, and that's fine. So, you don't need to use the account  code or something like that. What I'm saying, you can, for example, in this case, we sent  to the main API with the account code, and say this one is amusement park from Ecuador.  But if we Google the name of the company, and we get the application for the stuff,  we can just consume the API directly without any token or account code or something, and  it's the same stuff. There was an interesting end point for credit in your car, and that  say, okay, you need to generate the token, but we have the API key and the API secrets  right now. So we generate the token, and there's a different offer in this case that was $200,  $500, and they have ID, a sequential ID, too. There's an end point for sales. If you want  to do some online recharge on that, please set the deliver true parameter to do that  automatically, and you don't need to do anything. So, you can generate a lot of stuff. But I  don't know here, but $2,000 is a lot of money, or $200, too, so I don't want to be in jail  for the stuff. About the end points into the application, they have more than 20. All of  them without any token and that. All the code in plain text, as I told you. And there was  an interesting one about the customers. So, in this case, we can find the date customer,  and that's saying authorization meter with the token generated before, but they didn't  validate the stuff, so I don't know why they are sending that stuff. We can check the body  in this case that has the name, the last name, the email, and the newsletter, just random  stuff. But the most interesting stuff I think was the email, because we don't have any validation  or something, so, what's happening if we can just run the emails and get access to  that account? So now we can do some accounting. In this case, I check my account, and I have  this email and that from Webhook, but if we send a post, just changing the email, that  changes successfully without any validations, without any token. So, I record a little demo  for the stuff. It's just logging into my account. And just showing your stuff, because  there is no email or something for the user. The customer says, hey, we are changing your  email just for your information. So we log into our account, we exit, and we come back  to a Webhook, we send the post, and now we're going to go to the application and ask for  the, hey, I forgot my password. This one is my account, so please give me the password.  We're going to ask for the stuff. I'm so bad at editing videos, so, sorry, it could be  more faster, I think, but at least I try. So we receive the email, we're going to come  back to the application and say, okay, we're going to say the password 123, and we're going  to receive the stuff in our email. It could be more fast. Sorry. So, we log into our account  with the new password, and we get access for the same account, and the other user didn't  notice about that. I mean, when he tried to log in again, we're going to say they don't  have the user, but you can do that with all the users without any token or something.  About the risk condition is when you try to access to the same object at the same time.  There was a secure code for the lab which is really interesting. There is some different  type of attack for risk condition, but something is so easy. In this case, they have an offer  stuff like if you set the application in your phone, you can get 400 tickets for just reclaim  some rewards and that. I wrote a Python script, just a normal one. They send just random posts,  in this case, 100 threads. I run the stuff, it gets five hits, and when we check the history,  you have six stuff, too, with 300 tickets each one, and you can do that more technically  if you want, but in this case, it was just a random Python. This one was just tickets,  but you have some rewards about money and that, so maybe it could be more complicated  and dangerous. As I told you, in this case, there was 1,000 tickets and $100 bonus, but  I didn't check the stuff. As I told you, there was a booking portal for the different  arcade and amusement, and they have a lot of exposed data. In this case, the most interesting  are the TMP and the data. In the TMP, we can find some different logs from XML, some data  about the store, some pictures, some different APN ports, data about the cacher and that,  but not so interesting, I mean. Also, there was uploads. I wrote a little Python script  to try to find different interesting files because there was a random picture from the  places and that. An iPhone 3 with some folder that says facturación Argentina, which means  the invoice generated from Argentina. In that folder, they have some certificates, and they  use the stuff in Argentina for saying, okay, I'm this company, trust me, and this person  gave me $80,000. So we can generate a lot of different invoices at the name of the company,  but if we have the certificates, there is maybe some folder with all the invoices. So  the data folder, we found all the invoices from Argentina with all the customer data,  where they live, how they pay, how much, and there was around 600, 700 stuff. But also,  they need a booking manager for the stuff because you can get all the bookings, but  you need something to manage that stuff. So they have another portal who asks, okay, give  me your name, your last name, or the reservation code, but if you just press enter, just click  in search. You get all the reservation from all that customer, and some of them are new.  In this case, they're from April. Yeah, April, March. And they have some SQLI, some application  errors and that. You can manage all the stuff, and also you can set negative tips. So that's  really simple stuff. Well, all the customer data and that. About the service, as I told  you yesterday on the storytelling, sometimes I'm a little bit bored and I open Shoe and  I try to find something. So I say, okay, let's see what we can get from this stuff. First  of all, they have the send public, so you can create an account with just a random email.  In the send, they have a lot of different videos showing the application and how that  works, but they have a lot of user names, password, email, application key, secrets,  just in the random videos. And also they have some network maps, so that can give you some  idea about how is the network inside the different parks and arcades. Also there was a GoCart  team in the U.S. who they have public the user stuff. I mean, they have the login page,  but the webpack was exposed, so you can get all the different API end points, and in this  case you can get access to all the user, just the first name, the age and where they live,  but it's kind of private data. And also you can get access to all the different monitors  at the GoCart, so you can say, okay, maybe this guy is close to winning that. That was  without talking, too, so there was a lot of biggest problems. About the Spain was one  of the biggest stuff because they have exposed the admin console for all the different amusement  parks, but they have a user and password, so I tried to do some SQL that didn't work,  but they have exposed the webpack, too, so we can see the entire code of the application,  and they have some random API end points where you can check all the different machines into  a place, and you can get the public IP from them, so you can do some stuff. But also,  they had the login part public, too, and you can see the different roles, the login end  points, and as we saw at the beginning, they use like a random body for the responses,  and they say, okay, if this one is 200, okay, just give me the token and it's fine, but  if it's 407, do something, and if it's 420, do another stuff. I started to say, okay,  what is 420? I thought he was talking about some weed, maybe, or something like that.  So I changed the response code for 420, and that gave me this screen to say, okay, set  the new password for this user, so we are the same stuff at the beginning. We can change  all the passwords for all the users in the company. About the NFC, we have a lot of time.  The Brazilian card. I don't want to explain a little bit more. There is a secure code  for a guy who explained a lot of information about the NFC. In my case, I just used the  flipper zero for the card, because that was with the default credentials, the default  keys, the key A and key B, so we get access to the classic, we have the UID, and the NFC  had like 16 blocks and used the first one for the manufacturer data. In this case, the  card was empty. They just have some number in the first block, and if we moved that number  to decimal stuff, it is the same number as the card. So there's not much data into the  card, so you can just replace that number and you can emulate that card with your flipper.  Last week, I presented this talk in Spain, and one of the guys came and said, hey, I  went to an amusement park close to here with my son last week, and I have the card here  if you want to check. He said, yes, right now. We scanned the card, and that was the  same stuff. They changed the manufacturer, but they just have the number into the card,  so basically, it is the same stuff, like Argentina and all the different countries. But, for  emulate or try to change the number, you need the flipper zero or some different stuff for  the NFC. So I came back to the application, and I re-delivered a little bit more of the  code. In the Android application, they have this thing that says, if it's not iOS, I don't  know why they changed the platform into the Android application. If the NFC is okay, do  something. So I say, okay, maybe there is something interesting here. So I asked my  dad for the phone, and we logged into the application, just a random one. We have our  user, normal stuff, and we can get access to all the cards, and also we can emulate  the card with our phone, so we can just attach some random cards to the phone, and that's  going to work because they have a pin code, but they don't validate the stuff. You can  do some stuff, and you can do some account takeover, too, so you can join all the stuff.  I spoke so fast, but it's okay. What we can do, we can get the data from all the different  customers, just from the card stuff or from the bookings. We can emulate and get access  to them, charge some money into that stuff, and earn multiple prices. But, in Germany,  they don't have so much customers here, at least in the web page. They have a big amusement  park in Baden, but that's it, so. But I was here in Europe, they have, as I told you at  the beginning, Spain is one of the countries with more customers, and then some in Turkey,  but here in Germany, just Baden, so. See you there. About the conclusions. At 2024,  we still have some simple vulnerabilities in that stuff, so the zero days are so fucking  awesome, too, but just with some random stuff, we can exploit the big companies. The culture  could help the companies to avoid these mistakes and fix them in the development stage, and  you don't need to wait until the product is in production to fix it. Education and training  for the company, the normal stuff for everything. When I found this stuff, I reported several  times, and in April, yes, in April, May, they say we had a meeting in Colombia. I say, okay,  let's work together to fix all the stuff, la, la, la. They say, sure, let's do it. I mean, I report  in that stuff, so, if you want to work and you want to pay me for the stuff, that's perfect,  but I'm doing this stuff just for fun, I mean. Okay, I wrote my report, I send them, and that  was like two months ago, and they didn't answer, so last week, I sent another email, hey, guys,  what about, did you fix the stuff or something? And no one answered, so I hope they fix it.  And if not, you can go to Aden. No, I'm joking. So, if you found something, report the stuff,  just don't be an asshole and be facing the website and the stuff. You can report that and write the  talk for the stuff. And if someone sends you some report, please pay a little bit of attention. You  don't need to pay them, but just, hey, thank you, thank you for reporting the stuff, and that's  it, but just don't be an asshole again. And that's all. So, that was so fast. So, we have, like,  35 minutes. Thank you so much.  Thank you for the very entertaining talk, and the nice slides. And are there any questions  here in the audience? Man, that must have been one hell of a Brazilian girl.  Any other questions?  From my side, maybe. Are there any other things, other findings in the pipeline that you are still  not talking about? Yeah, I'm going to go present this talk in Vegas at DEF CON.  And we'll be maybe more focused in the US machines. But also, I want to present this  talk in Sky Talks, which is not recorded. So, if you want to see more vulnerabilities,  you can go there and check. But yeah, I'm going to go more in deep in some stuff, in some APIs,  and some disclosures, too. Any other questions from the audience?  Okay. Then, thanks again.