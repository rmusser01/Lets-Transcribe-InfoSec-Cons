{
  "metadata": {
    "webpage_url": "https://www.youtube.com/watch?v=03RfncyIAq0",
    "title": "TROOPERS24: DoubleDrive - Double Agents Hide Behind The Clouds",
    "description": "Talk by Or Yair - June 26th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/xsjajg/\n\nMore impressions:\nhttps://twitter.com/WEareTROOPERS\nhttps://twitter.com/ERNW_ITSec\nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
    "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
    "duration": 3206,
    "channel": "TROOPERS IT Security Conference",
    "uploader": "TROOPERS IT Security Conference",
    "upload_date": "20240902"
  },
  "segments": {
    "metadata": {
      "webpage_url": "https://www.youtube.com/watch?v=03RfncyIAq0",
      "title": "TROOPERS24: DoubleDrive - Double Agents Hide Behind The Clouds",
      "description": "Talk by Or Yair - June 26th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/xsjajg/\n\nMore impressions:\nhttps://twitter.com/WEareTROOPERS\nhttps://twitter.com/ERNW_ITSec\nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
      "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
      "duration": 3206,
      "channel": "TROOPERS IT Security Conference",
      "uploader": "TROOPERS IT Security Conference",
      "upload_date": "20240902"
    },
    "segments": [
      {
        "Time_Start": 0.0,
        "Time_End": 11.040000000000001,
        "Text": "This text was transcribed using whisper model: large-v2\n\n Thank you, everyone."
      },
      {
        "Time_Start": 11.040000000000001,
        "Time_End": 13.88,
        "Text": " So okay."
      },
      {
        "Time_Start": 13.88,
        "Time_End": 19.2,
        "Text": " As mentioned, my name is Roy and today I'm going to show you how I managed to turn Google"
      },
      {
        "Time_Start": 19.2,
        "Time_End": 25.2,
        "Text": " Drive and OneDrive into double agent ransomware."
      },
      {
        "Time_Start": 25.2,
        "Time_End": 27.12,
        "Text": " So this is me."
      },
      {
        "Time_Start": 27.12,
        "Time_End": 30.32,
        "Text": " I'm the security research team lead at SafeBridge."
      },
      {
        "Time_Start": 30.32,
        "Time_End": 33.72,
        "Text": " I have more than six years of experience in security research."
      },
      {
        "Time_Start": 33.72,
        "Time_End": 39.72,
        "Text": " My past research included some research in Linux, embedded systems and Android and for"
      },
      {
        "Time_Start": 39.72,
        "Time_End": 47.28,
        "Text": " more than three years now my main focus lies in research in the Windows operating system."
      },
      {
        "Time_Start": 47.28,
        "Time_End": 49.68,
        "Text": " But let's see what we're going to talk about today."
      },
      {
        "Time_Start": 49.68,
        "Time_End": 55.88,
        "Text": " So we're going to start with some general background about the state of ransomware today."
      },
      {
        "Time_Start": 55.88,
        "Time_End": 62.28,
        "Text": " We'll then present the research goals that I defined when I started the research."
      },
      {
        "Time_Start": 62.28,
        "Time_End": 67.34,
        "Text": " Following that, we'll deep dive into the technical details of how I managed to turn OneDrive"
      },
      {
        "Time_Start": 67.34,
        "Time_End": 73.6,
        "Text": " and Google Drive into being a ransomware, which I named DoubleDrive."
      },
      {
        "Time_Start": 73.6,
        "Time_End": 81.16,
        "Text": " We'll then see also how DoubleDrive bypasses certain EDRs and which ones it bypasses and"
      },
      {
        "Time_Start": 81.16,
        "Time_End": 88.1,
        "Text": " finally we'll also compare how OneDrive and Google Drive functioned in this scenario."
      },
      {
        "Time_Start": 88.1,
        "Time_End": 94.67999999999999,
        "Text": " So for those of you who are not familiar with the state of ransomware today, it is really"
      },
      {
        "Time_Start": 94.67999999999999,
        "Time_End": 96.67999999999999,
        "Text": " getting worse."
      },
      {
        "Time_Start": 96.67999999999999,
        "Time_End": 101.75999999999999,
        "Text": " According to research made by Sophos, we can clearly see that payments for ransomware groups"
      },
      {
        "Time_Start": 101.75999999999999,
        "Time_End": 109.94,
        "Text": " in the year 2023 were much more expensive than 2022 and according to the same research"
      },
      {
        "Time_Start": 110.1,
        "Time_End": 121.1,
        "Text": " in both years 2022 and 2023, 66% of the organizations answered that they were attacked by ransomware."
      },
      {
        "Time_Start": 121.1,
        "Time_End": 125.1,
        "Text": " The White House has even declared ransomware to be a national security threat and in the"
      },
      {
        "Time_Start": 125.1,
        "Time_End": 131.1,
        "Text": " same month that this happened, a world record was broken for most ransomware attacks in"
      },
      {
        "Time_Start": 131.1,
        "Time_End": 133.12,
        "Text": " a single month."
      },
      {
        "Time_Start": 133.12,
        "Time_End": 138.5,
        "Text": " So I do want you to keep that in mind during the talk, however, we're not here to talk"
      },
      {
        "Time_Start": 138.5,
        "Time_End": 144.78,
        "Text": " about ransomware statistics, but rather on the specific DoubleDrive ransomware research."
      },
      {
        "Time_Start": 144.78,
        "Time_End": 147.32,
        "Text": " So let's get to it."
      },
      {
        "Time_Start": 147.32,
        "Time_End": 155.42000000000002,
        "Text": " So when I started the research, I wanted to create some sort of a fully undetectable by"
      },
      {
        "Time_Start": 155.42000000000002,
        "Time_End": 157.46,
        "Text": " design ransomware."
      },
      {
        "Time_Start": 157.46,
        "Time_End": 164.18,
        "Text": " A ransomware that will have a fully, a true and fully legitimate flow for encrypting files."
      },
      {
        "Time_Start": 164.18,
        "Time_End": 170.26000000000002,
        "Text": " My assumption was that if I'll be able to find such a flow, then I'll be able to bypass"
      },
      {
        "Time_Start": 170.26000000000002,
        "Time_End": 174.04000000000002,
        "Text": " most common ransomware detection methods."
      },
      {
        "Time_Start": 174.04000000000002,
        "Time_End": 178.86,
        "Text": " So what if I told you that there is a way to encrypt files on your computer without"
      },
      {
        "Time_Start": 178.86,
        "Time_End": 182.66,
        "Text": " actually encrypting files on your computer?"
      },
      {
        "Time_Start": 182.66,
        "Time_End": 188.34,
        "Text": " And what if I told you that I can do that while at the same time I'm not even executing"
      },
      {
        "Time_Start": 188.34,
        "Time_End": 190.36,
        "Text": " code on your computer?"
      },
      {
        "Time_Start": 190.36,
        "Time_End": 195.84,
        "Text": " And what if not even a single malicious executable from my end needs to be present on your computer"
      },
      {
        "Time_Start": 195.84,
        "Time_End": 198.4,
        "Text": " while this happens?"
      },
      {
        "Time_Start": 198.4,
        "Time_End": 203.5,
        "Text": " In order to do that, I realized that I need to find myself a double agent program."
      },
      {
        "Time_Start": 203.5,
        "Time_End": 209.84,
        "Text": " This program, on the one hand, will be considered legitimate for performing mass file operations"
      },
      {
        "Time_Start": 209.84,
        "Time_End": 216.96,
        "Text": " on Windows, and on the second hand, I will be able to influence its file operations without"
      },
      {
        "Time_Start": 216.96,
        "Time_End": 221.12,
        "Text": " leaving any traces that lead back to me."
      },
      {
        "Time_Start": 221.12,
        "Time_End": 225.92000000000002,
        "Text": " Now after thinking about it for a while, I realized that very good candidates for such"
      },
      {
        "Time_Start": 225.92000000000002,
        "Time_End": 233.20000000000002,
        "Text": " double agents programs would be local agents of cloud storage services."
      },
      {
        "Time_Start": 233.20000000000002,
        "Time_End": 241.52,
        "Text": " That is because these services usually create a local sync directory or a local drive, which"
      },
      {
        "Time_Start": 241.52,
        "Time_End": 246.44,
        "Text": " they continuously synchronize with the files from the cloud storage."
      },
      {
        "Time_Start": 246.44,
        "Time_End": 252.2,
        "Text": " So by definition, they do mass file operation on the computer, and on the other hand, the"
      },
      {
        "Time_Start": 252.2,
        "Time_End": 260.32,
        "Text": " file operations that they do are triggered by changes in the cloud."
      },
      {
        "Time_Start": 260.32,
        "Time_End": 266.76,
        "Text": " And in my research, I chose to focus on OneDrive and Google Drive, and this is how I met them,"
      },
      {
        "Time_Start": 266.76,
        "Time_End": 273.6,
        "Text": " so you're welcome to say hi, but let's get to know them a bit more, a bit closer."
      },
      {
        "Time_Start": 273.6,
        "Time_End": 278.32000000000005,
        "Text": " So Google Drive is, of course, the most popular cloud storage service in the world."
      },
      {
        "Time_Start": 278.32000000000005,
        "Time_End": 284.8,
        "Text": " It has billions of users, and just like we need, it does mass file operations, by definition,"
      },
      {
        "Time_Start": 284.8,
        "Time_End": 290.40000000000003,
        "Text": " as it creates the G drive on your Windows computer and continuously synchronizes files"
      },
      {
        "Time_Start": 290.40000000000003,
        "Time_End": 292.96000000000004,
        "Text": " from the cloud storage to it."
      },
      {
        "Time_Start": 292.96000000000004,
        "Time_End": 300.68,
        "Text": " Now looking at OneDrive, OneDrive is Microsoft's recommended solution against ransomware, actually."
      },
      {
        "Time_Start": 300.68,
        "Time_End": 306.8,
        "Text": " Also, it is installed by default on every Windows computer starting 2013, and just like"
      },
      {
        "Time_Start": 306.8,
        "Time_End": 312.56,
        "Text": " Google Drive, it does mass file operation, by definition, as it has the OneDrive sync"
      },
      {
        "Time_Start": 312.56,
        "Time_End": 318.64,
        "Text": " folder, which it continuously synchronizes with the files from the cloud."
      },
      {
        "Time_Start": 318.64,
        "Time_End": 324.24,
        "Text": " We can also see in the Windows settings app that OneDrive is really being promoted as"
      },
      {
        "Time_Start": 324.24,
        "Time_End": 329.44,
        "Text": " some sort of an anti-ransomware tool, as we can see that in the ransomware data recovery"
      },
      {
        "Time_Start": 329.44,
        "Time_End": 335.56,
        "Text": " section in the settings, OneDrive is being referred, and in order to protect your PC"
      },
      {
        "Time_Start": 335.56,
        "Time_End": 341.12,
        "Text": " from ransomware, Microsoft recommends to store your important files on OneDrive, and this"
      },
      {
        "Time_Start": 341.12,
        "Time_End": 346.4,
        "Text": " way you will also have built-in ransomware detection and recovery, or at least this is"
      },
      {
        "Time_Start": 346.4,
        "Time_End": 349.12,
        "Text": " what they claim."
      },
      {
        "Time_Start": 349.12,
        "Time_End": 356.36,
        "Text": " And just to clarify what we're really trying to do here, so instead of like any other normal"
      },
      {
        "Time_Start": 356.36,
        "Time_End": 363.36,
        "Text": " ransomware that usually first achieves initial access and then just starting to do a bunch"
      },
      {
        "Time_Start": 363.36,
        "Time_End": 369.64,
        "Text": " of malicious operations, with of course the most popular one for ransomware being opening"
      },
      {
        "Time_Start": 369.64,
        "Time_End": 373.76,
        "Text": " and encrypting a lot of files, what we're trying to do is that after we got initial"
      },
      {
        "Time_Start": 373.76,
        "Time_End": 380.68,
        "Text": " access to a computer, we want to somehow conquer OneDrive and Google Drive, so they will do"
      },
      {
        "Time_Start": 380.68,
        "Time_End": 387.28000000000003,
        "Text": " all the dirty work for us while it will be considered legitimate."
      },
      {
        "Time_Start": 387.28000000000003,
        "Time_End": 392.96000000000004,
        "Text": " But at this point, I still had one problem, and that is that as far as I knew, OneDrive"
      },
      {
        "Time_Start": 392.96000000000004,
        "Time_End": 399.46000000000004,
        "Text": " and Google Drive were meant to synchronize only files inside the G drive and the OneDrive"
      },
      {
        "Time_Start": 399.46000000000004,
        "Time_End": 405.64,
        "Text": " sync folder that they create, and in order to really run a ransomware on local files"
      },
      {
        "Time_Start": 405.64,
        "Time_End": 411.84,
        "Text": " on the computer, I needed them to synchronize more local folders on the computer, and I"
      },
      {
        "Time_Start": 411.84,
        "Time_End": 414.68,
        "Text": " had no idea if it's possible."
      },
      {
        "Time_Start": 414.68,
        "Time_End": 419.97999999999996,
        "Text": " Also I had no idea if it's possible to perform this without me touching these targeted files"
      },
      {
        "Time_Start": 419.97999999999996,
        "Time_End": 426.68,
        "Text": " and creating a relation between me and them, and I had no idea if it would be considered"
      },
      {
        "Time_Start": 426.68,
        "Time_End": 428.62,
        "Text": " a legitimate operation."
      },
      {
        "Time_Start": 428.62,
        "Time_End": 430.15999999999997,
        "Text": " So I had to check."
      },
      {
        "Time_Start": 430.15999999999997,
        "Time_End": 435.12,
        "Text": " Now looking at Google Drive, Google Drive has such a built-in feature, you can go into"
      },
      {
        "Time_Start": 435.12,
        "Time_End": 441.12,
        "Text": " Google Drive settings and add another folder to continuously synchronize another local"
      },
      {
        "Time_Start": 441.12,
        "Time_End": 446.76,
        "Text": " folder on your computer, which is completely unrelated to the G drive, but of course I"
      },
      {
        "Time_Start": 446.76,
        "Time_End": 453.24,
        "Text": " needed to do that programmatically, so I found that Google Drive has a settings database"
      },
      {
        "Time_Start": 453.24,
        "Time_End": 458.32,
        "Text": " in the local app data folder, meaning in the current user's folder, so it's also writable"
      },
      {
        "Time_Start": 458.32,
        "Time_End": 463.72,
        "Text": " with the current user's permissions, and by just adding a simple row to this database,"
      },
      {
        "Time_Start": 463.72,
        "Time_End": 469.28000000000003,
        "Text": " you can make Google Drive on the next time that it restarts to synchronize whichever"
      },
      {
        "Time_Start": 469.28000000000003,
        "Time_End": 473.32000000000005,
        "Text": " local directory that you want on the computer."
      },
      {
        "Time_Start": 473.32000000000005,
        "Time_End": 479.64000000000004,
        "Text": " Now looking at OneDrive and how we can synchronize other local directories, Microsoft recommend"
      },
      {
        "Time_Start": 479.64000000000004,
        "Time_End": 484.84000000000003,
        "Text": " to use symbolic links that you create inside the OneDrive sync folder, and you point them"
      },
      {
        "Time_Start": 484.84000000000003,
        "Time_End": 489.24,
        "Text": " towards the target directories that you want to synchronize."
      },
      {
        "Time_Start": 489.24,
        "Time_End": 495.68,
        "Text": " Now symbolic links unfortunately require special permissions, which only administrators"
      },
      {
        "Time_Start": 495.68,
        "Time_End": 502.52,
        "Text": " have by default, and so for this purpose they just use junctions, which work very similarly"
      },
      {
        "Time_Start": 502.52,
        "Time_End": 508.2,
        "Text": " to symbolic links, however they just do not require any special permissions, so they can"
      },
      {
        "Time_Start": 508.2,
        "Time_End": 513.96,
        "Text": " be created just with the current user's permissions, and they are also the most popular recommended"
      },
      {
        "Time_Start": 513.96,
        "Time_End": 519.5600000000001,
        "Text": " way online that people recommend to synchronize more local paths, so they are also considered"
      },
      {
        "Time_Start": 519.5600000000001,
        "Time_End": 521.88,
        "Text": " legitimate."
      },
      {
        "Time_Start": 521.88,
        "Time_End": 529.4000000000001,
        "Text": " Now by synchronizing other local directories on the computer to the cloud storage services"
      },
      {
        "Time_Start": 529.4000000000001,
        "Time_End": 536.4000000000001,
        "Text": " from the target computer, we are basically creating a situation where Microsoft's and"
      },
      {
        "Time_Start": 536.4399999999999,
        "Time_End": 543.4399999999999,
        "Text": " Google's servers can create, modify, and delete files, local files, on our target computer,"
      },
      {
        "Time_Start": 545.36,
        "Time_End": 550.92,
        "Text": " and the ones to perform the actions would be the local agents, but without noticing"
      },
      {
        "Time_Start": 550.92,
        "Time_End": 557.4,
        "Text": " this sketch becomes very similar to something else that we all know that is called a C2"
      },
      {
        "Time_Start": 557.4,
        "Time_End": 564.4,
        "Text": " server and a malware, so now we identified the right candidates which we want to recruit"
      },
      {
        "Time_Start": 565.4,
        "Time_End": 571.52,
        "Text": " and we made them synchronize more local paths to the cloud storage, but we still need to"
      },
      {
        "Time_Start": 571.52,
        "Time_End": 578.52,
        "Text": " recruit these double agents, just like we can see here, but it wasn't really that easy,"
      },
      {
        "Time_Start": 583.9599999999999,
        "Time_End": 590.76,
        "Text": " but what does it really mean to recruit OneDrive and Google Drive to be our double agent transfer?"
      },
      {
        "Time_Start": 590.76,
        "Time_End": 597.76,
        "Text": " What do we need to actually achieve? In order to recruit them, we need to gain access to"
      },
      {
        "Time_Start": 598.24,
        "Time_End": 603.88,
        "Text": " the currently logged in account on the target computer, we need to get access to its cloud"
      },
      {
        "Time_Start": 603.88,
        "Time_End": 609.04,
        "Text": " storage. This way, if we can change files on the cloud storage, then we'll trigger the"
      },
      {
        "Time_Start": 609.04,
        "Time_End": 615.56,
        "Text": " same changes to happen on the target computer by Google Drive and OneDrive, so once we got"
      },
      {
        "Time_Start": 615.56,
        "Time_End": 620.0,
        "Text": " the initial access, the first option that we have to do is just log out and log into"
      },
      {
        "Time_Start": 620.0,
        "Time_End": 627.0,
        "Text": " a different OneDrive or Google Drive account, but this will be considered a bit noisy and"
      },
      {
        "Time_Start": 631.2,
        "Time_End": 636.16,
        "Text": " detectable to do right on the beginning of the attack before we even manage to encrypt"
      },
      {
        "Time_Start": 636.16,
        "Time_End": 641.4,
        "Text": " a single file, so instead what we can do is to somehow get access to the account which"
      },
      {
        "Time_Start": 641.4,
        "Time_End": 648.4,
        "Text": " is already logged in. We can do that either by stealing the credentials to it or the token,"
      },
      {
        "Time_Start": 649.0,
        "Time_End": 653.9599999999999,
        "Text": " now the credentials will probably not be saved as raw text on the computer itself, but the"
      },
      {
        "Time_Start": 653.9599999999999,
        "Time_End": 660.16,
        "Text": " token must be saved somewhere, so looking at Google Drive, Google Drive basically just"
      },
      {
        "Time_Start": 660.16,
        "Time_End": 667.16,
        "Text": " simply saves its token in the current user's credential set, so we can just call the cred"
      },
      {
        "Time_Start": 667.4399999999999,
        "Time_End": 673.0799999999999,
        "Text": " read API call in order to retrieve this token with the current user's permissions, most"
      },
      {
        "Time_Start": 673.2,
        "Time_End": 680.2,
        "Text": " surprisingly, none of the EDRs that I tested this against detected the cred read API call"
      },
      {
        "Time_Start": 681.44,
        "Time_End": 688.44,
        "Text": " and they do not consider it as malicious, so this was successfully achieved without"
      },
      {
        "Time_Start": 689.44,
        "Time_End": 695.9200000000001,
        "Text": " a detection, now looking at OneDrive, OneDrive is really eager to become a double agent,"
      },
      {
        "Time_Start": 695.9200000000001,
        "Time_End": 702.76,
        "Text": " OneDrive was just so informative that it just wrote its token in its logs, so basically"
      },
      {
        "Time_Start": 702.76,
        "Time_End": 707.8,
        "Text": " OneDrive's logs are called ODLs and they are stored in the current user directory in"
      },
      {
        "Time_Start": 707.8,
        "Time_End": 714.8,
        "Text": " the local app data directory, they are not saved as raw text but they can be easily parsed"
      },
      {
        "Time_Start": 715.52,
        "Time_End": 721.64,
        "Text": " using a script I found on GitHub and after successfully parsing the logs, you can see"
      },
      {
        "Time_Start": 721.64,
        "Time_End": 727.88,
        "Text": " that the token is just written inside in plain text and copying the token and adding the"
      },
      {
        "Time_Start": 728.0,
        "Time_End": 735.0,
        "Text": " prefix WLID 1.1 T equals to an authorisation header just allowed me to perform any API"
      },
      {
        "Time_Start": 738.08,
        "Time_End": 744.28,
        "Text": " request that I wanted against the currently logged in account on the computer, so what"
      },
      {
        "Time_Start": 744.28,
        "Time_End": 749.84,
        "Text": " does it mean? What does it mean that we can so easily steal Google Drives and OneDrives"
      },
      {
        "Time_Start": 749.84,
        "Time_End": 756.4,
        "Text": " token from the computer with just the current user permissions, basically any unprivileged"
      },
      {
        "Time_Start": 756.4,
        "Time_End": 763.4,
        "Text": " process on the computer can just have full access to your Google Drive and OneDrive account"
      },
      {
        "Time_Start": 763.48,
        "Time_End": 769.56,
        "Text": " if it's just running on your computer, so any executable that is running on your computer"
      },
      {
        "Time_Start": 769.56,
        "Time_End": 776.56,
        "Text": " by default you should assume that it can have this access. And now after we stole the token,"
      },
      {
        "Time_Start": 779.1999999999999,
        "Time_End": 785.4,
        "Text": " we already have a beginning to our double drive attack flow, looking at OneDrive it"
      },
      {
        "Time_Start": 785.4,
        "Time_End": 790.72,
        "Text": " starts with initial access just like any other normal ransomware but instead of starting"
      },
      {
        "Time_Start": 790.72,
        "Time_End": 795.9599999999999,
        "Text": " to encrypt files, what we do is just two very simple operations, we create junctions in"
      },
      {
        "Time_Start": 795.9599999999999,
        "Time_End": 799.72,
        "Text": " the OneDrive sink folder, point them to our target directories with the files that we"
      },
      {
        "Time_Start": 799.72,
        "Time_End": 806.6,
        "Text": " want to encrypt, the files are then synchronised to the cloud, we then just read logs and by"
      },
      {
        "Time_Start": 806.6,
        "Time_End": 811.56,
        "Text": " the time we read the logs, we find the token inside which we can already use to start encrypting"
      },
      {
        "Time_Start": 811.5600000000001,
        "Time_End": 818.5600000000001,
        "Text": " files on the cloud which will trigger the same changes on local machine. Now with OneDrive"
      },
      {
        "Time_Start": 819.0400000000001,
        "Time_End": 825.36,
        "Text": " it's pretty much the same as we already know, initial access and then just single row addition"
      },
      {
        "Time_Start": 825.36,
        "Time_End": 831.0000000000001,
        "Text": " to the settings database and a single API call to fetch the token and we are then in"
      },
      {
        "Time_Start": 831.0000000000001,
        "Time_End": 838.0000000000001,
        "Text": " the same situation. But this was not enough for me, as what I wanted to achieve is that"
      },
      {
        "Time_Start": 838.92,
        "Time_End": 845.88,
        "Text": " double drive will run on the target computer like some sort of a ghost. I wanted to run"
      },
      {
        "Time_Start": 845.88,
        "Time_End": 852.88,
        "Text": " it remotely. So in order to do that I had to exfiltrate the token from the target machine"
      },
      {
        "Time_Start": 853.52,
        "Time_End": 859.8,
        "Text": " but no worries because OneDrive and Google Drive are also excellent exfiltration tools."
      },
      {
        "Time_Start": 859.8,
        "Time_End": 865.44,
        "Text": " All that I needed to do is to upload a file containing the token to the victim's OneDrive"
      },
      {
        "Time_Start": 865.44,
        "Time_End": 871.8800000000001,
        "Text": " or Google Drive account which means that I'm not communicating with any C2 server and"
      },
      {
        "Time_Start": 871.8800000000001,
        "Time_End": 877.36,
        "Text": " I'm not communicating even with a OneDrive or Google Drive account that belongs to me"
      },
      {
        "Time_Start": 877.36,
        "Time_End": 883.6,
        "Text": " as the attacker but I'm communicating with the victim's account which is a legitimate"
      },
      {
        "Time_Start": 883.6,
        "Time_End": 890.6,
        "Text": " operation. Now after uploading the file I'm just using the built-in sharing feature in"
      },
      {
        "Time_Start": 891.12,
        "Time_End": 897.28,
        "Text": " OneDrive and Google Drive to share the file with the token with temporary email address"
      },
      {
        "Time_Start": 897.28,
        "Time_End": 903.28,
        "Text": " that belongs to me, the attacker, I receive it and then I can use the token. One single"
      },
      {
        "Time_Start": 903.28,
        "Time_End": 910.28,
        "Text": " small downside about this flow with OneDrive was that I could only share a file with an"
      },
      {
        "Time_Start": 911.48,
        "Time_End": 916.8000000000001,
        "Text": " email address that is linked to a Microsoft account. So using the OneDrive flow an attacker"
      },
      {
        "Time_Start": 916.84,
        "Time_End": 923.84,
        "Text": " would have to first create a Microsoft account which is a bit less ideal but we'll get back"
      },
      {
        "Time_Start": 924.1600000000001,
        "Time_End": 931.1600000000001,
        "Text": " to that later as well. So we got the access that we were aiming for to the cloud storage"
      },
      {
        "Time_Start": 933.5200000000001,
        "Time_End": 940.5200000000001,
        "Text": " of the already logged in account on the victim computer. So by achieving this access we already"
      },
      {
        "Time_Start": 941.4,
        "Time_End": 948.12,
        "Text": " have an extremely innovative, never seen before, cloud-based ransomware attack flow that practically"
      },
      {
        "Time_Start": 948.12,
        "Time_End": 954.88,
        "Text": " acts like a ghost on the target computer because all file encryption is done by OneDrive or"
      },
      {
        "Time_Start": 954.88,
        "Time_End": 960.4,
        "Text": " Google Drive which are considered to be very legitimate processes. So let's recap this"
      },
      {
        "Time_Start": 960.4,
        "Time_End": 967.4,
        "Text": " whole attack flow at this point. So we start again with initial access like any other ransomware."
      },
      {
        "Time_Start": 968.4,
        "Time_End": 975.4,
        "Text": " We then follow with two very simple operations which are the synchronization of other local"
      },
      {
        "Time_Start": 976.48,
        "Time_End": 982.1999999999999,
        "Text": " directories that we target for encryption. We then steal the token. By the time we stole"
      },
      {
        "Time_Start": 982.1999999999999,
        "Time_End": 988.24,
        "Text": " the token we do not need to perform any more operations on the OS because we got the token"
      },
      {
        "Time_Start": 988.24,
        "Time_End": 993.6,
        "Text": " we just need to exfiltrate it so we upload it to the victim's account, share it with"
      },
      {
        "Time_Start": 993.6,
        "Time_End": 999.44,
        "Text": " a temporary email address that belongs to the attacker and the attacker can start encrypting"
      },
      {
        "Time_Start": 999.44,
        "Time_End": 1006.44,
        "Text": " the files. However, as part of this attack flow, the target files are being uploaded"
      },
      {
        "Time_Start": 1008.2,
        "Time_End": 1015.2,
        "Text": " to OneDrive and Google Drive and these services do have file recovery features which we still"
      },
      {
        "Time_Start": 1015.44,
        "Time_End": 1020.12,
        "Text": " need to deal with because we don't want the victim to be able to recover the files from"
      },
      {
        "Time_Start": 1020.12,
        "Time_End": 1027.12,
        "Text": " there. So let's take a look at Google Drive first. Google Drive has a trash folder and"
      },
      {
        "Time_Start": 1028.56,
        "Time_End": 1034.72,
        "Text": " the default option in the UI is to move a file to the trash folder, not to delete it."
      },
      {
        "Time_Start": 1034.72,
        "Time_End": 1041.72,
        "Text": " In addition, each file has its 100 previous versions so if we encrypt files in Google"
      },
      {
        "Time_Start": 1042.68,
        "Time_End": 1046.88,
        "Text": " Drive the victim can potentially recover the previous versions from there so we want to"
      },
      {
        "Time_Start": 1046.88,
        "Time_End": 1053.88,
        "Text": " get rid of them. However, Google Drive also has an API for permanent deletion so with"
      },
      {
        "Time_Start": 1054.44,
        "Time_End": 1061.44,
        "Text": " a single HTTP request we can just delete files permanently without going through the trash"
      },
      {
        "Time_Start": 1062.64,
        "Time_End": 1069.64,
        "Text": " folder which will also delete their version history and then this is how we get rid of"
      },
      {
        "Time_Start": 1070.64,
        "Time_End": 1077.64,
        "Text": " the version history. So the only conclusion that an attacker can have based on this fact"
      },
      {
        "Time_Start": 1077.92,
        "Time_End": 1083.2800000000002,
        "Text": " is that after finishing to encrypt the files, the attacker also must delete the target files"
      },
      {
        "Time_Start": 1083.2800000000002,
        "Time_End": 1089.3600000000001,
        "Text": " that were encrypted and then create them back encrypted again in their original locations."
      },
      {
        "Time_Start": 1089.3600000000001,
        "Time_End": 1096.3600000000001,
        "Text": " Now I know that it may look like the first stage can be just skipped so we can start"
      },
      {
        "Time_Start": 1096.6000000000001,
        "Time_End": 1103.48,
        "Text": " just deleting the files first and create their encrypted versions. However, if we do that"
      },
      {
        "Time_Start": 1103.48,
        "Time_End": 1110.1200000000001,
        "Text": " then the local agents on the computer that we are targeting will start by deleting the"
      },
      {
        "Time_Start": 1110.1200000000001,
        "Time_End": 1116.92,
        "Text": " files and when we delete files we don't actually delete the content itself of the files but"
      },
      {
        "Time_Start": 1116.92,
        "Time_End": 1122.4,
        "Text": " we just delete the pointer to it. So basically if we start with the deletion stage, the contents"
      },
      {
        "Time_Start": 1122.4,
        "Time_End": 1128.88,
        "Text": " of the files that we want to encrypt will still be left unpointed on the hard drive"
      },
      {
        "Time_Start": 1128.88,
        "Time_End": 1133.76,
        "Text": " and then some recovery tools will be able to recover them and we want to prevent that."
      },
      {
        "Time_Start": 1133.76,
        "Time_End": 1138.72,
        "Text": " So we want to start by overriding the files and by this we can make sure that we are really"
      },
      {
        "Time_Start": 1138.72,
        "Time_End": 1145.72,
        "Text": " getting rid of the original content. Now looking at OneDrive, OneDrive has two primary file"
      },
      {
        "Time_Start": 1146.72,
        "Time_End": 1152.92,
        "Text": " recovery features which are file versioning and the recycle bin. We can also see that"
      },
      {
        "Time_Start": 1152.92,
        "Time_End": 1158.64,
        "Text": " these features are promoted as kind of security features against ransomware and the recycle"
      },
      {
        "Time_Start": 1158.64,
        "Time_End": 1165.32,
        "Text": " bin is pretty much self-explanatory but the file versioning features saves the 500 previous"
      },
      {
        "Time_Start": 1165.32,
        "Time_End": 1171.72,
        "Text": " versions of each file that was uploaded to OneDrive. In addition, there is no permanent"
      },
      {
        "Time_Start": 1171.76,
        "Time_End": 1177.3600000000001,
        "Text": " deletion so we cannot just delete a file to get rid of the version history and previous"
      },
      {
        "Time_Start": 1177.3600000000001,
        "Time_End": 1183.32,
        "Text": " versions are kept even if we delete the file to the recycle bin and then restore it. So"
      },
      {
        "Time_Start": 1183.32,
        "Time_End": 1188.8,
        "Text": " based on these facts, the only option that we have as attackers is to first encrypt the"
      },
      {
        "Time_Start": 1188.8,
        "Time_End": 1194.1200000000001,
        "Text": " files after we've done that, we delete the files, then we also need to empty the recycle"
      },
      {
        "Time_Start": 1194.1200000000001,
        "Time_End": 1199.48,
        "Text": " bin to get rid of the version history and then only create the encrypted files again."
      },
      {
        "Time_Start": 1200.08,
        "Time_End": 1206.2,
        "Text": " However, I was not very optimistic about having success in emptying the recycle bin. That"
      },
      {
        "Time_Start": 1206.2,
        "Time_End": 1212.0,
        "Text": " is because as you saw, it is promoted as kind of a security feature against ransomware so"
      },
      {
        "Time_Start": 1212.0,
        "Time_End": 1217.4,
        "Text": " it wouldn't make sense that an attacker that had the option to delete files in the first"
      },
      {
        "Time_Start": 1217.4,
        "Time_End": 1223.8,
        "Text": " place will also have the option to just disable the security feature that is meant to help"
      },
      {
        "Time_Start": 1223.8,
        "Time_End": 1229.6399999999999,
        "Text": " victims to recover those files and just empty the recycle bin. But I still tried my luck."
      },
      {
        "Time_Start": 1229.6399999999999,
        "Time_End": 1235.44,
        "Text": " So I started by just accessing the recycle bin from the OneDrive Windows app which just"
      },
      {
        "Time_Start": 1235.44,
        "Time_End": 1241.6399999999999,
        "Text": " opened the browser and then clicking to empty the recycle bin in the browser actually did"
      },
      {
        "Time_Start": 1241.6399999999999,
        "Time_End": 1248.6399999999999,
        "Text": " send a very different HTTP request than all other HTTP requests that I saw so far. It"
      },
      {
        "Time_Start": 1248.64,
        "Time_End": 1254.96,
        "Text": " was sent to a different domain, it used kind of a different path after the domain and instead"
      },
      {
        "Time_Start": 1254.96,
        "Time_End": 1260.8400000000001,
        "Text": " of using the authorization header, it used two other headers called cannery and app ID."
      },
      {
        "Time_Start": 1260.8400000000001,
        "Time_End": 1266.16,
        "Text": " Now app ID stayed constant between all requests but cannery kept changing so I had to trace"
      },
      {
        "Time_Start": 1266.16,
        "Time_End": 1272.4,
        "Text": " back its origin. Now the cannery was given in the HTML page of the recycle bin and it"
      },
      {
        "Time_Start": 1272.4,
        "Time_End": 1279.6000000000001,
        "Text": " was given in that page only if the recycle bin's web page was accessed with a cookie"
      },
      {
        "Time_Start": 1279.6000000000001,
        "Time_End": 1289.3200000000002,
        "Text": " that is called WLSSC which probably identifies a Microsoft account session. So I was kind"
      },
      {
        "Time_Start": 1289.3200000000002,
        "Time_End": 1295.0,
        "Text": " of stuck because all I had was the token that I was able to steal from the logs and I really"
      },
      {
        "Time_Start": 1295.0,
        "Time_End": 1301.2,
        "Text": " didn't want to steal the WLSSC cookie from the browser's cookie files because this is"
      },
      {
        "Time_Start": 1301.2,
        "Time_End": 1309.1200000000001,
        "Text": " considered to be a highly detectable and malicious operation. So I gave it some thought"
      },
      {
        "Time_Start": 1309.1200000000001,
        "Time_End": 1316.0800000000002,
        "Text": " and then I realized that OneDrive has other UIs as well, other interfaces and as far as"
      },
      {
        "Time_Start": 1316.0800000000002,
        "Time_End": 1325.32,
        "Text": " I knew, mobile apps do not tend to use cookies as part of their API and in addition it would"
      },
      {
        "Time_Start": 1325.32,
        "Time_End": 1331.0,
        "Text": " be considered a very poor experience, for example, for the Android native app to open"
      },
      {
        "Time_Start": 1331.0,
        "Time_End": 1337.32,
        "Text": " a web view or a web browser to access the recycle bin. And so I downloaded the OneDrive"
      },
      {
        "Time_Start": 1337.32,
        "Time_End": 1343.28,
        "Text": " app and I saw that I can really empty the recycle bin natively from the app itself."
      },
      {
        "Time_Start": 1343.28,
        "Time_End": 1347.8799999999999,
        "Text": " So this really increased my suspicion that there's probably some sort of a different"
      },
      {
        "Time_Start": 1347.88,
        "Time_End": 1355.24,
        "Text": " API that does not use cookies in the Android app. So I sniffed the HTTP request and I saw"
      },
      {
        "Time_Start": 1355.24,
        "Time_End": 1362.8000000000002,
        "Text": " that I was actually right. The HTTP request was very, very similar to the original one"
      },
      {
        "Time_Start": 1362.8000000000002,
        "Time_End": 1368.64,
        "Text": " but was just sent to a different domain. Now instead of using the canary header, it just"
      },
      {
        "Time_Start": 1368.64,
        "Time_End": 1374.3200000000002,
        "Text": " used the same authorization header with the same token that I was able to steal from OneDrive's"
      },
      {
        "Time_Start": 1374.32,
        "Time_End": 1385.04,
        "Text": " logs on Windows. So this means that practically any attacker that had the access to encrypt"
      },
      {
        "Time_Start": 1385.04,
        "Time_End": 1390.6799999999998,
        "Text": " and delete files in the first place can just also empty the recycle bin and prevent any"
      },
      {
        "Time_Start": 1390.6799999999998,
        "Time_End": 1396.6,
        "Text": " option for recovery even though the recycle bin is promoted in such a way that it's claimed"
      },
      {
        "Time_Start": 1396.6,
        "Time_End": 1404.12,
        "Text": " to be a security feature against ransomware. After seeing this, I decided to do some more"
      },
      {
        "Time_Start": 1404.1200000000001,
        "Time_End": 1409.72,
        "Text": " digging in the Android app and I also tried to share a file with a temporary email address"
      },
      {
        "Time_Start": 1409.72,
        "Time_End": 1416.0000000000002,
        "Text": " that is not linked to a Microsoft account. And surprisingly, this also just worked successfully"
      },
      {
        "Time_Start": 1416.0000000000002,
        "Time_End": 1424.24,
        "Text": " without any issues as opposed to how it was in Windows and in the browser. So this just"
      },
      {
        "Time_Start": 1424.24,
        "Time_End": 1430.8400000000001,
        "Text": " allowed me to improve the flow with OneDrive so the attacker will not need to create a"
      },
      {
        "Time_Start": 1430.84,
        "Time_End": 1438.32,
        "Text": " Microsoft account and this makes the attack flow more ideal and a bit stealthier. And"
      },
      {
        "Time_Start": 1438.32,
        "Time_End": 1446.28,
        "Text": " this is the HTTP request to do that with. So we added another stage to our double drive"
      },
      {
        "Time_Start": 1446.28,
        "Time_End": 1452.8799999999999,
        "Text": " attack flow which now also makes sure that the target victim cannot recover any of their"
      },
      {
        "Time_Start": 1452.88,
        "Time_End": 1460.8400000000001,
        "Text": " files using OneDrive's and Google Drive's file recovery features. So we had the entire"
      },
      {
        "Time_Start": 1460.8400000000001,
        "Time_End": 1468.3600000000001,
        "Text": " flow, but I still wanted to verify that there is nothing that can maybe somehow affect or"
      },
      {
        "Time_Start": 1468.3600000000001,
        "Time_End": 1476.6000000000001,
        "Text": " interfere with my double drive flow. So I went through OneDrive settings and I saw that"
      },
      {
        "Time_Start": 1476.6000000000001,
        "Time_End": 1483.2,
        "Text": " there is a setting to send an email notification when OneDrive detects that a lot of files"
      },
      {
        "Time_Start": 1483.2,
        "Time_End": 1490.88,
        "Text": " were deleted at once. So of course, I want to turn off this setting because I'm deleting"
      },
      {
        "Time_Start": 1490.88,
        "Time_End": 1499.8400000000001,
        "Text": " a lot of files at once. So I was not, again, very optimistic about having success with"
      },
      {
        "Time_Start": 1499.8400000000001,
        "Time_End": 1505.96,
        "Text": " doing this because you can assume that this looks like a security feature. This is meant"
      },
      {
        "Time_Start": 1505.96,
        "Time_End": 1513.52,
        "Text": " to alert victims that their files are being deleted. However, looking at the HTTP request"
      },
      {
        "Time_Start": 1513.52,
        "Time_End": 1520.04,
        "Text": " again, I was just able to send a very simple HTTP request with the same token from before"
      },
      {
        "Time_Start": 1520.04,
        "Time_End": 1527.72,
        "Text": " and change mass delete to false. And by that, I'm just asking OneDrive, please do not let"
      },
      {
        "Time_Start": 1527.72,
        "Time_End": 1534.4,
        "Text": " the victim know that I'm deleting a lot of files. But this was actually not the most"
      },
      {
        "Time_Start": 1534.4,
        "Time_End": 1542.0800000000002,
        "Text": " interesting thing about this JSON structure that is sent as part of this HTTP request."
      },
      {
        "Time_Start": 1542.0800000000002,
        "Time_End": 1550.1200000000001,
        "Text": " Another very interesting field was called ransomware detection, which was set to true."
      },
      {
        "Time_Start": 1550.1200000000001,
        "Time_End": 1555.88,
        "Text": " So yeah, if you remember in the beginning of the talk, I mentioned that Microsoft claimed"
      },
      {
        "Time_Start": 1555.88,
        "Time_End": 1561.0800000000002,
        "Text": " to have a built-in ransomware detection and recovery features built into OneDrive. And"
      },
      {
        "Time_Start": 1561.08,
        "Time_End": 1566.8,
        "Text": " in full disclosure, I ran DoubleDrive multiple times against multiple accounts and hundreds"
      },
      {
        "Time_Start": 1566.8,
        "Time_End": 1572.6399999999999,
        "Text": " of files, and I did not witness any some sort of ransomware detection, nor in any interface"
      },
      {
        "Time_Start": 1572.6399999999999,
        "Time_End": 1580.08,
        "Text": " or in email. But of course, as an attacker that runs a ransomware, I still want to change"
      },
      {
        "Time_Start": 1580.08,
        "Time_End": 1586.3999999999999,
        "Text": " a ransomware detection setting to false. So sending the same HTTP request, just change"
      },
      {
        "Time_Start": 1586.4,
        "Time_End": 1592.0800000000002,
        "Text": " ransomware detection to false, and it stayed this way. From Microsoft, after I reported"
      },
      {
        "Time_Start": 1592.0800000000002,
        "Time_End": 1598.0400000000002,
        "Text": " this, I was actually told that this is only the setting for the email notification about"
      },
      {
        "Time_Start": 1598.0400000000002,
        "Time_End": 1604.8400000000001,
        "Text": " the ransomware detection. But this still really doesn't make sense. Why would I have the option"
      },
      {
        "Time_Start": 1604.8400000000001,
        "Time_End": 1611.44,
        "Text": " to ask OneDrive to not let the victim know about a ransomware detection? And moreover,"
      },
      {
        "Time_Start": 1611.44,
        "Time_End": 1617.76,
        "Text": " as I already mentioned, I did not see any ransomware detection in any of the attempts"
      },
      {
        "Time_Start": 1617.76,
        "Time_End": 1626.8400000000001,
        "Text": " running DoubleDrive. This is just like, for instance, suggesting an API from an EDR on"
      },
      {
        "Time_Start": 1626.8400000000001,
        "Time_End": 1632.6000000000001,
        "Text": " a computer to offer all unprivileged process on the computer to turn off notifications"
      },
      {
        "Time_Start": 1632.6000000000001,
        "Time_End": 1639.56,
        "Text": " about malicious events. Now, speaking of EDRs, let's see how they performed against this"
      },
      {
        "Time_Start": 1639.6,
        "Time_End": 1646.56,
        "Text": " scenario. So none of the EDRs which I tested were able to stop and detect DoubleDrive,"
      },
      {
        "Time_Start": 1646.56,
        "Time_End": 1651.76,
        "Text": " not Defender for Endpoint, not Sentinel 1 XDR, not CrowdStrike Falcon, not Palo Alto"
      },
      {
        "Time_Start": 1651.76,
        "Time_End": 1659.2,
        "Text": " Cortex XDR, and not Cyber Reason. More specifically, talking about some of the features that were"
      },
      {
        "Time_Start": 1659.2,
        "Time_End": 1665.24,
        "Text": " bypassed as part of this attack flow. So one of them is called decoy files detection technique,"
      },
      {
        "Time_Start": 1665.24,
        "Time_End": 1671.8,
        "Text": " if you're not familiar with it. So it's basically a technique where EDRs place a bunch of decoy"
      },
      {
        "Time_Start": 1671.8,
        "Time_End": 1675.84,
        "Text": " files in highly targeted directories on the computer and then they wait to see if there"
      },
      {
        "Time_Start": 1675.84,
        "Time_End": 1683.4,
        "Text": " are any processes that access them and try to tamper with them in many ways. And if they"
      },
      {
        "Time_Start": 1683.4,
        "Time_End": 1687.48,
        "Text": " find such processes, then they consider them as malicious and they try to prevent their"
      },
      {
        "Time_Start": 1687.48,
        "Time_End": 1694.72,
        "Text": " operations. However, encrypting decoy files with OneDrive or Google Drive just raised"
      },
      {
        "Time_Start": 1694.72,
        "Time_End": 1703.04,
        "Text": " no detection even once the decoy files were encrypted because the EDRs whitelisted them"
      },
      {
        "Time_Start": 1703.04,
        "Time_End": 1710.72,
        "Text": " and they just blindly trusted them. They did not think that trusting them can lead to anything"
      },
      {
        "Time_Start": 1710.72,
        "Time_End": 1718.32,
        "Text": " like that. While some other EDRs were running that were also implementing the decoy files"
      },
      {
        "Time_Start": 1718.32,
        "Time_End": 1725.36,
        "Text": " approach, the behavior was kind of different because these EDRs just actively hide the"
      },
      {
        "Time_Start": 1725.36,
        "Time_End": 1730.96,
        "Text": " decoy files from OneDrive and Google Drive. So when they list the directory, the decoy"
      },
      {
        "Time_Start": 1730.96,
        "Time_End": 1737.52,
        "Text": " files are not there because they are trying to avoid false positives. So again, they just"
      },
      {
        "Time_Start": 1737.52,
        "Time_End": 1742.5,
        "Text": " blindly trusted them. They did not imagine that an attacker would be able to use and"
      },
      {
        "Time_Start": 1742.5,
        "Time_End": 1752.9,
        "Text": " leverage this trust. Another detection feature which was bypassed is looking for known ransomware"
      },
      {
        "Time_Start": 1752.9,
        "Time_End": 1762.86,
        "Text": " file extensions. For instance, like .encrypted or .WNY. So basically renaming files after"
      },
      {
        "Time_Start": 1762.86,
        "Time_End": 1769.14,
        "Text": " they were encrypted to such file extensions using OneDrive or Google Drive just did not"
      },
      {
        "Time_Start": 1769.14,
        "Time_End": 1774.6200000000001,
        "Text": " raise a single detection or any notification, not on the computer itself or in the management"
      },
      {
        "Time_Start": 1774.6200000000001,
        "Time_End": 1784.5,
        "Text": " console. And not even when I did this to decoy files. Another ransomware protection feature"
      },
      {
        "Time_Start": 1784.5,
        "Time_End": 1788.38,
        "Text": " that was bypassed is called the controlled folder access feature. So basically it's a"
      },
      {
        "Time_Start": 1788.38,
        "Time_End": 1796.3600000000001,
        "Text": " built-in feature in Windows which prevents any untrusted processes from modifying or"
      },
      {
        "Time_Start": 1796.3600000000001,
        "Time_End": 1802.68,
        "Text": " deleting any files that are located in one of the protected folders. The protected folders"
      },
      {
        "Time_Start": 1802.68,
        "Time_End": 1811.0400000000002,
        "Text": " is a list with some default directories in it from the beginning. And you can also change"
      },
      {
        "Time_Start": 1811.0400000000002,
        "Time_End": 1818.5200000000002,
        "Text": " it by default. It has the user libraries inside, like documents, downloads, not downloads,"
      },
      {
        "Time_Start": 1819.24,
        "Time_End": 1829.48,
        "Text": " folders. And so trying to modify files using OneDrive or Google Drive, files that are located"
      },
      {
        "Time_Start": 1829.48,
        "Time_End": 1836.68,
        "Text": " inside one of the protected folders just happened successfully without any issues as this folder"
      },
      {
        "Time_Start": 1836.68,
        "Time_End": 1843.36,
        "Text": " trusts Google Drive and OneDrive by default. So this is a working bypass for the controlled"
      },
      {
        "Time_Start": 1843.3600000000001,
        "Time_End": 1850.3600000000001,
        "Text": " folder access feature. Lastly, if we're talking about static signature-based detection, so"
      },
      {
        "Time_Start": 1850.3600000000001,
        "Time_End": 1858.96,
        "Text": " there is really no executable, ransomware executable to detect. The executables which"
      },
      {
        "Time_Start": 1858.96,
        "Time_End": 1867.8400000000001,
        "Text": " are most similar to a ransomware are basically OneDrive.exe and Google Drive FS.exe. And"
      },
      {
        "Time_Start": 1867.8400000000001,
        "Time_End": 1873.5200000000002,
        "Text": " now that we know how Double Drive works, we have a demonstration video in here in which"
      },
      {
        "Time_Start": 1873.5200000000002,
        "Time_End": 1881.2400000000002,
        "Text": " we'll see Double Drive in action leveraging OneDrive in order to bypass Palo Alto Cortex"
      },
      {
        "Time_Start": 1881.2400000000002,
        "Time_End": 1888.7200000000003,
        "Text": " XDR. The attempt will be to encrypt the documents folder of the target user. So let's take a"
      },
      {
        "Time_Start": 1888.7200000000003,
        "Time_End": 1895.2800000000002,
        "Text": " look. So we start with configuring Double Drive to use a temporary email and to target"
      },
      {
        "Time_Start": 1895.28,
        "Time_End": 1903.44,
        "Text": " the documents folder. We configure the executable, the executables. We can see that Palo Alto"
      },
      {
        "Time_Start": 1903.44,
        "Time_End": 1908.84,
        "Text": " Cortex XDR is up and running and configured to the most preventive settings and ransomware"
      },
      {
        "Time_Start": 1908.84,
        "Time_End": 1918.2,
        "Text": " protection. Now the executables will be ready. And we'll have an endpoint takeover executable"
      },
      {
        "Time_Start": 1918.2,
        "Time_End": 1924.72,
        "Text": " which performs two very simple actions, creation of junctions in the OneDrive sync folder and"
      },
      {
        "Time_Start": 1924.72,
        "Time_End": 1930.92,
        "Text": " reading logs. Then it uploads the file to the victim's account and exfiltrates the token"
      },
      {
        "Time_Start": 1930.92,
        "Time_End": 1937.56,
        "Text": " using the sharing features. So nothing malicious is happening in here. Two very simple operations."
      },
      {
        "Time_Start": 1937.56,
        "Time_End": 1942.08,
        "Text": " And then we can see that OneDrive is starting to synchronize files. We can see that we have"
      },
      {
        "Time_Start": 1942.08,
        "Time_End": 1951.08,
        "Text": " files in the documents folder. And now the files are starting to be uploaded to the OneDrive"
      },
      {
        "Time_Start": 1951.12,
        "Time_End": 1961.12,
        "Text": " victim's account. And we can see that the one to upload the files was really OneDrive. Okay. Now"
      },
      {
        "Time_Start": 1961.12,
        "Time_End": 1968.76,
        "Text": " we can comfortably run Double Drive as we're no longer running on the target computer. We have"
      },
      {
        "Time_Start": 1968.76,
        "Time_End": 1975.1599999999999,
        "Text": " access to our target files. We can start encrypting our target files. Our encrypted now while we're"
      },
      {
        "Time_Start": 1975.16,
        "Time_End": 1981.76,
        "Text": " not longer running on the computer. OneDrive is the one to encrypt those files. Let's wait for the"
      },
      {
        "Time_Start": 1981.76,
        "Time_End": 1993.1200000000001,
        "Text": " encryption to be done. And let's see what happens then. So I'll give it a few more seconds. And now"
      },
      {
        "Time_Start": 1993.1200000000001,
        "Time_End": 1999.68,
        "Text": " the encryption is done. We delete all the target files from the OneDrive cloud storage. We then"
      },
      {
        "Time_Start": 1999.68,
        "Time_End": 2005.0,
        "Text": " empty the recycle bin. And then we create all the files again in their original locations with"
      },
      {
        "Time_Start": 2005.4,
        "Time_End": 2011.88,
        "Text": " encrypted content. We can see that the recycle bin is empty. No files inside. And if we'll go to the"
      },
      {
        "Time_Start": 2011.88,
        "Time_End": 2020.36,
        "Text": " encrypted files, then we can see that they're all encrypted. And looking at the version history, we"
      },
      {
        "Time_Start": 2020.36,
        "Time_End": 2026.32,
        "Text": " can see only one version, which is the encrypted version. So no option to revert to a previous"
      },
      {
        "Time_Start": 2027.2,
        "Time_End": 2045.32,
        "Text": " unencrypted version. Okay. Thank you. Okay. So we saw we now understand how Double Drive works. We saw"
      },
      {
        "Time_Start": 2045.32,
        "Time_End": 2051.84,
        "Text": " it in action. Let's compare how OneDrive and Google Drive functioned in this scenario. So talking"
      },
      {
        "Time_Start": 2051.84,
        "Time_End": 2058.7200000000003,
        "Text": " about synchronizing more local directories on the computer other than the default one. Looking at"
      },
      {
        "Time_Start": 2058.7200000000003,
        "Time_End": 2064.56,
        "Text": " Google Drive, in order to do that, we needed to change a proprietary settings database, which"
      },
      {
        "Time_Start": 2064.56,
        "Time_End": 2072.1200000000003,
        "Text": " belongs to Google Drive. We could not do that with links. And I would say that this is something that"
      },
      {
        "Time_Start": 2072.1600000000003,
        "Time_End": 2081.1200000000003,
        "Text": " can be potentially detected. You can have the sense that if a third party process that is not linked"
      },
      {
        "Time_Start": 2081.12,
        "Time_End": 2087.44,
        "Text": " in any way to Google Drive accesses and modifies settings database that belongs to Google Drive,"
      },
      {
        "Time_Start": 2087.44,
        "Time_End": 2095.7599999999998,
        "Text": " this is kind of malicious. So this is in practice was not detected. But it would make sense to"
      },
      {
        "Time_Start": 2095.7599999999998,
        "Time_End": 2103.44,
        "Text": " detect it. However, on the other hand, OneDrive, in order to do that, we needed to create links in the"
      },
      {
        "Time_Start": 2103.44,
        "Time_End": 2111.0,
        "Text": " OneDrive sync folder, which is the default legitimate way to do it. So even if you want to detect it, it"
      },
      {
        "Time_Start": 2111.0,
        "Time_End": 2120.2,
        "Text": " wouldn't look different than if a user really intended to do so. And so in this case, Google Drive was a"
      },
      {
        "Time_Start": 2120.2,
        "Time_End": 2128.96,
        "Text": " bit better. Talking about the stealing of the token. So then again, a similar situation where in order to"
      },
      {
        "Time_Start": 2128.96,
        "Time_End": 2134.6,
        "Text": " steal it from Google Drive, we needed to steal it from the current user's credential set, which was not"
      },
      {
        "Time_Start": 2134.6,
        "Time_End": 2143.0,
        "Text": " detected, but again, can potentially be detected as it would make sense to detect such an API call from an"
      },
      {
        "Time_Start": 2143.0,
        "Time_End": 2149.7999999999997,
        "Text": " untrusted process. And comparing to that, in order to steal it from OneDrive, all that we needed to do is just"
      },
      {
        "Time_Start": 2149.7999999999997,
        "Time_End": 2155.72,
        "Text": " read logs, which is again, a completely legitimate operation, which would of course make sense to go"
      },
      {
        "Time_Start": 2155.7599999999998,
        "Time_End": 2164.0,
        "Text": " undetected. By the way, Microsoft did fix this issue after I reported with printing the token into the"
      },
      {
        "Time_Start": 2164.0,
        "Time_End": 2172.36,
        "Text": " logs. And I'm talking about file recovery prevention. So Google Drive does not really try to do anything"
      },
      {
        "Time_Start": 2172.4,
        "Time_End": 2179.04,
        "Text": " against it. It actually offers the permanent deletion API. So this is regarding Google Drive. With Google"
      },
      {
        "Time_Start": 2179.04,
        "Time_End": 2187.24,
        "Text": " Drive, it was pretty easy. But in OneDrive, they do not offer any permanent deletion API. They"
      },
      {
        "Time_Start": 2187.28,
        "Time_End": 2193.5200000000004,
        "Text": " differentiate the API of the Recycle Bin, and they consider the Recycle Bin as kind of our security"
      },
      {
        "Time_Start": 2193.5200000000004,
        "Time_End": 2202.6000000000004,
        "Text": " feature. However, in practice, we see that it didn't really matter. Lastly, talking about ransomware"
      },
      {
        "Time_Start": 2202.6000000000004,
        "Time_End": 2211.0000000000005,
        "Text": " awareness in general, comparing these two products. So I would say that I felt like Google Drive doesn't"
      },
      {
        "Time_Start": 2211.04,
        "Time_End": 2221.08,
        "Text": " really try to protect against ransomware. It just acts and is promoted like a normal cloud storage service."
      },
      {
        "Time_Start": 2221.12,
        "Time_End": 2227.96,
        "Text": " It doesn't try to say that it has any sophisticated security features. As opposed to it, OneDrive is"
      },
      {
        "Time_Start": 2227.96,
        "Time_End": 2236.52,
        "Text": " promoted as an anti-ransomware product that tries to help you protect yourself against ransomware. But"
      },
      {
        "Time_Start": 2236.52,
        "Time_End": 2245.68,
        "Text": " again, in practice, we saw that against this scenario, it doesn't really help in any sort of way. Now, I do"
      },
      {
        "Time_Start": 2245.68,
        "Time_End": 2252.88,
        "Text": " have some vendor responses in here. Let's start with the OneDrive attack flow. So I will start by saying"
      },
      {
        "Time_Start": 2252.88,
        "Time_End": 2259.68,
        "Text": " that MSRC did assist two of the reported cases regarding this flow as an important elevation of"
      },
      {
        "Time_Start": 2259.68,
        "Time_End": 2267.96,
        "Text": " privilege. However, no CV was granted and was just acknowledged in their website. This is their official"
      },
      {
        "Time_Start": 2267.96,
        "Time_End": 2273.72,
        "Text": " response. They did not respond regarding the bypass of Defender for endpoint. But just about the other"
      },
      {
        "Time_Start": 2273.72,
        "Time_End": 2281.96,
        "Text": " things, I won't read the full comment as you'll be able to watch it later in a published presentation."
      },
      {
        "Time_Start": 2282.6,
        "Time_End": 2289.2799999999997,
        "Text": " Regarding all the other EDR vendors overall, I have no complaints. They were very cooperative. They all"
      },
      {
        "Time_Start": 2289.28,
        "Time_End": 2295.88,
        "Text": " developed new detection techniques in order to deal with such ransomware. So I really thank them. They were"
      },
      {
        "Time_Start": 2295.88,
        "Time_End": 2303.2400000000002,
        "Text": " very cooperative. Again, I want to read the official comments. You'll be able to read them yourselves later."
      },
      {
        "Time_Start": 2304.88,
        "Time_End": 2311.2400000000002,
        "Text": " And lastly, unfortunately, from Sentinel One, I was responded that there do not appear to be any security"
      },
      {
        "Time_Start": 2311.2400000000002,
        "Time_End": 2318.44,
        "Text": " implications as a direct result of this behavior. These are the versions that you want to make sure you're updated"
      },
      {
        "Time_Start": 2318.44,
        "Time_End": 2325.16,
        "Text": " to in order to be safe from the DoubleDrive OneDrive attack flow. These are the versions where they inserted"
      },
      {
        "Time_Start": 2325.16,
        "Time_End": 2334.12,
        "Text": " new detection techniques and the OneDrive client version, which do not print the token into the logs. So I'll give"
      },
      {
        "Time_Start": 2334.12,
        "Time_End": 2342.76,
        "Text": " you another moment to take a picture. Okay, and now we have some vendor responses regarding Google Drive. So I"
      },
      {
        "Time_Start": 2342.76,
        "Time_End": 2350.6000000000004,
        "Text": " will say that I did not get all the responses from all the vendors yet. However, I can say that Palo Alto did"
      },
      {
        "Time_Start": 2350.6000000000004,
        "Time_End": 2357.96,
        "Text": " respond that they already developed a new detection technique against the DoubleDrive Google Drive"
      },
      {
        "Time_Start": 2357.96,
        "Time_End": 2364.96,
        "Text": " version. Microsoft, again, did not respond regarding the Defender for Endpoint product. They did respond"
      },
      {
        "Time_Start": 2364.96,
        "Time_End": 2371.1200000000003,
        "Text": " regarding the bypass of the control folder access feature again. They said that it's very creative, but they have"
      },
      {
        "Time_Start": 2371.2799999999997,
        "Time_End": 2378.64,
        "Text": " nothing to do with it. Regarding Sentinel One, I was again answered that there do not appear to be any direct"
      },
      {
        "Time_Start": 2378.64,
        "Time_End": 2387.16,
        "Text": " security implication. Well, that's okay. And now let's summarize everything that we learned here today. And I"
      },
      {
        "Time_Start": 2387.16,
        "Time_End": 2394.7599999999998,
        "Text": " think this is maybe the most important section of the talk. What can we learn from that? So the first and most"
      },
      {
        "Time_Start": 2394.76,
        "Time_End": 2404.2000000000003,
        "Text": " important thing, in my opinion, is that no process should be trusted by default by anything on the computer, even"
      },
      {
        "Time_Start": 2404.2000000000003,
        "Time_End": 2411.76,
        "Text": " if the process has the executable that was developed by Microsoft themselves, the vendor of the operating"
      },
      {
        "Time_Start": 2411.76,
        "Time_End": 2422.1600000000003,
        "Text": " system. If developers feel like they must trust a certain process, then they should at least understand and"
      },
      {
        "Time_Start": 2422.2,
        "Time_End": 2430.68,
        "Text": " think how the trust in this process might be leveraged by attackers and then set up the proper detections for that"
      },
      {
        "Time_Start": 2430.68,
        "Time_End": 2438.0,
        "Text": " and protection techniques. Second, we should really start preparing against the next generation of"
      },
      {
        "Time_Start": 2438.0,
        "Time_End": 2445.96,
        "Text": " ransomware. We all have this conventional thought that a ransomware is an executable that is being run, and then we"
      },
      {
        "Time_Start": 2445.96,
        "Time_End": 2453.0,
        "Text": " have a process, and this process encrypts a lot of files. But this is not necessarily true. Threat actors are"
      },
      {
        "Time_Start": 2453.0,
        "Time_End": 2461.52,
        "Text": " starting to be much more creative. We also have a recent example published by Kaspersky, actually, that shown a"
      },
      {
        "Time_Start": 2461.52,
        "Time_End": 2468.64,
        "Text": " ransomware that encrypts files using BeatLocker, for instance. So the next generation is already here. So we"
      },
      {
        "Time_Start": 2468.64,
        "Time_End": 2474.92,
        "Text": " should start thinking about such creative ways that ransomware attacks might happen and develop the proper"
      },
      {
        "Time_Start": 2475.08,
        "Time_End": 2483.48,
        "Text": " detection techniques. Lastly, we should also invest more in separating access between normal features and security"
      },
      {
        "Time_Start": 2483.48,
        "Time_End": 2490.4,
        "Text": " features, as like we saw, it doesn't make sense to enable an attacker that has the access to delete files in the first"
      },
      {
        "Time_Start": 2490.4,
        "Time_End": 2497.6800000000003,
        "Text": " place to also empty a recycle bin, which is a security feature, and it does not make sense to allow a ransomware to"
      },
      {
        "Time_Start": 2497.68,
        "Time_End": 2507.3999999999996,
        "Text": " disable a setting called ransomware detection. And with this takeaway, we are finished with the talk. We have our QR"
      },
      {
        "Time_Start": 2507.3999999999996,
        "Time_End": 2517.04,
        "Text": " code for the double drive repo in GitHub. And you can have my contact details. You're very welcome to contact me in"
      },
      {
        "Time_Start": 2517.04,
        "Time_End": 2524.3999999999996,
        "Text": " any way that you like. I promise that I'll try to be as responsive as I can. So don't be shy. And this is it."
      },
      {
        "Time_Start": 2527.68,
        "Time_End": 2544.48,
        "Text": " Thank you for the great talk. So I think we have plenty of time for questions. Yeah. Dennis."
      },
      {
        "Time_Start": 2547.7599999999998,
        "Time_End": 2556.44,
        "Text": " Hello, thanks for the great talk. I think I might have missed how you remote encrypted the files. Don't you have to link"
      },
      {
        "Time_Start": 2556.44,
        "Time_End": 2566.92,
        "Text": " the victims Google Drive or OneDrive temporarily to an attacker's endpoint? Or how did you do that? So you you create the"
      },
      {
        "Time_Start": 2566.92,
        "Time_End": 2573.56,
        "Text": " junctions like let's talk for instance about OneDrive. So once you created the junctions in your in the target computer that"
      },
      {
        "Time_Start": 2573.56,
        "Time_End": 2579.6,
        "Text": " you are attacking, so you're running on the target computer, you have your initial access, you're creating the junctions in"
      },
      {
        "Time_Start": 2579.6,
        "Time_End": 2585.72,
        "Text": " the OneDrive scene folder. The files are then uploaded to the cloud. Then from the attacker's computer, which is internet"
      },
      {
        "Time_Start": 2585.72,
        "Time_End": 2595.24,
        "Text": " access, you get the token to your temporary email, and you can send HTTP requests to OneDrive to OneDrive servers, which"
      },
      {
        "Time_Start": 2595.24,
        "Time_End": 2604.52,
        "Text": " practically acts as your C2 server. So you encrypt the files on the cloud. And then it triggers the same changes on the"
      },
      {
        "Time_Start": 2604.52,
        "Time_End": 2614.0,
        "Text": " target computer. So you have an attacker computer, a victim computer, and the C2 server is OneDrive's cloud service servers in"
      },
      {
        "Time_Start": 2614.0,
        "Time_End": 2615.04,
        "Text": " the middle."
      },
      {
        "Time_Start": 2617.24,
        "Time_End": 2621.44,
        "Text": " Okay, but that means I can ask OneDrive to encrypt files."
      },
      {
        "Time_Start": 2622.04,
        "Time_End": 2627.28,
        "Text": " You just modify the files. So you just send a different content, like you go like,"
      },
      {
        "Time_Start": 2628.04,
        "Time_End": 2632.44,
        "Text": " I sent this content from an attacker's endpoint. Yeah. Okay."
      },
      {
        "Time_Start": 2634.52,
        "Time_End": 2638.08,
        "Text": " Any other questions?"
      },
      {
        "Time_Start": 2640.72,
        "Time_End": 2649.7599999999998,
        "Text": " Also, thank you for your great talk. You said Microsoft changed the behavior where to store the token. So not anymore in the"
      },
      {
        "Time_Start": 2649.7599999999998,
        "Time_End": 2652.64,
        "Text": " locks. Do you know where they store it now?"
      },
      {
        "Time_Start": 2653.0,
        "Time_End": 2663.3199999999997,
        "Text": " No, I haven't checked, but I did implement another way to extract the token. So you can basically just perform a full process"
      },
      {
        "Time_Start": 2663.3199999999997,
        "Time_End": 2673.3199999999997,
        "Text": " dump on OneDrive. So EDRs do not stop all process dumps, at least not the ones that I checked. They only stop process dump on"
      },
      {
        "Time_Start": 2673.7200000000003,
        "Time_End": 2683.36,
        "Text": " specific processes such as LSAs, for instance. So you can just perform a process dump. It will go undetected as well. And then you"
      },
      {
        "Time_Start": 2683.36,
        "Time_End": 2693.7200000000003,
        "Text": " just search for regex with WLID 1.1 T equals and you'll find the token. So this is implemented inside the DoubleDrive repo as"
      },
      {
        "Time_Start": 2693.7200000000003,
        "Time_End": 2695.04,
        "Text": " well. Thank you."
      },
      {
        "Time_Start": 2703.6800000000003,
        "Time_End": 2711.32,
        "Text": " Yeah, also from my side, thank you for the great talk. And my question is, in the beginning, you had a slide with different"
      },
      {
        "Time_Start": 2711.36,
        "Time_End": 2723.28,
        "Text": " other cloud storage sync providers, like Dropbox. Did you look into them as well? Or is it ongoing research?"
      },
      {
        "Time_Start": 2723.44,
        "Time_End": 2733.4,
        "Text": " Um, no. So, like, I usually in my research, I tried to make a point, you know, not to develop a full tool, like as best as I can, so"
      },
      {
        "Time_Start": 2733.4,
        "Time_End": 2742.1600000000003,
        "Text": " attackers might use it, and I won't work it for many years until it will be perfected. So I think this makes the point. And it"
      },
      {
        "Time_Start": 2742.6000000000004,
        "Time_End": 2752.7200000000003,
        "Text": " also shows like a bit two different approaches between Google Drive and OneDrive. So no, I did not look at them. But I would"
      },
      {
        "Time_Start": 2752.7200000000003,
        "Time_End": 2761.0400000000004,
        "Text": " assume that like everything that the only thing that you need is just a way to synchronize local paths, more local paths on the"
      },
      {
        "Time_Start": 2761.0400000000004,
        "Time_End": 2772.36,
        "Text": " computer that that on which the cloud storage, cloud storage agent is running. So if you have that, you can implement it, you"
      },
      {
        "Time_Start": 2772.36,
        "Time_End": 2782.96,
        "Text": " just need to reverse engineer the like the web API, the REST API, or any other API that it uses. And then you can, you can run it"
      },
      {
        "Time_Start": 2783.0,
        "Time_End": 2786.1200000000003,
        "Text": " like it's a very small requirement."
      },
      {
        "Time_Start": 2786.88,
        "Time_End": 2798.6,
        "Text": " Okay, thank you. And another question. I'm not that familiar with the agents of OneDrive and Google Drive. But would it be"
      },
      {
        "Time_Start": 2798.68,
        "Time_End": 2809.56,
        "Text": " possible to steal other persons like other user accounts, files from a system? So are they just running with the this one users"
      },
      {
        "Time_Start": 2809.8399999999997,
        "Time_End": 2810.64,
        "Text": " permissions?"
      },
      {
        "Time_Start": 2811.52,
        "Time_End": 2821.0,
        "Text": " Not I don't, I'm not sure that I understood the question. I do mean, if, if, for instance, like Dropbox was, was installed, if I"
      },
      {
        "Time_Start": 2821.0,
        "Time_End": 2825.8399999999997,
        "Text": " would able to steal the user of Dropbox, like,"
      },
      {
        "Time_Start": 2826.44,
        "Time_End": 2836.52,
        "Text": " yeah, I mean, let's say the Google Drive is used by by me on my computer, but there's another user account. Is the agent running with"
      },
      {
        "Time_Start": 2836.56,
        "Time_End": 2839.76,
        "Text": " just to access my files, or would it be possible to?"
      },
      {
        "Time_Start": 2839.8,
        "Time_End": 2846.2000000000003,
        "Text": " No, so this was actually would be considered a vulnerability, since it would be able to access another user. And this research did"
      },
      {
        "Time_Start": 2846.2000000000003,
        "Time_End": 2857.4,
        "Text": " not include vulnerabilities, but just EDR bypasses. And the, like showing the point of this, like innovative attack flow of"
      },
      {
        "Time_Start": 2857.4,
        "Time_End": 2867.6400000000003,
        "Text": " how it will go undetected. No, it would be considered a vulnerability. And you are able to only like create a process dump of"
      },
      {
        "Time_Start": 2867.6400000000003,
        "Time_End": 2875.5600000000004,
        "Text": " processes that run with your permissions in Google Drive and OneDrive run with the current users permissions. So no, you won't be"
      },
      {
        "Time_Start": 2875.56,
        "Time_End": 2883.96,
        "Text": " able to, you need to start with you, you would be able to encrypt files of the user that you've got access to on the computer."
      },
      {
        "Time_Start": 2887.88,
        "Time_End": 2895.7999999999997,
        "Text": " Yes, thank you. Thank you for your talk. You were focusing on the OneDrive personal edition. Do you know if there's any significant"
      },
      {
        "Time_Start": 2895.7999999999997,
        "Time_End": 2902.36,
        "Text": " difference between OneDrive personal and the corporate SharePoint, Azure AD, whatever version?"
      },
      {
        "Time_Start": 2902.6400000000003,
        "Time_End": 2914.44,
        "Text": " Okay, so that's a very good question. And I have a very good answer. So basically, yeah, I focused on the OneDrive personal version. And I"
      },
      {
        "Time_Start": 2914.44,
        "Time_End": 2923.0,
        "Text": " did try to check if the API is similar between the OneDrive personal OneDrive for business. However, there were very different. And I"
      },
      {
        "Time_Start": 2923.0,
        "Time_End": 2934.24,
        "Text": " just, in order to implement it, I needed to like reverse the entire REST API again. And I did not have the time to do that. However, it"
      },
      {
        "Time_Start": 2934.24,
        "Time_End": 2943.52,
        "Text": " doesn't really matter. Why? Because Windows is installed by default with both OneDrive personal and OneDrive for business. And"
      },
      {
        "Time_Start": 2943.52,
        "Time_End": 2951.96,
        "Text": " what we're trying to do here is really not to target the cloud storage of OneDrive, but the local files on the computer would like"
      },
      {
        "Time_Start": 2951.96,
        "Time_End": 2958.76,
        "Text": " this attack is not interested in the files in the cloud. If you got the access already, it would be nice. But we're trying to target the"
      },
      {
        "Time_Start": 2958.76,
        "Time_End": 2968.28,
        "Text": " normal computer to do a local encryption with going undetected. So if OneDrive personal is also installed, even if you're not logged"
      },
      {
        "Time_Start": 2968.28,
        "Time_End": 2977.84,
        "Text": " into it, and you use OneDrive for business, then the attacker can still just log into his own OneDrive personal account and use the"
      },
      {
        "Time_Start": 2977.84,
        "Time_End": 2979.4,
        "Text": " personal account to encrypt the files."
      },
      {
        "Time_Start": 2983.4,
        "Time_End": 2984.44,
        "Text": " More questions."
      },
      {
        "Time_Start": 2984.44,
        "Time_End": 2985.88,
        "Text": " A lot of questions. That's good."
      },
      {
        "Time_Start": 2987.04,
        "Time_End": 2995.36,
        "Text": " Yeah, thanks. Really interesting. You showed in the OneDrive example that you use the Android API or an API intended for the Android"
      },
      {
        "Time_Start": 2995.36,
        "Time_End": 3002.56,
        "Text": " client to complete the exploit. Has Microsoft commented on that? Because actually, you use the token created for PC."
      },
      {
        "Time_Start": 3003.44,
        "Time_End": 3006.0,
        "Text": " I didn't hear you very well. Can you repeat the question?"
      },
      {
        "Time_Start": 3006.4,
        "Time_End": 3015.0,
        "Text": " You abuse the API that was intended for the Android client, and it worked because it took the same token format. Has Microsoft"
      },
      {
        "Time_Start": 3015.0,
        "Time_End": 3018.16,
        "Text": " commented on that, that you essentially exploited?"
      },
      {
        "Time_Start": 3018.32,
        "Time_End": 3021.56,
        "Text": " No, I did report it, but they did not respond."
      },
      {
        "Time_Start": 3022.36,
        "Time_End": 3023.08,
        "Text": " Okay, thanks."
      },
      {
        "Time_Start": 3023.08,
        "Time_End": 3035.2,
        "Text": " Hi, thank you for your talk. So my question would be, what would be the mitigation from a provider like Microsoft, Dropbox, Apple, to fix"
      },
      {
        "Time_Start": 3035.2,
        "Time_End": 3043.96,
        "Text": " this issue for all of the users? Because the mitigations you were showing, you already said, yeah, I already get the token somewhere"
      },
      {
        "Time_Start": 3043.96,
        "Time_End": 3057.28,
        "Text": " Okay, so I will say that I'm not sure if, and I also don't want to say that like, very confidently, but I'm not sure that it's"
      },
      {
        "Time_Start": 3057.28,
        "Time_End": 3087.0,
        "Text": " So I will say that I'm not sure if, and I also don't want to say that like, very confidently, but I'm not sure that it's the developer's job of OneDrive and Google Drive to protect against that, because looking at E-Windows, for instance, leaving cloud storage services aside,"
      },
      {
        "Time_Start": 3087.12,
        "Time_End": 3101.08,
        "Text": " you also have a lot of malicious things that you can do on Windows, for instance, creating process dump on LZAS and getting credentials that you should not be exposed to, but then EDRs prevent this operation."
      },
      {
        "Time_Start": 3102.08,
        "Time_End": 3124.44,
        "Text": " So I guess it's both the job of the developers and EDRs. Now looking at OneDrive, for instance, as I mentioned, like creating links in the OneDrive sync folder, and having the operation legitimate,"
      },
      {
        "Time_Start": 3124.44,
        "Time_End": 3150.44,
        "Text": " both if you do it from like a process on the computer or from the UI, is kind of hard to develop a detection for, but if you look at Google Drive, then if you do not allow links, and you have a proprietary database for this, then it would be really weird for another process to perform operations on it, and then it makes the life of the defenders much easier."
      },
      {
        "Time_Start": 3150.44,
        "Time_End": 3164.44,
        "Text": " In general, I would say that I think it's not the best idea to have a feature that continuously synchronizes some local files from your computer to the cloud and be dependent on that."
      },
      {
        "Time_Start": 3164.44,
        "Time_End": 3181.44,
        "Text": " I guess that the best thing to do would be to not have such features and just have one directory, which is the only one that is being synced, and then if you want to store another file on the cloud, just copy-paste it."
      },
      {
        "Time_Start": 3181.44,
        "Time_End": 3183.44,
        "Text": " Okay, thank you."
      },
      {
        "Time_Start": 3183.44,
        "Time_End": 3184.44,
        "Text": " You're welcome."
      },
      {
        "Time_Start": 3184.44,
        "Time_End": 3191.44,
        "Text": " Okay, if you have any other questions, I'll be here in the conference. Don't be shy, feel free to approach."
      },
      {
        "Time_Start": 3191.44,
        "Time_End": 3194.44,
        "Text": " All right, and with those words, enjoy your meal."
      }
    ]
  }
}