{
  "metadata": {
    "webpage_url": "https://www.youtube.com/watch?v=Gmtwtw1uKss",
    "title": "TROOPERS24: The Red Teamer\u2019s Guide to Deception",
    "description": "Talk by Balthasar Martin, Niklas van Dornick - June 26th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/8fjh87\n\nMore impressions:\nhttps://twitter.com/WEareTROOPERS\nhttps://twitter.com/ERNW_ITSec\nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
    "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
    "duration": 3063,
    "channel": "TROOPERS IT Security Conference",
    "uploader": "TROOPERS IT Security Conference",
    "upload_date": "20240902"
  },
  "segments": {
    "metadata": {
      "webpage_url": "https://www.youtube.com/watch?v=Gmtwtw1uKss",
      "title": "TROOPERS24: The Red Teamer\u2019s Guide to Deception",
      "description": "Talk by Balthasar Martin, Niklas van Dornick - June 26th, 2024 at TROOPERS24 IT security conference in Heidelberg, Germany hosted by @ERNW_ITSec\n\n#TROOPERS24 #ITsecurity \nhttps://troopers.de/troopers24/talks/8fjh87\n\nMore impressions:\nhttps://twitter.com/WEareTROOPERS\nhttps://twitter.com/ERNW_ITSec\nhttps://infosec.exchange/@WEareTROOPERS\nhttps://infosec.exchange/@ERNW https://ernw.de",
      "channel_url": "https://www.youtube.com/channel/UCPY5aUREHmbDO4PtR6AYLfQ",
      "duration": 3063,
      "channel": "TROOPERS IT Security Conference",
      "uploader": "TROOPERS IT Security Conference",
      "upload_date": "20240902"
    },
    "segments": [
      {
        "Time_Start": 0.0,
        "Time_End": 18.2,
        "Text": "This text was transcribed using whisper model: large-v2\n\n Welcome, today we want to talk about our sRLabs deception strategy that we developed to catch"
      },
      {
        "Time_Start": 18.2,
        "Time_End": 25.34,
        "Text": " attackers in your network, a few of our favorite AD honeypots, and then how we built the honeypot"
      },
      {
        "Time_Start": 25.34,
        "Time_End": 31.54,
        "Text": " that didn't exist before but that we always wanted to have to help the defense teams."
      },
      {
        "Time_Start": 31.54,
        "Time_End": 36.22,
        "Text": " My name is Balthazar, I'm leading the red team at sRLabs and I'm here today with my"
      },
      {
        "Time_Start": 36.22,
        "Time_End": 41.86,
        "Text": " colleague Niklas, he's also part of the red team."
      },
      {
        "Time_Start": 41.86,
        "Time_End": 46.66,
        "Text": " What you see here on this screenshot is a root shell on one of the target systems in"
      },
      {
        "Time_Start": 46.66,
        "Time_End": 52.379999999999995,
        "Text": " our recent engagement, and you can also see a mistake that I made."
      },
      {
        "Time_Start": 52.38,
        "Time_End": 57.18,
        "Text": " So I needed a command, I asked my colleague Fabian to send it to me, and I made the mistake"
      },
      {
        "Time_Start": 57.18,
        "Time_End": 62.42,
        "Text": " of copying the command from Microsoft Teams, and despite just selecting the text in the"
      },
      {
        "Time_Start": 62.42,
        "Time_End": 67.7,
        "Text": " middle, somehow it managed to throw in metadata and some line breaks into my clipboard, I"
      },
      {
        "Time_Start": 67.7,
        "Time_End": 71.86,
        "Text": " made the mistake of pasting directly into the terminal."
      },
      {
        "Time_Start": 71.86,
        "Time_End": 75.58,
        "Text": " In the course of this, also throwing the name of my colleague Fabian under the bus, who"
      },
      {
        "Time_Start": 75.58,
        "Time_End": 78.30000000000001,
        "Text": " had nothing to do with this."
      },
      {
        "Time_Start": 78.30000000000001,
        "Time_End": 80.18,
        "Text": " So why do I show you this?"
      },
      {
        "Time_Start": 80.18,
        "Time_End": 84.58000000000001,
        "Text": " As attackers, we are only human and we make mistakes."
      },
      {
        "Time_Start": 84.58000000000001,
        "Time_End": 89.98,
        "Text": " So in most engagements, there are ample opportunity to detect us."
      },
      {
        "Time_Start": 89.98,
        "Time_End": 94.9,
        "Text": " Maybe this to detect is not so easy, but there are a lot of other options as well."
      },
      {
        "Time_Start": 94.9,
        "Time_End": 100.38000000000001,
        "Text": " However, we still end up compromising most target environments."
      },
      {
        "Time_Start": 100.38000000000001,
        "Time_End": 102.5,
        "Text": " Let me give you a few examples."
      },
      {
        "Time_Start": 102.5,
        "Time_End": 108.34,
        "Text": " So one recent engagement was with a telco, we got into the network via code execution"
      },
      {
        "Time_Start": 108.34,
        "Time_End": 115.14,
        "Text": " in an internet exposed system, then found SSH keys, moved around in the Linux environment,"
      },
      {
        "Time_Start": 115.14,
        "Time_End": 121.18,
        "Text": " and finally got some credentials for a production automation user."
      },
      {
        "Time_Start": 121.18,
        "Time_End": 126.18,
        "Text": " With this user, we could achieve all our goals, we could access arbitrary systems, including"
      },
      {
        "Time_Start": 126.18,
        "Time_End": 130.14000000000001,
        "Text": " subscriber data and reading SMS."
      },
      {
        "Time_Start": 130.14000000000001,
        "Time_End": 135.18,
        "Text": " In this case, it was quite hard to catch us because we didn't trigger an alert, partially"
      },
      {
        "Time_Start": 135.18,
        "Time_End": 139.82,
        "Text": " due to a living off the land approach in the Linux environment."
      },
      {
        "Time_Start": 139.82,
        "Time_End": 143.5,
        "Text": " So very hard to catch us."
      },
      {
        "Time_Start": 143.5,
        "Time_End": 146.86,
        "Text": " Second example is a financial company."
      },
      {
        "Time_Start": 146.86,
        "Time_End": 152.58,
        "Text": " We actually sent a few phishing campaigns with malware, but our payload was detected"
      },
      {
        "Time_Start": 152.58,
        "Time_End": 154.66,
        "Text": " and blocked by the EDR."
      },
      {
        "Time_Start": 154.66,
        "Time_End": 159.42000000000002,
        "Text": " However, we found a different way in, and from there did password spraying from the"
      },
      {
        "Time_Start": 159.42000000000002,
        "Time_End": 165.58,
        "Text": " internet, exploited some Java servers to strengthen our foothold."
      },
      {
        "Time_Start": 165.58,
        "Time_End": 171.10000000000002,
        "Text": " Then we abused several AD problems, in the end had some admin for the identity management,"
      },
      {
        "Time_Start": 171.10000000000002,
        "Time_End": 176.86,
        "Text": " and got control of the objective over one of the core banking interfaces."
      },
      {
        "Time_Start": 176.86,
        "Time_End": 180.76000000000002,
        "Text": " So here we actually had the detection in the beginning, however lateral movement and privilege"
      },
      {
        "Time_Start": 180.76000000000002,
        "Time_End": 185.36,
        "Text": " escalation were on under-monitored systems and stayed undetected."
      },
      {
        "Time_Start": 185.36,
        "Time_End": 188.12,
        "Text": " And then last but not least, a manufacturing company."
      },
      {
        "Time_Start": 188.12,
        "Time_End": 193.28,
        "Text": " We started with an assumed breach account, got a bit of a foothold, and then performed"
      },
      {
        "Time_Start": 193.28,
        "Time_End": 198.64000000000001,
        "Text": " quite a few Active Directory attacks, like Kerberosting, configuring delegation, running"
      },
      {
        "Time_Start": 198.64000000000001,
        "Time_End": 200.72000000000003,
        "Text": " Bloodhound, things like this."
      },
      {
        "Time_Start": 200.72000000000003,
        "Time_End": 207.48000000000002,
        "Text": " And several were detected, but the investigation did not reveal our original accounts, our"
      },
      {
        "Time_Start": 207.48000000000002,
        "Time_End": 208.48000000000002,
        "Text": " foothold."
      },
      {
        "Time_Start": 208.48000000000002,
        "Time_End": 212.88000000000002,
        "Text": " So even though there were a few alerts, some were even dismissed, and others weren't enough"
      },
      {
        "Time_Start": 212.88,
        "Time_End": 217.04,
        "Text": " to kick us out of the network."
      },
      {
        "Time_Start": 217.04,
        "Time_End": 219.24,
        "Text": " So what do we learn from this?"
      },
      {
        "Time_Start": 219.24,
        "Time_End": 226.07999999999998,
        "Text": " So if we look at an attack over time, the deeper an attack goes into network, of course"
      },
      {
        "Time_Start": 226.07999999999998,
        "Time_End": 228.18,
        "Text": " the more effort it becomes."
      },
      {
        "Time_Start": 228.18,
        "Time_End": 233.96,
        "Text": " At the same time, most attacks fail early, and only a few make it through to the end."
      },
      {
        "Time_Start": 233.96,
        "Time_End": 235.51999999999998,
        "Text": " Now there's two problems."
      },
      {
        "Time_Start": 235.51999999999998,
        "Time_End": 240.64,
        "Text": " Because the effort at the start is not too high, attackers that are really determined"
      },
      {
        "Time_Start": 240.64000000000001,
        "Time_End": 245.64000000000001,
        "Text": " can try again and again until they get in at some point."
      },
      {
        "Time_Start": 245.64000000000001,
        "Time_End": 251.08,
        "Text": " And when they are in, we really see there is a lack of effective detection and response"
      },
      {
        "Time_Start": 251.08,
        "Time_End": 258.2,
        "Text": " for the lateral movement and privilege escalation stages of our Red Team engagements."
      },
      {
        "Time_Start": 258.2,
        "Time_End": 260.12,
        "Text": " Question is, why is that?"
      },
      {
        "Time_Start": 260.12,
        "Time_End": 263.2,
        "Text": " Because SOC is really hard."
      },
      {
        "Time_Start": 263.2,
        "Time_End": 265.92,
        "Text": " First you have the problem of achieving good lock coverage."
      },
      {
        "Time_Start": 265.92,
        "Time_End": 270.92,
        "Text": " You might be able to onboard 80% of the systems rather quickly, but the last 20% are really"
      },
      {
        "Time_Start": 270.92,
        "Time_End": 273.12,
        "Text": " a lot of effort and communication."
      },
      {
        "Time_Start": 273.12,
        "Time_End": 277.66,
        "Text": " So attackers with time can often find this one under-monitored system from where they"
      },
      {
        "Time_Start": 277.66,
        "Time_End": 279.28000000000003,
        "Text": " can operate."
      },
      {
        "Time_Start": 279.28000000000003,
        "Time_End": 284.06,
        "Text": " Second, corporate networks are really complex, and very weird things happen."
      },
      {
        "Time_Start": 284.06,
        "Time_End": 288.88,
        "Text": " So let's say you want to build an alert for a bloodhound LDAP enumeration."
      },
      {
        "Time_Start": 288.88,
        "Time_End": 293.52000000000004,
        "Text": " You might have some legacy tools in the network that regularly dump the full active directory."
      },
      {
        "Time_Start": 293.52,
        "Time_End": 299.08,
        "Text": " So suddenly you get a lot of false positives, and the real bloodhound alert might end up"
      },
      {
        "Time_Start": 299.08,
        "Time_End": 304.12,
        "Text": " not followed up upon, because the volume is just too high to perform an in-depth investigation"
      },
      {
        "Time_Start": 304.12,
        "Time_End": 307.71999999999997,
        "Text": " on all alerts."
      },
      {
        "Time_Start": 307.71999999999997,
        "Time_End": 314.0,
        "Text": " One more is that even if there is investigation, the SOC sometimes does not have the knowledge"
      },
      {
        "Time_Start": 314.0,
        "Time_End": 319.4,
        "Text": " of the specific administrator or the specific domain they're investigating for, and there's"
      },
      {
        "Time_Start": 319.48,
        "Time_End": 325.36,
        "Text": " a lack of communication with the administrators in many cases."
      },
      {
        "Time_Start": 325.36,
        "Time_End": 331.32000000000005,
        "Text": " This can also lead to incorrect classification of alerts."
      },
      {
        "Time_Start": 331.32000000000005,
        "Time_End": 334.48,
        "Text": " And then last but not least, it's often a stressful job."
      },
      {
        "Time_Start": 334.48,
        "Time_End": 336.18000000000006,
        "Text": " People have to work in shifts."
      },
      {
        "Time_Start": 336.18000000000006,
        "Time_End": 341.76000000000005,
        "Text": " So whenever people are trained to be really, really good at it, they often leave for roles"
      },
      {
        "Time_Start": 341.76000000000005,
        "Time_End": 347.82000000000005,
        "Text": " they think are more desirable because of this style of work."
      },
      {
        "Time_Start": 347.82,
        "Time_End": 352.46,
        "Text": " So what does that mean when combined?"
      },
      {
        "Time_Start": 352.46,
        "Time_End": 358.58,
        "Text": " Attackers with time, luck, or skill, however you call it, they can perform attack chains"
      },
      {
        "Time_Start": 358.58,
        "Time_End": 361.5,
        "Text": " that usually just trigger a few alerts."
      },
      {
        "Time_Start": 361.5,
        "Time_End": 366.65999999999997,
        "Text": " And SOCs against the large alert volume are optimized to handle this large volume with"
      },
      {
        "Time_Start": 366.65999999999997,
        "Time_End": 368.9,
        "Text": " okay-ish precision."
      },
      {
        "Time_Start": 368.9,
        "Time_End": 375.65999999999997,
        "Text": " So attack chains that just have a few medium alerts have a realistic chance to get through."
      },
      {
        "Time_Start": 375.66,
        "Time_End": 381.78000000000003,
        "Text": " So we think Blue Team needs some form of a smoke detector for these cases that pass"
      },
      {
        "Time_Start": 381.78000000000003,
        "Time_End": 386.58000000000004,
        "Text": " initial defenses to catch them before they compromise the full domain, to catch them"
      },
      {
        "Time_Start": 386.58000000000004,
        "Time_End": 390.90000000000003,
        "Text": " before the full fire is already burning."
      },
      {
        "Time_Start": 390.90000000000003,
        "Time_End": 398.14000000000004,
        "Text": " And we think for this problem, honeypots are a very underutilized but effective solution."
      },
      {
        "Time_Start": 398.14000000000004,
        "Time_End": 402.70000000000005,
        "Text": " So to be clear, I'm talking about internal honeypots, so not honeypots you put on the"
      },
      {
        "Time_Start": 402.7,
        "Time_End": 408.3,
        "Text": " internet for threat intelligence, but vulnerable systems or traps you place in your internal"
      },
      {
        "Time_Start": 408.3,
        "Time_End": 414.42,
        "Text": " network for attackers to find and then trigger an alert when they try to exploit them."
      },
      {
        "Time_Start": 414.42,
        "Time_End": 419.3,
        "Text": " They are also called canneries or deception technologies sometimes."
      },
      {
        "Time_Start": 419.3,
        "Time_End": 424.18,
        "Text": " Example could be a pair of invalid credentials hidden somewhere and you put an alert on when"
      },
      {
        "Time_Start": 424.18,
        "Time_End": 427.65999999999997,
        "Text": " someone tries to use these credentials."
      },
      {
        "Time_Start": 427.65999999999997,
        "Time_End": 432.5,
        "Text": " We think they are good because if you already have a SIEM, you can place a few honeypots"
      },
      {
        "Time_Start": 432.5,
        "Time_End": 436.5,
        "Text": " in some smart locations and already have quite a nice coverage."
      },
      {
        "Time_Start": 436.5,
        "Time_End": 440.38,
        "Text": " You don't need an extra tool if you have a SIEM and they have a low footprint and not"
      },
      {
        "Time_Start": 440.38,
        "Time_End": 443.26,
        "Text": " too much maintenance."
      },
      {
        "Time_Start": 443.26,
        "Time_End": 448.86,
        "Text": " What's also nice is because they are not used by legitimate users, you usually get a very"
      },
      {
        "Time_Start": 448.86,
        "Time_End": 450.42,
        "Text": " low noise detection."
      },
      {
        "Time_Start": 450.42,
        "Time_End": 454.74,
        "Text": " So if someone is doing something maliciously looking with a honeypot, it's quite likely"
      },
      {
        "Time_Start": 454.74,
        "Time_End": 457.7,
        "Text": " that it's really an attacker."
      },
      {
        "Time_Start": 457.7,
        "Time_End": 462.53999999999996,
        "Text": " And last but not least, they detect for lateral movement and privilege escalation."
      },
      {
        "Time_Start": 462.53999999999996,
        "Time_End": 466.94,
        "Text": " So they detect cases when an attacker is already in your network and it's really urgent to"
      },
      {
        "Time_Start": 466.94,
        "Time_End": 467.94,
        "Text": " do something about it."
      },
      {
        "Time_Start": 467.94,
        "Time_End": 471.53999999999996,
        "Text": " So the alerts have a high relevance."
      },
      {
        "Time_Start": 471.53999999999996,
        "Time_End": 477.02,
        "Text": " That means you can also directly send them to a senior analyst to investigate."
      },
      {
        "Time_Start": 477.02,
        "Time_End": 482.82,
        "Text": " So combining this together, we think that internal honeypots provide effective alerting"
      },
      {
        "Time_Start": 482.82,
        "Time_End": 487.38,
        "Text": " to prevent the worst in cases where attackers make it into your network."
      },
      {
        "Time_Start": 488.06,
        "Time_End": 489.94,
        "Text": " They also have a great cost-benefit ratio."
      },
      {
        "Time_Start": 489.94,
        "Time_End": 497.14,
        "Text": " And even if attackers anticipate their honeypots, they have to be super careful and they will"
      },
      {
        "Time_Start": 497.14,
        "Time_End": 500.54,
        "Text": " start doubting the real vulnerabilities as well."
      },
      {
        "Time_Start": 500.54,
        "Time_End": 504.58,
        "Text": " So even if they don't trigger them, because they're very, very careful, it slows them"
      },
      {
        "Time_Start": 504.58,
        "Time_End": 508.78,
        "Text": " down."
      },
      {
        "Time_Start": 508.78,
        "Time_End": 513.46,
        "Text": " So this is why we think you should implement some deception strategy."
      },
      {
        "Time_Start": 513.5400000000001,
        "Time_End": 519.22,
        "Text": " But before the people here that work for the deception software vendors or in the sales"
      },
      {
        "Time_Start": 519.22,
        "Time_End": 524.02,
        "Text": " department there get too happy, let's look at a case study from a recent test."
      },
      {
        "Time_Start": 524.02,
        "Time_End": 528.62,
        "Text": " We were up against the top-right quadrant deception tool, as I would call it."
      },
      {
        "Time_Start": 528.62,
        "Time_End": 532.86,
        "Text": " It was rolled out on all corporate laptops, placed in canneries, including in the Alsace"
      },
      {
        "Time_Start": 532.86,
        "Time_End": 539.1,
        "Text": " process, and it had a set of different credentials deployed to each laptop."
      },
      {
        "Time_Start": 539.1,
        "Time_End": 544.66,
        "Text": " So not two laptops were looking the same in terms of honeypots."
      },
      {
        "Time_Start": 544.66,
        "Time_End": 548.0600000000001,
        "Text": " This picture here is actually from their website."
      },
      {
        "Time_Start": 548.0600000000001,
        "Time_End": 551.0600000000001,
        "Text": " However, how did it go?"
      },
      {
        "Time_Start": 551.0600000000001,
        "Time_End": 554.1800000000001,
        "Text": " The setup was totally ineffective."
      },
      {
        "Time_Start": 554.1800000000001,
        "Time_End": 558.38,
        "Text": " And the main reason here is the coverage gap."
      },
      {
        "Time_Start": 558.38,
        "Time_End": 563.1,
        "Text": " They were rolled out with a lot of effort to all laptops, but we didn't come in via"
      },
      {
        "Time_Start": 563.1,
        "Time_End": 564.1,
        "Text": " a laptop."
      },
      {
        "Time_Start": 564.1,
        "Time_End": 568.6600000000001,
        "Text": " We got into the network via another infection vector."
      },
      {
        "Time_Start": 568.66,
        "Time_End": 573.9,
        "Text": " But even if we would have ended up on the laptops, putting credentials in the Alsace"
      },
      {
        "Time_Start": 573.9,
        "Time_End": 580.26,
        "Text": " process can sometimes be quite hard to find for attackers, because the laptops where the"
      },
      {
        "Time_Start": 580.26,
        "Time_End": 584.18,
        "Text": " deception solution is rolled out, these are also the laptops where you usually have a"
      },
      {
        "Time_Start": 584.18,
        "Time_End": 589.9399999999999,
        "Text": " strong EDR and where Alsace protections like credential guard might be in place."
      },
      {
        "Time_Start": 589.9399999999999,
        "Time_End": 594.3399999999999,
        "Text": " And so even if an attacker ends up on the laptop, that doesn't necessarily mean they"
      },
      {
        "Time_Start": 594.3399999999999,
        "Time_End": 597.86,
        "Text": " will find these honey tokens."
      },
      {
        "Time_Start": 597.86,
        "Time_End": 604.22,
        "Text": " So overall, the solution was somehow over-engineered with a lot of effort, but at the same time"
      },
      {
        "Time_Start": 604.22,
        "Time_End": 608.1,
        "Text": " not tailored enough to the specific environment."
      },
      {
        "Time_Start": 608.1,
        "Time_End": 612.14,
        "Text": " What we took away from that is that simple and well done often wins."
      },
      {
        "Time_Start": 612.14,
        "Time_End": 617.34,
        "Text": " So you need to make sure your honeypots integrate well in the environment."
      },
      {
        "Time_Start": 617.34,
        "Time_End": 621.82,
        "Text": " And ideally, you also have some admins to support you in the rollout, because they know"
      },
      {
        "Time_Start": 621.82,
        "Time_End": 623.4200000000001,
        "Text": " better how to blend in."
      },
      {
        "Time_Start": 623.42,
        "Time_End": 630.06,
        "Text": " Also, if you are on a budget, you don't need a tool."
      },
      {
        "Time_Start": 630.06,
        "Time_End": 639.6999999999999,
        "Text": " It's nice to have, but you can do quite a nice setup without specific tooling to buy."
      },
      {
        "Time_Start": 639.6999999999999,
        "Time_End": 646.62,
        "Text": " So for how to deploy honeypots in your network, we would like to talk about a few principles"
      },
      {
        "Time_Start": 646.62,
        "Time_End": 648.3399999999999,
        "Text": " that we follow there."
      },
      {
        "Time_Start": 648.3399999999999,
        "Time_End": 650.4599999999999,
        "Text": " First one is discoverability."
      },
      {
        "Time_Start": 650.46,
        "Time_End": 657.22,
        "Text": " So the attacker actually has to see the honeypot to trigger it and to find it."
      },
      {
        "Time_Start": 657.22,
        "Time_End": 659.1800000000001,
        "Text": " Let's say this is the network that you have."
      },
      {
        "Time_Start": 659.1800000000001,
        "Time_End": 661.58,
        "Text": " A node is basically some resource."
      },
      {
        "Time_Start": 661.58,
        "Time_End": 664.7800000000001,
        "Text": " An error means it can attack another resource."
      },
      {
        "Time_Start": 664.7800000000001,
        "Time_End": 666.82,
        "Text": " Question is, where do you place the honeypot?"
      },
      {
        "Time_Start": 666.82,
        "Time_End": 671.5400000000001,
        "Text": " Of course, you place it on the path where most attackers somehow can see it."
      },
      {
        "Time_Start": 671.5400000000001,
        "Time_End": 676.26,
        "Text": " The bubble at the bottom would maybe be honeypots on laptops only."
      },
      {
        "Time_Start": 677.26,
        "Time_End": 682.9399999999999,
        "Text": " Next, even if an attacker sees a honeypot, to make them step into the trap, they have"
      },
      {
        "Time_Start": 682.9399999999999,
        "Time_End": 685.5,
        "Text": " to think they get something out of it."
      },
      {
        "Time_Start": 685.5,
        "Time_End": 691.5,
        "Text": " So it needs to look appealing as if it advances your privileges in some way."
      },
      {
        "Time_Start": 691.5,
        "Time_End": 696.14,
        "Text": " One example here is if your honey users in Active Directory look like basic corporate"
      },
      {
        "Time_Start": 696.14,
        "Time_End": 701.14,
        "Text": " users, as a red team, we can often get these via external password spraying or a lot of"
      },
      {
        "Time_Start": 701.14,
        "Time_End": 702.26,
        "Text": " different ways."
      },
      {
        "Time_Start": 702.26,
        "Time_End": 706.42,
        "Text": " So it's not worth the risk of using these credentials if we find them, if we can get"
      },
      {
        "Time_Start": 706.42,
        "Time_End": 711.18,
        "Text": " similar accounts just from password spraying."
      },
      {
        "Time_Start": 711.18,
        "Time_End": 718.62,
        "Text": " So in this case, we would place the honeypot, of course, on the path to a high-value system."
      },
      {
        "Time_Start": 718.62,
        "Time_End": 719.8199999999999,
        "Text": " Next principle is authenticity."
      },
      {
        "Time_Start": 719.8199999999999,
        "Time_End": 724.54,
        "Text": " Here, you need to make sure your honeypots do not stick out when you place them in the"
      },
      {
        "Time_Start": 724.54,
        "Time_End": 725.54,
        "Text": " environment."
      },
      {
        "Time_Start": 725.54,
        "Time_End": 731.34,
        "Text": " There is a great blog post by Sean Metcalf, who I think is right now in Hall 2."
      },
      {
        "Time_Start": 731.4200000000001,
        "Time_End": 734.7800000000001,
        "Text": " Nicholas will talk about that a bit more later."
      },
      {
        "Time_Start": 734.7800000000001,
        "Time_End": 740.02,
        "Text": " But let me give you one example."
      },
      {
        "Time_Start": 740.02,
        "Time_End": 746.3000000000001,
        "Text": " You have deception solutions quite a bit that place cached credentials to be found on Windows"
      },
      {
        "Time_Start": 746.3000000000001,
        "Time_End": 747.3000000000001,
        "Text": " machines."
      },
      {
        "Time_Start": 747.3000000000001,
        "Time_End": 752.62,
        "Text": " However, there is a registry key that specifies the maximum number of cached credentials that"
      },
      {
        "Time_Start": 752.62,
        "Time_End": 753.82,
        "Text": " are allowed."
      },
      {
        "Time_Start": 753.82,
        "Time_End": 758.6600000000001,
        "Text": " If there are more cached credentials than this number actually specifies, attackers"
      },
      {
        "Time_Start": 758.66,
        "Time_End": 763.54,
        "Text": " can figure out something is fishy."
      },
      {
        "Time_Start": 763.54,
        "Time_End": 770.86,
        "Text": " So here, you would also place the honeypot where it looks the least suspicious."
      },
      {
        "Time_Start": 770.86,
        "Time_End": 772.9,
        "Text": " Maybe one more comment on authenticity."
      },
      {
        "Time_Start": 772.9,
        "Time_End": 775.38,
        "Text": " Don't be too concerned about it."
      },
      {
        "Time_Start": 775.38,
        "Time_End": 778.5,
        "Text": " In the sense of it looks too vulnerable."
      },
      {
        "Time_Start": 778.5,
        "Time_End": 782.8,
        "Text": " With this, I can say attackers are used to seeing something that looks unusually vulnerable."
      },
      {
        "Time_Start": 782.8,
        "Time_End": 785.86,
        "Text": " So also, don't overthink it."
      },
      {
        "Time_Start": 785.86,
        "Time_End": 787.1,
        "Text": " Next one is simple."
      },
      {
        "Time_Start": 787.1,
        "Time_End": 788.1,
        "Text": " Safety aspect."
      },
      {
        "Time_Start": 788.5400000000001,
        "Time_End": 789.5400000000001,
        "Text": " Honeypot shouldn't be exploitable."
      },
      {
        "Time_Start": 789.5400000000001,
        "Time_End": 795.14,
        "Text": " Otherwise, you really introduce new risk into the environment."
      },
      {
        "Time_Start": 795.14,
        "Time_End": 800.46,
        "Text": " Some people recommend placing real credentials in the network and setting the logon hours"
      },
      {
        "Time_Start": 800.46,
        "Time_End": 802.48,
        "Text": " for the account to deny."
      },
      {
        "Time_Start": 802.48,
        "Time_End": 807.02,
        "Text": " We think this can be a little bit risky because someone changes the logon hours without knowing"
      },
      {
        "Time_Start": 807.02,
        "Time_End": 812.22,
        "Text": " the context and suddenly you have a real vulnerability."
      },
      {
        "Time_Start": 812.22,
        "Time_End": 817.0600000000001,
        "Text": " And then last but not least, honeypots are only useful if they have a good signal to"
      },
      {
        "Time_Start": 817.0600000000001,
        "Time_End": 818.3800000000001,
        "Text": " noise ratio."
      },
      {
        "Time_Start": 818.3800000000001,
        "Time_End": 824.62,
        "Text": " So you need to limit false positives and you can consider this in how you set up the honeypot."
      },
      {
        "Time_Start": 824.62,
        "Time_End": 830.5400000000001,
        "Text": " Also, when the alert triggers, you need to have the locks available for an investigation."
      },
      {
        "Time_Start": 830.5400000000001,
        "Time_End": 835.2600000000001,
        "Text": " And let's say you have a honeypot with a credential that you somewhere hide in the network."
      },
      {
        "Time_Start": 835.2600000000001,
        "Time_End": 838.5000000000001,
        "Text": " If someone uses that credential, you need to be able to know the source IP where they"
      },
      {
        "Time_Start": 838.5000000000001,
        "Time_End": 839.7,
        "Text": " are coming from."
      },
      {
        "Time_Start": 839.7,
        "Time_End": 843.6200000000001,
        "Text": " So if you have a gateway somewhere in the network, that can prevent you from actually"
      },
      {
        "Time_Start": 843.62,
        "Time_End": 851.16,
        "Text": " figuring out where the login came from."
      },
      {
        "Time_Start": 851.16,
        "Time_End": 855.62,
        "Text": " So when you follow these steps, you should get to a nice setup."
      },
      {
        "Time_Start": 855.62,
        "Time_End": 858.0600000000001,
        "Text": " The question is how to start."
      },
      {
        "Time_Start": 858.0600000000001,
        "Time_End": 863.78,
        "Text": " For that, we differentiate the different types of internal honeypots in a few categories."
      },
      {
        "Time_Start": 863.78,
        "Time_End": 865.82,
        "Text": " First is honey network services."
      },
      {
        "Time_Start": 865.82,
        "Time_End": 873.32,
        "Text": " So these look like a normal service in the network like SSH or HTTP and they can often"
      },
      {
        "Time_Start": 873.32,
        "Time_End": 877.6800000000001,
        "Text": " be deployed as containers, sometimes even as dedicated hardware devices."
      },
      {
        "Time_Start": 877.6800000000001,
        "Time_End": 883.08,
        "Text": " And they alert when someone tries to use or attack these network services."
      },
      {
        "Time_Start": 883.08,
        "Time_End": 888.9200000000001,
        "Text": " There's also the differentiation between low interaction and high interaction honeypots."
      },
      {
        "Time_Start": 888.9200000000001,
        "Time_End": 893.1600000000001,
        "Text": " High interaction means attackers can explore them a bit more and don't notice so fast it's"
      },
      {
        "Time_Start": 893.1600000000001,
        "Time_End": 896.0400000000001,
        "Text": " a honeypot and you can observe their behavior more."
      },
      {
        "Time_Start": 896.0400000000001,
        "Time_End": 900.6800000000001,
        "Text": " So this is possible with these types of honeypots because you can just give them some shell"
      },
      {
        "Time_Start": 900.6800000000001,
        "Time_End": 906.0400000000001,
        "Text": " when they log in in SSH, change route it, and then they can still look around."
      },
      {
        "Time_Start": 906.0400000000001,
        "Time_End": 907.96,
        "Text": " So that's kind of nice."
      },
      {
        "Time_Start": 907.96,
        "Time_End": 913.1200000000001,
        "Text": " But at the same time, this whole concept of network services, especially in large networks,"
      },
      {
        "Time_Start": 913.1200000000001,
        "Time_End": 915.9200000000001,
        "Text": " is hard to roll out with good coverage."
      },
      {
        "Time_Start": 915.9200000000001,
        "Time_End": 919.84,
        "Text": " Because you might have thousands of network services and then there is one honey service"
      },
      {
        "Time_Start": 919.84,
        "Time_End": 920.96,
        "Text": " in the middle."
      },
      {
        "Time_Start": 920.96,
        "Time_End": 929.0400000000001,
        "Text": " How are attackers going to find specifically this one if they do not scan the full network?"
      },
      {
        "Time_Start": 929.04,
        "Time_End": 933.56,
        "Text": " In this case, we would also recommend honey tokens."
      },
      {
        "Time_Start": 933.56,
        "Time_End": 940.92,
        "Text": " We split them up into honey files and authentication secrets."
      },
      {
        "Time_Start": 940.92,
        "Time_End": 945.52,
        "Text": " Files are, for example, office documents or PDFs you place in your network."
      },
      {
        "Time_Start": 945.52,
        "Time_End": 950.8,
        "Text": " And when you open them, they trigger a DNS request so you know someone opened the file."
      },
      {
        "Time_Start": 950.8,
        "Time_End": 954.92,
        "Text": " They are a bit more prone to false positives because also normal users can find these on"
      },
      {
        "Time_Start": 954.92,
        "Time_End": 958.68,
        "Text": " a file share and open them."
      },
      {
        "Time_Start": 958.6800000000001,
        "Time_End": 960.9200000000001,
        "Text": " The nice thing is the location is very flexible."
      },
      {
        "Time_Start": 960.9200000000001,
        "Time_End": 966.32,
        "Text": " You can place them in your on-premise network, but also in your cloud, on SharePoint, in"
      },
      {
        "Time_Start": 966.32,
        "Time_End": 968.72,
        "Text": " some storage buckets."
      },
      {
        "Time_Start": 968.72,
        "Time_End": 972.96,
        "Text": " But next to the false positives, you also need to make sure that the traceability is"
      },
      {
        "Time_Start": 972.96,
        "Time_End": 973.96,
        "Text": " given."
      },
      {
        "Time_Start": 973.96,
        "Time_End": 976.84,
        "Text": " Let's say you have this document that triggers a DNS request."
      },
      {
        "Time_Start": 976.84,
        "Time_End": 981.96,
        "Text": " The attacker downloads the document, opens it in their network, and you get the DNS request."
      },
      {
        "Time_Start": 981.96,
        "Time_End": 986.08,
        "Text": " Well, then you know that somewhere there's an attacker who got the file, but you need"
      },
      {
        "Time_Start": 986.08,
        "Time_End": 989.72,
        "Text": " to be able to trace back from where in your network they got this file."
      },
      {
        "Time_Start": 989.72,
        "Time_End": 995.72,
        "Text": " So you cannot just take the same file and place it in a lot of different locations."
      },
      {
        "Time_Start": 995.72,
        "Time_End": 999.6,
        "Text": " Very similar here are the authentication secrets."
      },
      {
        "Time_Start": 999.6,
        "Time_End": 1005.44,
        "Text": " Here the advantage is that not only does an attacker have to find them, but also try to"
      },
      {
        "Time_Start": 1005.44,
        "Time_End": 1009.1600000000001,
        "Text": " authenticate, something that normal users probably wouldn't do."
      },
      {
        "Time_Start": 1009.1600000000001,
        "Time_End": 1015.12,
        "Text": " So there is a lower rate of false positives, and you only alert on attempted authentication."
      },
      {
        "Time_Start": 1015.16,
        "Time_End": 1020.72,
        "Text": " This could also be some AWS API token you hide in your source code."
      },
      {
        "Time_Start": 1020.72,
        "Time_End": 1024.72,
        "Text": " They're also quite flexible, have a bit less false positives, but also here you need to"
      },
      {
        "Time_Start": 1024.72,
        "Time_End": 1028.88,
        "Text": " be sure, especially for cloud systems, that you have the traceability if someone uses"
      },
      {
        "Time_Start": 1028.88,
        "Time_End": 1033.0,
        "Text": " that token coming from the internet."
      },
      {
        "Time_Start": 1033.0,
        "Time_End": 1036.48,
        "Text": " And then, last but not least, Active Directory Anipots."
      },
      {
        "Time_Start": 1036.48,
        "Time_End": 1041.16,
        "Text": " So these are AD objects that suggest some worthwhile attack path."
      },
      {
        "Time_Start": 1041.16,
        "Time_End": 1046.6200000000001,
        "Text": " And you need a CM or some monitoring for AD events to actually alert on these."
      },
      {
        "Time_Start": 1046.6200000000001,
        "Time_End": 1052.46,
        "Text": " We also count hiding credentials for Active Directory accounts to this category, instead"
      },
      {
        "Time_Start": 1052.46,
        "Time_End": 1058.2,
        "Text": " of authentication secrets, because in how they work and how you alert on them, they"
      },
      {
        "Time_Start": 1058.2,
        "Time_End": 1060.4,
        "Text": " are quite similar."
      },
      {
        "Time_Start": 1060.4,
        "Time_End": 1064.0400000000002,
        "Text": " More details Niklas will give you in a minute."
      },
      {
        "Time_Start": 1064.0400000000002,
        "Time_End": 1070.96,
        "Text": " They are nice because most attackers optimize their tool set for Active Directory, and a"
      },
      {
        "Time_Start": 1070.96,
        "Time_End": 1075.68,
        "Text": " lot of users can also see Active Directory, so they're easy to find and easy to exploit"
      },
      {
        "Time_Start": 1075.68,
        "Time_End": 1076.68,
        "Text": " for hackers."
      },
      {
        "Time_Start": 1076.68,
        "Time_End": 1081.3600000000001,
        "Text": " However, you might need support from some domain admin, and usually they are quite a"
      },
      {
        "Time_Start": 1081.3600000000001,
        "Time_End": 1085.8400000000001,
        "Text": " bit busy to set these up."
      },
      {
        "Time_Start": 1085.8400000000001,
        "Time_End": 1089.1200000000001,
        "Text": " So in what order would we recommend to deploy them?"
      },
      {
        "Time_Start": 1089.1200000000001,
        "Time_End": 1093.24,
        "Text": " Because they can be quite hard to discover, we would recommend to do the Honey Network"
      },
      {
        "Time_Start": 1093.24,
        "Time_End": 1096.64,
        "Text": " services last."
      },
      {
        "Time_Start": 1096.64,
        "Time_End": 1101.92,
        "Text": " For that, we would say use the authentication secrets, because they can flexibly cover a"
      },
      {
        "Time_Start": 1101.92,
        "Time_End": 1106.92,
        "Text": " lot of different environments together with the Honey files."
      },
      {
        "Time_Start": 1106.92,
        "Time_End": 1109.5200000000002,
        "Text": " And it depends a little bit what your actual architecture is."
      },
      {
        "Time_Start": 1109.5200000000002,
        "Time_End": 1113.64,
        "Text": " If you're more cloud-first, this can be more useful."
      },
      {
        "Time_Start": 1113.64,
        "Time_End": 1118.48,
        "Text": " And here we actually think there are ZAS products where you can set this up with a reasonable"
      },
      {
        "Time_Start": 1118.48,
        "Time_End": 1122.5,
        "Text": " cost and effort."
      },
      {
        "Time_Start": 1122.5,
        "Time_End": 1126.5200000000002,
        "Text": " And then, what we would tell you to start with is Active Directory Anipots."
      },
      {
        "Time_Start": 1126.52,
        "Time_End": 1131.32,
        "Text": " Most attack chains of hackers touch Active Directory at some point, so it's the perfect"
      },
      {
        "Time_Start": 1131.32,
        "Time_End": 1134.02,
        "Text": " location for deception in our view."
      },
      {
        "Time_Start": 1134.02,
        "Time_End": 1136.08,
        "Text": " So let's see what we can do here."
      },
      {
        "Time_Start": 1136.08,
        "Time_End": 1137.16,
        "Text": " Maybe one small tip."
      },
      {
        "Time_Start": 1137.16,
        "Time_End": 1141.52,
        "Text": " If you have past Red Team reports for your environment, you can read them to get inspiration"
      },
      {
        "Time_Start": 1141.52,
        "Time_End": 1146.32,
        "Text": " for great Honeypots to build, because these were real vulnerabilities that were exploited"
      },
      {
        "Time_Start": 1146.32,
        "Time_End": 1147.32,
        "Text": " by attackers."
      },
      {
        "Time_Start": 1147.32,
        "Time_End": 1148.32,
        "Text": " All right."
      },
      {
        "Time_Start": 1148.32,
        "Time_End": 1155.78,
        "Text": " Let's have a quick look at our favorite AD Honeypots and how they relate to the design"
      },
      {
        "Time_Start": 1155.78,
        "Time_End": 1158.26,
        "Text": " goals that we laid out earlier."
      },
      {
        "Time_Start": 1158.26,
        "Time_End": 1161.06,
        "Text": " So the first one is pretty straightforward."
      },
      {
        "Time_Start": 1161.06,
        "Time_End": 1166.22,
        "Text": " So the general idea being that you hide some fake credentials for AD accounts somewhere"
      },
      {
        "Time_Start": 1166.22,
        "Time_End": 1168.82,
        "Text": " in your internal network."
      },
      {
        "Time_Start": 1168.82,
        "Time_End": 1171.26,
        "Text": " And how you do that, there's many options for that."
      },
      {
        "Time_Start": 1171.26,
        "Time_End": 1173.94,
        "Text": " You can get really creative with this one."
      },
      {
        "Time_Start": 1173.94,
        "Time_End": 1180.58,
        "Text": " One example would be using the AD description attribute in that account."
      },
      {
        "Time_Start": 1180.58,
        "Time_End": 1184.62,
        "Text": " Or otherwise, a real classic is the hard-coded credential."
      },
      {
        "Time_Start": 1184.6200000000001,
        "Time_End": 1189.38,
        "Text": " You can see down here in some scripts that you distribute."
      },
      {
        "Time_Start": 1189.38,
        "Time_End": 1193.1000000000001,
        "Text": " So that makes it quite easy to discover for an attacker."
      },
      {
        "Time_Start": 1193.1000000000001,
        "Time_End": 1196.9,
        "Text": " And to make these accounts look appealing to attackers, you would like to give them"
      },
      {
        "Time_Start": 1196.9,
        "Time_End": 1203.1000000000001,
        "Text": " some interesting privileges via group membership, and make sure these permissions are visible"
      },
      {
        "Time_Start": 1203.1000000000001,
        "Time_End": 1204.74,
        "Text": " in LDAP."
      },
      {
        "Time_Start": 1204.74,
        "Time_End": 1208.42,
        "Text": " So attackers enumerating them will see that."
      },
      {
        "Time_Start": 1208.42,
        "Time_End": 1214.14,
        "Text": " Or just by using an interesting naming scheme for the account."
      },
      {
        "Time_Start": 1214.66,
        "Time_End": 1217.18,
        "Text": " Authenticity-wise, there's two options here."
      },
      {
        "Time_Start": 1217.18,
        "Time_End": 1223.14,
        "Text": " One is to use an active account that has very rare failed logons so far, so you don't get"
      },
      {
        "Time_Start": 1223.14,
        "Time_End": 1226.26,
        "Text": " too many false positives."
      },
      {
        "Time_Start": 1226.26,
        "Time_End": 1234.18,
        "Text": " Or even better, use a dedicated Honeypot account by recycling old decommissioned accounts in"
      },
      {
        "Time_Start": 1234.18,
        "Time_End": 1236.38,
        "Text": " your network."
      },
      {
        "Time_Start": 1236.38,
        "Time_End": 1241.5,
        "Text": " That way, you get very good, realistic values for all sorts of different attributes, like"
      },
      {
        "Time_Start": 1241.5,
        "Time_End": 1245.9,
        "Text": " the last logon, the password time, even the RID."
      },
      {
        "Time_Start": 1245.9,
        "Time_End": 1250.78,
        "Text": " A lot of these are mentioned in Sean's blog post, but be sure to check it out for more"
      },
      {
        "Time_Start": 1250.78,
        "Time_End": 1253.22,
        "Text": " details."
      },
      {
        "Time_Start": 1253.22,
        "Time_End": 1257.14,
        "Text": " Safety-wise, this Honeypot shouldn't be a problem at all, as long as you make sure that"
      },
      {
        "Time_Start": 1257.14,
        "Time_End": 1261.58,
        "Text": " account has a secure password, and the password hint that you distribute are not actually"
      },
      {
        "Time_Start": 1261.58,
        "Time_End": 1264.7,
        "Text": " related to that."
      },
      {
        "Time_Start": 1264.7,
        "Time_End": 1272.5800000000002,
        "Text": " And as mentioned before, we advise against using the logon hours deny hack."
      },
      {
        "Time_Start": 1272.5800000000002,
        "Time_End": 1278.02,
        "Text": " For alerting, you can actually just use the built-in Windows events."
      },
      {
        "Time_Start": 1278.02,
        "Time_End": 1287.78,
        "Text": " They contain sufficient information to build solid alert rules for your SIEM."
      },
      {
        "Time_Start": 1287.78,
        "Time_End": 1288.96,
        "Text": " So the next one."
      },
      {
        "Time_Start": 1288.96,
        "Time_End": 1292.6200000000001,
        "Text": " This one relates to Kerberos thing."
      },
      {
        "Time_Start": 1293.3400000000001,
        "Time_End": 1294.3400000000001,
        "Text": " Quick recap."
      },
      {
        "Time_Start": 1294.3400000000001,
        "Time_End": 1295.74,
        "Text": " We're all on the same page here."
      },
      {
        "Time_Start": 1295.74,
        "Time_End": 1301.5000000000002,
        "Text": " The Kerberos thing attack targets the Kerberos authentication protocol, the basic idea being"
      },
      {
        "Time_Start": 1301.5000000000002,
        "Time_End": 1309.6200000000001,
        "Text": " an attacker can request a service ticket from the domain controller, which is encrypted"
      },
      {
        "Time_Start": 1309.6200000000001,
        "Time_End": 1313.14,
        "Text": " with the hash of that account's password."
      },
      {
        "Time_Start": 1313.14,
        "Time_End": 1316.9,
        "Text": " So an attacker can extract that and try to crack it offline."
      },
      {
        "Time_Start": 1316.9,
        "Time_End": 1322.5800000000002,
        "Text": " And if he succeeds, because of a weak password, use that for authentication."
      },
      {
        "Time_Start": 1322.58,
        "Time_End": 1328.6999999999998,
        "Text": " We can use that to create Honeypot for this, which would be very easy to discover."
      },
      {
        "Time_Start": 1328.6999999999998,
        "Time_End": 1334.6999999999998,
        "Text": " A lot of attackers look around for these kind of vulnerable accounts and query out for users"
      },
      {
        "Time_Start": 1334.6999999999998,
        "Time_End": 1337.6599999999999,
        "Text": " with an SPN set."
      },
      {
        "Time_Start": 1337.6599999999999,
        "Time_End": 1342.34,
        "Text": " But to make these accounts look appealing, you would want to make sure that the password"
      },
      {
        "Time_Start": 1342.34,
        "Time_End": 1348.6999999999998,
        "Text": " hasn't been updated for a long time, or make sure it's a human account, because humans"
      },
      {
        "Time_Start": 1348.7,
        "Time_End": 1353.98,
        "Text": " are usually quite bad at picking good passwords."
      },
      {
        "Time_Start": 1353.98,
        "Time_End": 1357.6200000000001,
        "Text": " Authenticity-wise, we have two options here as well."
      },
      {
        "Time_Start": 1357.6200000000001,
        "Time_End": 1365.26,
        "Text": " Either set an SPN on a normal user, making it look like it was some forgotten test case"
      },
      {
        "Time_Start": 1365.26,
        "Time_End": 1368.18,
        "Text": " an admin tried out at some point."
      },
      {
        "Time_Start": 1368.18,
        "Time_End": 1376.78,
        "Text": " Or otherwise, again, use a dedicated Honey account by recycling decommissioned accounts."
      },
      {
        "Time_Start": 1376.78,
        "Time_End": 1382.3,
        "Text": " Also regarding authenticity, you should consider how common RC4 is in your environment."
      },
      {
        "Time_Start": 1382.3,
        "Time_End": 1387.1,
        "Text": " It would make it a bit easier for an attacker, and therefore more appealing."
      },
      {
        "Time_Start": 1387.1,
        "Time_End": 1393.42,
        "Text": " But if it's the only RC4 account in the whole network, it might look a bit suspicious."
      },
      {
        "Time_Start": 1393.42,
        "Time_End": 1397.58,
        "Text": " Safety-wise, same as with the other Honeypot, just ensure the account has a very strong"
      },
      {
        "Time_Start": 1397.58,
        "Time_End": 1402.1,
        "Text": " password, and then you're good to go."
      },
      {
        "Time_Start": 1402.1000000000001,
        "Time_End": 1409.5400000000002,
        "Text": " And if it's not a dedicated Honeypot account, make sure the owner is aware of that."
      },
      {
        "Time_Start": 1409.5400000000002,
        "Time_End": 1414.7400000000002,
        "Text": " And there's some built-in event IDs, again, that you can use to build solid alert rules"
      },
      {
        "Time_Start": 1414.7400000000002,
        "Time_End": 1417.6200000000001,
        "Text": " for your SEM."
      },
      {
        "Time_Start": 1417.6200000000001,
        "Time_End": 1422.8200000000002,
        "Text": " And then finally, the third one, not based on accounts, but on groups."
      },
      {
        "Time_Start": 1422.8200000000002,
        "Time_End": 1429.9,
        "Text": " So the idea here is that starting with Windows Server version 2016, it became quite difficult"
      },
      {
        "Time_Start": 1429.9,
        "Time_End": 1433.3000000000002,
        "Text": " to enumerate RDP privileges."
      },
      {
        "Time_Start": 1433.3000000000002,
        "Time_End": 1435.14,
        "Text": " So how can you use that for Honeypot?"
      },
      {
        "Time_Start": 1435.14,
        "Time_End": 1443.48,
        "Text": " You create a group that is named, or otherwise looks like it provides RDP privileges."
      },
      {
        "Time_Start": 1443.48,
        "Time_End": 1451.74,
        "Text": " Make sure that all users are members of domain users in LDAP and part of that group, so attackers"
      },
      {
        "Time_Start": 1451.74,
        "Time_End": 1455.7,
        "Text": " can easily find that when enumerating them."
      },
      {
        "Time_Start": 1455.7,
        "Time_End": 1467.94,
        "Text": " And yeah, make sure these appeal to the attacker by also giving local admin to that group."
      },
      {
        "Time_Start": 1467.94,
        "Time_End": 1472.72,
        "Text": " And ideally, do all of this on a machine that seems sort of relevant and important in your"
      },
      {
        "Time_Start": 1472.72,
        "Time_End": 1474.98,
        "Text": " internal network."
      },
      {
        "Time_Start": 1474.98,
        "Time_End": 1481.78,
        "Text": " And yeah, most attackers will try to connect using RDP, because there is no other way to"
      },
      {
        "Time_Start": 1481.86,
        "Time_End": 1487.86,
        "Text": " find out if this group actually provides these privileges."
      },
      {
        "Time_Start": 1487.86,
        "Time_End": 1493.26,
        "Text": " Safety-wise, you're good to go, as long as you make sure you don't provide actual RDP access."
      },
      {
        "Time_Start": 1493.26,
        "Time_End": 1498.26,
        "Text": " And it's also quite important to make sure that the admins in your organizations are"
      },
      {
        "Time_Start": 1498.26,
        "Time_End": 1504.74,
        "Text": " aware of this, so no one will actually add real RDP privileges in the future, thinking"
      },
      {
        "Time_Start": 1504.74,
        "Time_End": 1507.94,
        "Text": " a mistake has been made."
      },
      {
        "Time_Start": 1507.94,
        "Time_End": 1513.8600000000001,
        "Text": " And for alerting, there's some event IDs here you can use again."
      },
      {
        "Time_Start": 1513.8600000000001,
        "Time_End": 1518.78,
        "Text": " They even have a logon type specifically for RDP, but you might also include some others,"
      },
      {
        "Time_Start": 1518.78,
        "Time_End": 1527.7,
        "Text": " because there's some options which would probably result in a different logon type as well."
      },
      {
        "Time_Start": 1527.7,
        "Time_End": 1532.8200000000002,
        "Text": " And actually, this general approach does not only work for this RDP privileges, but for"
      },
      {
        "Time_Start": 1532.82,
        "Time_End": 1539.4199999999998,
        "Text": " example, you could also use VMware or vCenter in your organization for the vCenter admin"
      },
      {
        "Time_Start": 1539.4199999999998,
        "Time_End": 1548.6599999999999,
        "Text": " group, which usually also looks quite interesting for threat actors, especially ransomware groups."
      },
      {
        "Time_Start": 1548.6599999999999,
        "Time_End": 1551.9399999999998,
        "Text": " So that's been our favorite AD honeypot."
      },
      {
        "Time_Start": 1551.9399999999998,
        "Time_End": 1558.98,
        "Text": " Yes, but even though that list is already quite nice, there was one type of honeypot"
      },
      {
        "Time_Start": 1559.18,
        "Time_End": 1566.5,
        "Text": " that we think would catch us very reliably, and that we always wanted to build."
      },
      {
        "Time_Start": 1566.5,
        "Time_End": 1576.58,
        "Text": " So for this one, let me give you a brief introduction to ADCS, to Active Directory Certificate Services."
      },
      {
        "Time_Start": 1576.58,
        "Time_End": 1582.7,
        "Text": " This is the PKI solution by Microsoft that's integrated with Active Directory, and it can"
      },
      {
        "Time_Start": 1582.7,
        "Time_End": 1590.5,
        "Text": " be used to create certificates for TLS, email, code signing, but also for client authentication"
      },
      {
        "Time_Start": 1590.5,
        "Time_End": 1591.66,
        "Text": " in your network."
      },
      {
        "Time_Start": 1591.66,
        "Time_End": 1595.6200000000001,
        "Text": " So if you have an authentication certificate for a user or a machine, you can basically"
      },
      {
        "Time_Start": 1595.6200000000001,
        "Time_End": 1600.14,
        "Text": " do the same thing as if you have a password."
      },
      {
        "Time_Start": 1600.14,
        "Time_End": 1606.22,
        "Text": " In that sense, it's a very crucial component, because when compromised gives huge access"
      },
      {
        "Time_Start": 1606.22,
        "Time_End": 1612.14,
        "Text": " to basically full domain compromise, it's usually also considered Tier 0."
      },
      {
        "Time_Start": 1612.14,
        "Time_End": 1615.5400000000002,
        "Text": " How does the process work to get an authentication certificate?"
      },
      {
        "Time_Start": 1615.5400000000002,
        "Time_End": 1621.5400000000002,
        "Text": " So the available templates for certificates are published in Active Directory."
      },
      {
        "Time_Start": 1621.5400000000002,
        "Time_End": 1623.38,
        "Text": " They list a few properties."
      },
      {
        "Time_Start": 1623.38,
        "Time_End": 1628.46,
        "Text": " They also include the permissions who can enroll in a certain template, and the users"
      },
      {
        "Time_Start": 1628.46,
        "Time_End": 1633.5400000000002,
        "Text": " can query Active Directory to get a list of certificate authorities and supported certificate"
      },
      {
        "Time_Start": 1633.5400000000002,
        "Time_End": 1636.0200000000002,
        "Text": " templates."
      },
      {
        "Time_Start": 1636.0200000000002,
        "Time_End": 1641.98,
        "Text": " Then the user creates a certificate signing request from one of these templates, authenticates"
      },
      {
        "Time_Start": 1641.98,
        "Time_End": 1646.22,
        "Text": " to a CA, and sends this signing request."
      },
      {
        "Time_Start": 1646.22,
        "Time_End": 1652.18,
        "Text": " The CA then checks this request against the templates it actually supports, evaluates"
      },
      {
        "Time_Start": 1652.18,
        "Time_End": 1657.74,
        "Text": " it, and if everything checks out, sends back a signed certificate to the user that the"
      },
      {
        "Time_Start": 1657.74,
        "Time_End": 1663.42,
        "Text": " user can now use to authenticate in the Active Directory domain."
      },
      {
        "Time_Start": 1663.42,
        "Time_End": 1668.5,
        "Text": " So this is a process that we often exploit in our engagements that gives us a huge amount"
      },
      {
        "Time_Start": 1668.5,
        "Time_End": 1669.66,
        "Text": " of privileges."
      },
      {
        "Time_Start": 1669.66,
        "Time_End": 1675.74,
        "Text": " So we wanted to see if we can build Anipod for it."
      },
      {
        "Time_Start": 1675.74,
        "Time_End": 1679.34,
        "Text": " So first of all, why can you exploit ADCS so easily?"
      },
      {
        "Time_Start": 1679.34,
        "Time_End": 1685.1,
        "Text": " There's a lot of misconfigurations that can happen because ADCS is quite complex to configure."
      },
      {
        "Time_Start": 1685.1,
        "Time_End": 1691.14,
        "Text": " And I'm sure a lot of you know that great white paper by Will Schroeder and Lee Christensen"
      },
      {
        "Time_Start": 1691.14,
        "Time_End": 1696.9,
        "Text": " from SpectreOps from two years ago, I believe, who published the first eight of these very"
      },
      {
        "Time_Start": 1696.9,
        "Time_End": 1699.18,
        "Text": " common misconfigurations."
      },
      {
        "Time_Start": 1699.18,
        "Time_End": 1704.38,
        "Text": " And then in the following years, we've seen some more being published."
      },
      {
        "Time_Start": 1704.38,
        "Time_End": 1712.3400000000001,
        "Text": " Quick summary for those that we see the most often, the ESC1 is basically based on some"
      },
      {
        "Time_Start": 1712.3400000000001,
        "Time_End": 1718.7,
        "Text": " flags that you can set in these certificate templates, enabling the enrolling user to"
      },
      {
        "Time_Start": 1718.7,
        "Time_End": 1723.8600000000001,
        "Text": " specify who that certificate is going to be valid for."
      },
      {
        "Time_Start": 1723.8600000000001,
        "Time_End": 1729.5800000000002,
        "Text": " So you can actually just request an authentication certificate for other users or the domain"
      },
      {
        "Time_Start": 1729.5800000000002,
        "Time_End": 1734.14,
        "Text": " admin, for example, and then take over the whole environment."
      },
      {
        "Time_Start": 1734.14,
        "Time_End": 1743.94,
        "Text": " Then ESC2 and ESC3 basically result in the same thing, but with a bit more complex setup."
      },
      {
        "Time_Start": 1743.94,
        "Time_End": 1748.6200000000001,
        "Text": " So there's this feature in ADCS called Enrollment Agents."
      },
      {
        "Time_Start": 1748.6200000000001,
        "Time_End": 1753.6200000000001,
        "Text": " And if you have one template that enables a low-privileged user to get a certificate"
      },
      {
        "Time_Start": 1753.6200000000001,
        "Time_End": 1759.8600000000001,
        "Text": " for Enrollment Agents, you can then use that certificate in combination with a second template"
      },
      {
        "Time_Start": 1759.8600000000001,
        "Time_End": 1767.46,
        "Text": " for Enrollment Agents to also get an authentication certificate for domain admin."
      },
      {
        "Time_Start": 1767.46,
        "Time_End": 1774.7,
        "Text": " And then finally, misconfigurations we also see quite often are ESC8 and 11, which are"
      },
      {
        "Time_Start": 1774.7,
        "Time_End": 1778.46,
        "Text": " based on missing protection against relay attacks, but we're going to talk about that"
      },
      {
        "Time_Start": 1778.46,
        "Time_End": 1781.66,
        "Text": " in a bit."
      },
      {
        "Time_Start": 1781.66,
        "Time_End": 1788.22,
        "Text": " So as you can see, this bad boy can fit so many misconfigurations, which makes it a prime"
      },
      {
        "Time_Start": 1788.22,
        "Time_End": 1795.6200000000001,
        "Text": " target for attackers, but also an excellent location for a honeypot for multiple reasons,"
      },
      {
        "Time_Start": 1795.6200000000001,
        "Time_End": 1796.6200000000001,
        "Text": " actually."
      },
      {
        "Time_Start": 1796.6200000000001,
        "Time_End": 1800.26,
        "Text": " So first of all, access to ADCS is super easy."
      },
      {
        "Time_Start": 1800.26,
        "Time_End": 1805.86,
        "Text": " All you need as an attacker is a domain user, and you're good to go to interact with the"
      },
      {
        "Time_Start": 1805.86,
        "Time_End": 1816.22,
        "Text": " CAs, which makes it very easily discoverable for attackers when you implement an ADCS honeypot."
      },
      {
        "Time_Start": 1816.22,
        "Time_End": 1819.5,
        "Text": " Then as we've just seen, the configuration can be quite complex."
      },
      {
        "Time_Start": 1819.5,
        "Time_End": 1823.3799999999999,
        "Text": " There's a lot of things that can go wrong, and we've also seen there's a lot of tutorials"
      },
      {
        "Time_Start": 1823.38,
        "Time_End": 1832.14,
        "Text": " out there with quite good SEO that suggests enabling some of these options without properly"
      },
      {
        "Time_Start": 1832.14,
        "Time_End": 1834.8600000000001,
        "Text": " talking about the security implications."
      },
      {
        "Time_Start": 1834.8600000000001,
        "Time_End": 1839.7,
        "Text": " So that's one of the reasons why these misconfigurations are so common."
      },
      {
        "Time_Start": 1839.7,
        "Time_End": 1844.14,
        "Text": " On the other hand, for a honeypot, that would make for very good authenticity."
      },
      {
        "Time_Start": 1844.14,
        "Time_End": 1848.98,
        "Text": " Attackers are used to seeing these misconfigurations and wouldn't get suspicious."
      },
      {
        "Time_Start": 1848.98,
        "Time_End": 1852.5400000000002,
        "Text": " Furthermore, there's some great tooling out there."
      },
      {
        "Time_Start": 1852.54,
        "Time_End": 1857.8999999999999,
        "Text": " For example, CertiPy, to automatically scan for all these misconfigurations, and then"
      },
      {
        "Time_Start": 1857.8999999999999,
        "Time_End": 1867.3,
        "Text": " also making it very straightforward to exploit them, again, making an ADCS honeypot easily"
      },
      {
        "Time_Start": 1867.3,
        "Time_End": 1868.94,
        "Text": " discoverable."
      },
      {
        "Time_Start": 1868.94,
        "Time_End": 1874.6599999999999,
        "Text": " And we've seen that these kind of tools, CertiPy or Certify, are a part of the playbooks of"
      },
      {
        "Time_Start": 1874.6599999999999,
        "Time_End": 1878.3799999999999,
        "Text": " many threat actors out there."
      },
      {
        "Time_Start": 1878.5,
        "Time_End": 1885.3400000000001,
        "Text": " And with the central role that ADCS plays in an AD environment, compromise or some of"
      },
      {
        "Time_Start": 1885.3400000000001,
        "Time_End": 1888.6200000000001,
        "Text": " these misconfigurations usually have significant impact."
      },
      {
        "Time_Start": 1888.6200000000001,
        "Time_End": 1895.6200000000001,
        "Text": " When you find some of these, usually it results in full environment compromise, which greatly"
      },
      {
        "Time_Start": 1895.6200000000001,
        "Time_End": 1897.5800000000002,
        "Text": " appeals to attackers."
      },
      {
        "Time_Start": 1897.5800000000002,
        "Time_End": 1902.1000000000001,
        "Text": " ADCS is a very juicy target to exploit."
      },
      {
        "Time_Start": 1902.1000000000001,
        "Time_End": 1907.7800000000002,
        "Text": " And finally, from our experience, ADCS is usually quite undermonitored."
      },
      {
        "Time_Start": 1907.78,
        "Time_End": 1913.98,
        "Text": " So when we exploit misconfigurations, we mostly stay undetected afterwards."
      },
      {
        "Time_Start": 1913.98,
        "Time_End": 1920.1,
        "Text": " So that's why attackers usually feel quite safe about exploiting ADCS."
      },
      {
        "Time_Start": 1920.1,
        "Time_End": 1928.1399999999999,
        "Text": " So yeah, we see this is a great target to create honeypots for, but how do we do that?"
      },
      {
        "Time_Start": 1928.1399999999999,
        "Time_End": 1931.5,
        "Text": " Our first idea was to create a honeypot for EC8."
      },
      {
        "Time_Start": 1931.5,
        "Time_End": 1939.94,
        "Text": " So basically, there's a feature in the CA that you can enable so that you can also do"
      },
      {
        "Time_Start": 1939.94,
        "Time_End": 1947.02,
        "Text": " a certificate enrollment via a web API that supports HTTP, which is, of course, vulnerable"
      },
      {
        "Time_Start": 1947.02,
        "Time_End": 1948.22,
        "Text": " to relay attacks."
      },
      {
        "Time_Start": 1948.22,
        "Time_End": 1954.5,
        "Text": " But also with HTTPS, there are some misconfigurations that can happen that enable relay attacks."
      },
      {
        "Time_Start": 1954.5,
        "Time_End": 1961.38,
        "Text": " And if an attacker already found a way to coerce authentication with the domain controller,"
      },
      {
        "Time_Start": 1961.38,
        "Time_End": 1969.5800000000002,
        "Text": " they can use that to forward the NTLM v2 authentication handshake to the CA and then"
      },
      {
        "Time_Start": 1969.5800000000002,
        "Time_End": 1975.5400000000002,
        "Text": " receive a domain controller certificate."
      },
      {
        "Time_Start": 1975.5400000000002,
        "Time_End": 1980.8200000000002,
        "Text": " So yeah, quick analysis."
      },
      {
        "Time_Start": 1980.8200000000002,
        "Time_End": 1985.98,
        "Text": " The great thing about this, the attacker tooling, for example, CertiPy for this, doesn't check"
      },
      {
        "Time_Start": 1986.14,
        "Time_End": 1992.8600000000001,
        "Text": " for the templates in this case, but just connects to the CA via HTTP to see if this feature"
      },
      {
        "Time_Start": 1992.8600000000001,
        "Time_End": 1994.38,
        "Text": " is enabled."
      },
      {
        "Time_Start": 1994.38,
        "Time_End": 1997.8600000000001,
        "Text": " So this makes it very easy to implement a honeypot."
      },
      {
        "Time_Start": 1997.8600000000001,
        "Time_End": 2005.5,
        "Text": " You would just have to mock parts of that interaction with the CA web server."
      },
      {
        "Time_Start": 2005.5,
        "Time_End": 2012.18,
        "Text": " However, we think because this requires the whole relay and coercion setup to be present"
      },
      {
        "Time_Start": 2012.18,
        "Time_End": 2019.22,
        "Text": " already, it can be quite tricky for attackers to exploit, or at least the majority of attackers"
      },
      {
        "Time_Start": 2019.22,
        "Time_End": 2022.14,
        "Text": " would not super easily step into this trap."
      },
      {
        "Time_Start": 2022.14,
        "Time_End": 2027.26,
        "Text": " So there's probably better options for honeypots here."
      },
      {
        "Time_Start": 2027.26,
        "Time_End": 2029.5600000000002,
        "Text": " And we followed down quite a few paths."
      },
      {
        "Time_Start": 2029.5600000000002,
        "Time_End": 2037.8600000000001,
        "Text": " So after the ESC8 honeypot, we looked quite deeply into ESC3."
      },
      {
        "Time_Start": 2037.8600000000001,
        "Time_End": 2042.16,
        "Text": " And the interesting thing about ESC3 and these enrollment agents, you can actually play"
      },
      {
        "Time_Start": 2042.16,
        "Time_End": 2049.4,
        "Text": " restrictions in the CA on the enrollment agent part so that the exploitation of the"
      },
      {
        "Time_Start": 2049.4,
        "Time_End": 2055.28,
        "Text": " second template will fail, but attackers are not able to enumerate this beforehand."
      },
      {
        "Time_Start": 2055.28,
        "Time_End": 2059.84,
        "Text": " So you would actually be able to make a setup that is safe against ESC3, but still looks"
      },
      {
        "Time_Start": 2059.84,
        "Time_End": 2062.16,
        "Text": " vulnerable from the attacker perspective."
      },
      {
        "Time_Start": 2062.16,
        "Time_End": 2067.9,
        "Text": " However, an attacker would still obtain an enrollment certificate from that first template."
      },
      {
        "Time_Start": 2067.9,
        "Time_End": 2074.56,
        "Text": " So there might be some opportunities in the future for an attacker to still find another"
      },
      {
        "Time_Start": 2074.56,
        "Time_End": 2080.78,
        "Text": " template with the configuration that's valid for enrollment agents, and thereby still be"
      },
      {
        "Time_Start": 2080.78,
        "Time_End": 2083.02,
        "Text": " exploitable at some point."
      },
      {
        "Time_Start": 2083.02,
        "Time_End": 2087.26,
        "Text": " In our opinion, it's just too risky to actually roll out this honeypot."
      },
      {
        "Time_Start": 2087.26,
        "Time_End": 2094.88,
        "Text": " We tried to make it more safe using approaches like auto-revocation, but certificate revocation"
      },
      {
        "Time_Start": 2094.88,
        "Time_End": 2096.62,
        "Text": " is a complex topic."
      },
      {
        "Time_Start": 2096.62,
        "Time_End": 2102.8599999999997,
        "Text": " There's a lot of caching happening, and it's not very straightforward to make sure revocation"
      },
      {
        "Time_Start": 2102.8599999999997,
        "Time_End": 2108.5,
        "Text": " actually happens instantaneously, and there's no time window where an attacker could potentially"
      },
      {
        "Time_Start": 2108.5,
        "Time_End": 2116.8599999999997,
        "Text": " exploit vulnerability with a valid certificate."
      },
      {
        "Time_Start": 2116.8599999999997,
        "Time_End": 2122.8399999999997,
        "Text": " So we haven't been too happy about our options until we finally found out about policy modules."
      },
      {
        "Time_Start": 2122.8399999999997,
        "Time_End": 2125.18,
        "Text": " So what are policy modules?"
      },
      {
        "Time_Start": 2125.18,
        "Time_End": 2130.4199999999996,
        "Text": " Policy modules provide a way for you to implement some custom logic in the CA for certificate"
      },
      {
        "Time_Start": 2130.4199999999996,
        "Time_End": 2136.2999999999997,
        "Text": " issuance or denial, and it's actually just implemented with a DLL that you load on the"
      },
      {
        "Time_Start": 2136.2999999999997,
        "Time_End": 2138.7,
        "Text": " CA server then."
      },
      {
        "Time_Start": 2138.7,
        "Time_End": 2144.98,
        "Text": " And we found a very great implementation of such an ADCS policy module called TameMyCerts,"
      },
      {
        "Time_Start": 2144.98,
        "Time_End": 2148.1,
        "Text": " which is developed and maintained by Uwe Gradenegger."
      },
      {
        "Time_Start": 2148.1,
        "Time_End": 2154.62,
        "Text": " And this allows for very fine-grained control about this certificate issuance checks that"
      },
      {
        "Time_Start": 2154.62,
        "Time_End": 2160.38,
        "Text": " can be specified in XML, and it also provides some additional logging capabilities, which"
      },
      {
        "Time_Start": 2160.38,
        "Time_End": 2163.1,
        "Text": " are great for building honeypots."
      },
      {
        "Time_Start": 2163.1,
        "Time_End": 2170.02,
        "Text": " So we decided to go with this and use it to build a very simple yet effective honeypot"
      },
      {
        "Time_Start": 2170.02,
        "Time_End": 2173.06,
        "Text": " for ESC 1."
      },
      {
        "Time_Start": 2173.06,
        "Time_End": 2181.62,
        "Text": " So quick recap, in ESC 1, it's based on some flag that is set in the certificate template,"
      },
      {
        "Time_Start": 2181.62,
        "Time_End": 2187.7,
        "Text": " which basically enables the requester to specify a subject alternative name in the"
      },
      {
        "Time_Start": 2187.7,
        "Time_End": 2193.8599999999997,
        "Text": " certificate signing request, which would then result in a certificate that is also valid"
      },
      {
        "Time_Start": 2193.8599999999997,
        "Time_End": 2201.58,
        "Text": " for other accounts, like the domain controller or domain admin."
      },
      {
        "Time_Start": 2201.58,
        "Time_End": 2208.3399999999997,
        "Text": " And yeah, it's very easy to specify a policy like this in XML that would just deny all"
      },
      {
        "Time_Start": 2208.34,
        "Time_End": 2216.06,
        "Text": " incoming certificate signing requests where the subject alternative name is set, thereby"
      },
      {
        "Time_Start": 2216.06,
        "Time_End": 2222.1000000000004,
        "Text": " making it impossible to exploit ESC 1 in this case."
      },
      {
        "Time_Start": 2222.1000000000004,
        "Time_End": 2231.34,
        "Text": " But still to the attacker, using tools like 3rdPy, it would look vulnerable."
      },
      {
        "Time_Start": 2231.34,
        "Time_End": 2235.7000000000003,
        "Text": " So yeah, let's talk about alerting in this case."
      },
      {
        "Time_Start": 2235.7000000000003,
        "Time_End": 2241.5800000000004,
        "Text": " So we actually, so far, implemented two different kind of alerts for this."
      },
      {
        "Time_Start": 2241.5800000000004,
        "Time_End": 2247.9800000000005,
        "Text": " There's some built-in event sources in the CA, which you first have to activate by enabling"
      },
      {
        "Time_Start": 2247.9800000000005,
        "Time_End": 2253.78,
        "Text": " the extended audit log, and then you actually get some events that also contain the template"
      },
      {
        "Time_Start": 2253.78,
        "Time_End": 2255.38,
        "Text": " that has been used."
      },
      {
        "Time_Start": 2255.38,
        "Time_End": 2262.4600000000005,
        "Text": " And we can use that to create medium alerts whenever this honey template is used."
      },
      {
        "Time_Start": 2262.46,
        "Time_End": 2266.7,
        "Text": " But then with the extended logging from Tameisource, we can also create a very highly critical"
      },
      {
        "Time_Start": 2266.7,
        "Time_End": 2273.06,
        "Text": " alert whenever someone actually tries to exploit ESC 1 in combination with that template on"
      },
      {
        "Time_Start": 2273.06,
        "Time_End": 2276.3,
        "Text": " the CA."
      },
      {
        "Time_Start": 2276.3,
        "Time_End": 2282.38,
        "Text": " And in the future, we've already talked about with the maintainer of that module, it's easily"
      },
      {
        "Time_Start": 2282.38,
        "Time_End": 2292.42,
        "Text": " possible to extend the logging capabilities even further for more customized alert rules."
      },
      {
        "Time_Start": 2292.42,
        "Time_End": 2300.5,
        "Text": " Yes, alert rules, great thing about these is you can create them in the Sigma rule format,"
      },
      {
        "Time_Start": 2300.5,
        "Time_End": 2301.84,
        "Text": " which is CM agnostic."
      },
      {
        "Time_Start": 2301.84,
        "Time_End": 2303.46,
        "Text": " So that's what we're doing."
      },
      {
        "Time_Start": 2303.46,
        "Time_End": 2310.82,
        "Text": " So you can generate Sigma rules and then import these in whatever CM solution you're using."
      },
      {
        "Time_Start": 2310.82,
        "Time_End": 2316.5800000000004,
        "Text": " And in the future, we're planning for some more improvements when we support some of"
      },
      {
        "Time_Start": 2316.5800000000004,
        "Time_End": 2320.82,
        "Text": " these other honey templates that you've seen before."
      },
      {
        "Time_Start": 2320.82,
        "Time_End": 2326.06,
        "Text": " All right, and now it's time to announce CertiCeption."
      },
      {
        "Time_Start": 2326.06,
        "Time_End": 2332.42,
        "Text": " So as part of this conference, we're going to release our tooling to set up ADCS honeypots."
      },
      {
        "Time_Start": 2332.42,
        "Time_End": 2339.02,
        "Text": " What CertiCeption provides for you is it sets up a new certificate authority, adds a vulnerable"
      },
      {
        "Time_Start": 2339.02,
        "Time_End": 2345.1,
        "Text": " ESC 1 template to just that CA and enables it there."
      },
      {
        "Time_Start": 2345.1,
        "Time_End": 2353.02,
        "Text": " And then also installs and configures the TameWise policy module and configures it in"
      },
      {
        "Time_Start": 2353.02,
        "Time_End": 2359.2599999999998,
        "Text": " a way to make sure ESC 1 cannot actually be exploited."
      },
      {
        "Time_Start": 2359.2599999999998,
        "Time_End": 2364.78,
        "Text": " And also enables the extended audit log and creates these Sigma rules that you can import"
      },
      {
        "Time_Start": 2365.42,
        "Time_End": 2370.42,
        "Text": " into your CM to get alerts."
      },
      {
        "Time_Start": 2370.42,
        "Time_End": 2375.7400000000002,
        "Text": " And then, yeah, there's still one tiny issue."
      },
      {
        "Time_Start": 2375.7400000000002,
        "Time_End": 2385.1000000000004,
        "Text": " So as you see, the templates are centrally published in the AD LDAP."
      },
      {
        "Time_Start": 2385.1000000000004,
        "Time_End": 2390.1000000000004,
        "Text": " So if you have multiple CAs in your environment, someone in the future, some admin who is not"
      },
      {
        "Time_Start": 2390.1,
        "Time_End": 2396.7,
        "Text": " aware, might import that vulnerable ESC 1 template into a different CA that doesn't"
      },
      {
        "Time_Start": 2396.7,
        "Time_End": 2403.7,
        "Text": " use the policy module to make it safe, thereby resulting in an actually exploitable configuration."
      },
      {
        "Time_Start": 2403.7,
        "Time_End": 2411.1,
        "Text": " So that's why we set up some continuous monitoring to check if this happens or any other vulnerable"
      },
      {
        "Time_Start": 2411.1,
        "Time_End": 2423.02,
        "Text": " configuration is created using Certify as a tool."
      },
      {
        "Time_Start": 2423.02,
        "Time_End": 2427.1,
        "Text": " So yeah, how do you use CertiCeption?"
      },
      {
        "Time_Start": 2427.1,
        "Time_End": 2433.7799999999997,
        "Text": " All you need is a domain joined Windows server that the CA is then created on."
      },
      {
        "Time_Start": 2433.7799999999997,
        "Time_End": 2440.9,
        "Text": " CertiCeption uses Ansible that communicates via WinRM, so you need to make sure that connectivity"
      },
      {
        "Time_Start": 2440.9,
        "Time_End": 2448.34,
        "Text": " is set up, and then you need to have accounts with the privileges that are required to create"
      },
      {
        "Time_Start": 2448.34,
        "Time_End": 2453.42,
        "Text": " and register CAs and import the policy modules."
      },
      {
        "Time_Start": 2453.42,
        "Time_End": 2458.5,
        "Text": " And then what you do is choose some unique parameters, like the template name, the name"
      },
      {
        "Time_Start": 2458.5,
        "Time_End": 2462.5,
        "Text": " of the CA, to make sure it fits into your environment."
      },
      {
        "Time_Start": 2462.5,
        "Time_End": 2468.1800000000003,
        "Text": " Optionally, if you have some EDR deployed, you'll want to make sure that the continuous"
      },
      {
        "Time_Start": 2468.18,
        "Time_End": 2474.74,
        "Text": " monitoring that is scanning for vulnerable template configuration does not trigger any"
      },
      {
        "Time_Start": 2474.74,
        "Time_End": 2476.18,
        "Text": " alerts there."
      },
      {
        "Time_Start": 2476.18,
        "Time_End": 2480.02,
        "Text": " And then just run CertiCeption."
      },
      {
        "Time_Start": 2480.02,
        "Time_End": 2482.58,
        "Text": " It's setting up everything for you."
      },
      {
        "Time_Start": 2482.58,
        "Time_End": 2487.3399999999997,
        "Text": " Connect the event logs to your CM, import the signal rule there, and then go for a test"
      },
      {
        "Time_Start": 2487.3399999999997,
        "Time_End": 2491.3399999999997,
        "Text": " run to validate the setup."
      },
      {
        "Time_Start": 2491.3399999999997,
        "Time_End": 2497.94,
        "Text": " And then you're good to go to catch some attackers with this ADCS honeypot."
      },
      {
        "Time_Start": 2498.14,
        "Time_End": 2500.26,
        "Text": " Some small disclaimer at this point."
      },
      {
        "Time_Start": 2500.26,
        "Time_End": 2503.86,
        "Text": " Of course, use of CertiCeption is at your own risk."
      },
      {
        "Time_Start": 2503.86,
        "Time_End": 2504.86,
        "Text": " Read the code."
      },
      {
        "Time_Start": 2504.86,
        "Time_End": 2505.86,
        "Text": " It's not that complicated."
      },
      {
        "Time_Start": 2505.86,
        "Time_End": 2507.58,
        "Text": " Understand what it does."
      },
      {
        "Time_Start": 2507.58,
        "Time_End": 2513.26,
        "Text": " And we expect some potential for improvements in the future after this release."
      },
      {
        "Time_Start": 2513.26,
        "Time_End": 2517.18,
        "Text": " You will be able to find it under the GitHub link."
      },
      {
        "Time_Start": 2517.18,
        "Time_End": 2521.78,
        "Text": " Now it's time for some demos."
      },
      {
        "Time_Start": 2528.38,
        "Time_End": 2534.1,
        "Text": " Okay, so what you see here is the configuration file where there are some parameters in there"
      },
      {
        "Time_Start": 2534.1,
        "Time_End": 2541.02,
        "Text": " to customize your setup so it doesn't look the same and obvious in all environments."
      },
      {
        "Time_Start": 2541.02,
        "Time_End": 2548.3,
        "Text": " And then in this video, Niklas executes the Ansible playbook, provides the passwords for"
      },
      {
        "Time_Start": 2548.3,
        "Time_End": 2550.98,
        "Text": " the accounts."
      },
      {
        "Time_Start": 2550.98,
        "Time_End": 2556.2200000000003,
        "Text": " And what follows now is a bit of a longer Ansible run that I think we can skip over"
      },
      {
        "Time_Start": 2556.2200000000003,
        "Time_End": 2560.7000000000003,
        "Text": " here, but it basically sets up a new CA and configures it."
      },
      {
        "Time_Start": 2560.7000000000003,
        "Time_End": 2566.0600000000004,
        "Text": " On that new CA, installs the policy model and the restrictions, and afterwards creates"
      },
      {
        "Time_Start": 2566.0600000000004,
        "Time_End": 2567.0600000000004,
        "Text": " the template."
      },
      {
        "Time_Start": 2567.0600000000004,
        "Time_End": 2571.1400000000003,
        "Text": " And so we don't create the template first and then place the restrictions later if something"
      },
      {
        "Time_Start": 2571.1400000000003,
        "Time_End": 2572.94,
        "Text": " happens in between, you have a problem."
      },
      {
        "Time_Start": 2572.94,
        "Time_End": 2575.42,
        "Text": " But the order is switched."
      },
      {
        "Time_Start": 2575.42,
        "Time_End": 2580.6400000000003,
        "Text": " And then in the end, prints the sigma rules."
      },
      {
        "Time_Start": 2580.64,
        "Time_End": 2587.04,
        "Text": " So let's skip a little bit further to when the Ansible playbook completes."
      },
      {
        "Time_Start": 2587.04,
        "Time_End": 2596.4,
        "Text": " We can take a look into the sigma rules here."
      },
      {
        "Time_Start": 2596.4,
        "Time_End": 2604.2799999999997,
        "Text": " That should be, this is the template, the sigma rule should be here."
      },
      {
        "Time_Start": 2604.2799999999997,
        "Time_End": 2608.52,
        "Text": " You can see it's customized based on the parameters you entered previously for your CA to be set"
      },
      {
        "Time_Start": 2608.52,
        "Time_End": 2613.12,
        "Text": " up."
      },
      {
        "Time_Start": 2613.12,
        "Time_End": 2621.8,
        "Text": " And then we can take a look how it looks from the attacker perspective."
      },
      {
        "Time_Start": 2621.8,
        "Time_End": 2627.8,
        "Text": " So in this case, we use CertiPy first to enumerate the available templates."
      },
      {
        "Time_Start": 2627.8,
        "Time_End": 2633.32,
        "Text": " And there you can see, after this, you can see the CA we just set up in the output."
      },
      {
        "Time_Start": 2633.32,
        "Time_End": 2638.48,
        "Text": " And you can see the template is recognized as vulnerable to ESC1 by the tool."
      },
      {
        "Time_Start": 2639.44,
        "Time_End": 2644.56,
        "Text": " Next, when attempting exploitation, so trying to get a certificate for the domain administrator"
      },
      {
        "Time_Start": 2644.56,
        "Time_End": 2651.12,
        "Text": " by specifying a subject alternative name, you will see the request actually fails."
      },
      {
        "Time_Start": 2651.12,
        "Time_End": 2655.36,
        "Text": " In this case, the error message is invalid name, but this is actually the error message"
      },
      {
        "Time_Start": 2655.36,
        "Time_End": 2661.92,
        "Text": " right now you get when the request is denied by the policy module."
      },
      {
        "Time_Start": 2661.92,
        "Time_End": 2667.12,
        "Text": " Now when you have onboarded your logs to the CM, brief view how that will look."
      },
      {
        "Time_Start": 2667.12,
        "Time_End": 2671.04,
        "Text": " So right now we have the medium alert for someone interacts with the CA, and we have"
      },
      {
        "Time_Start": 2671.04,
        "Time_End": 2674.12,
        "Text": " the critical alert for someone actually trying to exploit it."
      },
      {
        "Time_Start": 2674.12,
        "Time_End": 2678.7999999999997,
        "Text": " So this is how it could look in your CM."
      },
      {
        "Time_Start": 2678.7999999999997,
        "Time_End": 2688.04,
        "Text": " Good."
      },
      {
        "Time_Start": 2688.04,
        "Time_End": 2692.7599999999998,
        "Text": " Because not all attackers use CertiPy, we also took screenshots of the three most common"
      },
      {
        "Time_Start": 2692.76,
        "Time_End": 2696.0400000000004,
        "Text": " tools that we know of for checking this."
      },
      {
        "Time_Start": 2696.0400000000004,
        "Time_End": 2700.88,
        "Text": " In each three of the tools, the template appears as vulnerable."
      },
      {
        "Time_Start": 2700.88,
        "Time_End": 2708.48,
        "Text": " The two of these that also exploit, you see that exploitation fails in both."
      },
      {
        "Time_Start": 2708.48,
        "Time_End": 2710.6400000000003,
        "Text": " There's still a bit to do."
      },
      {
        "Time_Start": 2710.6400000000003,
        "Time_End": 2715.4,
        "Text": " First after this talk, we will publish the repository."
      },
      {
        "Time_Start": 2715.4,
        "Time_End": 2720.0800000000004,
        "Text": " And then we want to implement more different honey templates aside from ESC1."
      },
      {
        "Time_Start": 2720.08,
        "Time_End": 2725.04,
        "Text": " There's a lot more options what we can do here with this policy module."
      },
      {
        "Time_Start": 2725.04,
        "Time_End": 2732.2,
        "Text": " We also want to support placing honey templates on existing CAs."
      },
      {
        "Time_Start": 2732.2,
        "Time_End": 2740.36,
        "Text": " Then you need to maintain one CA less, because right now the tool sets up a dedicated CA."
      },
      {
        "Time_Start": 2740.36,
        "Time_End": 2743.88,
        "Text": " Also we want to see what other hardening options we can put in place."
      },
      {
        "Time_Start": 2743.88,
        "Time_End": 2747.56,
        "Text": " And for this, we are happy to receive the scrutiny of the community."
      },
      {
        "Time_Start": 2747.56,
        "Time_End": 2749.68,
        "Text": " Now it was just released, please look at it."
      },
      {
        "Time_Start": 2749.68,
        "Time_End": 2752.2799999999997,
        "Text": " Do you find any other ways how this might be exploited?"
      },
      {
        "Time_Start": 2752.2799999999997,
        "Time_End": 2754.68,
        "Text": " Some additional hardening potential?"
      },
      {
        "Time_Start": 2754.68,
        "Time_End": 2756.08,
        "Text": " Please let us know."
      },
      {
        "Time_Start": 2756.08,
        "Time_End": 2761.3599999999997,
        "Text": " And then we also want to tune a little bit the error messages that are sent, so that"
      },
      {
        "Time_Start": 2761.3599999999997,
        "Time_End": 2764.12,
        "Text": " even these can be customized in the future."
      },
      {
        "Time_Start": 2764.12,
        "Time_End": 2774.44,
        "Text": " So even when an attacker steps into it, they don't see so easily that it's a honeypot."
      },
      {
        "Time_Start": 2774.44,
        "Time_End": 2776.56,
        "Text": " So please try to use it."
      },
      {
        "Time_Start": 2776.56,
        "Time_End": 2778.18,
        "Text": " Please have a look."
      },
      {
        "Time_Start": 2778.18,
        "Time_End": 2783.94,
        "Text": " What you take away from today is first that we think honeypots provide great and meaningful"
      },
      {
        "Time_Start": 2783.94,
        "Time_End": 2789.06,
        "Text": " detections for cases where attackers make it past your initial defenses."
      },
      {
        "Time_Start": 2789.06,
        "Time_End": 2793.02,
        "Text": " But it is important that you make sure they are custom-tailored to your environment and"
      },
      {
        "Time_Start": 2793.02,
        "Time_End": 2797.3799999999997,
        "Text": " that you think through how you deploy and how you place them."
      },
      {
        "Time_Start": 2797.3799999999997,
        "Time_End": 2802.08,
        "Text": " And of course, as Ellipse, a deception is the honeypot that would definitely catch us"
      },
      {
        "Time_Start": 2802.08,
        "Time_End": 2805.62,
        "Text": " and that we thought defenders always wanted to have."
      },
      {
        "Time_Start": 2805.62,
        "Time_End": 2806.62,
        "Text": " Thank you."
      },
      {
        "Time_Start": 2806.62,
        "Time_End": 2817.74,
        "Text": " So I think the QR code right now still leads to an empty page."
      },
      {
        "Time_Start": 2817.74,
        "Time_End": 2823.7799999999997,
        "Text": " We will publish it during Troopers and then also make the slides available in the repository."
      },
      {
        "Time_Start": 2823.7799999999997,
        "Time_End": 2826.62,
        "Text": " Everything will be there."
      },
      {
        "Time_Start": 2826.62,
        "Time_End": 2836.2599999999998,
        "Text": " Any questions?"
      },
      {
        "Time_Start": 2836.9,
        "Time_End": 2842.5,
        "Text": " Thanks for the great talk and the great deception idea."
      },
      {
        "Time_Start": 2842.5,
        "Time_End": 2852.94,
        "Text": " One thing I think might be a risk if the attacker compromises the CA host itself and extracts"
      },
      {
        "Time_Start": 2852.94,
        "Time_End": 2855.5,
        "Text": " the CA certificate."
      },
      {
        "Time_Start": 2855.5,
        "Time_End": 2861.38,
        "Text": " What are your thoughts about removing the CA certificate from the NT art store so that"
      },
      {
        "Time_Start": 2861.42,
        "Time_End": 2867.26,
        "Text": " even if the certificate is stolen or the policy module doesn't work, the certificate can't"
      },
      {
        "Time_Start": 2867.26,
        "Time_End": 2870.06,
        "Text": " be used for authentication?"
      },
      {
        "Time_Start": 2870.06,
        "Time_End": 2872.1400000000003,
        "Text": " So first, yeah, definitely a risk."
      },
      {
        "Time_Start": 2872.1400000000003,
        "Time_End": 2874.7000000000003,
        "Text": " Good point."
      },
      {
        "Time_Start": 2874.7000000000003,
        "Time_End": 2879.7000000000003,
        "Text": " We would first recommend that if you set this up, you have to treat it like any other CA"
      },
      {
        "Time_Start": 2879.7000000000003,
        "Time_End": 2882.1800000000003,
        "Text": " in your network in terms of hardening."
      },
      {
        "Time_Start": 2882.1800000000003,
        "Time_End": 2887.46,
        "Text": " I think somewhere also in the security considerations in the repo, it says there is no HSM used."
      },
      {
        "Time_Start": 2887.46,
        "Time_End": 2893.18,
        "Text": " If all your other CAs use an HSM and this one doesn't, then it would be weakening your"
      },
      {
        "Time_Start": 2893.18,
        "Time_End": 2895.34,
        "Text": " security."
      },
      {
        "Time_Start": 2895.34,
        "Time_End": 2901.18,
        "Text": " We tried playing around a little bit with removing it, but we didn't have much success"
      },
      {
        "Time_Start": 2901.18,
        "Time_End": 2906.5,
        "Text": " where everything still worked smoothly and looked like from the outside everything is"
      },
      {
        "Time_Start": 2906.5,
        "Time_End": 2908.1,
        "Text": " fine."
      },
      {
        "Time_Start": 2908.1,
        "Time_End": 2911.78,
        "Text": " It is one of the hardening options we still want to see a little bit if we can add this"
      },
      {
        "Time_Start": 2912.02,
        "Time_End": 2917.9,
        "Text": " as an additional flag for more security if you want to deploy this in production."
      },
      {
        "Time_Start": 2917.9,
        "Time_End": 2918.9,
        "Text": " It's a good idea."
      },
      {
        "Time_Start": 2918.9,
        "Time_End": 2924.02,
        "Text": " We tried it out and couldn't make it work yet, but it's still on the radar."
      },
      {
        "Time_Start": 2924.02,
        "Time_End": 2930.1400000000003,
        "Text": " Do you know if Certify or Certify looks for that the CA is actually in the NT art store?"
      },
      {
        "Time_Start": 2930.1400000000003,
        "Time_End": 2935.98,
        "Text": " So I think in our test yesterday, we saw it didn't, but that's a check that can be easily"
      },
      {
        "Time_Start": 2935.98,
        "Time_End": 2936.98,
        "Text": " implemented, right?"
      },
      {
        "Time_Start": 2936.98,
        "Time_End": 2940.7400000000002,
        "Text": " I think that's something the two developers would probably fix reasonably quick."
      },
      {
        "Time_Start": 2940.7400000000002,
        "Time_End": 2948.18,
        "Text": " Also, like the root certificate of the Honeypot CA is currently not added to the trusted root"
      },
      {
        "Time_Start": 2948.18,
        "Time_End": 2953.22,
        "Text": " certs in the domain, which is also not checked by Certify."
      },
      {
        "Time_Start": 2953.22,
        "Time_End": 2954.22,
        "Text": " Yet."
      },
      {
        "Time_Start": 2954.22,
        "Time_End": 2955.22,
        "Text": " Thanks."
      },
      {
        "Time_Start": 2955.22,
        "Time_End": 2966.82,
        "Text": " We have a question."
      },
      {
        "Time_Start": 2966.82,
        "Time_End": 2970.5,
        "Text": " Thank you for your talk regarding your experience you've made."
      },
      {
        "Time_Start": 2970.5,
        "Time_End": 2976.94,
        "Text": " Would you recommend and suggest only set up and install your individual Honeypots that"
      },
      {
        "Time_Start": 2976.94,
        "Time_End": 2980.9,
        "Text": " fits quite well into your existing infrastructure?"
      },
      {
        "Time_Start": 2980.9,
        "Time_End": 2986.5,
        "Text": " Because I'm assuming if you buy one of the big deception technology products, they come"
      },
      {
        "Time_Start": 2986.5,
        "Time_End": 2989.88,
        "Text": " off with their own virtualization, their own orchestration."
      },
      {
        "Time_Start": 2989.88,
        "Time_End": 2994.5,
        "Text": " And when it comes to timing and fingerprinting, or even routing tables, when you are on prem,"
      },
      {
        "Time_Start": 2994.5,
        "Time_End": 3003.22,
        "Text": " it should be quite easy to detect that there is a Honeypot in place."
      },
      {
        "Time_Start": 3003.22,
        "Time_End": 3008.7,
        "Text": " So yeah, I think there are options to detect that if it's set up with, let's say, commercial"
      },
      {
        "Time_Start": 3008.7,
        "Time_End": 3011.46,
        "Text": " tooling compared to really doing it yourself."
      },
      {
        "Time_Start": 3011.46,
        "Time_End": 3014.22,
        "Text": " I agree with your points."
      },
      {
        "Time_Start": 3014.22,
        "Time_End": 3019.46,
        "Text": " I still think that for a lot of attackers, they are enough."
      },
      {
        "Time_Start": 3019.46,
        "Time_End": 3024.46,
        "Text": " And like a normal ransomware gang wouldn't measure the response timings on certain services."
      },
      {
        "Time_Start": 3025.42,
        "Time_End": 3028.2200000000003,
        "Text": " But yeah, if you want to do it perfect, and if you want to catch, let's say, the big nation"
      },
      {
        "Time_Start": 3028.2200000000003,
        "Time_End": 3031.94,
        "Text": " state actors, that's definitely a consideration."
      },
      {
        "Time_Start": 3031.94,
        "Time_End": 3035.94,
        "Text": " Okay, thank you."
      },
      {
        "Time_Start": 3035.94,
        "Time_End": 3040.54,
        "Text": " Any more questions?"
      },
      {
        "Time_Start": 3040.54,
        "Time_End": 3041.54,
        "Text": " Doesn't look like it."
      },
      {
        "Time_Start": 3041.54,
        "Time_End": 3042.54,
        "Text": " Then thank you very much for your presentation."
      },
      {
        "Time_Start": 3042.54,
        "Time_End": 3043.54,
        "Text": " Appreciate it for your contribution to Troopers."
      },
      {
        "Time_Start": 3043.54,
        "Time_End": 3044.54,
        "Text": " So I'll give a round of applause."
      },
      {
        "Time_Start": 3044.54,
        "Time_End": 3045.54,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3045.54,
        "Time_End": 3046.54,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3046.54,
        "Time_End": 3047.54,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3047.54,
        "Time_End": 3048.54,
        "Text": " Thank you."
      },
      {
        "Time_Start": 3048.54,
        "Time_End": 3049.04,
        "Text": " Thank you."
      }
    ]
  }
}