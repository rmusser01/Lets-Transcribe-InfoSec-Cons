- **Introduction:**
    - Speaker: Roy, Security Research Team Lead at SafeBridge
    - Topic: Turning Google Drive and OneDrive into double agent ransomware
    - **Ransomware:** a significant and growing threat, with increasing payments and attacks.
- **Research Goals:**
    - Create a fully undetectable ransomware by leveraging cloud storage services.
    - Find a legitimate way to encrypt files without executing code or leaving malicious traces.
- **Double Agents:**
    - Cloud storage services like Google Drive and OneDrive perform mass file operations.
    - Changes in the cloud trigger file operations on local machines.
    - These services can be influenced without leaving traces, making them ideal double agents.
- **Google Drive & OneDrive:**
    - Google Drive: Most popular cloud storage with billions of users.
    - OneDrive: Microsoft's recommended solution against ransomware, installed by default on Windows since 2013.
    - Both services create local sync directories, continuously synchronizing files with the cloud.
- **Recruiting Double Agents:**
    - Goal: Gain access to the logged-in account and its cloud storage.
    - Methods: Steal credentials or tokens, which are accessible with current user permissions.
    - Google Drive: Token stored in current user's credential set.
    - OneDrive: Token written in plain text in logs, allowing API requests with authorization header.
- **DoubleDrive Attack Flow:**
    - Initial access like any ransomware.
    - Synchronize local directories targeted for encryption.
    - Steal token and exfiltrate it by uploading to victim's account and sharing with attacker's temporary email.
    - Encrypt files in the cloud, triggering changes on the local machine.
    - Prevent file recovery by deleting target files, emptying recycle bin, and creating encrypted versions.
    - Additional stage: Ensure no email notifications or ransomware detection alerts are triggered.
- **Comparison of Google Drive and OneDrive:**
    - Synchronizing local directories:
        - Google Drive: Modify proprietary settings database, potentially detectable.
        - OneDrive: Create links in the sync folder, legitimate and harder to detect.
    - Stealing the token:
        - Google Drive: Retrieve from current user's credential set, potentially detectable.
        - OneDrive: Read from logs, a legitimate operation.
    - File recovery prevention:
        - Google Drive: Offers permanent deletion API.
        - OneDrive: No permanent deletion, but recycle bin can be emptied using Android app API.
    - Ransomware awareness:
        - Google Drive: Doesn't promote security features, acts like a normal cloud storage service.
        - OneDrive: Marketed as anti-ransomware, but doesn't offer effective protection.
- **Vendor Responses:**
    - MSRC acknowledged the importance of reported cases but did not grant CV.
    - EDR vendors developed new detection techniques, except Sentinel One, who saw no security implications.
    - Microsoft fixed the issue of printing the token in logs but didn't respond regarding Defender for Endpoint bypass.
- **Summary & Takeaways:**
    - No process should be trusted by default, even those developed by Microsoft.
    - Prepare for the next generation of ransomware with creative attack methods.
    - Invest in separating access between normal and security features.
    - QR code for DoubleDrive repo provided for further exploration.