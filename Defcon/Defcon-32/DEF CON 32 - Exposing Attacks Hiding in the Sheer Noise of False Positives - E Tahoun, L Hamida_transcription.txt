{
  "webpage_url": "https://www.youtube.com/watch?v=h8E6w3vVzWo",
  "title": "DEF CON 32 - Exposing Attacks Hiding in the Sheer Noise of False Positives - E Tahoun, L Hamida",
  "description": "In the complex landscape of modern cybersecurity, identifying coordinated attacks within massive volumes of security data is a formidable challenge. Security professionals often grapple with distinguishing these attacks from numerous false positives and isolated incidents. This talk will illuminate how data science can be harnessed to transform tons of heterogeneous events, logs, and alerts into a bunch of clusters, a few kill chains, and fewer actionable insights, with open-source models, and security knowledge encoding. Join us on a journey to enhance security operations efficacy and efficiency! No data science expertise is required!",
  "channel_url": "https://www.youtube.com/channel/UC6Om9kAkl32dWlDSNlDS9Iw",
  "duration": 3323,
  "channel": "DEFCONConference",
  "uploader": "DEFCONConference",
  "upload_date": "20241016"
}

0.00s - 5.32s | This text was transcribed using whisper model: large-v2

 I'm Ming from the Packet Hacking Village, and this last and final talk of the day is
5.32s - 10.28s |  uh, sponsored by the Packet Hacking Village, and it is our pleasure to introduce to you
10.28s - 11.28s |  Ez Tahoun!
11.28s - 12.28s |  Let's just talk.
12.28s - 17.50s |  Hello, hello.
17.50s - 18.50s |  Hey, everybody.
18.50s - 19.50s |  My name is Ez.
19.50s - 24.90s |  I'm here to talk a little, a little, about AI, because I know everybody got baited here
24.90s - 28.70s |  into AI, but the more the merrier, you know.
28.70s - 33.82s |  I'll talk more about the use case, less about AI, but before we start, how is everybody's
33.82s - 34.82s |  DevCon?
34.82s - 35.82s |  Yeah?
35.82s - 36.82s |  Alright.
36.82s - 38.78s |  Hell yeah.
38.78s - 42.26s |  Are you guys more on the blue team side?
42.26s - 43.26s |  Anybody here on the blue team?
43.26s - 44.26s |  Blue teamers?
44.26s - 45.26s |  Holy moly.
45.26s - 46.26s |  Alright.
46.26s - 47.26s |  The whole, this side is blue team?
47.26s - 48.26s |  This side is red team?
48.26s - 49.26s |  Who's on this side?
49.26s - 50.26s |  Are you guys red teamers, by any chance?
50.26s - 51.26s |  Okay.
51.26s - 52.26s |  What the hell is going on on this side?
52.26s - 53.26s |  Are you guys, like, cloud engineers?
53.26s - 54.26s |  Network engineers?
54.26s - 55.26s |  Purple?
55.26s - 56.26s |  Lots of purples.
56.26s - 57.26s |  Data scientists?
57.26s - 58.26s |  Lots of data scientists.
58.26s - 59.26s |  Alright.
59.26s - 60.26s |  Email security?
60.26s - 62.93s |  Goddamn.
62.93s - 63.93s |  Alright.
63.93s - 64.93s |  That's pretty cool.
64.93s - 65.93s |  Alright.
65.93s - 66.93s |  So, a lot of blue teamers.
66.93s - 67.93s |  A few data scientists made it in.
67.93s - 68.93s |  So, thank you for, you know, coming into a talk that has AI in the title.
68.93s - 69.93s |  I know that, that doesn't work.
69.93s - 70.93s |  People usually get scared of that word.
70.93s - 71.93s |  I remember at Black Hat, I got sold to while I was pissing in a urinal, and it was an AI.
71.93s - 72.93s |  So, I was like, uh, you know, like, there's a lot of AI, and you don't know what to do
72.93s - 73.93s |  with it.
73.93s - 74.93s |  So, I was like, uh, you know, like, there's a lot of AI, and you don't know what to do
74.93s - 75.93s |  with it.
75.93s - 76.93s |  So, I was like, uh, you know, like, there's a lot of AI, and you don't know what to do
76.93s - 77.93s |  with it.
77.93s - 79.93s |  I know that, that doesn't work.
79.93s - 81.85s |  People usually get scared of that word.
81.85s - 86.73s |  I remember at Black Hat, I got sold to while I was pissing in a urinal, and it was an AI.
86.73s - 92.17s |  So, I was like, uh, you know, like, there's a lot of AI, and you don't know what the hell
92.17s - 93.77s |  works and what the hell doesn't.
93.77s - 97.73s |  But the right framework that I will try to push on you today is essentially, talk about
97.73s - 102.29s |  the use case, less about the tool, convince me about the use case first, and then we'll
102.29s - 103.79s |  figure out how to do it.
103.79s - 104.79s |  Right?
104.79s - 108.03s |  So my talk is going to be all about context is all you need.
108.03s - 110.59s |  I have a few practitioners here.
110.59s - 113.07s |  There's George Cizerou at Ruby.
113.07s - 116.23s |  And there's Harry CIO at SAP AnnaSquare.
116.23s - 119.23s |  They're essentially the people that I bring in whenever
119.23s - 122.23s |  I have to get some validation on the problem.
122.23s - 125.75s |  So I'll try to throw them a few curveballs every now and then.
125.75s - 127.71s |  If you guys want to come up and do a quick intro,
127.71s - 128.63s |  that's fine as well.
128.63s - 130.35s |  You want to come up?
130.35s - 131.47s |  Not feeling like it?
131.47s - 132.79s |  Is everybody so tired at 5?
132.79s - 134.47s |  Is that what's going on?
134.47s - 136.67s |  You're drinking a Red Bull, and you're tired?
136.67s - 138.43s |  What the hell is wrong with that Red Bull?
138.43s - 140.75s |  Is it expired?
140.75s - 147.35s |  There are stairs on this side.
147.35s - 147.85s |  Go ahead.
147.85s - 148.35s |  100%.
148.35s - 150.31s |  Go for it, Harry.
150.31s - 156.15s |  Harry Sorori, NS2, SAP, supporting
156.15s - 159.19s |  Department of Defense.
159.19s - 161.39s |  It's about a $4.5 billion project
161.39s - 164.27s |  that I'm heading over there.
164.27s - 166.87s |  Lots of fun things, especially when
167.39s - 171.11s |  dealing with defense and all that good stuff.
171.11s - 173.59s |  There's a lot of moving parts there.
177.87s - 178.63s |  Hi, everyone.
178.63s - 180.07s |  My name is George Alcora.
180.07s - 183.91s |  I'm the CISO for Ruby Life.
183.91s - 186.91s |  I like to tell people that in my job,
186.91s - 189.87s |  I work to help people get securely laid.
189.87s - 193.07s |  I'm the CISO for, well, you've probably
193.07s - 195.11s |  heard the brand, Ashley Madison.
195.11s - 196.67s |  So we run online dating.
196.97s - 198.51s |  Ashley Madison is our flagship brand.
198.51s - 200.35s |  So that's where I work.
200.35s - 204.27s |  In terms of this, well, when I started my cybersecurity
204.27s - 206.99s |  career, I worked as a security operations analyst.
206.99s - 208.71s |  And I dealt with ArcSight.
208.71s - 210.59s |  If you guys remember ArcSight?
210.59s - 211.31s |  Oh, yeah.
211.31s - 212.83s |  Remember ArcSight?
212.83s - 214.75s |  So this is going to be a really relevant talk.
214.75s - 216.95s |  And Ezeldine's been killing it this afternoon, guys.
216.95s - 217.79s |  So please enjoy.
217.79s - 218.47s |  100%.
218.47s - 219.19s |  I appreciate you.
219.19s - 219.67s |  Please grab a seat.
219.67s - 220.83s |  Can I make a disclaimer?
220.83s - 221.87s |  Oh, more disclaimers.
221.87s - 223.41s |  I don't know if the mics are working.
223.41s - 225.43s |  Are the mics working, folks?
225.43s - 227.43s |  If you may enable them, that would be fantastic.
227.43s - 232.39s |  This way, they don't have to come back and forth.
232.39s - 233.55s |  Disclaimer is all yours.
233.55s - 236.71s |  I'm not a subscriber of Ashley Madison,
236.71s - 238.91s |  so I could keep my job.
238.91s - 239.67s |  Yes.
239.67s - 240.17s |  Yes.
240.17s - 241.47s |  I'll find your profile here.
241.47s - 242.11s |  Right.
242.11s - 244.15s |  None of us are in that breach, huh?
244.15s - 246.23s |  OK.
246.23s - 247.91s |  So the reason I bring in these folks
247.91s - 249.91s |  are essentially to talk more about the use case,
249.91s - 251.51s |  like what the hell is going on.
251.51s - 254.67s |  And usually, if I give them the mic,
254.67s - 256.51s |  they start talking about incidents.
256.51s - 258.95s |  And they tell you, oh, in this incident,
258.95s - 260.79s |  we found so much shit.
260.79s - 262.27s |  Here's how it started.
262.27s - 263.83s |  Step one, we found this thing.
263.83s - 265.39s |  Step two, there was this other thing.
265.39s - 267.71s |  Step three, there was this other thing that we found out
267.71s - 268.87s |  and we uncovered.
268.87s - 270.59s |  And what they're essentially telling you
270.59s - 273.59s |  is they have so much good investigators and their team
273.59s - 275.99s |  and outstanding contextualization
275.99s - 278.03s |  that these humans did.
278.03s - 280.95s |  So context, apparently, is very important.
280.95s - 282.43s |  And let's talk a little about that.
282.43s - 283.75s |  You guys are all blue teamers, so I'm not
283.75s - 285.19s |  going to bore you with the bullshit.
285.19s - 287.19s |  But here's a quick agenda.
287.19s - 288.87s |  The agenda is, who the hell am I?
288.87s - 291.95s |  And then some challenges, a lot of challenges,
291.95s - 293.35s |  a little bit more.
293.35s - 295.55s |  And we're going to talk a little about MITRE ATT&CK.
295.55s - 297.47s |  Anybody knows what's MITRE ATT&CK?
297.47s - 299.07s |  Oh, everybody knows.
299.07s - 300.35s |  OK.
300.35s - 301.71s |  I'll do a quick brief.
301.71s - 304.35s |  And then we're going to talk about the what, the when,
304.35s - 305.19s |  the who.
305.19s - 308.55s |  When you do an investigation, what the hell happened?
308.55s - 309.91s |  When did it happen?
309.91s - 310.87s |  And who was involved?
310.87s - 312.27s |  Tell me all the entities that are involved.
312.27s - 313.59s |  Tell me what the hell happened.
313.63s - 315.23s |  If you can do that with models, that's fantastic.
315.23s - 318.63s |  If you can't, I mean, do it anyways.
318.63s - 320.59s |  Do it the hard way, you know?
320.59s - 321.87s |  And then we're going to go through some examples.
321.87s - 325.35s |  And I don't know why I put QA at the end.
325.35s - 328.71s |  If you have questions, by all means, shout it out.
328.71s - 329.59s |  I'm being serious.
329.59s - 330.83s |  Shout it out.
330.83s - 333.31s |  If you're so polite you cannot do that, just raise your hand.
333.31s - 334.67s |  I will stop whatever the hell I'm saying,
334.67s - 335.91s |  and I'll take your question.
335.91s - 337.11s |  That's my promise.
337.11s - 337.99s |  All right.
337.99s - 338.59s |  Who the hell am I?
338.59s - 340.15s |  I'm a data scientist.
340.15s - 342.11s |  I used to be a data scientist at the SOC,
342.15s - 344.51s |  Royal Bank of Canada, Hawaii Horn Cyber Defense,
344.51s - 346.03s |  Forescout, a bunch of others.
346.03s - 347.99s |  But essentially, I'm a nerd,
347.99s - 351.91s |  and I do data science for the SOC.
351.91s - 353.39s |  What's the problem with cybersecurity?
353.39s - 355.59s |  Why does every year we have essentially
355.59s - 356.71s |  a much bigger problem?
358.03s - 361.39s |  I remember I did this similar talk about a year ago,
361.39s - 362.83s |  and I was talking about Colonial Pipeline.
362.83s - 364.39s |  This year I'm talking about CrowdStrike.
364.39s - 366.71s |  Every year there's something that's way worse, right?
366.71s - 369.15s |  So why do things keep on getting worse?
369.15s - 370.75s |  And maybe CrowdStrike is not the best,
370.79s - 373.79s |  but the other ones are not as popular.
373.79s - 376.63s |  CrowdStrike seems to be popular this time around.
376.63s - 380.31s |  But essentially, attacks seem to be a lot stealthier, right?
380.31s - 382.23s |  And the folks here that work at Blue Team,
382.23s - 383.87s |  they know the job is not very easy.
383.87s - 386.51s |  They came up here because there was AI,
386.51s - 388.19s |  and there was SOC, and they were like, fuck yeah.
388.19s - 390.11s |  Somebody's gonna automate my job?
390.11s - 390.95s |  Fuck yeah.
390.95s - 391.91s |  Automate it, man.
391.91s - 393.91s |  I wanna get another one.
393.91s - 395.87s |  Nobody really likes their job in the SOC
395.87s - 397.95s |  because attacks are so fucking stealthy,
397.95s - 399.71s |  and they grow stealthier every year.
399.71s - 400.59s |  And guess what?
400.59s - 402.99s |  You take the fall because you're the SOC, right?
404.15s - 406.11s |  And because you're the SOC, you also have,
406.11s - 407.35s |  I don't know how many alerts a day.
407.35s - 409.11s |  I stopped updating that number,
409.11s - 410.51s |  but that number keeps on increasing.
410.51s - 411.83s |  But it doesn't matter,
411.83s - 412.87s |  because at the end of the day as a human,
412.87s - 415.55s |  you can only look at maybe like 20 tickets a day, right?
415.55s - 416.79s |  10 tickets.
416.79s - 419.07s |  Anybody here looks at 20 or more?
420.31s - 421.15s |  Yeah.
421.15s - 423.27s |  There's one guy who's probably a fucking genius.
423.27s - 424.43s |  He can look at more than 20.
424.43s - 428.35s |  I actually blank out after five tickets.
428.35s - 429.51s |  I used to work at the SOC.
429.51s - 431.99s |  Like after five tickets, everything sounds the same.
431.99s - 432.83s |  You know, I just like,
432.83s - 436.03s |  I wanna get by and my boss had this weird KPI of,
436.03s - 441.03s |  you know, MTTD, MTTR, whatever bullshit.
441.03s - 443.27s |  And it essentially just meant do it fast.
443.27s - 444.63s |  No one cares.
444.63s - 446.55s |  And they just did everything fast as you know,
446.55s - 449.59s |  like false positive, false positive, false positive.
449.59s - 450.79s |  Right?
450.79s - 451.67s |  You don't want it fast, man.
451.67s - 453.15s |  Sure, I'll get it to you.
453.15s - 455.59s |  I'll get it in 20 seconds if I have to.
455.59s - 458.71s |  But we have so many tools.
458.71s - 460.99s |  I was telling you about Black Hat, terrible experience.
460.99s - 462.71s |  There's like a shit ton of tools everywhere.
462.71s - 463.67s |  Vendors are everywhere.
463.67s - 466.23s |  Can't even find non-vendors anymore.
466.23s - 468.03s |  But there's a lot of vendors.
468.03s - 469.27s |  There's a lot of tools.
469.27s - 471.47s |  And somehow security is worse.
471.47s - 472.51s |  How did that work?
472.51s - 473.35s |  I don't know.
474.75s - 475.59s |  Right?
486.12s - 488.00s |  100%, 100%.
488.00s - 489.28s |  You're on top of it.
489.96s - 491.92s |  Give this man a cookie, right?
491.92s - 493.72s |  You're on top of it.
493.72s - 496.69s |  It's a lot.
496.69s - 497.53s |  Hell yeah.
498.49s - 501.57s |  At 5 p.m. everybody wants a Red Bull, right?
501.57s - 503.49s |  But yeah, we have a lot of tools.
503.49s - 504.41s |  We have a lot of alerts.
504.41s - 505.45s |  We have a lot of shit.
505.45s - 508.61s |  And it's all up to not acquiring more.
508.61s - 511.61s |  It's up to people and process, not technology anymore.
528.99s - 534.45s |  Yeah, that's also presuming that over that three to four year
534.45s - 537.73s |  cycle, you have the same staff and personnel manning your sock.
537.73s - 539.53s |  Let's not forget about turnover, eh?
540.57s - 541.41s |  Yeah.
547.19s - 548.99s |  Dude, I'd fucking buy you a beer tonight.
548.99s - 551.71s |  Like, you know what's up and you speak it out.
551.71s - 552.91s |  Like, I fucking love you, man.
552.91s - 554.15s |  Like, that's what's up.
554.15s - 556.67s |  So, hell yeah.
559.59s - 560.43s |  Hell yeah.
560.43s - 561.75s |  Yep, we need some of that.
561.75s - 562.59s |  We need some of that.
562.59s - 564.55s |  A lot of people are, you know.
564.55s - 565.39s |  I mean.
577.60s - 580.08s |  He was post-breach, though, yeah.
580.08s - 580.92s |  He's post-breach.
580.92s - 584.64s |  He came in to clean up, but dude, I was in fucking,
584.64s - 586.24s |  I was in that fucking data set.
586.24s - 589.52s |  I'm not, yep, yep.
589.52s - 591.96s |  Well, yeah, the funny part is, I was actually,
591.96s - 594.96s |  when that happened, I had started my career in cyber
594.96s - 596.80s |  having left military SIGINT.
596.80s - 598.96s |  So, I was working at a MSSP,
598.96s - 601.28s |  which had a lot of Government of Canada clients.
601.28s - 603.76s |  And so, the funny thing was in that breach list,
604.16s - 606.56s |  there was a lot of at Canada dot C addresses.
606.56s - 608.52s |  So, what a lot of people were doing,
608.52s - 610.00s |  cheating on their spouses,
610.00s - 612.56s |  were actually using their government email accounts,
612.56s - 614.56s |  their government work email accounts,
614.56s - 617.76s |  to get a platform or to get a profile on the site.
617.76s - 619.20s |  But then when they got popped,
619.20s - 621.64s |  not only was it an issue in terms of their spouse,
621.64s - 624.24s |  but now their employer was pretty pissed off at them.
624.24s - 641.40s |  And just saying, hey, that's Bitcoin.
641.40s - 642.24s |  Yep.
642.24s - 643.76s |  Well, there's been multiple.
643.76s - 646.47s |  Multi-extortion.
646.47s - 647.95s |  The funny thing is about that,
648.15s - 649.51s |  I don't want to derail this talk,
649.51s - 652.67s |  but like, the funny thing about that is to this day,
652.67s - 655.11s |  I mean, they use that old list
655.11s - 657.11s |  because Troy Hunt posted it, right?
657.11s - 660.43s |  So, everyone uses that list and tries to act like
660.43s - 663.39s |  it's a new breach info or a new credential to pop off,
663.39s - 665.71s |  but it's like still the 2015 credential.
665.71s - 668.71s |  That person's moved on from the site well beyond,
668.71s - 672.11s |  but they're still trying to run attempts on the old creds.
672.11s - 675.67s |  So, I think it's just, it's a taboo thing.
676.67s - 677.75s |  Everyone's been popped.
677.75s - 679.35s |  SolarWinds been popped.
679.35s - 681.51s |  Like British Airways has been popped.
681.51s - 683.23s |  How many countless breaches have happened
683.23s - 684.91s |  of major enterprises?
684.91s - 686.87s |  Yeah, those are the ones we're talking about.
686.87s - 688.15s |  Those are the ones we know about.
688.15s - 689.51s |  Yeah.
689.51s - 691.11s |  It's just cause it's got,
691.11s - 693.95s |  it has to do with sex and everyone thinks it's taboo.
697.91s - 698.75s |  Yep.
700.75s - 704.79s |  Hell yeah.
704.79s - 706.39s |  I appreciate your service, sir.
707.39s - 711.65s |  But yeah, I mean, I can turn this into a SkyTalk
711.65s - 713.89s |  and we can start ranting, you know, like,
713.89s - 715.93s |  I can fucking rant.
715.93s - 716.77s |  No, no, no.
716.77s - 717.61s |  I'm-
717.61s - 719.33s |  Is this turning into sock therapy?
719.33s - 720.81s |  Sock therapy is valid too.
720.81s - 722.13s |  Look up my fucking agenda, bro.
722.13s - 723.13s |  It's like all SkyTalk.
723.13s - 724.17s |  It's all ranting.
724.17s - 725.37s |  Like the machine learning is like,
725.37s - 726.77s |  you know, number 5.8.
728.77s - 729.93s |  I'm all about the rant, bro.
729.93s - 732.21s |  Like that's, it's the use case, right?
732.21s - 735.61s |  It's like, what's broken and how do we fix it, right?
735.61s - 736.93s |  But yeah.
737.53s - 738.77s |  But yeah, you're on top of it.
738.77s - 742.13s |  Like too many tools, too many rules, too many playbooks,
742.13s - 743.93s |  too many whatever the fuck you want to call them.
743.93s - 746.65s |  It's just searches, lookups, right?
746.65s - 749.53s |  And who has to tune those?
749.53s - 750.77s |  The people in the process.
750.77s - 752.53s |  But we don't want to buy those.
752.53s - 753.49s |  We want to buy the technology.
753.49s - 755.05s |  So we want to buy the sexiest shit
755.05s - 756.97s |  and we want to install the sexiest shit.
756.97s - 757.81s |  Do we have the right people
757.81s - 759.01s |  in process for that technology?
759.01s - 760.17s |  Nope.
760.17s - 761.01s |  Do we care?
761.01s - 761.85s |  Nope.
761.85s - 764.69s |  We care about AI because I'm a new leader
764.69s - 766.49s |  and I want to put AI in my company
767.49s - 769.69s |  and you guys deal with it until you stop dealing with it
769.69s - 771.89s |  and the company's fucked and now I leave
771.89s - 773.77s |  and they get the new guys, right?
774.89s - 777.49s |  So it's just so bloated and ineffective
777.49s - 779.13s |  for a variety of reasons.
779.13s - 781.05s |  Most of these reasons are not technology.
781.05s - 783.61s |  Most of these reasons are people in process.
783.61s - 785.73s |  And since I baited you all with AI,
785.73s - 788.37s |  I will give you a lot more people in process today.
788.37s - 790.73s |  So what the hell is wrong with our security?
790.73s - 794.09s |  Why is it so less secure than what it was 50 years ago?
794.09s - 795.57s |  Well, the naive way to think about this
795.65s - 797.33s |  is it used to be so simple.
797.33s - 798.65s |  It's not even apples to apples.
798.65s - 800.21s |  It used to be so fucking simple.
800.21s - 802.45s |  Now it's so fucking complicated, right?
802.45s - 804.25s |  And to hack Stuxnet,
804.25s - 808.45s |  you had a virus circulate the entire world for two years.
808.45s - 810.21s |  Finally, someone picked it up on a USB,
810.21s - 812.53s |  put it in the printer to print an assignment for their kid
812.53s - 813.97s |  and boom, bada boom, right?
813.97s - 817.65s |  But in reality, if you want to do Stuxnet today,
817.65s - 819.13s |  there's like a smart grid.
819.13s - 820.81s |  There's like people selling solar power
820.81s - 822.09s |  back to the nuclear plant
822.09s - 824.05s |  and some bullshit like that on the smart grid
824.09s - 826.65s |  where technically everything is connected
826.65s - 830.25s |  and the attack surface is like so much easier.
830.25s - 832.05s |  What do you mean we have to wait for two years
832.05s - 833.65s |  for someone to put it on a USB?
833.65s - 835.29s |  Not anymore.
835.29s - 839.77s |  So this is essentially why everybody here is so vibing
839.77s - 842.13s |  when we are complaining
842.13s - 846.25s |  because we are constantly waiting for that talk at DEF CON
846.25s - 848.01s |  that will come and automate our jobs
848.01s - 850.61s |  and take it away from us so that we can do something else.
850.61s - 851.61s |  We don't want to be analysts.
851.61s - 852.65s |  We want to be engineers.
852.65s - 853.61s |  We want to be architects.
853.61s - 854.89s |  We want to be cloud folks.
854.89s - 857.53s |  Fuck it, we want to be compliance folks if we have to.
857.53s - 858.37s |  Any...
859.89s - 861.45s |  No hate on the compliance folks,
863.17s - 864.25s |  but essentially like we can,
864.25s - 865.61s |  I could be a freaking salesperson
865.61s - 866.81s |  instead of being a SOC analyst.
866.81s - 868.69s |  You know, like it's shit,
868.69s - 871.81s |  but what does it take for a SOC analyst?
871.81s - 873.77s |  What is actually so hard?
873.77s - 876.77s |  And the expensive folks at SANS,
876.77s - 878.61s |  they run a SOC survey
878.61s - 881.25s |  and in the SOC survey for the last six, seven years,
881.25s - 882.41s |  it's always been the same shit.
882.41s - 884.81s |  People go and they vote on what's the thing
884.81s - 885.81s |  they hate the most,
885.81s - 887.69s |  what the thing essentially is
887.69s - 890.13s |  we're going to all hang our trouble on.
890.13s - 892.01s |  And it's always, always, always lack of
892.01s - 895.49s |  quote, quote, beautiful, sweet correlation.
895.49s - 897.77s |  What the hell is correlation?
897.77s - 899.49s |  I don't know if someone knows what that is correlation,
899.49s - 900.65s |  but essentially just says like,
900.65s - 902.33s |  what that is relevant to what?
902.33s - 903.97s |  And it's like so ambiguous
903.97s - 907.09s |  that people can sell you what they call correlation searches
907.09s - 908.57s |  if it's looking for like two things
908.57s - 909.97s |  that it's going to put together
910.01s - 912.49s |  if they fit a specific rule, right?
913.69s - 915.09s |  But that's all good
916.37s - 918.61s |  if you have all of your data in one place.
919.57s - 922.41s |  How many people here have everything they need in the SIM?
924.65s - 925.97s |  Yes.
925.97s - 927.37s |  Nobody, right?
927.37s - 928.21s |  Which one?
928.21s - 929.05s |  Yes.
929.05s - 930.61s |  Do you want the Splunk or the Elastic or the S3 bucket?
930.61s - 932.21s |  Like which one do you want, bro?
933.53s - 934.37s |  Damn.
934.37s - 935.21s |  Okay. Which index?
935.21s - 936.05s |  Which silo on it?
936.05s - 936.89s |  Okay.
937.85s - 938.85s |  Yeah.
938.85s - 941.55s |  Yeah.
942.59s - 943.43s |  I have a sock for insider threat.
943.43s - 944.51s |  I have a sock for this guy.
944.51s - 945.87s |  I have a sock for the NERC SIP.
945.87s - 947.23s |  I have a sock for whatever.
947.23s - 949.47s |  I have a sock at the company we bought.
949.47s - 951.03s |  It's not technically part of our company,
951.03s - 952.59s |  but it's, you know, it's a sub-organization.
952.59s - 953.99s |  It's like another entity that we bought.
953.99s - 956.15s |  They have their own sock and they don't give us the shit.
956.15s - 958.15s |  We have a sock that works part of a NOC.
958.15s - 959.87s |  We have a sock that's called Data Fusion
959.87s - 961.07s |  that the new leader made.
961.07s - 962.87s |  You know, I know what's up.
962.87s - 967.51s |  So if we don't have all the data in one place,
967.51s - 969.75s |  can we put all the data in one place?
969.79s - 972.27s |  Wouldn't that be a pretty nice process, right?
972.27s - 974.63s |  Like let's get as much data in one place.
974.63s - 976.15s |  And then we start talking about money.
976.15s - 978.87s |  Like, dude, it costs a shit ton to get it into one place.
978.87s - 981.35s |  And by the way, to get it in one place,
981.35s - 983.23s |  I have to put everything in one data model.
983.23s - 984.83s |  I have to make sure I have the right, you know,
984.83s - 986.71s |  parsers or whatnot.
986.71s - 987.83s |  It's 2024.
988.71s - 991.07s |  LLMs can actually make you, like,
991.07s - 993.39s |  any kind of data model into any other data model.
993.39s - 994.75s |  So we have an open source thing.
994.75s - 996.47s |  If you go to GitHub Sapienta,
996.47s - 999.35s |  we get anything in any data model put into one data model.
999.35s - 1000.91s |  And it's also 2024.
1000.91s - 1002.43s |  Storage is so fucking cheap.
1002.43s - 1004.79s |  I don't know why do you have to put it into a SIM,
1004.79s - 1007.19s |  put it into a fucking S3 bucket as a cold archive.
1007.19s - 1008.47s |  It's cheap enough.
1008.47s - 1010.23s |  If you can get it all there
1010.23s - 1012.83s |  and you can fight the people to get it all there
1012.83s - 1015.07s |  and you can call everybody and get the right data,
1015.07s - 1017.63s |  you can have the dream kind of thing
1017.63s - 1019.27s |  where you have everything in one S3.
1019.27s - 1021.63s |  If you don't get the entire dream, that's fine.
1021.63s - 1023.31s |  If you can get like 70% of that dream,
1023.31s - 1025.83s |  get just like everything into like a cheap storage
1025.83s - 1027.79s |  and a cloud, that'll be fantastic.
1027.79s - 1029.59s |  Because if you have everything in one place,
1029.59s - 1031.71s |  ideally in dreamland,
1032.71s - 1034.91s |  and you can pull it off without wasting a lot of money
1034.91s - 1035.75s |  or asking for budget,
1035.75s - 1036.75s |  just put it in cloud,
1036.75s - 1039.31s |  cost 20 cents a terabyte or something like that, right?
1039.31s - 1040.91s |  On S3.
1040.91s - 1043.87s |  You can essentially have almost everything you need
1043.87s - 1047.27s |  to run these kind of queries, right?
1047.27s - 1049.19s |  Because what do we have in the SOC today?
1049.19s - 1050.39s |  It's 2024.
1050.39s - 1053.87s |  We have the same shit that we used to do before I was born,
1053.87s - 1055.31s |  queries and playbooks.
1055.31s - 1056.83s |  Why?
1056.83s - 1058.43s |  We can trust that shit, right?
1058.43s - 1059.51s |  We can trust it.
1059.51s - 1060.63s |  It's explainable.
1060.63s - 1061.47s |  It's adaptable.
1061.47s - 1062.39s |  It's customizable.
1062.39s - 1063.23s |  It's transparent.
1063.23s - 1067.01s |  Yes.
1079.63s - 1080.47s |  That's true.
1080.47s - 1081.31s |  That's true.
1081.31s - 1082.15s |  A lot of the insider threat data
1082.15s - 1083.55s |  could not be given to the SOC.
1083.55s - 1084.63s |  It's PIIs.
1084.63s - 1085.47s |  Yeah.
1085.47s - 1087.27s |  The risk compliance people
1087.27s - 1089.23s |  are not gonna let you have your insider threat data there.
1089.23s - 1090.95s |  If you have UEBA, they're not gonna let you have it.
1090.95s - 1092.79s |  If you have endpoints or emails
1092.79s - 1094.67s |  or stuff from Outlook or whatnot, nope.
1094.67s - 1096.71s |  You're not gonna have that in the SOC, no way.
1096.71s - 1098.83s |  But if we can get as close as possible,
1099.75s - 1101.23s |  we can get something there.
1101.23s - 1103.59s |  And the point is we use queries and playbooks
1103.59s - 1106.19s |  because I can fucking trust that shit.
1106.19s - 1107.07s |  Like I trust it.
1107.07s - 1107.91s |  I can see it.
1107.91s - 1108.75s |  I can read the rule.
1108.75s - 1109.83s |  Look at how nice it is.
1109.83s - 1110.91s |  It's so open.
1110.91s - 1112.03s |  It's so transparent.
1112.03s - 1113.51s |  It's so nice.
1113.51s - 1115.35s |  I can actually read that shit.
1115.35s - 1117.15s |  I fully understand when it triggers.
1117.15s - 1120.23s |  It triggers when it finds these kind of stuff in the query.
1120.23s - 1122.91s |  Command, all kinds of commands in my web shell traffic
1122.91s - 1125.95s |  or in my web traffic in general as a post,
1125.95s - 1126.83s |  that's when it triggers.
1126.83s - 1127.99s |  I completely understand that.
1128.03s - 1129.27s |  Can you say that about an LLM?
1129.27s - 1130.47s |  Hell no.
1130.47s - 1132.59s |  How many people here are using anomaly detector?
1132.59s - 1134.27s |  Anomaly detection, UEBA?
1135.51s - 1136.35s |  Two people.
1136.35s - 1138.03s |  It's 2024, right?
1138.03s - 1139.07s |  Like five years ago,
1139.07s - 1142.19s |  a shit ton of people put their money on UEBA, right?
1142.19s - 1143.23s |  What's wrong with UEBA?
1143.23s - 1144.07s |  Why don't you use it?
1144.07s - 1144.91s |  Why do you use it?
1144.91s - 1155.92s |  What do you hate about it if you use it?
1155.92s - 1157.16s |  Oh.
1157.16s - 1158.00s |  It works.
1158.00s - 1161.32s |  If you say this is gonna give me everything I don't see
1161.32s - 1164.70s |  and all that's going to be broken.
1164.70s - 1167.10s |  I'm definitely buying you a beer tonight.
1167.14s - 1168.66s |  Bye.
1168.66s - 1169.50s |  Sorry, go ahead.
1170.82s - 1173.22s |  Yeah, yeah, 100%, come up.
1173.22s - 1174.74s |  Hell yeah, come up.
1174.74s - 1175.58s |  Woo-hoo.
1178.68s - 1179.52s |  Can you give us a quick intro?
1179.52s - 1181.00s |  Can we get the third mic running?
1181.00s - 1181.84s |  My dude.
1186.64s - 1187.68s |  Thank you.
1187.68s - 1189.04s |  Oh.
1189.04s - 1189.88s |  All good.
1189.88s - 1190.72s |  Sweet.
1190.72s - 1191.56s |  Thank you for coming up.
1192.60s - 1194.04s |  By popular choice.
1194.04s - 1195.56s |  The people's choice panelist.
1196.88s - 1197.72s |  My name's Walt.
1197.72s - 1199.36s |  I'm a 15 year schmo.
1199.44s - 1204.44s |  I'm in cyber defense working for the man.
1208.62s - 1209.82s |  And-
1209.82s - 1211.02s |  Uncle Sam?
1211.02s - 1211.86s |  That man, yeah.
1213.30s - 1214.18s |  I love that man.
1215.14s - 1220.14s |  But, and I started as a sock analyst
1220.22s - 1224.26s |  and I'm somewhere between senior sock analyst
1224.26s - 1227.98s |  and the guy in the office who does ML
1227.98s - 1230.22s |  and plays with the Splunk models
1230.74s - 1233.74s |  and tries to build the dashboards.
1233.74s - 1234.58s |  Oh yeah.
1235.54s - 1238.82s |  That's, and yeah, I'm loud and over opinionated.
1238.82s - 1242.82s |  I mean, yeah, yeah.
1242.82s - 1244.50s |  I hear you.
1244.50s - 1246.14s |  There's a lot of stuff that you didn't say
1246.14s - 1247.58s |  that, you know, I can feel it.
1247.58s - 1248.42s |  I was in the sock.
1248.42s - 1249.78s |  I was using Splunk.
1249.78s - 1252.70s |  I used MLTK, DSDL, all that good shit, eh?
1252.70s - 1253.54s |  What was that?
1253.54s - 1255.62s |  MLTK, machine learning toolkit.
1255.62s - 1256.46s |  Oh yes.
1256.46s - 1257.30s |  Deep science.
1257.30s - 1259.18s |  MLTK, I like it.
1259.18s - 1263.22s |  It works nicely for something that's embedded.
1263.22s - 1264.98s |  I haven't played with elastics
1264.98s - 1267.50s |  embedded machine learning that much yet.
1268.90s - 1270.22s |  I can do some stuff in scikit.
1270.22s - 1274.50s |  I have done stuff in scikit-learn.
1274.50s - 1276.10s |  I have a master's.
1276.10s - 1277.10s |  Nice.
1277.10s - 1278.74s |  I got it last year.
1278.74s - 1282.30s |  Oh, all fresh with all the data science.
1282.30s - 1286.98s |  Hey, and it's, I went there because there was a need.
1286.98s - 1287.82s |  Hell yeah.
1287.82s - 1290.38s |  Somebody has to be able to sit there and say,
1290.38s - 1293.42s |  the machine learning works for the use case
1293.42s - 1295.50s |  and don't buy the black box.
1295.50s - 1296.50s |  Hell yeah.
1296.50s - 1297.98s |  That's my role in the office.
1297.98s - 1298.82s |  Yes.
1298.82s - 1300.98s |  If they ask me if this actually makes sense,
1300.98s - 1302.94s |  then I figure out a way to use it.
1302.94s - 1303.78s |  That's amazing.
1303.78s - 1304.62s |  It's like taking my life
1304.62s - 1307.62s |  and just making it a lot more full of experience
1307.62s - 1309.30s |  kind of thing, you know?
1309.30s - 1311.30s |  Like I worked like a couple of years in the sock
1311.30s - 1313.38s |  and then I went into a PhD
1313.38s - 1315.78s |  to solve some issues in the sock.
1315.78s - 1318.34s |  You essentially worked a lot more in the sock,
1318.34s - 1319.66s |  saw a lot more bullshit.
1319.66s - 1322.14s |  So yeah, I'm going to refer a lot back to you.
1322.14s - 1323.58s |  If you have anything to say, just-
1323.58s - 1324.42s |  No worries.
1324.42s - 1325.26s |  Boom, right away.
1325.26s - 1326.90s |  I don't have to prompt you.
1326.90s - 1327.74s |  I'll just go for it.
1327.74s - 1329.74s |  Unfortunately, my daughter is now cringing.
1329.74s - 1330.58s |  Oh yes.
1330.58s - 1333.90s |  Right?
1333.90s - 1335.10s |  Yeah, I mean, you made it to the con.
1335.10s - 1336.06s |  What did you think?
1339.06s - 1339.90s |  All right.
1339.90s - 1341.74s |  So back to the discussion,
1341.74s - 1346.34s |  we love rules because they're understandable.
1346.34s - 1347.38s |  They're transparent.
1347.38s - 1348.34s |  I can customize them.
1348.34s - 1349.90s |  I can fucking give them feedback
1349.90s - 1351.46s |  and they can do whatever I want them to do.
1351.46s - 1352.70s |  I trust them.
1352.70s - 1355.30s |  I will never get fired without understanding why.
1356.18s - 1357.02s |  AI?
1357.02s - 1360.30s |  I'll get fired and I will be like, why?
1361.46s - 1362.58s |  Why did it not work?
1362.58s - 1365.22s |  The vendor told me it will work, right?
1365.22s - 1367.82s |  So anyways, rules are pretty nice.
1367.82s - 1370.22s |  Have you guys ever seen investigative playbooks?
1371.18s - 1372.02s |  Anybody know what that is?
1372.02s - 1373.30s |  An investigative playbook?
1373.30s - 1374.14s |  Okay.
1374.14s - 1376.66s |  So an investigative playbook is a fancy way to say,
1376.66s - 1378.98s |  you know, I have a bunch of searches
1378.98s - 1380.82s |  that go back to back to back to back.
1380.82s - 1383.26s |  And if they're within five minutes of each other,
1383.26s - 1385.74s |  they come all together within a ticket.
1385.74s - 1386.58s |  That's pretty much it.
1386.58s - 1390.18s |  It's like security analytics stories from Splunk.
1390.18s - 1393.50s |  In Splunk, they also now have the risk-based alerting.
1393.50s - 1396.94s |  Essentially just means like if something is scored
1396.94s - 1398.10s |  like five out of 10 risk,
1398.10s - 1399.50s |  and another thing is five out of 10 risk,
1399.54s - 1400.70s |  and they happen within five minutes,
1400.70s - 1402.50s |  boom, it's 10 out of 10 risk for both of them,
1402.50s - 1404.50s |  put them together in a ticket and tell me.
1404.50s - 1405.90s |  But essentially all of these nice things
1405.90s - 1408.94s |  are rules on top of rules on top of rules.
1408.94s - 1412.98s |  And every year, although it's 2020 fucking four,
1412.98s - 1417.82s |  we get new ways to apply rules as if we're in the 60s.
1417.82s - 1420.98s |  Why the hell are we not using any more like things
1420.98s - 1424.70s |  other than rules and solid, narrow logic?
1424.70s - 1426.26s |  Because we can not trust it.
1426.26s - 1427.10s |  Okay.
1427.98s - 1429.90s |  So what do we like so much about our rules?
1429.90s - 1431.02s |  What makes us trust them?
1431.02s - 1433.86s |  Well, I can also map them to MITRE ATT&CK techniques.
1433.86s - 1436.42s |  Anybody here, I'll ask this question one more time
1436.42s - 1439.50s |  just to, anybody here does not know what's MITRE ATT&CK,
1439.50s - 1441.14s |  and I will go through it quickly.
1442.14s - 1443.66s |  Okay, let's go through it quickly.
1443.66s - 1447.54s |  So MITRE ATT&CK is essentially a way to say what happened
1447.54s - 1450.10s |  when we talk about the what, the who, the when.
1450.10s - 1454.54s |  If I tell you, oh, this vendor says this thing happened,
1454.54s - 1455.98s |  and you don't have a common reference
1456.22s - 1457.54s |  for what the hell is this thing,
1457.54s - 1460.26s |  you don't really fully understand what is it.
1460.26s - 1462.38s |  And a lot of the people in this industry
1462.38s - 1465.90s |  are so scared to ask or say that they don't know.
1465.90s - 1468.18s |  So nobody actually figures out
1468.18s - 1469.38s |  what the hell are they talking about.
1469.38s - 1471.74s |  And they just keep on going and they never ask,
1471.74s - 1472.82s |  dude, I didn't understand that.
1472.82s - 1474.30s |  I don't know what's going on.
1474.30s - 1475.98s |  And just keep on going, right?
1475.98s - 1478.74s |  Everybody acts like, you know, they know it all.
1478.74s - 1480.18s |  And nobody wants to be, you know,
1480.18s - 1482.30s |  like the only person that asked the question.
1482.30s - 1484.86s |  But anyways, MITRE ATT&CK is solving that
1484.86s - 1486.58s |  as a big Wikipedia.
1486.58s - 1490.10s |  And this Wikipedia is essentially full of techniques.
1490.10s - 1492.62s |  And every technique has a procedural example.
1492.62s - 1493.86s |  It tells you how to detect it,
1493.86s - 1495.62s |  how to mitigate it and whatnot.
1495.62s - 1497.82s |  And one neat thing about MITRE is essentially
1497.82s - 1501.26s |  in MITRE ATT&CK, you can see that going left to right,
1501.26s - 1502.66s |  you're actually going sequentially.
1502.66s - 1504.42s |  So there is causality going left to right.
1504.42s - 1505.82s |  Damn, I lost my light.
1505.82s - 1507.42s |  Was that me by any chance?
1507.42s - 1508.50s |  That wasn't me, right?
1509.62s - 1510.46s |  No worries.
1510.46s - 1511.30s |  You guys can still see me.
1511.30s - 1513.98s |  I don't need a humongous light bulb in my face.
1513.98s - 1517.74s |  But going left to right, like you start at initial access.
1517.74s - 1519.38s |  So this is when I send you like an email
1519.38s - 1521.62s |  and tell you, yo, what's up?
1521.62s - 1524.02s |  You won a hundred million Bitcoins.
1524.02s - 1524.86s |  Click here.
1525.94s - 1528.46s |  And then once you click here, a bunch of shit happens,
1528.46s - 1530.58s |  including like execution, persistence,
1530.58s - 1533.90s |  privilege escalation, you know, the whole thing
1533.90s - 1535.42s |  until you end up at impact, right?
1535.42s - 1537.02s |  You end up with some sort of like ransom.
1537.02s - 1538.46s |  Now I'm extorting you.
1538.46s - 1539.50s |  You end up, maybe it was like
1539.50s - 1540.66s |  some sort of command and control.
1540.66s - 1542.90s |  Now we have something that keeps on moving your mouse
1542.90s - 1544.90s |  or something like that, right?
1544.90s - 1546.78s |  Okay, so that's the fun stuff at MITRE.
1546.78s - 1549.38s |  One more fun thing at MITRE.
1549.38s - 1553.02s |  At the SOC, we are always talking about single alerts,
1553.02s - 1556.58s |  single isolated, disjointed, siloed alerts.
1556.58s - 1559.94s |  And these are not how people talk about incidents.
1559.94s - 1561.70s |  If anybody here can talk about an incident,
1561.70s - 1562.62s |  that would be nice.
1562.62s - 1563.82s |  I don't mean to pick on you guys,
1563.82s - 1565.98s |  but can you share a single incident
1565.98s - 1568.30s |  that was like a full investigation, like end to end?
1568.30s - 1570.34s |  I know George might share one.
1570.34s - 1571.54s |  He kind of prepared one.
1572.54s - 1574.30s |  Or if you can go for it as well.
1574.30s - 1576.18s |  Whoever wants to go for like a full investigation,
1576.18s - 1578.06s |  like some sort of an APT that you can share,
1578.06s - 1578.90s |  some sort of like-
1578.90s - 1581.70s |  Yeah, APTs I can't share.
1581.70s - 1582.54s |  Right.
1582.54s - 1584.18s |  I can't share APTs, sorry.
1584.18s - 1585.78s |  The only thing I can share,
1585.78s - 1587.74s |  and you kind of saw or heard earlier.
1587.74s - 1589.30s |  Yeah, he's probably the only guy that will share
1589.30s - 1592.26s |  because DOD, DOD, so, you know.
1592.26s - 1594.58s |  This is fine because it happened years ago
1594.58s - 1597.46s |  and we weren't like told we had to be classified about it,
1597.46s - 1600.86s |  but like beyond the details of it.
1600.90s - 1604.66s |  But basically we had stopped at my previous employer,
1604.66s - 1607.62s |  a series of persistent DDoS attacks
1607.62s - 1609.54s |  that the campaign ran for,
1609.54s - 1612.50s |  I would say arguably about maybe almost two weeks.
1612.50s - 1614.30s |  And every day we were getting progressively worse
1614.30s - 1615.86s |  and worse attempts at us.
1615.86s - 1618.18s |  We were getting like higher and higher ping rates.
1618.18s - 1621.98s |  And so it was really crippling the latency
1621.98s - 1624.58s |  of our entire organization, our ability to work.
1625.74s - 1628.94s |  Eventually we were able to kind of change
1628.94s - 1629.82s |  rate limiting rules.
1629.82s - 1631.54s |  We were able to change certain configurations
1631.54s - 1633.14s |  within the infrastructure that allowed us
1633.14s - 1636.34s |  to retain traffic flow once again.
1636.34s - 1640.22s |  And suddenly we found that the attacks had stopped
1640.22s - 1642.66s |  and we didn't really know what happened.
1644.30s - 1646.94s |  We got a weird call, because I'm Canadian.
1646.94s - 1649.98s |  We had a weird call about, I'd say 12 days later
1649.98s - 1652.14s |  from our public safety department,
1652.14s - 1654.18s |  which is kind of like our department
1654.18s - 1656.10s |  that has all the intelligence agencies.
1656.10s - 1658.74s |  And so folks from our CSIS,
1658.74s - 1662.34s |  which is like our CIA, came up and told us,
1662.34s - 1663.90s |  and they sat us down for a briefing
1663.90s - 1665.66s |  with our senior executives,
1665.66s - 1669.66s |  that we were actually, we were attacked by Fancy Bear.
1669.66s - 1672.90s |  And we'd actually repelled the attack by Fancy Bear,
1672.90s - 1674.50s |  which was fucking wild.
1677.18s - 1679.62s |  But really what they were trying to do
1679.62s - 1681.54s |  is they were trying to take down the ability
1681.54s - 1683.10s |  of our organization to operate,
1683.10s - 1685.46s |  because we were helping with research
1685.46s - 1687.62s |  for missile targeting systems
1687.62s - 1689.98s |  and other kind of modern technology
1689.98s - 1693.10s |  that the Canadian Armed Forces was developing.
1693.10s - 1695.58s |  Unfortunately, they weren't, well, fortunately for us,
1695.58s - 1698.02s |  but unfortunately for them, they weren't successful.
1698.02s - 1700.46s |  But what was amazing to me was that for us,
1700.46s - 1702.18s |  we just cut to the fundamentals
1702.18s - 1704.10s |  of how to repel a DDoS attack,
1706.02s - 1708.06s |  where we didn't know that we were fighting
1708.06s - 1709.78s |  a nation state actor.
1709.78s - 1711.74s |  We didn't know until after the fact,
1711.74s - 1714.02s |  until the government came and told us,
1714.02s - 1716.86s |  this is actually what you were up against.
1716.86s - 1718.98s |  To this day, I'm still actually blown away by that,
1718.98s - 1720.42s |  because we had no clue.
1720.42s - 1723.94s |  To us, it just seemed like a really, really persistent
1723.94s - 1727.22s |  APT group that was just a run-of-the-mill APT group,
1727.22s - 1731.66s |  because it was really just a really annoying DDoS attack
1731.66s - 1734.30s |  that didn't really have any special parameters to it.
1734.30s - 1736.02s |  So I found that kind of fascinating,
1736.02s - 1738.62s |  and I don't really think that's a standard APT for them,
1738.62s - 1742.54s |  because I've seen the old APT32 blogs
1742.54s - 1743.78s |  come out all the time
1743.78s - 1746.70s |  with some of the innovative social engineering tactics
1747.54s - 1748.46s |  that they like to use.
1748.46s - 1749.90s |  But I think on this one,
1749.90s - 1752.14s |  they were just looking at who's part of the supply chain
1752.14s - 1755.02s |  for this project, and let's attack every organization
1755.02s - 1757.22s |  as part of that build for that construction.
1757.22s - 1760.42s |  So it's kind of an interesting kind of outlook,
1760.42s - 1762.06s |  but you have to look at,
1762.06s - 1764.66s |  when you are attacked by a nation state
1764.66s - 1766.82s |  or a large APT actor,
1766.82s - 1768.58s |  you have to look at it from the human level
1768.58s - 1771.26s |  as to why they are trying to attack your organization,
1771.26s - 1773.86s |  and what are the crown jewels they're trying to go after.
1773.86s - 1775.78s |  So if they're trying to just disable your ability
1775.82s - 1777.22s |  to function and operate,
1777.22s - 1778.94s |  that's legitimate means of compromise
1778.94s - 1780.30s |  that they're trying to achieve.
1780.30s - 1782.98s |  If they're trying to steal and exfiltrate data,
1782.98s - 1785.18s |  that operation's probably gonna be more malicious,
1785.18s - 1788.06s |  because they're gonna have to get inside your environment
1788.06s - 1790.14s |  and then move laterally across,
1790.14s - 1791.78s |  probably break access at some point
1791.78s - 1793.74s |  or get some kind of privileged account,
1793.74s - 1796.30s |  and then be able to exfiltrate the data
1796.30s - 1799.02s |  to a C2 somewhere without you noticing.
1799.02s - 1801.46s |  So oftentimes you're gonna deal with like,
1801.46s - 1802.30s |  what's it called?
1807.30s - 1808.14s |  Low and slow?
1808.14s - 1809.10s |  Low and slow, there we go.
1809.10s - 1810.42s |  Low and slow.
1810.42s - 1811.90s |  By the way, for those of you
1811.90s - 1815.54s |  who are playing in machine learning and anomaly detection,
1815.54s - 1817.26s |  anomaly detection is very good
1817.26s - 1819.66s |  at giving you low and slow prospects.
1819.66s - 1820.50s |  Yeah.
1820.50s - 1821.34s |  Yeah.
1821.34s - 1823.62s |  That's been the best use case I've got so far.
1823.62s - 1825.62s |  But they can maintain your presence in your environment
1825.62s - 1827.10s |  for months without you realizing it,
1827.10s - 1827.94s |  if they do it correctly.
1827.94s - 1828.86s |  If they do it correctly,
1828.86s - 1830.30s |  but at the very least,
1830.30s - 1833.06s |  when you're dealing with just trying to find odd traffic
1833.06s - 1835.82s |  that you'll not spot,
1835.82s - 1839.50s |  otherwise, that's the sort of anomaly
1839.50s - 1841.58s |  that you are actually trying to leverage.
1842.42s - 1846.26s |  But most of the people that I know that have UEBA still,
1846.26s - 1848.38s |  but the people that don't have UEBA,
1848.38s - 1849.70s |  they don't have the anomaly detection
1849.70s - 1853.26s |  because they end up dialing it down so much
1853.26s - 1854.62s |  in face of false positives,
1854.62s - 1857.06s |  they miss the slow and stealthy stuff.
1857.06s - 1859.82s |  They only wanna see the extra, extra, extra spicy stuff
1860.26s - 1861.98s |  that the rule can get them.
1861.98s - 1864.34s |  And that mindset's part of the problem.
1864.34s - 1865.42s |  The other thing is,
1866.86s - 1870.18s |  for the really loud, obvious stuff for the fault,
1870.18s - 1872.30s |  which is generates tons of false positives,
1872.30s - 1876.34s |  you should be tuning your inputs
1876.34s - 1879.62s |  to your anomaly detection algorithm beforehand.
1881.46s - 1883.34s |  If I know this,
1883.34s - 1886.34s |  and your analysts should be able to also go through
1886.34s - 1889.30s |  and say, right, here's the ones that are,
1889.30s - 1891.26s |  this traffic I've seen elsewhere,
1892.14s - 1894.94s |  it's loud, this isn't a good prospect because X,
1894.94s - 1896.98s |  and then go to Y.
1896.98s - 1897.82s |  Hell yeah.
1897.82s - 1900.82s |  Yeah, I mean, it goes back to people on process.
1900.82s - 1903.62s |  Like you have anomaly detection there for years,
1903.62s - 1905.94s |  people don't use it because they don't tune it.
1905.94s - 1908.54s |  And when they tune it, they tune it out.
1908.54s - 1911.14s |  They literally just, it's too many false positives,
1911.14s - 1912.62s |  let's just get rid of it.
1912.62s - 1915.42s |  Because if I have all of the slow and stealthy appearing,
1915.42s - 1917.74s |  I have all of the garbage appearing.
1917.74s - 1919.22s |  So it's a trade-off.
1919.98s - 1921.38s |  Do I wanna see all the slow and stealthy,
1921.38s - 1924.46s |  or do I wanna not have a million fucking tickets every day?
1925.98s - 1929.46s |  I think there's another issue of insider threats, right?
1929.46s - 1932.02s |  Two of some of the biggest ones I've seen
1932.02s - 1936.02s |  that I was a part of that organization
1936.02s - 1940.46s |  were people that were either fired or about to quit,
1940.46s - 1942.82s |  and they set up the environment.
1942.82s - 1945.10s |  And if you don't have that detection,
1946.02s - 1949.66s |  and someone's doing this setting up of the environment,
1949.66s - 1953.74s |  and they're starting to have a bunch of scripts execute
1953.74s - 1956.70s |  to create accounts, and get into those accounts,
1956.70s - 1959.50s |  and piggyback on that, and create scripts
1959.50s - 1960.74s |  to start shutting things down,
1960.74s - 1963.46s |  or moving data, whatever it is, or both,
1965.38s - 1967.46s |  you should be able to detect those things
1967.46s - 1968.78s |  before those people depart.
1968.78s - 1970.74s |  That actually brings me up another point.
1970.74s - 1972.58s |  You should really invest in DLP.
1973.58s - 1976.54s |  Data loss prevention is a major issue,
1976.54s - 1978.86s |  and particularly when it comes to insider threat.
1978.86s - 1980.10s |  So I can give you an example.
1980.10s - 1981.18s |  I won't say which employer,
1981.18s - 1983.66s |  but let's say we had to let go of an HR person,
1983.66s - 1987.10s |  and it was a sudden cut financially-based.
1987.10s - 1990.58s |  Their performance was good, but we had to let them go.
1990.58s - 1992.94s |  Oftentimes, when folks are put in that position,
1992.94s - 1994.46s |  they're gonna try to smash and grab
1994.46s - 1996.14s |  as many files as possible,
1996.14s - 1997.98s |  perhaps to spin off in a consultancy,
1997.98s - 1999.10s |  or do whatever it is they're gonna do
1999.10s - 2000.94s |  with their business after the fact.
2000.94s - 2002.82s |  But obviously, corporate data,
2002.82s - 2004.62s |  you can't just carry home with you.
2004.62s - 2006.74s |  That's not the way it works.
2006.74s - 2009.54s |  So I knew about a month in advance
2009.54s - 2011.74s |  of when this person was gonna get let go,
2011.74s - 2015.46s |  and so I kind of set up a surveillance
2015.46s - 2017.42s |  with my SOC manager, and I was like,
2017.42s - 2019.14s |  hey, can you watch this person?
2019.14s - 2021.46s |  Can you specifically see what's happening
2021.46s - 2023.94s |  in their endpoint over the next few weeks?
2023.94s - 2026.06s |  So it was kind of an interesting process
2026.06s - 2028.40s |  where they were gonna get notice
2028.40s - 2029.74s |  that we were gonna let them go,
2029.74s - 2031.42s |  and then there was a two-week buffer window
2031.42s - 2033.66s |  for them to kind of hand off everything.
2033.66s - 2035.62s |  And I suspected within that two weeks,
2035.62s - 2037.90s |  they would attempt to do a big data exfil.
2037.90s - 2039.54s |  And what happened, it was like,
2039.54s - 2042.00s |  I think a day before we cut off
2042.00s - 2043.90s |  all their accounts and everything,
2043.90s - 2045.88s |  a massive data exfil.
2045.88s - 2048.26s |  So we ended up getting alerted to what they were doing
2048.26s - 2050.50s |  because we had our endpoint sensors
2050.50s - 2052.38s |  detecting what was going on,
2052.38s - 2055.34s |  that we had seen the files in the transfer specifically,
2055.34s - 2057.46s |  so that we knew exactly by name
2057.46s - 2059.46s |  which files had actually gone out.
2060.14s - 2061.66s |  So we were able to call this person back,
2061.66s - 2064.42s |  be like, hey, can you put those files on a USB
2064.42s - 2066.54s |  and please confirm deleting them from your computer
2066.54s - 2070.24s |  because they belong to the company.
2070.24s - 2073.42s |  All right, so DLP is essentially a bunch of rules, right?
2073.42s - 2074.96s |  More rules that we trust.
2074.96s - 2076.12s |  It's not anomalous, right?
2076.12s - 2081.12s |  Yeah, it's a, here we set up these sorts of files
2081.72s - 2084.60s |  or these sorts of indicators.
2084.60s - 2086.72s |  And one of the other things you absolutely need
2086.72s - 2088.86s |  is somebody involved in the process
2088.86s - 2091.54s |  to know what should be happening.
2091.54s - 2092.58s |  It's the deep knowledge.
2092.58s - 2094.54s |  You have to have somebody know what should be happening.
2094.54s - 2095.38s |  Hell yeah.
2095.38s - 2096.90s |  This is what's odd.
2096.90s - 2097.74s |  Hell yeah.
2097.74s - 2102.74s |  And have a clue as to when to really put that extra.
2104.34s - 2106.06s |  Yeah, extra scrutiny kind of thing, you know?
2106.06s - 2106.90s |  Extra scrutiny, yeah.
2106.90s - 2107.90s |  And that's the context.
2107.90s - 2110.02s |  Context was the boss told you, you know,
2110.02s - 2111.76s |  like this guy's gonna do some shit.
2111.76s - 2114.18s |  That's fucking amazing intel, thank you.
2114.18s - 2117.22s |  Somebody's gonna do some shit, I'll look there, right?
2117.26s - 2119.66s |  But if I have anomaly detection,
2119.66s - 2121.58s |  George was talking about that a little earlier as well.
2121.58s - 2123.26s |  He was like, they can be there for months.
2123.26s - 2124.78s |  What does that mean?
2124.78s - 2126.86s |  Anomaly detection, my friends,
2126.86s - 2129.58s |  needs some sort of a time for baselining.
2129.58s - 2131.18s |  It baselines over a month.
2131.18s - 2133.46s |  You have someone that does something fishy every year
2133.46s - 2135.22s |  because they go and they pull financial metrics
2135.22s - 2136.58s |  for the taxes or some bullshit.
2136.58s - 2138.78s |  Every single year, you have a ticket.
2138.78s - 2140.50s |  Every single year, it doesn't matter.
2140.50s - 2142.38s |  And that's why UABA is not the most popular thing
2142.38s - 2143.66s |  in the world, and it will never be
2143.66s - 2147.99s |  because you have to tune the shit out of it, right?
2148.47s - 2152.07s |  For us, we wanna stop fucking hyper-tuning everything.
2152.07s - 2153.75s |  We wanna have regular lives.
2153.75s - 2157.67s |  So that takes us to essentially attack flows.
2157.67s - 2160.99s |  Attack flows are incidents that, you know,
2160.99s - 2162.87s |  when I asked George to talk about an incident,
2162.87s - 2165.67s |  he was like, there was a lot of DDoS,
2165.67s - 2169.23s |  but DDoS usually happens all the way at the end.
2169.23s - 2173.19s |  I know Chris usually has a lot of incidents to share,
2173.19s - 2176.47s |  and sometimes they're all over the place.
2176.47s - 2177.91s |  Sometimes they're only at the end.
2178.75s - 2181.59s |  What happens is, if you only see stuff at the end,
2181.59s - 2183.63s |  you just didn't see the rest.
2183.63s - 2185.27s |  You just didn't put it together.
2185.27s - 2188.59s |  And if you have seen some things but missed a few,
2188.59s - 2190.47s |  you know why you missed them,
2190.47s - 2191.99s |  because these guys were good,
2191.99s - 2194.95s |  and they got your essentially, you know,
2194.95s - 2197.75s |  like blind spots in coverage, blind spots in whatever.
2197.75s - 2199.75s |  So most of the investigations,
2199.75s - 2201.27s |  trying to put the whole story,
2201.27s - 2203.55s |  like give me some sort of an attack flow.
2203.55s - 2205.91s |  Anybody here familiar with a MITRE attack flow?
2206.87s - 2208.15s |  God damn, only three people.
2208.15s - 2210.67s |  What the hell is going on with MITRE?
2210.67s - 2213.27s |  All right, so I'm gonna pitch MITRE for you.
2213.27s - 2215.87s |  Here is what they call a MITRE attack flow.
2215.87s - 2217.19s |  I can see strategically
2217.19s - 2220.27s |  and mainly a little bit operationally
2220.27s - 2221.91s |  what was happening at Equifax, for instance.
2221.91s - 2223.75s |  So there was a vulnerability, exploit, whatever,
2223.75s - 2226.79s |  you know, like web shell, yada, yada, yada, encrypted shell.
2226.79s - 2228.67s |  There was like a lot of queries to the database.
2228.67s - 2231.79s |  That's how Equifax got breached.
2231.79s - 2233.27s |  And my data is there.
2233.27s - 2235.55s |  If you can find my SIN number, my address,
2235.83s - 2238.59s |  you can find a lot of information about me if you want.
2238.59s - 2239.63s |  Download the data breach
2239.63s - 2242.47s |  and please don't steal my identity, but I can't stop you.
2244.11s - 2246.31s |  And God knows I spend a lot of time in the bank
2246.31s - 2248.71s |  whenever I do something because of this,
2248.71s - 2250.71s |  but can't really complain, you know.
2251.67s - 2252.99s |  This is the attack flow.
2252.99s - 2255.55s |  And they archived a bunch of stuff that they got
2255.55s - 2258.27s |  and they exfiltrated it via C2,
2258.27s - 2260.59s |  non-C2 protocol via multi-hub proxy and whatnot.
2260.59s - 2263.67s |  If you want to watch some more of these,
2263.67s - 2267.63s |  instead of APT PDF reports, you can have an APT flow
2267.63s - 2271.19s |  and you can see the nice strategic movement there.
2271.19s - 2272.67s |  But anyways, why the hell do we care about this?
2272.67s - 2273.95s |  We care about this to tell you
2273.95s - 2277.55s |  that we have been fed our entire lives in the sock,
2277.55s - 2279.87s |  that an alert is important.
2279.87s - 2282.83s |  There is something called a notable alert.
2282.83s - 2284.51s |  To hell with an alert.
2284.51s - 2285.75s |  It's about the story.
2285.75s - 2287.79s |  It's about show me the entire freaking flow.
2287.79s - 2289.27s |  To hell with a single technique.
2289.27s - 2290.79s |  Show me the other shit.
2290.79s - 2292.39s |  That's the context.
2292.39s - 2295.15s |  Show me a piece of intel that the boss tells me,
2295.15s - 2296.83s |  somebody's going to pull some shit on you.
2296.83s - 2298.87s |  Good. Now I know where to look.
2298.87s - 2301.03s |  Now it's no more a single incident of data exfiltration.
2301.03s - 2303.95s |  It's data exfiltration that I have good reasoning for.
2303.95s - 2306.15s |  This person is disgruntled and so on and so forth.
2306.15s - 2308.39s |  And these kinds of stories are very important.
2308.39s - 2310.83s |  And that's what usually goes in an incident report.
2310.83s - 2312.11s |  And that's what people like to talk about
2312.11s - 2313.35s |  when they save the day.
2313.35s - 2315.95s |  You don't save the day against a single incident.
2315.95s - 2317.55s |  Sorry, against a single alert.
2317.55s - 2319.67s |  You save the day against a full attack.
2319.67s - 2322.23s |  It might be a full playbook that executes in 20 seconds.
2322.23s - 2324.23s |  It might be an APT that's just been there
2324.23s - 2326.23s |  for a couple of years, whatever it is.
2326.23s - 2327.19s |  It's not one thing.
2327.19s - 2328.23s |  It looks like this.
2329.15s - 2331.91s |  So can we do this with data science?
2331.91s - 2333.91s |  You know, I came here for data science.
2333.91s - 2334.75s |  You baited me.
2334.75s - 2336.15s |  And now you're feeding me a lot of bullshit
2336.15s - 2337.07s |  about people process.
2337.07s - 2338.23s |  Give me some technology, my dude,
2338.23s - 2339.39s |  or I'm going to leave right now.
2339.39s - 2340.51s |  Gotcha. Okay.
2340.51s - 2342.07s |  Here's some technology.
2342.07s - 2345.19s |  So we need some sort of finding
2345.19s - 2346.63s |  mitered attack techniques for everything.
2346.63s - 2348.79s |  Why? Because it's a what?
2348.79s - 2351.79s |  If I hire unicorns like you guys,
2351.79s - 2354.15s |  I don't need to detail everything for a what.
2354.15s - 2358.87s |  But if I hire the 20 resumes that I got in Las Vegas,
2358.87s - 2360.91s |  they're all juniors and they need jobs.
2360.91s - 2362.67s |  And we in security like to say
2362.67s - 2364.23s |  that we have a lack of talent.
2364.23s - 2365.59s |  Fuck no.
2365.59s - 2367.55s |  We have no talent shortage.
2367.55s - 2369.59s |  We have unicorn shortage.
2369.59s - 2372.15s |  I can not hire someone like you guys,
2372.15s - 2376.75s |  but I can hire a shit ton of people that are juniors.
2376.75s - 2378.87s |  And because I can't afford you within my budget,
2378.87s - 2380.59s |  I just say, oh, I have a talent shortage.
2380.59s - 2382.91s |  No, I just can't afford you.
2382.91s - 2384.03s |  And you're too few.
2384.03s - 2387.27s |  I can find a lot of juniors and beginners.
2387.27s - 2389.59s |  So if I give them a mitered attack for everything,
2389.59s - 2390.87s |  their life could be slightly better
2390.87s - 2392.39s |  because now they know the procedural examples,
2392.39s - 2393.35s |  mitigation and detection.
2393.35s - 2394.27s |  They have the description.
2394.27s - 2397.27s |  They have a common language to talk about with me,
2397.27s - 2398.95s |  especially when they see anything in the sim
2398.95s - 2400.67s |  or in any other queue.
2400.67s - 2402.11s |  So how do I get them everything?
2402.11s - 2403.15s |  With mitered attack techniques?
2403.15s - 2406.75s |  Well, you know, I can give them something that I get from,
2406.75s - 2409.59s |  I don't know, sometimes my EDR has mitered attack, right?
2409.63s - 2412.31s |  Anybody here has mitered attack from the EDR?
2412.31s - 2413.91s |  Yeah, a bunch of us.
2413.91s - 2416.47s |  So sometimes the NDR would give you some, you know,
2416.47s - 2419.27s |  but most of the data does not have mitered attack.
2419.27s - 2422.11s |  And the mitered attack that you have was for marketing.
2422.11s - 2423.19s |  It was for dashboards.
2423.19s - 2426.39s |  It was for sexy stuff at RSA and Black Hat.
2426.39s - 2428.51s |  It was not to actually use it.
2428.51s - 2430.35s |  So ideally we have a mitered attack
2430.35s - 2432.71s |  that we can actually use that is not crowdsourced
2432.71s - 2434.99s |  where every single one was given by a different author.
2434.99s - 2435.83s |  Ideally we have one thing
2435.83s - 2437.71s |  that gives everything a mitered attack.
2437.71s - 2438.95s |  How do I do that?
2439.03s - 2440.67s |  I can just deed up everything in my sim
2440.67s - 2443.31s |  and get all the different messages and signatures
2443.31s - 2444.35s |  that would ever trigger.
2444.35s - 2446.83s |  And I, you know, hand annotate them.
2446.83s - 2448.51s |  That's the version 0.1.
2448.51s - 2451.59s |  Version 0.2 is to use an LLM like ChatGPT
2451.59s - 2453.03s |  and let ChatGPT do it.
2453.03s - 2456.83s |  Like I can go to ChatGPT and I'd say, you know,
2456.83s - 2459.95s |  ChatGPT, what technique is happening here and there?
2459.95s - 2461.43s |  And it would tell me, you know,
2461.43s - 2466.43s |  what mitered technique is run DLL 32 registry run key?
2467.43s - 2469.63s |  You know, whatever.
2469.63s - 2471.95s |  It will tell me, it might not be good,
2471.95s - 2473.75s |  but it could be consistent.
2473.75s - 2475.39s |  Can ChatGPT be consistent?
2476.51s - 2479.23s |  Depends, but if you really are after consistency,
2479.23s - 2484.23s |  you go to a model that you can tune the API off.
2485.39s - 2486.95s |  And if you tune the API,
2486.95s - 2489.07s |  it would look something like this.
2489.07s - 2490.43s |  You go to the settings on Hugging Chat.
2490.43s - 2491.51s |  If you don't know about Hugging Chat,
2491.51s - 2495.51s |  it's just a way to get LLMs tuned for your use cases.
2495.55s - 2497.47s |  And you essentially choose any model
2497.47s - 2498.95s |  and you can give it a lot of links
2498.95s - 2501.71s |  for things that it should use, you know,
2501.71s - 2503.79s |  to do OSINT or to do whatever you want.
2504.99s - 2508.51s |  But essentially, let's create one together if you want.
2508.51s - 2510.27s |  Let me figure out how do I create one.
2510.27s - 2511.71s |  I can do this on my phone.
2511.71s - 2514.07s |  I don't have to, you know, walk away from here empty handed.
2514.07s - 2517.11s |  I can walk away with a new assistant that I can create
2517.11s - 2519.51s |  and I can call a TTP detector.
2519.51s - 2520.35s |  And how do I do that?
2520.35s - 2523.71s |  I close ChatGPT and I start any of these models.
2523.71s - 2525.75s |  And the key here is temperature.
2525.75s - 2527.43s |  Why is ChatGPT not consistent?
2527.43s - 2529.87s |  It's creative, it hallucinates every now and then.
2529.87s - 2531.95s |  That's why I don't know a single person in this room
2531.95s - 2535.55s |  that uses an LLM for anything serious other than reporting
2535.55s - 2536.99s |  or some sort of, you know,
2536.99s - 2539.51s |  some sort of how do I write this query
2539.51s - 2540.91s |  or something like that, right?
2540.91s - 2542.87s |  But you don't really depend on it because it hallucinates.
2542.87s - 2544.79s |  If you drive down the temperature all the way down,
2544.79s - 2546.95s |  it will stop hallucinating and it will be consistent.
2546.95s - 2548.47s |  What is consistent or deterministic?
2548.47s - 2550.79s |  It means same input, same output every single day.
2550.79s - 2552.19s |  Same input, same output.
2552.23s - 2553.07s |  And if I have that,
2553.07s - 2557.11s |  I can technically use that for my classification.
2557.11s - 2560.27s |  We're gonna talk a little bit more about that later.
2560.27s - 2562.47s |  For now, let's talk about, okay, my dude,
2562.47s - 2564.31s |  you need miter attacks for everything.
2564.31s - 2567.43s |  Sure, give this guy all the miter attack he needs.
2567.43s - 2568.71s |  Now what?
2568.71s - 2570.67s |  Now the layer ones can actually understand what's going on
2570.67s - 2573.39s |  when they open their sim and they see a million tickets
2573.39s - 2575.43s |  for them to work on, a million notable alerts.
2575.43s - 2578.43s |  However, how the hell do they work through the million?
2578.43s - 2579.87s |  That's why we came here.
2579.87s - 2582.11s |  How do we do data reduction?
2583.03s - 2584.87s |  How do we go from a million notable alerts
2584.87s - 2587.19s |  into, I don't know, 10 tickets?
2587.19s - 2589.39s |  Something that a human can actually do.
2589.39s - 2590.71s |  Because if I have a million notable alerts,
2590.71s - 2593.03s |  I'm only gonna tune my notable alerts
2593.03s - 2595.11s |  to only have 20 extra, extra, extra spicy
2595.11s - 2597.71s |  and I will never lay eyes on anything else.
2597.71s - 2600.71s |  Anybody here has terabytes going into their sim?
2600.71s - 2603.19s |  Like a day, terabytes?
2603.19s - 2604.43s |  Fuck yeah, a lot of people.
2604.43s - 2605.59s |  Okay, nice.
2605.59s - 2608.35s |  So do you ever look at any of that data?
2608.35s - 2609.19s |  No.
2609.19s - 2612.06s |  Why do you collect it?
2612.06s - 2612.90s |  Compliance.
2613.38s - 2614.34s |  Thank you.
2614.34s - 2615.82s |  We do not collect it because we need it.
2615.82s - 2617.98s |  We collect it because the boss wants it.
2617.98s - 2622.30s |  So essentially, what do we actually need?
2622.30s - 2627.10s |  We need about 20 rules, 50 rules, 100 rules.
2627.10s - 2628.86s |  200 rules, that's about it.
2628.86s - 2630.70s |  200 rules, hopefully they don't trigger.
2630.70s - 2632.38s |  When they trigger, I'm kind of worried.
2632.38s - 2633.42s |  Do I ever investigate them?
2633.42s - 2636.50s |  If I'm in the right mood, if I'm in the right day
2636.50s - 2639.34s |  and one of them triggers, I will investigate them.
2639.34s - 2642.34s |  But if you need me to do it super, super duper fast,
2642.42s - 2644.38s |  I'll just close them right away.
2644.38s - 2646.70s |  You want the entity D, I got you.
2646.70s - 2651.10s |  So essentially, how do we find things that are relevant?
2651.10s - 2653.26s |  Yes, 10 minutes to go.
2653.26s - 2654.82s |  How do we find things that are relevant?
2654.82s - 2656.14s |  I have to essentially investigate
2656.14s - 2657.90s |  what are the questions to ask, right?
2657.90s - 2660.38s |  So what is relevant between this alert and this alert?
2660.38s - 2661.86s |  Well, they share an entity
2661.86s - 2663.50s |  or maybe they don't share an exact entity.
2663.50s - 2664.78s |  It's not a common entity.
2664.78s - 2666.66s |  It's a similar entity.
2666.66s - 2668.70s |  Can I put that in the rule or a playbook?
2668.70s - 2671.42s |  No, there is no similarity in the rules.
2671.42s - 2674.26s |  You only have the exact same entity or not.
2674.26s - 2676.26s |  These two entities are in the exact same business unit
2676.26s - 2677.10s |  or not.
2677.10s - 2679.42s |  They have the exact same operating system or not.
2679.42s - 2681.34s |  Similar business units or operating systems
2681.34s - 2682.90s |  or similar ports does not exist.
2682.90s - 2684.02s |  There's no similarity.
2684.02s - 2686.18s |  However, as a human, you're actually doing that.
2686.18s - 2687.58s |  You're looking at similarity.
2687.58s - 2690.34s |  You're looking at similar, even tickets historically,
2690.34s - 2692.86s |  like there was something similar to this before
2692.86s - 2693.94s |  and how would the people do it
2693.94s - 2696.14s |  if I have historical data on my tickets?
2696.14s - 2698.62s |  But essentially, I'm looking for event attributes.
2698.62s - 2700.26s |  Like the EDR gives me a lot of attributes
2700.26s - 2702.10s |  like parent process and whatnot,
2702.10s - 2703.94s |  registry keys and yada, yada, yada.
2703.94s - 2706.18s |  NDR would give me like packet size and so on and so forth,
2706.18s - 2710.14s |  protocol port and identity would give me a lot of events,
2710.14s - 2711.86s |  you know, like what exactly happened in this?
2711.86s - 2712.98s |  Was it like an account change?
2712.98s - 2714.74s |  Was it, what the hell was it?
2714.74s - 2717.38s |  But essentially, I'm looking at event attributes.
2717.38s - 2719.62s |  I'm looking at entities attributes, right?
2719.62s - 2721.46s |  And in my brain, I'm doing similarity.
2721.46s - 2722.74s |  Nice.
2722.74s - 2725.66s |  You were talking about attack detection models.
2725.66s - 2727.78s |  You said I can do it with an LLM.
2727.78s - 2729.38s |  Can you do any better, right?
2729.42s - 2730.26s |  I can do a Hugging Chat.
2730.26s - 2731.50s |  I can even do an Ollama.
2731.50s - 2733.98s |  If you don't know what's an Ollama,
2733.98s - 2737.86s |  you just go here to Ollama and it's a local LLM
2737.86s - 2739.74s |  instead of hosted in Hugging Chat
2739.74s - 2741.54s |  or Chajipati or whatever the hell.
2741.54s - 2742.62s |  You can just host it locally.
2742.62s - 2744.86s |  You can do it in AWS with Bedrock, yada, yada, yada.
2744.86s - 2747.86s |  But can I do better than just a vanilla LLM
2747.86s - 2749.86s |  with the creativity turned all the way down,
2749.86s - 2750.98s |  all the temperature all the way down?
2750.98s - 2751.86s |  Yes, you can.
2751.86s - 2752.70s |  We did.
2752.70s - 2756.18s |  We put three years into this and we built a goddamn LLM
2756.18s - 2758.30s |  that knows everything about cyber and it's open source
2758.30s - 2759.26s |  and you can use it for free.
2760.14s - 2761.22s |  You don't have to pay us ever.
2761.22s - 2762.94s |  But essentially, how did we do that?
2762.94s - 2764.30s |  We gave it a large unlabeled corpus.
2764.30s - 2765.74s |  You know, all the stuff in your bookmarks,
2765.74s - 2767.90s |  the books, the slides, the white papers,
2767.90s - 2768.98s |  it's all the shit that you want to read
2768.98s - 2770.14s |  but you never will.
2770.14s - 2771.82s |  You just put it in bookmarks forever.
2771.82s - 2773.98s |  Or if you're one of these guys like me,
2773.98s - 2776.18s |  you just open a shit ton of tabs
2776.18s - 2778.46s |  and your browser can't take it anymore.
2779.86s - 2780.70s |  Yep.
2782.18s - 2785.38s |  So yeah, we just gave all of that to the LLM
2785.38s - 2787.42s |  and I took them off my bookmarks
2787.42s - 2790.90s |  and now I have an LLM that actually read them from scratch
2790.90s - 2794.38s |  and that LLM, I gave a small labeled corpus to
2794.38s - 2797.06s |  and I can talk a lot about the small labeled corpus
2797.06s - 2798.70s |  but that's what took three years
2798.70s - 2800.50s |  because I actually wanted a small labeled corpus
2800.50s - 2801.94s |  of labels that I trust.
2801.94s - 2803.62s |  Here's the alert, here's the mindset attack
2803.62s - 2805.38s |  and you cannot get that.
2805.38s - 2807.10s |  That is so fucking hard.
2807.10s - 2808.26s |  Humans are not consistent.
2808.26s - 2810.34s |  We have to make one human sit down at the end
2810.34s - 2812.90s |  and write regular expressions to keep themselves consistent
2812.90s - 2814.50s |  when they attack something
2814.50s - 2817.18s |  because every day they would attack something differently.
2817.94s - 2818.78s |  It was so fucking hard.
2818.78s - 2819.62s |  And then we had to like do data balance.
2819.62s - 2820.98s |  Like this is so fucking hard.
2820.98s - 2823.34s |  A small labeled corpus, that's impossible.
2823.34s - 2826.62s |  But again, open source, already out there, use it.
2826.62s - 2828.98s |  But this is how you end up with essentially
2828.98s - 2830.94s |  like you have techniques for everything.
2830.94s - 2833.02s |  Of course, it's actually probabilistic at the backend.
2833.02s - 2835.66s |  Like I actually have a probability for every single class.
2835.66s - 2837.14s |  But in this case, I was like, you know what?
2837.14s - 2839.10s |  Anything above 99% show it to me.
2839.10s - 2839.94s |  And that was it.
2839.94s - 2841.02s |  And it was pretty decent.
2841.02s - 2843.14s |  And even if it was not decent, I don't give a shit.
2843.14s - 2844.86s |  It's consistent and it's in everything.
2844.86s - 2846.74s |  You have a PowerShell in my organization.
2847.30s - 2848.14s |  I have a technique.
2848.14s - 2849.66s |  You have a Windows event log in my organization.
2849.66s - 2850.62s |  I have a technique.
2850.62s - 2852.66s |  You have whatever the fuck that I get in my sim,
2852.66s - 2853.50s |  I have a technique.
2853.50s - 2854.78s |  Even if I don't get it in my sim,
2854.78s - 2856.70s |  as long as it ends on my S3 bucket
2856.70s - 2858.98s |  and it goes through this, I have a goddamn technique.
2858.98s - 2862.50s |  And I can hire the 20 resumes that I got of juniors
2862.50s - 2863.86s |  because they actually know what the hell is going on
2863.86s - 2864.70s |  when they see something.
2864.70s - 2867.22s |  You don't have to ask me, what is run DLL 32?
2867.22s - 2868.50s |  I don't fucking give a shit.
2868.50s - 2871.50s |  You have to just say, what is T1218?
2871.50s - 2872.34s |  And you have to read about it.
2872.34s - 2873.74s |  And you have to figure out how to mitigate
2873.74s - 2874.58s |  and how to investigate about it.
2874.58s - 2876.58s |  You can go to chat GPT and be like,
2877.42s - 2879.98s |  T1218, what should I do?
2879.98s - 2880.82s |  What are the next steps?
2880.82s - 2881.66s |  What should I investigate?
2881.66s - 2882.82s |  And it will tell you, right?
2882.82s - 2884.18s |  It's a common language.
2884.18s - 2885.50s |  So anyways, now that I have that,
2885.50s - 2887.34s |  I wanna cluster events that are relevant.
2887.34s - 2889.14s |  How do I cluster events that are relevant?
2889.14s - 2890.74s |  Well, I can do it vanilla.
2890.74s - 2893.98s |  And I have code here for essentially clustering.
2893.98s - 2897.22s |  And I just zoom in on the sexy eye candy,
2897.22s - 2899.78s |  but forget the eye candy for a second.
2899.78s - 2900.98s |  This is just like eye candy that shows you
2900.98s - 2902.46s |  like clusters of events and whatnot.
2902.46s - 2904.98s |  But if I wanna do much better,
2905.02s - 2908.66s |  and if I can actually hire a summer intern for data science,
2908.66s - 2911.06s |  instead of just DIY it myself,
2911.06s - 2913.18s |  I will tell them to use a knowledge graph.
2913.18s - 2914.38s |  What the hell is a knowledge graph?
2914.38s - 2916.90s |  Clustering is unsupervised, right?
2916.90s - 2917.98s |  Clustering is unsupervised,
2917.98s - 2919.22s |  which means that it actually doesn't know
2919.22s - 2920.66s |  where the hell is it going.
2920.66s - 2921.74s |  And it doesn't know what's right
2921.74s - 2923.50s |  because you don't know what's right.
2923.50s - 2924.70s |  You actually don't know what's right.
2924.70s - 2925.86s |  And you don't know how to guide it,
2925.86s - 2927.66s |  but you know how to think.
2927.66s - 2930.46s |  You know how to investigate to a certain degree.
2930.46s - 2931.86s |  Anybody here has documentation?
2931.86s - 2933.50s |  If I join as a new SOC analyst,
2933.50s - 2935.14s |  how to investigate something?
2936.14s - 2939.30s |  One, okay, two, three, four, four.
2939.30s - 2941.22s |  Okay, you guys are fantastic.
2941.22s - 2942.50s |  Most people don't, right?
2942.50s - 2945.14s |  Do you have historical tickets by any chance?
2945.14s - 2947.14s |  Historical tickets, historical investigations?
2947.14s - 2948.62s |  Okay, about five, six people.
2948.62s - 2950.02s |  Okay, nice.
2950.02s - 2952.06s |  Most of us, we're the normies.
2952.06s - 2953.18s |  We're the 99%.
2953.18s - 2954.50s |  We don't have shit, right?
2954.50s - 2957.86s |  So it's all stuck in the brain of a unicorn
2957.86s - 2958.78s |  sitting in my SOC.
2958.78s - 2961.54s |  And without this unicorn, everything fails, right?
2961.54s - 2962.38s |  So I know how to think.
2962.50s - 2964.66s |  That's a failure of your unicorn.
2964.66s - 2965.50s |  Right.
2965.50s - 2967.50s |  Because the first thing we should be doing
2967.50s - 2970.30s |  when we pull this stuff is writing out,
2970.30s - 2974.62s |  oh, here's a little FAQ of how I do what I do.
2974.62s - 2976.58s |  And it might not work for you,
2976.58s - 2978.86s |  but you can see how my brain's gonna work on it.
2978.86s - 2981.38s |  And then you can adapt your brain
2981.38s - 2983.78s |  to the same goal at least.
2983.78s - 2987.14s |  And oh, by the way, here's all the things I screwed up on
2987.14s - 2989.74s |  so you don't make my mistakes.
2989.74s - 2990.58s |  Yes.
2991.02s - 2992.86s |  There's also SOPs too, right?
2992.86s - 2995.94s |  I mean, if you document what people are supposed to do,
2995.94s - 2996.78s |  then who reads them?
2996.78s - 2999.82s |  Yeah, the SOPs, the FAQs, boilerplate.
2999.82s - 3003.46s |  Oh, dear Lord, as much as you can boilerplate.
3003.46s - 3005.50s |  Boilerplate your friend.
3006.94s - 3011.58s |  Because if they want to spend hours crafting an IR
3011.58s - 3014.78s |  and they've got 75% pre-written,
3015.66s - 3017.54s |  put this here, put this here,
3017.54s - 3019.30s |  make sure it all makes sense.
3019.30s - 3021.34s |  Here's where you put the actual details
3021.34s - 3023.10s |  of what happened in the narrative.
3023.10s - 3024.30s |  And here's all the rest of the stuff
3024.30s - 3025.62s |  that we just have to put in.
3025.62s - 3026.46s |  Hell yeah.
3026.46s - 3028.42s |  I mean, if you actually have some sort of documentation,
3028.42s - 3029.26s |  that's fantastic.
3029.26s - 3031.18s |  If you don't, you have to figure out
3031.18s - 3032.94s |  how to put the knowledge out there.
3034.54s - 3037.34s |  You can, you can, don't lose hope.
3037.34s - 3038.98s |  The knowledge is essentially is gonna be encoded
3038.98s - 3040.30s |  in some sort of data structure.
3040.30s - 3042.22s |  And data structures are essentially pretty nice
3042.22s - 3044.58s |  because they tell the clustering algorithm
3044.58s - 3045.90s |  what to look for.
3045.90s - 3047.42s |  Clustering, again, doesn't know what to do.
3047.42s - 3048.26s |  It's unsupervised,
3048.26s - 3049.74s |  but you can make it semi-supervised
3049.74s - 3051.66s |  and cheat your way a little
3051.66s - 3052.94s |  and just give it knowledge.
3052.94s - 3053.94s |  Tell it, you know.
3053.94s - 3055.94s |  In my investigations, I always look for entities.
3055.94s - 3056.78s |  Okay.
3056.78s - 3060.18s |  So the entity is a node and the event is a edge.
3060.18s - 3063.78s |  And between as, as an entity and Google
3063.78s - 3066.34s |  or Ashley Madison or whatever you want,
3066.34s - 3068.90s |  like it's essentially another entity.
3068.90s - 3070.34s |  And these are the events that happened.
3070.34s - 3072.42s |  And these events, essentially,
3072.42s - 3074.22s |  I want you to cluster them,
3074.22s - 3075.62s |  thinking all the time in the cluster
3075.62s - 3077.22s |  about what entities are involved.
3077.22s - 3079.82s |  It's an entity-centric way.
3079.82s - 3081.42s |  But again, do you have the right process
3081.42s - 3082.90s |  to have the entity attributes?
3082.90s - 3084.38s |  Do you have the right stuff?
3084.38s - 3085.50s |  It's all a process.
3085.50s - 3086.86s |  Because when you go to data science,
3086.86s - 3088.50s |  it's about what data do you have, right?
3088.50s - 3090.74s |  And also what knowledge do you have to put there?
3090.74s - 3092.78s |  But given the right data, not the right data,
3092.78s - 3095.62s |  given a good enough data and a good enough knowledge,
3095.62s - 3097.10s |  you can actually get very useful clusters.
3097.10s - 3097.94s |  And guess what?
3097.94s - 3099.38s |  They compete with nothing.
3099.38s - 3101.78s |  Today, chapter one, machine learning and clustering
3101.78s - 3103.58s |  competes with absolutely nothing
3103.58s - 3105.58s |  because you have a bunch of humans that sit in your sock
3105.58s - 3108.70s |  and they do whatever,
3108.70s - 3112.22s |  but you don't actually know how do they correlate things
3112.22s - 3113.74s |  because you don't document them.
3113.74s - 3115.86s |  Clustering, at least, is fully transparent.
3115.86s - 3117.06s |  It's auditable.
3117.06s - 3118.90s |  It's actually explainable.
3118.90s - 3121.22s |  And you can track it down and you can give it feedback.
3121.22s - 3123.06s |  And it's very easy to give feedback.
3123.06s - 3124.94s |  But also, you can also chain things
3124.94s - 3126.06s |  in a finite-state machine.
3126.06s - 3128.50s |  And in data science, we call those Markovian chains,
3128.50s - 3130.98s |  but Markovian models are another way
3130.98s - 3132.50s |  to say finite-state machine.
3132.50s - 3134.06s |  We just like to complicate things.
3134.10s - 3136.74s |  But essentially, they say that if you find a few steps,
3136.74s - 3138.98s |  even if it misses a few because of zero days or whatnot,
3138.98s - 3140.30s |  it's fine, put them together.
3140.30s - 3143.26s |  And what you end up with is 2,500 alerts
3143.26s - 3146.26s |  given with 180,000 events and logs.
3146.26s - 3147.50s |  And they give you eight clusters.
3147.50s - 3148.46s |  In reality, in the sock,
3148.46s - 3151.74s |  we only knew about one ticket or one cluster.
3151.74s - 3155.58s |  And that one cluster had about 10 alerts.
3155.58s - 3157.66s |  And 10 alerts are essentially a lot.
3157.66s - 3159.54s |  I don't think anybody has a ticket with 10 alerts,
3159.54s - 3160.54s |  but that was not enough
3160.54s - 3163.94s |  because that exact cluster had 202 alerts.
3164.94s - 3166.74s |  And of course, not all of these were good.
3166.74s - 3169.46s |  Some of these were garbage, but we gave it feedback.
3169.46s - 3170.42s |  And it was fantastic.
3170.42s - 3172.34s |  And when I showed it to my sock people,
3172.34s - 3174.26s |  it was like, okay, this is pretty good.
3174.26s - 3176.74s |  What amazing technology, what alien technology is this?
3176.74s - 3179.18s |  And I was like, this is chapter one machine learning.
3179.18s - 3180.74s |  This is clustering.
3180.74s - 3181.78s |  And you can give it feedback.
3181.78s - 3183.38s |  It's chapter one, fuck yeah.
3183.38s - 3186.26s |  Like we're working with rules, we're working with stuff,
3186.26s - 3187.42s |  and it's a big data problem.
3187.42s - 3189.02s |  And we don't have a single big data solution
3189.02s - 3191.66s |  because we're skeptical about anything
3191.66s - 3192.62s |  that we don't understand.
3192.62s - 3193.78s |  Clustering, you can understand
3194.06s - 3195.82s |  down to the latest bit of it,
3195.82s - 3198.02s |  and you can give it feedback and you should use it.
3198.02s - 3198.86s |  And it's open source.
3198.86s - 3202.22s |  So essentially, if you want to take something from this,
3202.22s - 3204.10s |  put techniques in everything, that's the what.
3204.10s - 3207.50s |  And for investigations, welcome to cybersecurity.
3207.50s - 3209.78s |  No one actually knows how do we do investigations correctly.
3209.78s - 3211.30s |  We don't have proper documentation.
3211.30s - 3213.38s |  We don't have a single even resource.
3213.38s - 3215.02s |  We don't have a course about how to investigate stuff
3215.02s - 3218.30s |  in the SOC that is unified and people know about, yeah.
3218.30s - 3219.94s |  But essentially, if you have a clustering algorithm,
3219.94s - 3222.54s |  you have a way to unify how do you deal with this
3222.54s - 3225.74s |  and it scales and it's not a GPU, it's not an LLM.
3225.74s - 3228.66s |  It's $20 a month for a clustering algorithm
3228.66s - 3231.18s |  to run through terabytes and terabytes of data every day
3231.18s - 3233.82s |  and fully explainable and you can give it feedback.
3234.78s - 3237.38s |  But yeah, here's essentially a quick example
3237.38s - 3239.22s |  that is technical, so I didn't completely bait you.
3239.22s - 3241.62s |  Here's an input and here's how you cluster it.
3241.62s - 3243.14s |  You just say cluster zero has all of these
3243.14s - 3244.94s |  and you can give that to an LLM and write the report.
3244.94s - 3246.58s |  LLMs are really good at writing reports.
3246.58s - 3248.06s |  If I give this to an LLM,
3248.06s - 3250.82s |  it will make me an amazing report I can give to my boss.
3250.82s - 3252.02s |  But now when I look at a ticket,
3252.50s - 3254.30s |  it doesn't have to be one alert, a notable alert.
3254.30s - 3256.42s |  My ticket is one notable alert,
3256.42s - 3258.82s |  200 possibly relevant alerts
3258.82s - 3261.46s |  and if I have historical tickets,
3261.46s - 3264.14s |  here is three relevant tickets from history
3264.14s - 3266.86s |  so that I know what happened historically.
3266.86s - 3271.02s |  But yeah, that's pretty much a wrap.
3271.02s - 3274.34s |  This is how we compare against essentially other methods.
3274.34s - 3276.82s |  It's actually efficient because you don't do rules,
3276.82s - 3279.38s |  you don't do searches and it's easier to adapt and maintain
3279.38s - 3280.30s |  and it's actually standalone.
3280.30s - 3281.90s |  So when your boss changes the SIM,
3282.78s - 3283.62s |  you don't lose your work, it's standalone
3283.62s - 3285.62s |  and it's a legacy you can leave behind you.
3285.62s - 3286.58s |  Anyways, I appreciate you.
3286.58s - 3287.98s |  Thank you for the panelists.
3287.98s - 3295.57s |  Thank you guys for listening.
3295.57s - 3298.09s |  I have a shit ton of stickers and I don't know,
3298.09s - 3300.41s |  I can take a lot of questions outside as well.
3300.41s - 3301.25s |  I have a shit ton of stickers
3301.25s - 3302.53s |  and I'd love to connect with you.
3302.53s - 3305.33s |  You guys probably should connect with these guys.
3305.33s - 3307.17s |  There are innovative leaders.
3307.17s - 3309.17s |  These are the kind of leaders that we have on camera
3309.17s - 3314.17s |  saying they like juniors and they don't like MTTD.
3314.41s - 3317.21s |  They don't like the old fashioned way of doing things.
3318.21s - 3320.09s |  These are the kind of leaders you probably want to work with
3320.09s - 3321.17s |  but I appreciate you.