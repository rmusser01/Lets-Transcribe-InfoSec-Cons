{
  "webpage_url": "https://www.youtube.com/watch?v=QgeEHdAmJDg",
  "title": "DEF CON 32 - Secret Life of  Rogue Device: Lost IT Assets on the Public Marketplace - Matthew Bryant",
  "description": "An ex-employee's work laptop, a secret hardware prototype, the company backup server, and classified government computers. What do these things have in common? They should never end up on the public market. Ask any IT department and they'll tell you that \"it happens\", but how serious is the problem and what's really at stake? This talk explores the interesting journey of a research project to learn the surprising answers to these questions.\n\nAlong the way we'll scrape over 150 million images from online listings in Western and Eastern second hand markets, hack together an OCR cluster out of old iPhones, reverse engineer well-obfuscated Chinese apps, and converse with secretive underground groups of collectors.",
  "channel_url": "https://www.youtube.com/channel/UC6Om9kAkl32dWlDSNlDS9Iw",
  "duration": 1815,
  "channel": "DEFCONConference",
  "uploader": "DEFCONConference",
  "upload_date": "20241016"
}

0.00s - 4.04s | This text was transcribed using whisper model: large-v2

 Good deal. Thank you all for coming. This is a secret life of a rogue device
5.24s - 9.36s |  My wife told me not to tell anybody who helped me with these slides and make them look beautiful
9.36s - 15.12s |  So I'm just gonna say a beautiful anonymous woman helped me make these look nice and the earlier format was much uglier
15.12s - 16.36s |  I assure you
16.36s - 22.04s |  So a quick background. I'm Matthew. My friends call me mandatory
22.04s - 29.50s |  I've worked on a variety of security projects things like XSS center cursed Chrome and I write security research at the hacker blog calm
29.94s - 32.58s |  In my professional life, I also lead the red team at snap
33.18s - 37.69s |  So this talks sort of about quote-unquote rogue hardware
38.43s - 43.03s |  Ending up on the secondhand online electronics markets. So what do I mean by rogue?
43.03s - 45.39s |  I mean things that shouldn't end up there
45.39s - 49.43s |  So this is kind of a few key categories, right things like employee laptops
49.43s - 54.17s |  Which you're probably familiar with right that shouldn't be resold maybe has sensitive data on it stuff like that
54.95s - 56.63s |  It means things like prototypes
56.63s - 59.15s |  So early development version of your favorite products
59.15s - 63.87s |  maybe like the iPhones that you enjoy right earlier stages when they were first being built right and
64.07s - 70.11s |  Then sort of like more specialized things like factory line equipments and you know backup hard drives stuff like that
70.11s - 72.11s |  So that's sort of what we'll be covering
72.35s - 77.64s |  The main questions we're gonna be answering here is some of them are pretty obvious, right?
77.64s - 80.76s |  It's like how often does this actually happen right? Is this a problem, right?
80.76s - 85.32s |  And then for the stuff that does end up here, you know on these secondary markets. What's the impact?
85.32s - 90.00s |  Is there anything security related that we have to worry about and then, you know, ultimately what is it?
90.00s - 92.00s |  That actually ends up getting resold like this
93.32s - 99.12s |  Along the way we'll sort of figure out like, you know, what are the challenges of doing research in this space once we figure those
99.12s - 103.48s |  Out well to scale it up to sort of do all of the listings across Western and Eastern markets
103.48s - 108.96s |  And then we'll finish up with everybody's favorite part, which is like war stories and loot and all that cool stuff
111.60s - 114.84s |  Great. So what are the challenges to finding rogue hardware?
115.84s - 120.28s |  First one is probably pretty obvious. You probably already guessed it. We've got to get it from somewhere
120.28s - 122.84s |  So what are the places that stuff gets resold on right?
122.84s - 127.64s |  So if you're you know from the US you probably familiar with eBay right for the Western side of things
127.76s - 132.60s |  There's also other things like Craigslist and Facebook Marketplace, but those are generally a little bit more local, right?
132.60s - 136.44s |  You they might expect you to show up and you know, that's kind of hard to scale out
136.44s - 139.72s |  So we want stuff where you can sort of ship it. So we'll kind of focus on eBay on this side
140.72s - 146.24s |  On the eastern side, you know sort of where all the electronics are assembled actually put together right within some manufactured
146.60s - 151.72s |  There's another market which you may not be as familiar with. I apologize to the native Chinese speakers here
151.72s - 152.64s |  I'm gonna butcher this word
152.64s - 154.64s |  But Shen you is the app that they have there
154.76s - 160.48s |  Which is much larger than I thought it was going to be but this is basically the second-hand market in China
160.48s - 162.40s |  So if you want to resell something there
162.40s - 168.53s |  So we know the where but the second challenge is like sellers don't usually make listings like this
168.53s - 173.17s |  They're not like hey, this is a secret, you know prototype for this crazy product thing, right?
173.45s - 177.37s |  Usually the sellers don't even know what it is that they're selling right in many of these cases
177.57s - 182.21s |  And they're not just gonna put that in a listing where we could easily find it. So how do we deal with that?
183.25s - 187.61s |  I'll give you a little spoiler a lot of the information that we actually want is more in the images, right?
187.61s - 188.77s |  So it's not in any text
188.77s - 194.13s |  What's actually in the text embedded in the images themselves if you have again a company laptop probably sticker on the bottom
194.13s - 197.05s |  It says property of whatever or asset tag, you know, whatever
197.81s - 202.01s |  So we have to dig a little bit deeper to find the answer to this stuff right to figure out the real truth of where
202.01s - 202.85s |  These are
202.85s - 209.34s |  So assuming that we get all the stuff from where we've talked about and then we sort of analyze those images and do all this
209.34s - 212.62s |  Stuff right? We still have to know kind of like what we're looking for, right?
212.66s - 218.06s |  So in the case of prototypes, like I mentioned there's like secret code words secret labeling conventions they use
218.62s - 223.14s |  For I mentioned before for employee laptops, there's special barcode formats and whatever else, right?
223.14s - 226.46s |  So we have to sort of figure out what these are in order to identify when these things show up
226.98s - 232.84s |  And let's talk about sort of building a pipeline for detecting this rogue hardware at scale
234.40s - 238.24s |  Probably unsurprisingly the first challenge is we've got to scrape the hell out of a bunch of sites, right?
238.24s - 242.36s |  So I mentioned before we'll focus on two main sites here eBay and sinew
242.80s - 246.24s |  Let's start off with eBay because it's dramatically easier to scrape. You'll see why
247.12s - 249.00s |  So on the eBay side, this is pretty simple
249.00s - 253.92s |  You just do searches for the kind of products you're looking for right something like laptop or phone or whatever it is
254.28s - 258.36s |  You scrape the resulting listings and you extract the images out of them so we can do analysis on them
259.44s - 263.60s |  But we have a hurdle and this is pretty much the case for any major site, right?
263.60s - 267.16s |  They'll have some form of rate limiting right to prevent either bots or whatever it is
267.60s - 271.96s |  In the case of eBay if you do too many requests, they give you this fake 404 page saying hey
272.56s - 276.36s |  You know, you're doing that too much and to try to fool you into thinking this page doesn't exist
277.72s - 281.08s |  Luckily in the modern Internet is not quite as simple as it used to be, right?
281.08s - 286.76s |  We have like CDN services in the middle of a lot of things to sort of speed up page loads and optimize content being served
286.76s - 290.56s |  At the edge right and we can use this to our advantage to circumvent this rate limiting
290.76s - 295.16s |  So in the case of eBay, you know, they essentially have an allow list from all of cloudflare
295.16s - 298.60s |  Which is a popular CDNs like IP ranges that said hey if it's coming from here
299.00s - 301.84s |  Don't bother with the rate limiting just allow unlimited requests, right?
302.32s - 305.72s |  So cloudflare allows you to make workers which come from like their space, right?
305.72s - 310.52s |  So I just simply upload a cloudflare worker which proxy to eBay and so by using this as a proxy
310.52s - 316.56s |  I can get around all the rate limiting and do unlimited requests. So super easy. We've got that problem solved
317.76s - 319.52s |  moving right along
319.52s - 325.16s |  All right. So in the China side right Shen you it's not quite as easy
325.16s - 327.92s |  In fact, you go to their website and you don't see like anything at all
327.92s - 331.00s |  It just says like hey download our app to continue. They're like, all right
331.44s - 336.20s |  So you go to their your local app store you download their web their their little app
336.20s - 338.20s |  You start browsing for listings on this, right?
338.40s - 341.92s |  Of course if we want to do this at scale and do any scrapings is not going to cut it
341.92s - 345.92s |  So we got to crack open the app. We remove cert pinning and under the hood
345.92s - 350.84s |  We find that it has a total custom signing API for all of their requests
351.04s - 354.04s |  So they basically generate some cryptographic material. They sign all the requests
354.04s - 356.52s |  They have to be byte perfect and be signed properly
356.52s - 359.76s |  Otherwise the servers will just reject your requests on top of this
359.76s - 364.78s |  Even if you do those requests you get responses where the fields are actually encrypted in their proprietary format
365.00s - 367.40s |  So you have to be able to figure out how to get rid of that as well
367.88s - 370.28s |  And of course they implement their own capture system
370.28s - 375.04s |  So if you're doing a lot of these requests, right, you're not logged in they're gonna spawn this and you have to solve this
375.04s - 376.24s |  and
376.24s - 380.24s |  You're like it's too easy. There's still more all of that stuff
380.52s - 387.00s |  It's not done like in the Java where it might be easier to reverse right? It's done deep inside the obfuscated JNA binary, right?
387.00s - 389.36s |  So you're gonna have to pull out some assembly and start cooking, right?
390.04s - 394.20s |  Really great job actually like by the team. They did a good job of doing the any bot stuff here
395.12s - 400.12s |  But for us, this is just like a skill issue. So we're gonna have to get around all this shit, right?
401.04s - 405.24s |  If any of you have ever done Android reverse engineering before you have personally been on this scale
405.36s - 409.00s |  You start off and you're like reading a blog post. You're like dude Frieda is sick
409.00s - 412.92s |  I can just hook all these functions and like I don't have to do a reverse engineering look like
413.12s - 418.88s |  Easy and then eventually you start like becoming like I'm the real deal. I learned assembly. I can reverse engineer stuff
418.88s - 424.12s |  I can actually just figure out their custom thing and like re-implemented my own language and it's super leaf
424.12s - 427.28s |  And then they do an update and it breaks all your shit and you're like, wait a minute
427.92s - 430.44s |  Every update I'm gonna have to do like three hours of reversing
430.44s - 434.76s |  No fucking thank you. And so you go back to Frieda, right? So in this case, we just skip to the end
435.76s - 438.40s |  so I wrote a custom thing to basically
438.92s - 445.48s |  basically open the app click through all the prompts do initial requests and do the fun like thumb capsule sliding thing automatically and
445.76s - 449.00s |  Then once it's into the state where I can start actually doing these requests
449.00s - 453.96s |  It does a Frieda server and doesn't injection so we can basically hand it an HTTP request that
454.12s - 458.68s |  We want to sign for us and it will return us to sign the request that we can then send to their API server
461.43s - 462.99s |  So this is essentially what it looks like
462.99s - 466.95s |  You got like a rooted phone with a server and essentially it does the signing proxying for us, right?
466.95s - 470.19s |  and then we send that off over residential proxy to make the request and
470.83s - 475.55s |  Result looks something like this again cable management was not me. It was much uglier when I did it
476.23s - 480.00s |  So this gives us a good way to sort of find new sellers, right?
480.00s - 484.64s |  We do searches we get their seller IDs and now we've got a good base to actually scrape the items that we want here
485.56s - 488.96s |  So when I said that there's like no websites that was kind of a lie
489.08s - 493.28s |  They do have a special like preview thing for ostensibly growth reasons, right?
493.28s - 497.24s |  So you can like share a link in the app with somebody else and they don't have to have the app to see it
497.24s - 499.64s |  And it's like a little it'll show you the listing information
499.64s - 501.76s |  But then when you try to buy it, right, it's like down on our app
502.00s - 506.92s |  So that sounds like a great way to get around this but there's kind of a caveat, right?
506.96s - 510.20s |  The rate limiting here is severe. I don't mean like you're like wow
510.20s - 513.88s |  This is like three previews you view it and it's like no, no, no, no more
513.88s - 519.26s |  No more previews you got to log in and so this means that we're gonna need like a lot of IP addresses
520.04s - 523.36s |  So even for like the crappy budget networks, this is gonna be a lot of IP addresses
523.64s - 530.52s |  So I had to do a little bit of digging pun intended and I was like, oh it's available over IPv6
530.96s - 534.76s |  Last time I checked I think there's a lot more IPv6 IPs out there than IPv4
535.08s - 537.08s |  So I think there might be a solution here
537.08s - 538.76s |  Okay
538.76s - 544.00s |  So I went straight to the source for you know for me this is like the North American number registry
544.00s - 545.12s |  Which is Aaron, right?
545.12s - 551.84s |  you can apparently get a fat 36 range IPv6 right allocation and it only costs like 250 bucks a year and
552.04s - 555.76s |  So with this you actually the number of IPs is a bigger number that I can even pronounce
555.80s - 558.88s |  But you essentially have a limited IP space that you can now utilize.
559.92s - 564.12s |  I combined this with a piece of software that my friend wrote which essentially takes like if you have a box where you write
564.12s - 569.60s |  All the IP addresses to you this turns it into like a Sox by a Sox proxy server where every request you make to it
569.60s - 572.28s |  It will randomize it through the outbound range that you have set up, right?
572.36s - 577.76s |  So now we can just start blasting from a limit this huge range right with unlimited IPs and rate limiting is
578.00s - 581.84s |  We'll call it more or less solved, right? We may never come from the same IP twice
583.98s - 585.14s |  Great
585.14s - 587.90s |  Scraping is solved. Let's talk about that second challenge, right?
588.14s - 593.94s |  Again, that challenge is that the secrets that we want are probably not outright in the listing description, right? They're hidden, right?
593.94s - 596.06s |  Maybe the seller doesn't even know what it is that they're selling
596.78s - 602.06s |  So, how do we address this right? The key way that we do this is via OCR, right? So
602.74s - 604.62s |  There's some problems with this in practice
604.62s - 606.50s |  You probably heard of open source solutions
606.50s - 611.50s |  but they have things like this where Apple does their very chic gray on silver design and
611.70s - 615.30s |  Even some humans have issues reading this text right and computers are no different
615.46s - 621.14s |  When I plug this into the open source Tesseract model, right? It basically said there's no text on this
621.14s - 622.70s |  I have no idea what you're talking about
622.70s - 628.18s |  So that was like not gonna fly. I looked at some like proprietary APIs, right?
628.18s - 630.58s |  There's Google Vision Google Vision actually did a great job
630.58s - 634.54s |  I was like, wow, look at all the text that I could you know, want me to get out of this, right?
635.06s - 637.06s |  but then I sort of looked at the pricing and
637.98s - 643.66s |  I was like, oh one penny for seven images. That's pretty good. But then I was like wait so for a million images
643.66s - 647.38s |  That's 1500 bucks and we're doing hundreds of millions of images. So
648.10s - 650.10s |  Yeah, that's not really tenable
650.98s - 653.90s |  But I had sort of a eureka moment when I was actually using my iPhone
653.90s - 658.02s |  I had one of those old-school captures, you know before the current more annoying like grid ones
658.50s - 660.50s |  where essentially I held my thumb down and I
660.78s - 666.50s |  Realized that I could actually select the warped texts and I could copy it and I was like wait
666.50s - 671.54s |  I was as an OCR model. This is sick, and I could paste it and it got it exactly, right?
671.54s - 675.14s |  so I was like there there might be something here and
676.66s - 679.98s |  Not only is it available you can actually like if you just write an app you can integrate
679.98s - 684.78s |  with this API and automate it so I wrote some of the ugliest Swift code any of you have probably ever seen and
685.18s - 692.54s |  made a little HTTP server where I could send it an image and it would do OCR in English and Chinese and do barcode detection and
693.06s - 699.34s |  This basically solved it, but you're probably like, okay, you can use an iPhone, but that's got to be expensive, right?
699.34s - 701.18s |  Like iPhones are super expensive
701.18s - 707.82s |  but in fact the GPU acceleration chip actually goes back as far as the iPhone second generation SE and
708.58s - 714.62s |  And if you get those on like, you know cricket wireless or some unpopular carrier, right they're sold for as little as 40 bucks
715.02s - 719.74s |  So you can get these for super cheap and you can build yourself a high-capacity OCR array
720.70s - 722.70s |  So I wired a bunch of these together
722.90s - 727.30s |  And I had a high-capacity array that could do around 50 HD images
727.54s - 731.90s |  second in English and Chinese even with a lot of text and barcode detection as well and
732.38s - 739.22s |  To make it even better it basically uses no power because the mobile like compute was actually super efficient. So it worked out really well
740.86s - 744.78s |  Great so we scraped all this shit. We got all these images we can do OCR on all these images
744.78s - 747.94s |  We index all of it, but now we need to know what we're looking for, right?
748.14s - 750.06s |  So I started off by just looking like
750.06s - 756.02s |  general examples of like prototypes and company laptops and sort of built a very early set of keywords to alert on and
756.10s - 760.82s |  When I found matches to those alerts for products that were listed anything else on the laptops that they had
760.82s - 766.02s |  I then added those marks to my list of things to alert for right so maybe I had some text that was like property
766.02s - 770.34s |  Of then I get a barcode and I'd see what their barcode format was and then I would add that to my rules
770.34s - 773.10s |  And it's iterative, right? So every time I get more results
773.10s - 774.82s |  I'm improving my rule sets and pretty soon
774.82s - 779.30s |  I've got a huge alert list of keywords that when something comes up I can immediately get a notified of it. I
780.26s - 784.02s |  Made this a little easier by building like a nice little data lake UI so I can just type in
784.10s - 789.38s |  Fancy type any keyword and it will immediately start showing me matching listings so I can very quickly cook these things up
791.71s - 795.19s |  Talked about a lot of pieces overall, but this is kind of a 10,000 foot view
795.35s - 802.35s |  you've got the most convoluted set of like free to server bullshit combined with like exit proxying combined with like elastic search and
802.43s - 807.07s |  iPhone OCRs, but TLDR took a lot to do this with the level of data that we're doing
808.83s - 810.75s |  Overall we're talking about
810.75s - 817.41s |  Much more now, but probably like 50 million listings scraped, right? We're talking over 250 million images OCR in total, right?
817.63s - 819.87s |  None of the iPhones are exploded yet. Very great work
822.04s - 825.04s |  Said there was only three challenges. There's actually kind of 3.5
825.20s - 830.72s |  So imagine you're selling something on eBay and some random person like some remote province of China says
830.72s - 833.84s |  Hey, could you just like ship this to me and you'd be like, dude
833.84s - 835.24s |  I don't know how to do paperwork for Canada
835.24s - 837.68s |  Let alone like you know this place in China, right?
837.68s - 841.40s |  And it's so different if you ask somebody and do domestic Chinese markets to say hey
841.40s - 844.12s |  Could you ship this to me in like, you know, Alabama or whatever it is, right?
844.36s - 850.12s |  So we kind of have to figure out like how can we work in these markets and buy from local sellers when we ourselves like
850.16s - 853.80s |  Don't maybe don't speak the language to understand the culture and when I get it like exported to us
854.84s - 856.84s |  So where can this secret knowledge be found?
858.00s - 863.50s |  Luckily, there's a community who's very familiar with a domestic Chinese market built around like really high-end fake
864.24s - 868.64s |  Fashion replicas. So yeah, your Gucci handbag that's like indistinguishable or whatever from the real one
869.08s - 874.80s |  There's a community that kind of focuses on basically getting these from inside of the domestic Chinese market and they use these agents
874.80s - 877.08s |  Which will actually do the work of communicating with the seller
877.08s - 881.00s |  They'll buy it and they'll actually like rewrap it for you and do all the export forms to get it to you
881.32s - 886.36s |  So we basically use the exact same stuff that they use to get these designer clothes and we kind of have this solved
886.88s - 891.05s |  So this is what you've all been waiting for. I'm sure let's go to the loot
891.05s - 896.89s |  So now what we found here before we again, we'll start off with employee devices here before we sort of get into these
897.09s - 899.35s |  We'll dispel some very quick like well
899.61s - 904.89s |  Actually things that I'm sure you're gonna want to say and one of the common rebuttals I hear is like sure you can find this
904.89s - 910.05s |  Hardware leaking out, but it's it's probably all locked and requires a passcode to access them or whatever
910.05s - 912.25s |  So there's no way that you can like actually do this, right?
912.93s - 918.71s |  My rebuttal in this case is merely a slide. Obviously, there's a lot more examples, but there's only so much space
920.69s - 928.03s |  Plenty of notable examples here, right and you're like, okay, okay. Okay. They're unlocked
928.03s - 931.63s |  I get it. I get it, but that doesn't mean that there's actually anything sensitive on the devices, right?
931.87s - 934.09s |  And again, I only have a slide as a rebuttal
934.75s - 937.03s |  again, many more examples, right and
939.28s - 943.36s |  If you're like my company is not affected if you work for a fortune 500 company
943.52s - 947.26s |  Guarantee you I've seen your equipment end up on eBay or some other market, right?
947.64s - 952.18s |  Super wide breadth of you do any volume of employee equipment or whatever. It's gonna be here
953.62s - 957.80s |  So let's talk about the war stories. I want to actually do a quick little preface here
957.80s - 960.68s |  All of my examples are for a pretty popular company called Apple
961.24s - 965.56s |  This is not because Apple like fucked up especially actually it's pretty much the opposite
965.56s - 971.20s |  They were like a mature hardware company and my point of the research targeting like their stuff was more because like if it affects them
971.72s - 974.76s |  We can be pretty sure that any other company is affected as well, right?
974.76s - 980.12s |  They have they have resources right to make this right. So I will start with the story of the time capsule
980.96s - 987.00s |  So I built up a good little database of alerts and keywords for those things and eventually I got alerted to a time capsule
987.00s - 988.68s |  That was listed in the United Kingdom
988.68s - 993.44s |  and the reason why I got an alert is I had this cool sticker on the background which said property of Apple Computers Inc
993.60s - 997.76s |  Expensed equipment and I was like, hmm. This might be interesting and
998.52s - 1003.04s |  I looked at the description and it said this said hey, it was part of an office clearance good sign
1003.44s - 1007.44s |  It's been powered up and lights up as expected, but it has not been tested beyond this point
1007.76s - 1012.64s |  This is the perfect description for if you think something's gonna be good because it means the device works
1012.84s - 1016.96s |  We couldn't wipe it ourselves because we couldn't really get it like turned on like all set up, right?
1016.96s - 1020.92s |  But we can be pretty sure that like it's at least in the original state that maybe they got it in, right?
1022.00s - 1026.64s |  So I also did some googling and there was actually an office clearance for Apple that like they moved offices
1026.64s - 1028.64s |  So it seemed like it lined up
1028.80s - 1030.80s |  So I placed a bid. I
1031.04s - 1035.76s |  Didn't realize how big the shipping was it was actually like almost like it's like more than the actual device itself
1035.76s - 1041.32s |  so I kind of learned that lesson the hard way, but we'll take a risk got into United States after
1041.84s - 1044.84s |  Sweating with a heat gun and getting the back off and pulling the hard drive out
1044.84s - 1048.12s |  I was able to connect it up to my laptop to start doing like
1048.84s - 1050.84s |  to look at the drive rights and
1051.64s - 1055.72s |  Initially, I looked at it. I was like, oh, you know shoot. Oh, there's no files. Looks like they deleted them
1056.48s - 1058.12s |  I was like unless
1058.12s - 1062.32s |  Unless they deleted it and they didn't actually do a secure wipe of it. So maybe they're still hanging around
1062.32s - 1065.72s |  Let's just just in case let's do a forensic scan this thing, right?
1066.12s - 1069.32s |  So I let this thing run that cooked for around 28 hours
1069.88s - 1071.88s |  For two terabytes, which is quite a while and
1072.40s - 1080.32s |  Turns out it's not entirely true. There was data on the device things like internal credentials things like internal support tickets
1080.84s - 1084.96s |  sales reports and figures internal documentation apps repair guides
1085.84s - 1088.04s |  internal emails bank account information
1088.80s - 1095.60s |  Passport and ID scans and I swear this last one is true dank internal memes from these Apple stores in Europe
1096.60s - 1103.48s |  There was literally an entire video done in like the Backstreet Boys style of how to count the inventory in your Apple store
1103.48s - 1107.52s |  I kid you not it hurt me so much to like hand this back over. So
1110.09s - 1114.73s |  Anyways, I got this and I was like, all right, this is scary. I'm gonna tell Apple about this, right?
1114.73s - 1118.73s |  I used the only only channel they had for reporting which was like their regular
1119.13s - 1125.09s |  Like sort of bug bounty reporting cue thing and said hey, I've got this time capsule looks like it's from like the 2010s
1125.09s - 1128.21s |  It's got like a bunch of euro of stored data and you probably want this
1129.93s - 1135.49s |  You know, I got this I originally submit this actually to them and I got I think some regular like product security person
1135.49s - 1139.93s |  Who's like I do bugs like I don't know what the what this is or what I'm supposed to do with it
1139.93s - 1144.93s |  And he's just like I sent an email to our internal to keep like people but there's nothing I can do with this
1144.93s - 1147.65s |  So I originally was like, oh, this is easiest disclosure ever
1147.65s - 1152.01s |  It's like already over but then I got email later from their G stock in London
1152.01s - 1157.05s |  Which is like hey, we actually do we would very much like that drive and you're in the Bay Area, right?
1157.05s - 1159.17s |  Could you just like drive ten minutes and drop that off for us?
1159.17s - 1166.84s |  And I was like sure, you know lunch break head over there drop it off to them and I was like good deal
1166.84s - 1171.68s |  You know, I sent an email saying we're all good. The disclosure is all finished. I was like cool done deal
1173.32s - 1176.36s |  Later on I received an update like later that night where they were like, hey
1176.96s - 1182.16s |  Any other POC's off that drive that you can send us just to assess the impact of the report and I was kind of like
1182.64s - 1186.16s |  But I already gave you the drive so like how would I how would I do that?
1186.16s - 1188.56s |  Cuz like obviously I don't have the data. I gave it back to you, right?
1188.56s - 1191.88s |  So I was kind of like I think it was just a medication between the team
1191.88s - 1194.52s |  But I was kind of like a little bit like what's the deal here?
1198.94s - 1202.82s |  Cool. So let's talk about prototypes right another one of those like main columns. I mentioned
1203.66s - 1207.34s |  They usually look something like this right lots of scary hardware labels in the back
1207.90s - 1209.90s |  Usually a phone number to report it being missing
1210.62s - 1217.06s |  And Apple actually has some pretty interesting prototypes, they're a little bit more valuable than your regular prototype that you might find
1218.10s - 1220.66s |  Here's a bunch of stuff that I was able to get over doing this research
1221.10s - 1223.66s |  This is actually a small part of a lot of the prototypes. Those are the defiance
1225.38s - 1231.10s |  So the reason why Apple prototypes are a little bit more interesting is because they have something called dev fusing and a lot of
1231.10s - 1237.54s |  Their prototype versions of the iPhone right and you're like, what the hell is depth using essentially in a production iPhone that you buy from
1237.90s - 1244.46s |  Right, they actually burn these fuses which prevent you from being able to do debugging of the application processor and the secure enclave processor
1244.46s - 1249.58s |  Right, and so when you do exploit development, you've kind of heard these like million-dollar or whatever iPhone exploits
1249.74s - 1254.38s |  Having one of these phones is key because it allows you to really easily debug your exploit to make you know
1254.38s - 1255.66s |  Get it pull it off essentially
1255.66s - 1260.02s |  So there's like a big gray market spawned off of this Apple actually has researcher devices that they'll give you
1260.22s - 1263.18s |  If you follow a bunch of legal procedures to get yourself
1263.66s - 1267.30s |  But you know, there's still people that don't want to deal with that. So there's still this big gray market, right?
1267.54s - 1271.74s |  But there's these TLDR. There's these super rare iPhones which are useful for security research, right?
1272.54s - 1273.86s |  This is sort of what that looks like
1273.86s - 1275.10s |  They have different fusing states
1275.10s - 1279.52s |  If you have the debugging cable, you can basically plug the iPhone in and say yes, this is a deaf used iPhone
1279.98s - 1284.86s |  So again on around November 23rd 2023
1284.86s - 1289.02s |  I had my pipeline alerted to a bunch of listings being created at once in China
1289.02s - 1293.22s |  And they were all iPhone 14s and initially, you know when I get a bunch of alerts at once
1293.22s - 1296.26s |  I'm like, oh somebody's reposted their listing like eight times or whatever
1296.30s - 1298.46s |  But then I started to look at the photos and I was like
1298.98s - 1303.54s |  Wait a minute. These are all distinct iPhones. This is not like one iPhone that's been repeatedly posted
1304.14s - 1306.58s |  So it turned out this is actually a huge cache of these
1307.14s - 1313.66s |  Prototype iPhone 14s, which at the time was the latest model of iPhone, right? So this is like a video of the seller
1314.94s - 1318.58s |  Furthermore when I actually bought one of these iPhones and imported it here
1318.58s - 1322.90s |  I realized that the seller when he was sort of taking pictures to validate the camera worked
1323.02s - 1325.74s |  He didn't turn off the GPS tagging feature in the photos
1325.90s - 1329.74s |  so I actually had the exact location in China where the seller actually was and
1330.50s - 1333.64s |  Worse than that. He also took selfies to validate the camera
1334.50s - 1338.62s |  So in terms of like finding the source of these leaks, this is a pretty compelling way to do that, right?
1340.06s - 1341.66s |  But I don't want to give you the wrong impression
1341.66s - 1346.18s |  It's not just that these prototype iPhones will only come from like, you know, wherever in China that they're made
1346.18s - 1348.26s |  He actually ironically so I live in the Bay Area
1348.26s - 1353.02s |  It's either in these remote provinces of China or it's a 10-minute drive from my house with very little in between
1353.54s - 1357.30s |  So in this case like this was one that was leaked in San Francisco, right?
1357.30s - 1361.42s |  It's a DVT model iPhone 14 and it did indeed have depth fusing, right?
1361.50s - 1365.18s |  The most hilarious part about this actually is that the sellers oftentimes when they have these
1365.22s - 1371.38s |  They try to do like a regular restore of the device only to realize like this is a weird iPhone. I can't restore this
1371.38s - 1374.38s |  I have no idea what's going on here. They're just like I got I'll sell it for parts
1374.38s - 1380.74s |  Whatever and so the listings are sold usually for parts when it's actually like a very, you know expensive prototype iPhone, right?
1382.50s - 1388.18s |  Cool so it kind of covered a couple examples here. We talked about time capsule. We talked about these rare prototype devices, right?
1388.18s - 1390.98s |  Let's go to the thing the place where these things are made, right?
1390.98s - 1394.92s |  So in this case the assembly line is for Foxconn for Apple for the most part, right?
1396.18s - 1398.18s |  So I looked at a lot of these Chinese listings
1398.42s - 1400.02s |  Things that had like, you know
1400.02s - 1402.90s |  A bunch of labels that appeared to be related to Foxconn, right?
1402.90s - 1406.90s |  And I started to realize that there was a pattern that was starting to emerge when I looked at these things, right?
1406.98s - 1410.06s |  So if it's used inside of Foxconn, I started to realize that hey
1410.06s - 1411.70s |  It usually has this like, you know
1411.70s - 1416.14s |  Three-letter four-letter a six-digit combo thing that they used to label like internal equipment
1416.14s - 1420.54s |  And so I created a quick rule that anytime something like this shows up in China
1420.58s - 1422.70s |  Why don't you let me know and I'll take a look at it, right?
1422.90s - 1425.46s |  I'm sure all of you can sort of see where this might be going
1426.18s - 1428.86s |  Sometime later. I got an alert for a listing like this
1429.42s - 1431.74s |  For only 181. This is like
1432.54s - 1434.54s |  $28 I think in USD and
1434.98s - 1436.54s |  When I took a closer look at it
1436.54s - 1438.46s |  It had all the markings that I wanted
1438.46s - 1442.86s |  And I looked at the bottom of it and there was an interesting of hole drilled in the bottom
1442.86s - 1444.30s |  I was like, oh, okay
1444.30s - 1448.86s |  So like they basically took a drill press to this thing to like securely destroy it and you know
1448.86s - 1450.86s |  What can get rid of the hard drive?
1450.94s - 1453.62s |  But then I thought about it a little bit more and I was like, wait a minute
1453.62s - 1457.86s |  Let me look up a schematic of what this looks like inside. I was like, okay, so if like the hard drive is here
1457.86s - 1459.18s |  and
1459.18s - 1461.50s |  that means the magnetic platter is here and
1462.70s - 1464.70s |  They drilled the hole like here
1465.50s - 1477.16s |  There might be a chance and this is one of those things where I'm like, there's no way but it would be too cool
1477.16s - 1480.44s |  If it works, so I bought it right into the United States again
1480.96s - 1482.28s |  Didn't you know?
1482.28s - 1483.68s |  Disassembled it pulled the hard drive out
1483.68s - 1489.24s |  I looked inside and I saw that beautiful orange PCB color and I was like, I think they might have missed it
1489.24s - 1491.36s |  But let's let's send it to the experts
1492.08s - 1497.76s |  So I shopped around a little bit found a cheap lab down in LA to that said hey they gave me the honest answer
1497.76s - 1500.76s |  Which is exactly what I was looking for where they were basically like, all right
1500.76s - 1502.76s |  Listen, you drilled a hole in the damn thing
1502.76s - 1507.72s |  Like if you did that and you didn't turn it on and there's not a bunch of dust and all these other things then yeah
1507.72s - 1511.20s |  I think we can recover it, but don't get your hopes up like be aware, right?
1511.72s - 1516.24s |  So I said down to them they basically after some time came back to me and they said hey, you know
1516.24s - 1517.12s |  We pop this thing open
1517.12s - 1520.48s |  It looks like it just hit the PCB and in order to recover it
1520.48s - 1524.56s |  We basically get to buy a working drive go into a clean room and swap the magnetic platter from one to the other
1525.52s - 1531.64s |  Obviously after getting this email I was like so just to be clear you're saying they did miss the magnetic platter and they were like
1531.64s - 1533.64s |  Yep, it pretty much missed everything
1533.80s - 1537.12s |  So it looks like there might be a chance here. There's not a lot of dust even on the platter
1537.12s - 1539.12s |  So I think we might be good
1539.96s - 1543.36s |  Sometime later. I got the email that I was looking for where they said hey
1543.36s - 1549.28s |  I got 99.99 whatever percent of the data and I was like, oh, yeah, it's all coming together
1551.16s - 1556.00s |  But I was still like if you do a lot of this research you always try to like hold off on being too excited because
1556.00s - 1558.68s |  Your dreams have been crushed too many times by it not working out
1558.68s - 1562.68s |  So I was like, you know, maybe maybe somebody actually bought it reused it and then they drilled the hole in it
1562.68s - 1565.96s |  So like, you know, maybe it's not actually the real thing, but it was
1566.96s - 1569.68s |  These are the wallpapers from it being used in the factory line
1569.68s - 1574.28s |  It was used to do Q&A ostensibly for actually a couple things that look like but for iPad QA it looked like
1575.04s - 1581.60s |  Came along with a bunch of really tasty internal Apple software for sort of interfacing with their prototype devices and doing QA on the line
1581.92s - 1586.60s |  all of that good stuff right came with internal credentials for the Foxconn factory and
1587.04s - 1591.60s |  a bunch of other cool stuff a lot of cool Apple tooling to with a bunch of like you could tell engineers came up with
1591.60s - 1594.32s |  The name of these tools right like footing whatever so
1596.04s - 1599.36s |  Another funny story about this one is when I gave this one to Apple like the first time
1599.36s - 1603.24s |  There's a lot of miss a lot of communication when it came to the time capsule like back and forth to coordinate it
1603.24s - 1607.76s |  The second time I was like, hey, I've got this random drive from the Foxconn line. I got did this forensics
1607.76s - 1609.20s |  I got all this data. I want to give it back to you
1609.20s - 1613.80s |  They were just like here's a prepaid FedEx envelope. You just drop that shit in the mail get it right to us
1613.80s - 1615.80s |  I was like sweet
1618.57s - 1622.33s |  Great, so we've got some cool PLCs. We kind of show off the problem, right?
1622.37s - 1626.37s |  Let's go into like maybe what are the high level like takeaways of this whole stuff, right?
1628.96s - 1632.88s |  So one thing that's kind of interesting is like this is not like, you know
1632.92s - 1637.12s |  You think like the conventional hacking stories and sort of like, you know cracking code or whatever
1637.12s - 1643.28s |  But this research raises kind of interesting question, which is like have I done anything sort of unethical or wrong here, right?
1643.28s - 1647.08s |  If you talk about the source of a lot of these other prototypes, we're talking about pretty illicit stuff, right?
1647.08s - 1651.64s |  They're paying somebody I assume to take it off the factory line or whatever it is, but we're not we're not doing that
1651.64s - 1653.64s |  We're just literally looking for public listings
1653.76s - 1658.76s |  We come to the table with a little bit more information about what is in those like listings and what it actually means, right?
1658.76s - 1661.16s |  And ostensibly they would have been sold anyways
1661.20s - 1666.08s |  But we just instead buy it in the first place, right? So have we like really done anything wrong, you know
1666.08s - 1668.12s |  I mean, so it's just a very interesting question there
1669.52s - 1672.96s |  I think another potentially interesting takeaway here is you know
1672.96s - 1679.36s |  You're probably more familiar when we have like very standardized full disk encryption and mobile device management for like the standard set of things
1679.52s - 1682.80s |  So you get your work laptop things are pretty well understood there
1682.80s - 1686.56s |  You have your like work phone and DM solutions that these solutions are pretty straightforward
1686.56s - 1691.08s |  But then when you get to the more custom hardware side, you don't necessarily have that level of maturity
1691.08s - 1692.44s |  It's like the time capsule, right?
1692.44s - 1696.76s |  It's like is there a clear suite that can that can actually do ensure that these things work the way that you expect?
1696.76s - 1702.32s |  And so I would assume that this probably extends to any other type of custom hardware where you don't have this very standardized
1702.40s - 1704.40s |  format of software to protect this
1705.68s - 1710.04s |  This one is probably obvious for anybody's done anything related to hardware or who lives through COVID
1710.76s - 1716.88s |  Supply chains are incredibly difficult, right? You've got multiple sides of the globe on different time zones doing iterations on hardware
1716.88s - 1719.80s |  It's not like software where you're halfway through and you're like, ah
1719.80s - 1721.44s |  Let's just can all this and rewrite it
1721.44s - 1724.32s |  You're kind of your parameters are slowly narrowing and you've got to like
1724.68s - 1729.32s |  Throughout all this time make sure none of them leak out and everything's securely destroyed and all this stuff, right?
1729.32s - 1731.04s |  You got to keep everybody super tight-lipped
1731.04s - 1735.72s |  So it's very challenging to do this right across many countries and to deliver this final product
1737.32s - 1742.44s |  Another interesting point as you noted with one of these examples is leaks very much point to sources
1742.84s - 1746.52s |  So you mentioned like we found listings where these things sort of bubbled up, right?
1746.52s - 1750.52s |  And we can then take those to go to the sellers to figure out like what's the real story here?
1750.52s - 1755.36s |  Where did this shit actually come from and we can start to understand a full picture of like where is my stuff breaking apart?
1755.36s - 1756.88s |  How is this stuff leaking out, right?
1756.88s - 1761.60s |  So it becomes a very good opportunity to sort of identify these sources and ultimately close them if you're the company
1761.60s - 1769.08s |  I think another really interesting piece of this too is I would say that like e-waste is a particularly interesting point, right?
1769.08s - 1773.28s |  So if you have your stuff going to e-waste a lot of people sort of assume like oh, it's gonna be destroyed
1773.44s - 1778.56s |  But then you get people who are at the e-waste side who are like, why are they throwing away 50 good iPhones?
1778.56s - 1781.92s |  Like this could be resold right now. Like it's very strange, right?
1781.92s - 1785.92s |  And so a lot of these I think leaked out from sort of e-waste recycling centers, right?
1785.92s - 1787.52s |  And this is what causes these problems
1787.52s - 1791.20s |  So you got to make sure that like your stuff is actually being destroyed and not being you know
1791.20s - 1798.44s |  Essentially diverted and potentially resold. I just want to give a quick quick special. Thanks to Apple demo
1798.44s - 1804.12s |  He does a bunch of iPhone prototype stuff check out his YouTube for helping me serve the initial research and understanding of this space
1804.56s - 1807.04s |  And I'd like to thank all of you for coming to this