{
  "webpage_url": "https://www.youtube.com/watch?v=T5K4ABfzkhI",
  "title": "DEF CON 32 - Behind Enemy Lines: Engaging and Disrupting Ransomware Web Panel - Vangelis Stykas",
  "description": "Ransomware groups have become notably proficient at wreaking havoc across various sectors , but we can turn the tables. However, a less explored avenue in the fight against these digital adversaries lies in the proactive offense against their web panels. In this presentation, I will delve into the strategies and methodologies for infiltrating and commandeering the web panels used by ransomware groups to manage their malicious operations or the APIs used during their initial exfiltration of data.\n\nI will demonstrate how to leverage these vulnerabilities to gain unauthorized access to the ransomware groups' web panels. This access not only disrupts their operations but also opens a window to gather intelligence and potentially identify the operators behind those APTs. Let\u2019s explore the frontiers of cyber offense, targeting the very command and control (C2) centers ransomware groups rely on, turning the tables in our ongoing battle against cyber threats, it\u2019s our turn to wreak havoc.",
  "channel_url": "https://www.youtube.com/channel/UC6Om9kAkl32dWlDSNlDS9Iw",
  "duration": 2338,
  "channel": "DEFCONConference",
  "uploader": "DEFCONConference",
  "upload_date": "20241016"
}

3.09s - 12.09s | This text was transcribed using whisper model: large-v2

 Hello Deftone. First of all, if anyone does not want to be photographed, I'm going to take two pictures.
12.09s - 28.42s |  That's for my mom. She never believes that anyone comes and hears me talking.
28.42s - 34.75s |  That says a lot about her trust issues, but yeah.
34.75s - 42.75s |  So, hello everyone and welcome to my talk, Behind Enemy Lines, Engaging and Disrupting ransomware web panels.
45.61s - 50.61s |  This talk is PG-17 due to two reasons.
50.61s - 60.61s |  First, there are going to be some notions about drugs and bad words from people in the talk.
60.61s - 68.61s |  And secondly, I love saying fuck and shit, and I'm not going to stop it.
71.34s - 74.34s |  Hello all. As you can see, I'm Vangelis Stikas.
74.34s - 80.34s |  I'm the CTO and co-founder of a penetration testing firm called Atropos.
80.34s - 90.34s |  We specialize in API penetration testing and green PV and electronic vehicle chargers penetration testing.
90.34s - 99.34s |  My research interest for the past decade is API security and for the past couple of years, malware and ransomware situation.
99.34s - 114.61s |  How everything started. So, I don't know who of you were here last DEF CON, but I did a pretty similar talk about malware C2s, which was really, really easy.
114.61s - 122.61s |  So, I wanted a bigger challenge and the main question in here is, could it be any harder?
125.72s - 132.72s |  Markus Hatzins, I think you all know who he is, said that cyber threat intelligence is such a white industry.
132.72s - 143.72s |  In contrast to the actual intelligence, which is a monopoly of the governments, there is the CTI.
143.72s - 153.72s |  There is just some random dude named Brad who got really baked one night and yellowed his way into a major APT's backend server.
153.72s - 159.72s |  Two issues in here. I'm going to start with the one that has legal implications.
159.72s - 168.18s |  Who the fuck named his son Brad? I'm not Brad, I'm Vangelis.
168.18s - 180.18s |  And secondly, I don't take drugs. I do like my occasional alcohol, but I also have three really strange people in the signal chat.
181.18s - 186.18s |  If you want to drop them a follow on Twitter, Twitter, no text, fuck Elon Musk.
186.18s - 195.18s |  First is Solfer, my really good friend and pretty much partner in all my research and the main person to blame.
196.18s - 210.18s |  My second person is Iskuri, who is a legendary DEF CON, multiple times DEF CON and Black Hat speaker and a person who hacks bootloaders for fun.
210.18s - 222.18s |  And third one is No Thanks. He's a super ninja hacker, multiple times DEF CON speaker too, and a really good artist.
222.18s - 229.18s |  So all three of them were trying to poke me around to start going after ransomware.
229.18s - 239.00s |  A couple of minutes ago, I asked how much more difficult it would be.
239.00s - 252.00s |  For the malwares, in the past couple of years, I have been able to pawn or gain access to pretty much 50% of all the bundles that I have seen.
252.00s - 257.00s |  So it's 18 out of 36. For the ransomware, it's quite difficult.
257.00s - 266.00s |  So I only was able to get access to three and a half out of 140 that I have tested.
266.00s - 276.34s |  Quick intro. That's the only intro. Ransomware is a type of malicious software that threatens to publish or block access until the blah, blah, blah.
276.34s - 280.34s |  If you don't know what the ransomware is, go somewhere else.
281.34s - 287.23s |  How ransomware hacks work, there's a step-by-step process.
287.23s - 297.23s |  One is they somehow get access and distribute their malware and infect an internal user.
297.23s - 301.23s |  The second step is getting access to command and control C2s.
301.23s - 305.23s |  Then they do the discovery and lateral movement.
305.23s - 309.23s |  The data extraction, so they're extracting all the data.
309.23s - 313.23s |  Data encryption, which means you have lost all your data.
313.23s - 319.23s |  Then there is extortion, so what we're going to see there are three or four ways of extortion.
319.23s - 325.23s |  And then there is resolution, however you resolve that issue.
329.61s - 336.61s |  That slide is going to seem like I'm pitching you on how good ransomware market is.
336.61s - 338.61s |  I'm not.
338.61s - 340.61s |  I fucking hate them.
340.61s - 342.61s |  They fucking hate me.
342.61s - 345.61s |  But I want to say some good stuff about them.
345.61s - 348.61s |  It's the fastest growing type of cybercrime.
348.61s - 354.61s |  Their payout broke the limit of 1 billion last year.
354.61s - 356.61s |  They hit 1.1 billion.
356.61s - 359.61s |  It's a highly professional industry.
359.61s - 363.61s |  It seems that the boundaries here are falling off.
363.61s - 370.61s |  So they're after hospitals, critical national infrastructure, and pretty much everything else.
370.61s - 375.61s |  And WannaCry opened the kind of forms that we cannot close.
375.61s - 379.61s |  Again, this slide too, I fucking hate them.
379.61s - 381.61s |  The gangs are highly hierarchical.
381.61s - 385.61s |  We expect that it's a criminal rig.
385.61s - 387.61s |  They have a clear structure.
387.61s - 390.61s |  The first part is obviously the tech part that we're going to see later on.
390.61s - 396.61s |  But they also have ransomware negotiators and customer support, as pretty much any company has.
396.61s - 402.61s |  Money launderers and payment processing, because as we saw, they're processing 1.1 billion per year.
402.61s - 410.86s |  And collaboration and partnerships, because why not partner with a ransomware, right?
410.86s - 412.86s |  The tech part.
412.86s - 416.86s |  They have several specific and special users.
416.86s - 418.86s |  One is the malware developers.
418.86s - 420.86s |  I'm not going to explain what it is.
420.86s - 425.86s |  Exploitation developers who are possibly developing either zero day or end day.
425.86s - 428.86s |  They have special people for data theft and leaks.
428.86s - 430.86s |  They have people for operational security.
430.86s - 434.86s |  And last but not least, and usually we don't know about that,
434.86s - 437.86s |  they have really good people on infrastructure and hosting.
437.86s - 442.86s |  And that makes sense, because imagine owning a unicorn company,
442.86s - 447.86s |  extracting half a terabyte of data and not being able to process it
447.86s - 451.86s |  because your infrastructure or hosting was bad enough.
451.86s - 456.52s |  Let's move to the ransomware models.
456.52s - 458.52s |  First of all, there were lone wolves.
458.52s - 461.52s |  At some point, right now, they're no longer it.
461.52s - 465.52s |  Those were single people who were doing everything.
465.52s - 469.52s |  Initial access brokers are a special way of ransomware groups.
469.52s - 474.52s |  There are people who specialize in just that, initial access,
474.52s - 477.52s |  getting it and then selling it to other ransomware groups.
477.52s - 481.52s |  Only one ransomware groups, which is from start to finish,
481.52s - 484.52s |  everything done by them.
484.52s - 490.52s |  And ransomware as a service, which you could consider it as software as a service
490.52s - 496.52s |  or as I like to say, ransomware meets capitalism.
496.52s - 501.12s |  How ransomware as a service are being paid?
501.12s - 505.12s |  Flat monthly fee, affiliate programs with a monthly percent of the profits,
505.12s - 507.12s |  one-time license.
507.12s - 512.12s |  This is not as a service, just saying, but they do advertise that.
512.12s - 517.12s |  Pure profit sharing, payments made to the RAS,
517.12s - 524.12s |  and then they give their affiliate, not me, a part of the profits.
524.12s - 529.12s |  And the most well-known were Lockbit, Blackcat, Clop, and some more.
529.12s - 536.12s |  This is my only try of being a graphic designer.
536.12s - 538.12s |  You see I'm not good.
538.12s - 541.12s |  So we are going after the C2 server.
541.12s - 543.12s |  As we can see, there's the user, there's the cloud,
543.12s - 549.12s |  and there is the hacker slash ransomware on the top with the red.
549.12s - 553.12s |  Can anyone guess why he's the hacker?
553.12s - 555.12s |  No one?
555.12s - 557.12s |  He's wearing a hoodie, guys.
557.12s - 559.12s |  If you wear a hoodie, you're a hacker.
559.12s - 560.12s |  You should know that.
560.12s - 564.40s |  You're DEF CON for fuck's sake.
564.40s - 565.40s |  The extortion, how they do.
565.40s - 569.40s |  They establish communications with victim with multiple ways,
569.40s - 574.40s |  talks, telegram, email, or some internal web panels.
574.40s - 575.40s |  Keep that in mind.
575.40s - 577.40s |  You're going to see one.
577.40s - 582.40s |  They lay their terms and then they extort victims in multiple ways.
582.40s - 585.40s |  There are four ways of extorting people.
585.40s - 587.40s |  The first is ransomware data.
587.40s - 589.40s |  So they have encrypted their data.
589.40s - 595.40s |  So they're wanting the money to decrypt data.
595.40s - 599.40s |  This was easily fell over
599.40s - 606.40s |  because now pretty much everyone has a proper backup system, I hope.
606.40s - 609.40s |  Then the second part where the second level of extortion
609.40s - 611.40s |  was releasing data to the public.
611.40s - 613.40s |  So extorting the people that we have your data,
613.40s - 615.40s |  we're going to release it on the public.
615.40s - 619.40s |  The third was DDoS with knowledge obtained from data.
619.40s - 625.40s |  And fourth was communicate with people that were the victim's customers
625.40s - 627.40s |  or even the LEA.
627.40s - 634.40s |  We have seen in 2024 a lot of groups going to the LEIA
634.40s - 638.40s |  and saying that this company was hacked and they did not report it.
640.74s - 643.74s |  So let's set some goals.
643.74s - 648.74s |  First, we want to identify all the C2s and data leak sites.
648.74s - 652.74s |  Try to find any vulnerabilities, and I mean any vulnerabilities.
652.74s - 654.74s |  Identify any people behind them.
654.74s - 658.74s |  Try to disrupt panels and threat actors.
658.74s - 661.74s |  And the three last ones are really, really important.
661.74s - 666.74s |  Do not disrupt with any active LEA investigation.
666.74s - 670.74s |  Don't be a malakas, and don't get vanned.
670.74s - 675.74s |  So those two, the last are my motto for the past couple of years.
675.74s - 676.74s |  I have them as stickers.
676.74s - 678.74s |  If you want them, come ask for them.
678.74s - 684.74s |  So the past couple of years, I have been joking around
684.74s - 687.74s |  that I will be vanned, which was mostly a joke
687.74s - 692.74s |  and a tongue in the cheek thing.
692.74s - 697.74s |  But right now, I'm trying to disrupt criminal rigs
697.74s - 705.74s |  that handle more or less tens of millions of dollars,
705.74s - 707.74s |  and they are criminal rigs.
707.74s - 716.74s |  So this is no longer a joke, but an actual probable risk for me.
716.74s - 724.74s |  So this last night, when someone tried to enter my room by wrong,
724.74s - 727.74s |  I literally thought that I was getting vanned.
727.74s - 730.74s |  This is not funny.
730.74s - 737.74s |  A more probable situation, though, is me waking up again with this message.
737.74s - 743.74s |  I don't know how many of you have woken up with this kind of message,
743.74s - 748.74s |  whether on your Google account or your iPhone.
748.74s - 750.74s |  But when you wake up and you see that government-backed attackers
750.74s - 757.12s |  may be trying to steal your password, you are freaked out.
757.12s - 761.12s |  So I'm going to say it here in DEF CON.
761.12s - 763.12s |  I also said it on Black Hat a couple of days ago.
763.12s - 768.12s |  If anyone wants to burn his one million zero day
768.12s - 772.12s |  to get access to my email or my phone,
772.12s - 775.12s |  I'm going to delete the photos from my kids
775.12s - 781.82s |  and give him my phone for just 100K plus VAT.
781.82s - 787.22s |  There's no reason to burn your zero day for me.
787.22s - 795.22s |  I want to state again that I had really low expectations into finding anything,
795.22s - 800.22s |  and I didn't find as much as I would want.
800.22s - 803.22s |  How did I identify pandemics?
803.22s - 809.22s |  Those really nice people that are doing CTI, I'm not a CTI expert.
809.22s - 814.22s |  I'm just a random guy who Googles and doing scrolls on Twitter.
814.22s - 820.22s |  So I use Ransomlook.io, Ransomwave, Ransomware.live,
820.22s - 823.22s |  the deep dark CTI on GitHub,
823.22s - 826.22s |  and lots and I mean lots of doing scrolling
826.22s - 831.82s |  and monitoring CTI companies for new posts.
832.82s - 837.82s |  Research had certain limitations that I knew from the beginning.
837.82s - 840.82s |  The C2s had a terribly small lifetime
840.82s - 847.82s |  because they were live only during the actual phase of being of the ponies.
847.82s - 850.82s |  And they're also really difficult to find
850.82s - 853.82s |  because all the CTIs companies will keep them for themselves,
853.82s - 858.82s |  obviously, and not going to post an active threat.
858.82s - 863.82s |  The data link sites are very, very well looked after,
863.82s - 866.82s |  and they're also behind Tor and Onion.
866.82s - 872.82s |  So it gives an extra obstacle that I would have to bypass
872.82s - 874.82s |  in order to get to them and test them.
874.82s - 880.49s |  My methodology is quite straightforward.
880.49s - 884.49s |  I'm going to ignore malware distribution and reversing.
884.49s - 888.49s |  First, because I'm a singleton and I don't understand reversing.
888.49s - 892.49s |  This is mostly because I'm, as I said, a singleton,
892.49s - 897.49s |  and two, because I hate assembly due to my college years
897.49s - 902.49s |  and a certain person who tried to teach me.
902.49s - 905.49s |  I would just run the malware in a sandbox,
905.49s - 907.49s |  extract all the URLs,
907.49s - 911.49s |  and use data link URLs found via CTI or other means.
911.49s - 919.86s |  And then I will introduce you to a newer Toyota Corolla.
919.86s - 922.86s |  The Toyota Corolla of security testing,
922.86s - 926.86s |  also known as web application penetration testing,
926.86s - 929.86s |  will get you from place A to place B.
929.86s - 932.86s |  It's not sexy. It's not nice.
932.86s - 934.86s |  But by getting you from A to B,
934.86s - 939.86s |  it will probably also give you some info about ransomware groups
939.86s - 941.86s |  and potentially a couple of RCs.
941.86s - 945.50s |  Methodology.
945.50s - 946.50s |  Boring stuff, but I have to say,
946.50s - 951.50s |  because those tools literally made the whole research.
951.50s - 953.50s |  Dirsearch for the win.
953.50s - 954.50s |  FFUF.
954.50s - 955.50s |  Burpsuit.
955.50s - 958.50s |  The trifecta of Tor, which is Tor Expert Bundle,
958.50s - 960.50s |  Tor Browser, and Tor Socks,
960.50s - 963.50s |  which greatly helps to run any other tool.
963.50s - 964.50s |  Coffee.
964.50s - 966.50s |  And I mean a lot of coffee.
966.50s - 968.50s |  Anyrun for running all the malwares.
968.50s - 970.50s |  Several droplets on DigitalOcean,
970.50s - 972.50s |  because, as I said, they had a lot of operation security,
972.50s - 975.50s |  so I was getting banned en masse.
975.50s - 977.50s |  So done ION Census,
977.50s - 983.50s |  so that you could potentially find websites outside of Tor.
983.50s - 985.50s |  And did I mention coffee?
985.50s - 987.50s |  I mean lots of coffee.
987.50s - 992.67s |  How I'm going to approach the whole thing.
992.67s - 994.67s |  Black box web application testing.
994.67s - 998.67s |  Use any acquired information for furthering my attacks.
998.67s - 1001.67s |  Interact with data leaks and chat websites.
1001.67s - 1003.67s |  Intentionally infect sandbox
1003.67s - 1005.67s |  so that I could get a ticket.
1005.67s - 1006.67s |  And by ticket I mean,
1006.67s - 1010.67s |  you're going to see later that all the chats wanted a ticket
1010.67s - 1014.67s |  so that they can identify what company you were in.
1014.67s - 1019.34s |  My first step was, as I did with malware,
1019.34s - 1022.34s |  just blatantly run Dirsearch and FFUF
1022.34s - 1025.34s |  with a custom word list through Tor Socks.
1025.34s - 1027.34s |  My results were disappointing.
1027.34s - 1031.34s |  There were only 15 URLs that gave something interesting,
1031.34s - 1034.34s |  which is not exactly interesting.
1034.34s - 1038.34s |  Then I moved to manually check all of them.
1038.34s - 1041.34s |  Five of them were WordPress.
1041.34s - 1044.34s |  A couple of them were leaking IP addresses,
1044.34s - 1046.34s |  and some of them were cheeky.
1046.34s - 1049.34s |  And when I say cheeky, I mean really cheeky.
1049.34s - 1053.34s |  So one of them told me to fuck off.
1053.34s - 1057.34s |  The other one told me to use the N word.
1057.34s - 1060.34s |  I'm not going to use it because I respect people.
1060.34s - 1064.34s |  And the cheeky was Abish who said,
1064.34s - 1067.34s |  just business, nothing personal.
1067.34s - 1070.34s |  Keep that.
1070.34s - 1072.34s |  So let's go.
1072.34s - 1076.34s |  Much like Alice in Wonderland,
1076.34s - 1081.34s |  let's take the little dumb bunny by hand
1081.34s - 1088.42s |  and let's move inside ransomware land, shall we?
1088.42s - 1089.42s |  First one is mallocs.
1089.42s - 1091.42s |  I don't know who is familiar with that.
1091.42s - 1094.42s |  They're also known as Target Company, Fargo,
1094.42s - 1097.42s |  and Tonsomething.
1097.42s - 1098.42s |  I cannot pronounce it.
1098.42s - 1101.42s |  First appearance was of June 2021.
1101.42s - 1104.42s |  They target mostly Windows machines
1104.42s - 1107.42s |  and specifically MSSQL servers,
1107.42s - 1109.42s |  the brute force SA accounts.
1109.42s - 1112.42s |  Last year, they started using also some NDAs,
1112.42s - 1117.42s |  and they are in the hundreds of victims.
1118.42s - 1122.42s |  This is their index page of their data leaks.
1122.42s - 1125.42s |  As you can see, they have a lot of victims.
1125.42s - 1130.42s |  And the slash malloc slash private sign-in,
1130.42s - 1135.42s |  they requested a private key so that I could chat with them.
1135.42s - 1139.42s |  So I had to, as I said, infect something.
1139.42s - 1141.42s |  I infected anyone.
1141.42s - 1143.42s |  I got a key.
1145.76s - 1146.76s |  Is it clear?
1146.76s - 1148.76s |  I said, hello.
1148.76s - 1149.76s |  Guy didn't respond.
1149.76s - 1153.76s |  So I said again, hello.
1153.76s - 1154.76s |  Nothing back.
1154.76s - 1156.76s |  Sorry.
1156.76s - 1160.76s |  I then decided to run Deer Search and FFUF.
1160.76s - 1164.76s |  There was an Apache server status page exposed,
1164.76s - 1168.76s |  which was leaking URLs, server IP addresses,
1168.76s - 1171.76s |  and it was also leaking tokens to check other people's messages.
1171.76s - 1173.76s |  But that was not fun enough.
1173.76s - 1178.84s |  So can you see the whole thing?
1178.84s - 1183.84s |  There is a button underneath my hello that says reply.
1183.84s - 1185.84s |  This is the post message.
1185.84s - 1187.84s |  It's practically a quote.
1187.84s - 1191.84s |  Can anyone guess what the issue is in here?
1191.84s - 1194.44s |  No?
1194.44s - 1196.75s |  Okay.
1196.75s - 1200.75s |  So there was an IDOR on reply ID parameter,
1200.75s - 1205.75s |  which means I could quote pretty much any message in the world.
1206.75s - 1207.75s |  In the server.
1207.75s - 1209.75s |  The parameter was an incremental integer,
1209.75s - 1212.75s |  so all I had to do was to take that post,
1212.75s - 1215.75s |  write the Python script really badly,
1215.75s - 1221.75s |  and do a for loop from one to, I don't know, 50 million,
1221.75s - 1223.75s |  and export all the messages.
1223.75s - 1234.16s |  That was also used for in-organization messages.
1234.16s - 1236.16s |  So first there is the boss.
1236.16s - 1239.16s |  Clearly a God complex.
1239.16s - 1241.16s |  I work according to my own schedule,
1241.16s - 1243.16s |  which does not change on anyone's request.
1243.16s - 1247.16s |  As soon as I see the payment, I will send the decryptor.
1247.16s - 1250.16s |  I have a well-maintained business, blah, blah.
1250.16s - 1255.16s |  It will not be disturbed by any moron that could not secure their machines.
1255.16s - 1258.16s |  Oh, the irony, right?
1258.16s - 1262.16s |  And last one, I was on special key for a couple of days,
1262.16s - 1266.16s |  so fuck off and do the work that I'm paying you to do.
1266.16s - 1268.16s |  I don't know exactly what special key is,
1268.16s - 1271.16s |  but I think it's a drag.
1271.16s - 1276.47s |  So employees, boss, the budget for this client is only 15K.
1276.47s - 1278.47s |  Do you agree?
1278.47s - 1280.47s |  They don't need much data.
1280.47s - 1282.47s |  And Jessica, probably to another employee,
1282.47s - 1284.47s |  boss is not on a good mood today.
1284.47s - 1285.47s |  Let's be careful.
1285.47s - 1287.47s |  Yeah, be careful.
1287.47s - 1290.78s |  Good for you, Jessica.
1290.78s - 1292.78s |  And last but really not least,
1292.78s - 1295.78s |  the boss was sending the decryptors to the guys.
1295.78s - 1297.78s |  Here's the decryptor for company A.
1297.78s - 1299.78s |  Here's the decryptor for company B.
1299.78s - 1303.78s |  I got those decryptors because I wanted them too.
1303.78s - 1308.19s |  This is the actual organization.
1308.19s - 1311.19s |  I said I wouldn't have another graphic,
1311.19s - 1313.19s |  but I needed to do another graphic.
1313.19s - 1315.19s |  You should forgive me for that.
1315.19s - 1319.19s |  So boss on the top, Panda, Jessica, Malox, and Ismail on the bottom.
1319.19s - 1322.19s |  And then after a day or so,
1322.19s - 1327.19s |  unfortunately, my chat was disabled and my ID was fixed.
1327.19s - 1329.19s |  Message was not delivered.
1329.19s - 1333.19s |  Unfortunately, I couldn't quote it anymore.
1333.19s - 1334.19s |  What did I get?
1334.19s - 1336.19s |  I got internal knowledge of the team.
1336.19s - 1338.19s |  I got pretty much all of their messages.
1338.19s - 1339.19s |  I got some decryptors,
1339.19s - 1343.19s |  which I communicated to the companies that were ransomed with,
1343.19s - 1345.19s |  and they used it.
1345.19s - 1350.19s |  Once the admin got up or sober, I don't know what,
1350.19s - 1351.19s |  it was fixed.
1351.19s - 1355.19s |  So all in all, result?
1355.19s - 1357.19s |  Mediocre, I guess.
1357.19s - 1359.19s |  Sorry about that, but I was too verbose.
1359.19s - 1361.19s |  I was too blatant.
1361.19s - 1366.19s |  I just did it all at once, but I wanted to do it.
1366.19s - 1370.19s |  That's my second group.
1370.19s - 1374.19s |  I think all of you know it, Black Hat and Alpha V.
1374.19s - 1376.19s |  They're also known as Noberus.
1376.19s - 1378.19s |  Their first appearance was in 2021.
1378.19s - 1381.19s |  They operated as a ransomware as a service.
1381.19s - 1384.19s |  They have a Rust-based malware and server-side C2,
1384.19s - 1387.19s |  and they use the triple extortion scheme.
1387.19s - 1391.86s |  The Rust loader that we're going to go after
1391.86s - 1394.86s |  was researched by Lapuseanu,
1394.86s - 1398.86s |  sorry if I butchered your name, Andrei,
1398.86s - 1400.86s |  by Bitdefender Labs.
1400.86s - 1402.86s |  It was targeting only Mac.
1402.86s - 1404.86s |  It was developed in Rust.
1404.86s - 1408.86s |  I think all of the Black Hat malware was developed in Rust,
1408.86s - 1413.86s |  and their C2 was used on all of Black Hat malware.
1413.86s - 1418.86s |  Andrei Lapuseanu, that's the actual research
1418.86s - 1420.86s |  that I saw while Doomscrolling,
1420.86s - 1426.86s |  and there were one, two, three, four CNC servers in there.
1426.86s - 1429.86s |  I checked all the C2 URLs.
1429.86s - 1433.86s |  One of them was online, but it was just returning 404.
1433.86s - 1436.86s |  So me being me, I have decided to put it
1436.86s - 1441.86s |  in the loop of continuous scanning that I have in my rig.
1441.86s - 1446.86s |  And two days later, it downloaded some documentation.
1446.86s - 1449.86s |  The first documentation was for clients,
1449.86s - 1454.86s |  so I could see all the malware-infected clients.
1454.86s - 1457.86s |  And the second one was tasks,
1457.86s - 1461.86s |  so I could see all the tasks that were ever run
1461.86s - 1464.86s |  on the server, on the machines.
1464.86s - 1467.86s |  Unfortunately, both of those endpoints
1467.86s - 1470.86s |  were offline at that point.
1470.86s - 1475.86s |  So what I had to do is read the documentation,
1475.86s - 1478.86s |  try to guess, not exactly guess,
1478.86s - 1480.86s |  try to understand the documentation,
1480.86s - 1483.86s |  create a Python script, automate the check,
1483.86s - 1487.86s |  and put that in the loop again, and wait.
1487.86s - 1492.86s |  And by wait, I mean really wait.
1492.86s - 1496.86s |  I think seven or eight days after,
1496.86s - 1499.86s |  I got a push notification on my phone.
1499.86s - 1501.86s |  Yay, you got something.
1501.86s - 1504.86s |  So I extracted 197 commands in two minutes
1504.86s - 1506.86s |  on a four-hour window.
1506.86s - 1508.86s |  What does that say to us?
1508.86s - 1512.86s |  It means that Black Cat was putting the C2 server
1512.86s - 1515.86s |  only when using it and exploiting it,
1515.86s - 1518.86s |  and when they're not using it to do any movement,
1518.86s - 1520.86s |  any lateral movement or anything else,
1520.86s - 1522.86s |  they were putting it off.
1522.86s - 1528.86s |  And you can see that in here, it uploads a file.
1528.86s - 1530.86s |  And this is the scary command.
1530.86s - 1535.86s |  When you see the XXX in here was a company's name,
1535.86s - 1538.86s |  so when you see zipping someone's AWS
1538.86s - 1543.86s |  and GCP environments on an env.zip
1543.86s - 1546.86s |  and then being uploaded to another server,
1547.86s - 1549.86s |  it means that someone is getting exploited
1549.86s - 1552.86s |  as we speak right now.
1552.86s - 1557.86s |  So I had to switch to incident response mode.
1557.86s - 1561.86s |  I hate incident response.
1561.86s - 1563.86s |  I identified four companies.
1563.86s - 1566.86s |  All of them were cryptocurrency-related.
1566.86s - 1569.86s |  Crypto is cryptography.
1569.86s - 1571.86s |  Fuck cryptocurrency.
1571.86s - 1573.86s |  Two of them were unicorns,
1573.86s - 1578.86s |  which means their valuation was over a billion.
1578.86s - 1580.86s |  All four of them were notified,
1580.86s - 1582.86s |  and they acknowledged the issue.
1582.86s - 1585.86s |  None of them were ransomed.
1585.86s - 1586.86s |  What did I do?
1586.86s - 1589.86s |  I got all the info and understood the lateral movement
1589.86s - 1591.86s |  that Black Cat was doing at that point.
1591.86s - 1593.86s |  I stopped the whole campaign.
1593.86s - 1595.86s |  Four companies were not ransomed,
1595.86s - 1609.38s |  and Black Cat got a really big financial hit.
1609.38s - 1612.38s |  And after a month, under increasing federal scrutiny,
1612.38s - 1616.38s |  Black Cat ransomware gang pulls XXX on its way out.
1616.38s - 1619.38s |  I'm not going to say that this was all me,
1619.38s - 1622.38s |  but I'm going to say that my exploitation
1622.38s - 1624.38s |  and stopping that campaign
1624.38s - 1628.38s |  probably helped them to do that XXX,
1628.38s - 1630.38s |  the decision to do that XXX.
1630.38s - 1637.30s |  So all in all, I would say not bad, right?
1637.30s - 1640.30s |  Third one, Everest.
1640.30s - 1643.30s |  Oh, my lovely Everest.
1643.30s - 1646.30s |  Active since late 2020.
1646.30s - 1648.30s |  They targeted high-profile targets
1648.30s - 1651.30s |  for the first three years.
1651.30s - 1656.30s |  In the last year, they moved to also lower-profile targets.
1656.30s - 1659.30s |  They pivoted to initial access broker.
1659.30s - 1662.30s |  They pivoted to just data leak.
1662.30s - 1665.30s |  Fuck, they pivot around like they're startups.
1665.30s - 1668.30s |  They grade it as highly sophisticated
1668.30s - 1670.30s |  by multiple researchers,
1670.30s - 1673.30s |  and they're also well-known for being paid
1673.30s - 1678.30s |  and not getting and then releasing the data,
1678.30s - 1681.30s |  so they're mentally unstable.
1681.30s - 1682.30s |  Right?
1682.30s - 1686.30s |  Why don't you go after a mentally unstable millionaire?
1686.30s - 1691.19s |  This is their data leak page.
1691.19s - 1694.19s |  Does it look like something you know?
1694.19s - 1696.19s |  No one?
1696.19s - 1704.22s |  It's fucking WordPress.
1704.22s - 1709.62s |  Version 5.5.3.
1709.62s - 1712.62s |  This version was done in 2020.
1712.62s - 1714.62s |  That's four years ago.
1714.62s - 1717.62s |  There on the left, there is the login page,
1717.62s - 1719.62s |  and on the right, there is also the readme.txt
1719.62s - 1723.62s |  in case you didn't know how to install WordPress.
1723.62s - 1729.97s |  Then I ran WPScan via Torsox
1729.97s - 1732.97s |  because why not, right?
1732.97s - 1736.97s |  It said it's really insecure, 42 vulnerabilities identified.
1736.97s - 1740.97s |  Unfortunately, none of them was really exploitable
1740.97s - 1742.97s |  by silly me.
1742.97s - 1746.97s |  The only thing that I could see in here
1746.97s - 1752.97s |  was that error on RSS functions.
1752.97s - 1753.97s |  As you can see in here,
1753.97s - 1757.97s |  we can see that the PHP error reporting was on.
1757.97s - 1759.97s |  It was a Windows machine,
1759.97s - 1763.97s |  and we were running Vertigo server hosting,
1763.97s - 1767.97s |  which is end of life for the past two years.
1767.97s - 1770.97s |  They also had OpenDIR,
1770.97s - 1772.97s |  so you could see pretty much everything.
1772.97s - 1776.97s |  They had a couple of zip files, but nothing interesting.
1776.97s - 1780.97s |  They also had PHPMyAdmin.
1780.97s - 1782.97s |  Why not, right?
1782.97s - 1787.97s |  And I did what every super hacker does in the world.
1787.97s - 1795.97s |  I googled Vertigo default MySQL password.
1795.97s - 1803.70s |  Yeah, I got that, but unfortunately, it didn't work.
1803.70s - 1809.70s |  And that was my talk up until 15th of July.
1809.70s - 1815.70s |  Then my nine-year-old son, okay, let me stop.
1815.70s - 1816.70s |  In Greece, I have two sons.
1816.70s - 1817.70s |  The one is nine-year-old.
1817.70s - 1821.70s |  The other just became 13,
1821.70s - 1824.70s |  so can we all say happy birthday to Antonis?
1824.70s - 1830.04s |  Because thanks for that.
1830.04s - 1831.04s |  Happy birthday, Antonis.
1831.04s - 1835.04s |  I should be there in Greece, but I'm here, so you know me.
1835.04s - 1840.04s |  So my nine-year-old was sitting at my computer
1840.04s - 1844.04s |  reading my 2000 open tabs.
1845.04s - 1847.04s |  At some point, he says,
1847.04s - 1852.04s |  that's a really strange name to call your server.
1852.04s - 1855.04s |  Why the fuck would you call it Vertigo?
1855.04s - 1858.04s |  I'm like, no, it's not Vertigo, it's Vertigo.
1858.04s - 1860.04s |  He says, no, I know how to read.
1860.04s - 1863.04s |  It has two R's, it's Vertigo.
1863.04s - 1869.67s |  I'm like, what, motherfucker?
1869.67s - 1871.67s |  He then said that he's not the thing, I'm the thing,
1871.67s - 1873.67s |  but it is what it is.
1873.67s - 1875.67s |  Do you all know what that means?
1875.67s - 1879.67s |  I have to reuse my favorite meme.
1879.67s - 1882.67s |  I use Vertigo, and what that means is,
1882.67s - 1889.25s |  I'm the fucking admin.
1889.25s - 1894.01s |  WordPress administration,
1894.01s - 1898.01s |  I did develop a WordPress plugin.
1898.01s - 1901.01s |  No, I didn't develop a WordPress plugin, sorry.
1901.01s - 1904.01s |  I took a PHP cell, Pony cell,
1904.01s - 1908.01s |  zipped it, named it cell.plugin,
1908.01s - 1915.62s |  uploaded there,
1915.62s - 1918.62s |  and I think I might have prematurely
1918.62s - 1921.62s |  used the I'm the admin meme,
1921.62s - 1923.62s |  because right now,
1923.62s - 1933.86s |  I'm the fucking admin in the whole situation.
1933.86s - 1938.86s |  Then, after doing things that
1938.86s - 1940.86s |  most of the red teamers in here,
1940.86s - 1942.86s |  I see a really good red teamer in here,
1942.86s - 1945.86s |  would decapitate me of doing,
1945.86s - 1949.86s |  but again, I'm a simpleton, sorry about that.
1949.86s - 1952.86s |  I somehow run Mimikatz,
1952.86s - 1955.86s |  got the whole, I don't know, token and shit,
1955.86s - 1960.13s |  and all that, which means,
1960.13s - 1962.13s |  they're Russians.
1962.13s - 1965.13s |  Who the fuck would expect them to be Russians?
1965.13s - 1969.13s |  It's a Windows 2012 server,
1969.13s - 1972.13s |  and they have done a lot of crimes,
1972.13s - 1978.08s |  but can anyone guess what's their biggest crime?
1978.08s - 1981.08s |  They haven't paid for WinRAR.
1981.08s - 1987.66s |  For fuck's sake, if you make,
1987.66s - 1989.66s |  I don't know, 20 million per year,
1989.66s - 1991.66s |  pay the fucking WinRAR.
1991.66s - 1996.20s |  So, database export,
1996.20s - 1998.20s |  username extract,
1998.20s - 2000.20s |  remote command execution on the server,
2000.20s - 2003.20s |  got hold of their own secret keys,
2003.20s - 2006.20s |  lots, and I mean lots of locks to analyze.
2006.20s - 2009.20s |  I was hoping that it would be down
2009.20s - 2011.20s |  by someone by now,
2011.20s - 2012.20s |  but it's still there,
2012.20s - 2015.20s |  so if anyone wants to play, go play.
2015.20s - 2025.01s |  Result?
2025.01s - 2028.01s |  Again, this was supposedly my talk
2028.01s - 2030.01s |  up until this Saturday,
2030.01s - 2032.01s |  but this Saturday,
2032.01s - 2035.80s |  Black Angels,
2035.80s - 2037.80s |  it emerged in May 2022,
2037.80s - 2039.80s |  high profile targets,
2039.80s - 2040.80s |  Babook based,
2040.80s - 2042.80s |  that means that they just
2042.80s - 2044.80s |  stole the whole league of Babook,
2044.80s - 2045.80s |  and they're using it,
2045.80s - 2048.80s |  they're focused on Linux and ESXi,
2048.80s - 2052.80s |  and they received a record 75 million ransom,
2052.80s - 2054.80s |  as we all saw last week.
2054.80s - 2056.80s |  And then,
2056.80s - 2058.80s |  Rakesh Krishnan,
2058.80s - 2060.80s |  I hope I said it correctly,
2060.80s - 2062.80s |  found their clear text,
2062.80s - 2065.80s |  their open web IP,
2065.80s - 2068.80s |  which means I had to take a look.
2068.80s - 2069.80s |  This was on Saturday morning,
2069.80s - 2072.80s |  and I was flying away Saturday evening,
2072.80s - 2074.80s |  so I had six hours.
2074.80s - 2079.85s |  You can go there right now.
2079.85s - 2080.85s |  I should make it a demo,
2080.85s - 2082.85s |  but I don't like demos.
2082.85s - 2084.85s |  They have a different HTTPS
2084.85s - 2086.85s |  and HTTP configuration.
2086.85s - 2089.85s |  The HTTPS is on the slash public
2089.85s - 2092.85s |  of their symphony.
2092.85s - 2095.85s |  The HTTP port 80
2095.85s - 2098.85s |  is on the root of symphony,
2098.85s - 2100.85s |  which means if you go to .env,
2100.85s - 2102.85s |  you are going to see .env,
2102.85s - 2104.85s |  and you are going to see AppSecret
2104.85s - 2108.85s |  and the MySQL password.
2108.85s - 2113.85s |  You do what you want with that information.
2113.85s - 2115.85s |  What did I found?
2115.85s - 2116.85s |  .env file exposure,
2116.85s - 2118.85s |  internal URLs exposure,
2118.85s - 2120.85s |  some error logs exposed.
2120.85s - 2123.85s |  I'm not going to say what those error logs were.
2123.85s - 2125.85s |  You can look at it.
2125.85s - 2127.85s |  One message mentioning
2127.85s - 2131.85s |  5.5 million payment exposed.
2131.85s - 2133.85s |  This was nowhere to be found,
2133.85s - 2135.85s |  so I guess they were paid
2135.85s - 2137.85s |  and killed the whole thing.
2137.85s - 2140.85s |  All in all, that was fast.
2140.85s - 2142.85s |  I could do some stuff with AppSecret,
2142.85s - 2144.85s |  but unfortunately I had to fly here,
2144.85s - 2150.12s |  so you should excuse me for that.
2150.12s - 2154.12s |  We are getting to the end.
2154.12s - 2159.12s |  My favorite part of ethical dilemmas.
2159.12s - 2161.12s |  Are we the baddies?
2161.12s - 2164.12s |  What the fuck we are doing with our lives?
2164.12s - 2168.72s |  I never wanted to become a vigilante.
2168.72s - 2170.72s |  I'm not seeing myself as a vigilante
2170.72s - 2173.72s |  or someone who wanted to do bad things.
2173.72s - 2176.72s |  I always wanted to be considered,
2176.72s - 2178.72s |  as we Greeks say,
2178.72s - 2180.72s |  the Socratic fly or the god fly.
2180.72s - 2182.72s |  I wanted to be the one that
2182.72s - 2185.72s |  reinvents the status quo
2185.72s - 2189.72s |  and tries to make the bad people,
2189.72s - 2190.72s |  the ransomware gangs,
2190.72s - 2194.72s |  give them a taste of their own medicine.
2194.72s - 2197.72s |  And I also want to say to CTI companies
2197.72s - 2201.72s |  that they would really need to be more
2201.72s - 2204.72s |  open into sharing information.
2204.72s - 2209.72s |  If I only had C2's information more quicker,
2209.72s - 2214.72s |  I would have a really bigger talk right now.
2214.72s - 2217.72s |  Except the two CTI companies
2217.72s - 2219.72s |  that have already used my research
2219.72s - 2221.72s |  without mentioning me.
2221.72s - 2228.08s |  Those can go fuck off, I don't care.
2228.08s - 2230.08s |  Conclusions.
2230.08s - 2234.08s |  Some of us fail and fail miserably.
2234.08s - 2237.08s |  Some of you really succeed
2237.08s - 2240.08s |  and succeed gloriously.
2240.08s - 2243.08s |  And I'm really happy with everyone that succeeds.
2243.08s - 2246.08s |  I know that for the past two years
2246.08s - 2248.08s |  I have been looking,
2248.08s - 2250.08s |  I really love VX Underground
2250.08s - 2254.08s |  and their five horsemen paradigm.
2254.08s - 2256.08s |  So for the past two years,
2256.08s - 2259.08s |  from London 2022 with Spower,
2259.08s - 2261.08s |  Defcon last year with Stealer and Botnet,
2261.08s - 2264.08s |  and this year's Defcon and Blackhat with Ransomware,
2264.08s - 2268.08s |  I have been fighting all those five horsemen.
2268.08s - 2273.08s |  And while I never had a clear win,
2273.08s - 2276.08s |  I could never say that this was not the case,
2276.08s - 2278.08s |  that I didn't look anyone,
2278.08s - 2281.08s |  all of them in the eye and smiled.
2281.08s - 2284.08s |  So, thank you.
2284.08s - 2286.08s |  And if anyone has any questions,
2286.08s - 2289.08s |  we have like five minutes to talk.
2289.08s - 2291.08s |  There's the microphone.
2291.08s - 2299.13s |  No one?
2299.13s - 2300.13s |  Nice.
2300.13s - 2302.13s |  Thank you, guys.
2302.13s - 2304.13s |  Oh, I have one.
2304.13s - 2306.13s |  Where is he?
2306.13s - 2307.13s |  Oh, nice.
2307.13s - 2311.46s |  Hi, thank you.
2311.46s - 2312.46s |  Great talk.
2312.46s - 2314.46s |  My question is,
2314.46s - 2317.46s |  which would you choose to fight?
2317.46s - 2321.46s |  Five duck-sized horses
2321.46s - 2323.46s |  or...
2323.46s - 2325.46s |  Oh, I got it wrong.
2325.46s - 2326.46s |  I got no question.
2326.46s - 2327.46s |  Thank you for the talk.
2327.46s - 2329.46s |  Thank you.
2329.46s - 2331.46s |  Anyone else?
2331.46s - 2333.46s |  Thank you, guys.