**Presentation Overview**
- **Title:** DEF CON 32 - Finding & exploiting local attacks on 1Password Mac desktop app
- **Presenters:** J. Hoffman, C. Morgan
- **Objective:** Explore local security of 1Password MacOS desktop application and potential vulnerabilities 

**Introduction to 1Password Security**
- **1Password's role:** Manages sensitive credentials and provides encryption standards
- **Research focus:** Local attacks to dump 1Password vaults on MacOS
- **Security concerns:** Vulnerabilities in application, IPC mechanisms, and open source software usage

**Local Security Model of 1Password**
- **Password handling:** Password combined with a locally stored **secret key** to generate an **account unlock key** (muck)
- **SSO integration:** Involves device key stored in **Mac keychain** to decrypt credential bundle
- **Security measures:** SIP and code signing on MacOS to create security boundaries

**Identified Vulnerabilities**
- **Electron framework:** Used by 1Password, has a defined attack surface
- **Browser extension vulnerability:** Enabled by default, can sync passwords without re-authentication
- **Native messaging host:** Deviation from typical IPC, lacks audit token for secure verification
- **Biometric authentication:** Possible to bypass fingerprint checks with Frida

**Exploitation Techniques**
- **Frida tool:** Used for dumping, instrumenting, and hooking
- **Browser extension manipulation:** Load modified extension from disk to spoof legitimate extension
- **Secure enclave involvement:** Key used to decrypt the **biometric unlock** entry in keychain
- **Code injection:** Achieved through overwritten **main.js** file in Electron apps

**Research Findings and Exploitation**
- **Old client exploitation:** Usage of old 1Password versions lacking hardened runtime
- **Session type spoofing:** Using "browser" session type to request muck when 1Password is unlocked
- **Biometric unlock investigation:** Involves keychain and secure enclave interaction

**Detection and Prevention Recommendations**
- **Alert on dangerous flags:** Monitor for flags like **dash dash load extension** in browsers
- **Monitor browser spawns:** Alert if browser is spawned by processes other than launch D
- **Session identification:** Use session identifiers for monitoring legitimate user activities

**Disclosure and Remediation**
- **Reporting timeline:** Initial findings reported in January 2024, followed by updates in March and April
- **Fixes implemented:** XPC bypass, biometric enforcement, and settings modification vulnerabilities addressed
- **Recommendations:** Update to the latest 1Password version for full protection

**Conclusion**
- **Research significance:** Highlights potential vulnerabilities in popular password managers
- **Future work:** Release of additional scripts and tools for vulnerability research and exploration