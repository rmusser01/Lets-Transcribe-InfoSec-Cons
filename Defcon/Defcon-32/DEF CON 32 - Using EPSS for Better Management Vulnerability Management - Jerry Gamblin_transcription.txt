{
  "webpage_url": "https://www.youtube.com/watch?v=02ElRMhArcQ",
  "title": "DEF CON 32 - Using EPSS for Better Management Vulnerability Management - Jerry Gamblin",
  "description": "The Exploit Prediction Scoring System (EPSS) provides efficient, data-driven vulnerability management data that uses current threat information from CVE and real-world exploit that helps understand the probability that a vulnerability will be exploited.\n\nThis talk will discuss the EPSS model in-depth and demonstrate how to implement EPSS for CI/CD pipelines and more traditional operating systems and application patching.",
  "channel_url": "https://www.youtube.com/channel/UC6Om9kAkl32dWlDSNlDS9Iw",
  "duration": 1471,
  "channel": "DEFCONConference",
  "uploader": "DEFCONConference",
  "upload_date": "20241016"
}

3.25s - 6.56s | This text was transcribed using whisper model: large-v2

 Thank you
6.56s - 8.56s |  Thank you everyone for having me here
8.72s - 15.20s |  He didn't ask but I'm interested how many people work directly or indirectly with vulnerability management in their day jobs
15.24s - 21.28s |  All right that that was the hands that I wanted to see there, right? So we'll get started here
21.28s - 27.28s |  This is super quick and we'll dig in and have some time for questions at the end about me. My name is Jay gambling
27.68s - 33.58s |  You can just call me a vulnerability enthusiast. That's kind of my unofficial title
33.58s - 38.38s |  I run two websites that you guys might like to look at one of them is CVE dot ICU
39.54s - 44.42s |  What it'll do is it'll give you how many CVS are published daily weekly help you kind of break down
44.42s - 48.98s |  So if you have to write any reports and push those reports up to your management
48.98s - 52.54s |  I built this site specifically for people to be able to go and grab
53.22s - 59.66s |  Data level graphics for for their reports. I also run a website called patch this dot app
60.58s - 65.82s |  What it does is it gives you a list of vulnerabilities on your network that you should be investigating
65.82s - 68.44s |  We'll get to both of those a little bit later in the talk
69.86s - 74.12s |  I'm a member of the EPSS the exploit prediction scoring system sig
74.22s - 80.82s |  So I sit on those board meetings and I sit in their planning meetings and I help kind of guide where the EPSS goes
82.06s - 85.66s |  I'm not special in any way and that is an open sig
85.66s - 92.82s |  So if you're interested in data science or vulnerability management, you can sign up for that sig on first org
92.90s - 94.90s |  We'd love to have more people
95.62s - 98.78s |  Especially people who are not in industry in that sig
98.78s - 103.68s |  So if you do vulnerability management in your day job, we would love to have you join the sig
103.68s - 108.58s |  We just have a new co-chair of the sig who runs vulnerability management at Peloton
108.58s - 112.62s |  So we're really trying to be more focused on on the community
113.54s - 115.70s |  I'm also on the CVE sig members
115.70s - 119.46s |  So I spent a lot of time working with the quality working group for CVE data
119.46s - 123.30s |  And if you know CVE data, you know that that's a hard group to be on
123.94s - 131.18s |  And I'm also on the automated working group which helps companies and individuals process CVE data at scale because it's so large
131.98s - 138.34s |  Feel free to contact me at either on X or email me or I have a bunch
138.34s - 143.98s |  I have 20 years worth of CVE scripts and data on my github website. That's completely free
144.82s - 149.00s |  So let's talk about the vulnerability reality here
150.80s - 156.72s |  The problem is there are a hundred and ten CVEs roughly published per day this year
158.12s - 162.96s |  Organizations do not know what to remediate first when I started doing vulnerability management
163.80s - 168.56s |  20 years ago for the government there were 18 CVEs a day
169.24s - 176.12s |  It was my job basically to read all 18 CVE descriptions and say yeah, we have this no
176.12s - 180.40s |  I've never heard of this right one person could do it and it wasn't a big deal
183.00s - 188.80s |  We were way past that now we're in the age of you need machine learning and some algorithms to help you figure out what to patch
189.76s - 191.76s |  many organizations
192.12s - 194.12s |  Use the CVSS score
194.96s - 196.36s |  to
196.36s - 201.44s |  Determine what to publish because PCI tells them they have to I will tell you right now
201.56s - 204.70s |  That is a misuse of the CVSS scoring system
204.88s - 210.54s |  Their SIG would want me to tell you do not use CVSS to determine what to patch on your network
210.72s - 215.20s |  That's not what it's built for. That's not how it's designed and that's not how you're supposed to use it
216.56s - 218.56s |  the solution is
219.28s - 221.04s |  People are moving to
221.04s - 225.68s |  Dispatching known exploitable CVEs first and that's the only way to do it
225.68s - 230.88s |  I'm lucky enough to have been part of a startup that was acquired by Cisco that built the first
232.40s - 238.52s |  Vulnerability management program that looked at what was exploitable and kind of helped companies patch that
241.08s - 245.96s |  So here are the number of CVEs published per day this year
246.44s - 250.88s |  And you guys don't have to grab pictures of the screen all the time if you don't want to I know it's handy
250.88s - 254.68s |  But I will tweet a link to this PDF deck right after it after the talk
254.68s - 257.64s |  So if you want the data, you know, you don't have to screenshot it
259.00s - 266.18s |  Yeah, we're over a hundred CVEs a day, but at least two times a week we had 250 new CVEs a day
266.18s - 268.18s |  That's normally on Tuesdays and Thursdays
268.40s - 274.20s |  So if you ever wonder why your vulnerability management people look so stressed on Tuesdays and Thursdays
274.20s - 276.58s |  It's because their workload about doubled that week
277.22s - 284.85s |  So here's the CVEs per year, we've had two pretty big events here
284.85s - 289.05s |  That's kind of changed the trajectory of CVEs and how they're published in
290.33s - 291.61s |  2016
291.61s - 298.05s |  They opened up the CNA process which allowed companies to directly publish
298.81s - 304.73s |  CVEs to the CVE list, right? So if you're Microsoft or you're just even Joe's
305.57s - 312.77s |  Software shop you could take control of what CVEs got published for your for your list that that really took us up in
313.65s - 317.21s |  2020 something else happened. Does anybody have a guess what happened in 2020?
318.73s - 324.77s |  Covid but also github github became a CNA and in that time and
325.09s - 330.69s |  Started really really pushing hard on publishing CVEs for all open source vulnerability
331.21s - 335.23s |  Source code that's on their network right on there in their repo
335.33s - 339.49s |  So they shot to the top of the CNA list really really quick
339.57s - 346.09s |  So now we have a much more CVEs and a lot of them you'll never see on your on your network, right?
346.49s - 352.73s |  Therefore some code somebody wrote one time and somebody found a CVE in it and it just sits there, right? So it's just noise
353.65s - 361.53s |  So let's talk about what EPS is. EPSS stands for exploit prediction scoring system
361.57s - 364.37s |  I just realized I didn't put this in the slide deck and I'm sorry about that
365.85s - 370.13s |  So EPSS is a data driven estimating the likelihood
370.77s - 375.65s |  That any CVE on the CVE list will be exploited in the next 30 days
375.89s - 382.41s |  So that's a sliding 30-day windows. So every night at midnight we run that we run the model
382.41s - 386.29s |  It shoots out a new score for the CVEs and publishes it
386.33s - 390.41s |  So what I really want to lean into here is if you do want to use EPSS
390.41s - 392.89s |  It's not a grab at one time and this is my list
392.93s - 400.17s |  You really have to build it into your process so that you grab it every night at it's normally done by 330 Eastern
400.41s - 405.13s |  So whatever time zone that is for you is you should grab it after 4 a.m
405.29s - 408.81s |  Eastern US time and it'll be updated for that day
410.45s - 415.53s |  EPSS is managed under first. I was lucky enough to work at Kenna security. Like I mentioned earlier
415.93s - 418.21s |  We gave them the patent for
418.93s - 424.81s |  EPSS to use and they now manage that as a nonprofit as part of our acquisition into the Cisco systems
426.65s - 429.25s |  The score is used everywhere if you use
430.09s - 433.81s |  If you use vulnerability management software over a hundred known
434.89s - 441.89s |  Vulnerability management software tools has the EPSS score built into either algorithm or they display it on their website in some way
442.17s - 445.69s |  There's a list on the website that you can see if you're using it already
448.02s - 454.86s |  So the EPSS data provides two data sets. It's a really simple data set. It has it's a three column
456.22s - 458.62s |  CSV the first column is the CVE number
458.62s - 464.94s |  the second column is the EPSS score and then the third column because people ask for it is what
465.14s - 471.06s |  Percentage of the CVEs this is right. It's just a base percentile number. I
471.74s - 472.78s |  I
472.78s - 474.78s |  Pulled these numbers today
474.86s - 480.38s |  the high scoring CVE is is a Cisco CVE from
481.06s - 483.26s |  2019 for a gigabit interface router
484.02s - 492.26s |  The mean score is only zero point zero four and the low score is zero point zero zero zero four
493.54s - 499.30s |  So that is shared by 7,000 CVS. That's the floor CV number that that's what you get
499.42s - 501.42s |  That's the score you get if you're a CV at all
503.10s - 508.22s |  So this is what the EPSS scores look like spread out over a graph, right?
508.54s - 514.86s |  We tell people all the time that you have to figure out what your comfort level is and what to do, right? So
515.62s - 516.46s |  Here's the graph
516.46s - 522.34s |  We always show people and say if you're trying to patch everything you're gonna lose if you want to use EPSS in your patching system
522.34s - 527.86s |  We tell people to start at a minimum of 0.5 and it breaks that down to here
528.30s - 530.30s |  Today there was
530.34s - 536.02s |  5,671 CVEs that the model predicts will be exploited in the next 30 days
536.54s - 540.18s |  So that's much more manageable for people to use, right?
540.18s - 543.86s |  So the data is there and the data is doing what we want the data to do
543.86s - 550.38s |  It's kind of it's kind of an odd thought to think that we want to weed out 95 98 percent of all CVEs
550.50s - 557.58s |  But that is the goal of the EPSS project is to say that here are the CVEs that we have high
558.46s - 561.46s |  Expectation to be exploited in the next 30 days in the wild
564.26s - 565.86s |  um, I
565.86s - 569.70s |  Will start this slide by saying I am NOT a data scientist. So
570.82s - 574.70s |  If you want to talk to our data scientist Jay Jacobs runs the data science program
574.70s - 578.34s |  And he'll be happy to dig into the the geek stuff with you there in the math
578.78s - 585.80s |  But when they when they built v3 and released it in 2023, we saw an 82% increase over the v2 model
586.00s - 588.80s |  So that so that was really good and we're looking again and we'll
589.20s - 596.20s |  Release a new model in the fall and the v4 and we really think that we're gonna get about another 80% increase in efficiency
596.64s - 603.88s |  Again, so it's really the model is really really starting to shape up and be hard to defeat in what it does in predicting
603.88s - 606.68s |  What CVEs are going to be exploited in the next 30 days?
608.36s - 613.60s |  So the data source is used in the in CVE in EPSS is pretty interesting
614.20s - 616.20s |  We work with a lot of companies
616.56s - 622.04s |  in the threat space and in the technology space and they give us their data for free and
622.52s - 629.80s |  We give them back the EPSS score to the community. That's that's the working agreement we have with them, but we bring in probably
631.80s - 635.44s |  2,500 variables at the end of the day to calculate these scores
635.64s - 640.56s |  There's a white paper that you can go read that talks about how to use EPSS
640.92s - 644.00s |  For vulnerability scoring and get into all the math if you need it
644.48s - 650.76s |  So let's just talk about what you guys are here for using EPSS for vulnerability management
651.28s - 653.28s |  So this is a warning
653.88s - 657.36s |  EPSS is not a one-size-fits-all
658.28s - 660.56s |  thing right we think that
661.36s - 668.16s |  When we do it, we look at what an average network is and we say and we and we build the model against an average
668.76s - 671.40s |  Corporate network if your network is different
671.60s - 677.48s |  We would suggest that you do all the testing and all the research and understand, you know, we're not testing it
677.48s - 683.00s |  We're not a hospital network. So we don't have that kind of stuff sitting around. So we're not an IOT network
683.00s - 688.64s |  We're not an OT network. So if you guys have IOT IOT OT our health care stuff on there
688.64s - 692.80s |  This might not be the model for you because it doesn't weigh heavily in there
693.08s - 700.44s |  We would love to talk to you guys about that though, especially if you're interested in building a health care specific or an OT specific
700.88s - 708.24s |  Model of EPSS so that we could lean in and say here's EPSS for OT providers. Here's EPSS for health care providers
710.20s - 711.52s |  So
711.52s - 715.48s |  the best way to use EPSS for VM is to understand that it's for
715.84s - 721.00s |  Network based attacks because of where we get the data and how CVEs are
721.60s - 724.76s |  Weighted this model is heavily for network attacks
724.76s - 729.44s |  So if you have a network that you let students connect to or that you have a big corporate network
729.48s - 735.20s |  This is the model to use because those are the those are the vulnerabilities and the exploits that we can
735.52s - 742.32s |  Detect and are probably 99% of the exploits that people see in the wild. There are very few keyboard
742.88s - 748.00s |  Hackers these days right like I have to be in front of the machine to make this exploit work
748.00s - 755.40s |  So so this model understands that and has been built back to use network based attacks as its primary course course
757.64s - 764.16s |  EPSS should only be used primarily after all known exploited vulnerabilities are off your network
765.08s - 767.00s |  Let me say that again
767.00s - 769.68s |  EPSS should only be used as a primary source of information
770.60s - 774.48s |  After you removed all exploited known vulnerabilities from your network
774.68s - 779.24s |  How many people have removed all known exploited vulnerabilities from their network
779.60s - 783.96s |  Yeah, so there there there are very few people who to have done that
783.96s - 790.44s |  I love for people to use EPSS in deciding what to patch but EPSS does not
790.92s - 793.52s |  stop and does not pivot away from
794.28s - 797.96s |  Fixing stuff on your network that you know bad guys are attacking now
798.60s - 803.72s |  In some point we get to the point where everybody has all the known exploited vulnerabilities patched
803.72s - 809.68s |  Then EPSS is a superstar, right? Because then you're just patching what you think the bad guys are doing but
810.96s - 812.96s |  99.9% of us right now have
813.12s - 818.60s |  Vulnerabilities on our network that you can go to github and find an exploit for and run it against it, right?
819.72s - 821.72s |  There's a super in-depth app
822.72s - 827.32s |  In-depth guide that we just built on EPSS at risk-based prioritization
828.12s - 829.16s |  github.io
829.16s - 832.20s |  That sits you all through this we worked with Yahoo
832.96s - 837.84s |  Microsoft and a couple other companies that gave us data on the vulnerabilities on their network
837.92s - 843.68s |  To kind of help build out a model to show you what it would look like if you deployed EPSS on there
843.92s - 847.80s |  I'm not gonna spend a lot of time digging into that today because our time is so short
847.92s - 851.20s |  But I would suggest that you go there and look at that
851.92s - 856.20s |  I've also built patch this dot app
856.80s - 861.16s |  Which isn't the primary focus of this call, but if you do not have a threat intelligence
861.68s - 869.88s |  Program today. I take what 80% of all threat intelligence platforms are built on put it in a CSV and give it to
869.88s - 871.88s |  Everybody for free every night
872.20s - 878.60s |  What it does is it goes out and checks what hackers what quote-unquote bad guys are using to exploit networks
879.00s - 880.44s |  puts and
880.44s - 884.92s |  Combines that together breaks it down and gives you a list of about six thousand C
885.44s - 889.32s |  CVEs that we know are being actively used to exploit networks
889.32s - 893.80s |  So if you need a place to start and a place to look I suggest this
893.80s - 897.28s |  I'm happy to take any pull requests or any information you guys have on this site, too
897.28s - 901.32s |  As it's it's one of my side projects that I'm really really into
901.88s - 909.96s |  So EPSS and the deployment pipelines. This is where it gets interesting, especially for second DevOps people
912.68s - 917.96s |  EPSS is built to be ran this way and a lot of tools already have it built in
918.64s - 923.38s |  If you use any of the major code repositories either get lab or github
923.60s - 926.72s |  It's both built into their into their scanning already
926.72s - 933.76s |  So when it finds a CV in your code, it will tell you that hey, here's the CVE. Here's the EPSS score
933.76s - 935.20s |  Here's a CV SS score
935.20s - 941.84s |  So I would really suggest that if you dev on one of those if that's one of the places where you keep your your dev
941.84s - 946.96s |  Tools that you you enable both EPSS on both get lab and github
948.08s - 951.72s |  There's also a github action that I love to have people use
951.72s - 954.20s |  especially if you're using Kubernetes or
954.76s - 962.20s |  Docker in your environment because what it does is it uses a open source program either trivia or something along those lines
962.20s - 969.56s |  to scan your docker container files and and your development files for known vulnerabilities it will then go in and
970.00s - 972.88s |  Run EPS against it and you can set a threshold
973.20s - 976.60s |  Like I don't like if it's above a point six in EPSS
976.80s - 983.48s |  Please do not let this push to to prod so that your teams can go back and fix that. It's super simple
983.48s - 987.28s |  I'm super proud of the team that's built that it's actually made the main github
988.28s - 996.12s |  Security advanced security toolkit, so it's built into what github tries to have use internally and tries to have their best customers use
997.28s - 1004.00s |  Here's a little screenshot of what that looks like. And with that I am done. I want to take your questions
1004.00s - 1008.24s |  I want to understand what you guys want and kind of use that so if you have any questions
1008.92s - 1013.12s |  I'm here for them. If not, I hope you guys enjoyed the app sec village this year
1013.12s - 1018.72s |  This is one of my favorite villages and I'm super glad to end the conference here their question in the back
1019.36s - 1033.77s |  So no, nothing goes to one that that that's the model, right?
1034.13s - 1037.33s |  because we have to we have to see it happen and
1038.29s - 1041.81s |  Since we don't run any IPS or IDS is ourself
1041.89s - 1047.81s |  We can only assume assume that it happens. So those bump up into the high 90s really quick
1048.33s - 1052.97s |  97 98 99 but there's no such thing as as a 1.0 in
1054.21s - 1061.69s |  EPSs today because we don't have first-hand knowledge and we're always looking at data from other IDS
1061.69s - 1068.89s |  IPS vendors and since we can't see at the end if that was actually a successful attack it kind of gets fuzzy
1072.78s - 1074.16s |  Yes. Yeah
1074.16s - 1074.66s |  Yes
1074.66s - 1075.02s |  Yes
1075.02s - 1082.50s |  We did and we actually released a study if you go to Scientia calm the company that that builds and maintains the model
1082.54s - 1086.22s |  They just released the EPSs study that that puts it against that
1086.22s - 1091.30s |  So it's on LinkedIn or Twitter if you can find it. If not, I'm happy to share it with you
1098.77s - 1100.53s |  Yes
1100.53s - 1103.33s |  CWEs give me a headache to be completely honest there
1103.33s - 1109.13s |  They're so it's so hard to get CVEs to line up with CWEs correctly
1110.01s - 1112.01s |  Because the CWE pool is so wide
1112.73s - 1118.97s |  We work closely with the CWE program. I've talked to them about that. We'd love to get CWE data in there
1120.25s - 1125.49s |  But it's it's so complicated. It's gonna take much more conflict much more
1126.81s - 1134.41s |  Stronger and well-built models to be able to build that data out correctly because one cross-site scripting is not like another cross-site scripting
1134.41s - 1141.51s |  So like knowing severity across CWEs is where it gets really really difficult, especially if you just don't want it to be static
1142.05s - 1157.15s |  So we have talked with the CVSS SIG quite a bit and the problem with see the CVSS SIG
1157.31s - 1159.79s |  Environmental factors is that they're always turned on
1160.01s - 1164.97s |  You can only lower a CVSS score by saying that we don't know that this is exploited
1164.97s - 1169.49s |  We don't if the CVSS model was built the other way or when you flip the flag
1169.49s - 1170.93s |  It made the score go up
1170.93s - 1172.33s |  We would love to do that
1172.33s - 1176.17s |  But now all you can do on CVSS is flip a flag and make the score go down
1176.17s - 1180.65s |  So it it's kind of hard to marry that to probability model
1185.84s - 1187.84s |  Yes
1188.52s - 1194.96s |  No, we're just looking for people who would be interested in kind of talking about that and joining the SIG and to help us kind
1194.96s - 1196.52s |  of understand a
1196.52s - 1198.28s |  Where can we get the data on?
1198.28s - 1206.00s |  Who's attacking OT what those look like like what the IDS IPS rules look like and kind of build a mirror model of the regular
1206.24s - 1210.44s |  EPSS score so if you know anybody who has that data or whatever, that would be great
1210.44s - 1215.16s |  We'd love to have you if you just go to first org slash EPSS. There's a sign up for the SIG there
1216.32s - 1218.60s |  There was oh go ahead. Sorry
1228.37s - 1230.33s |  Yeah, I mean it really depends
1230.33s - 1233.85s |  I like I like 0.5 that that cuts you down to about
1234.13s - 1239.73s |  5,000 CVS and then you get some then you get to marry that list against what's actually on your network and
1240.05s - 1244.17s |  Most people we've seen when you take that 5,000 and marry it against actual networks
1244.17s - 1248.25s |  You get down to 50 or 60 CVS that are 0.5 or above, right?
1248.25s - 1253.57s |  but that's the that's the hard work in the homework that you have to do is to take the list and then actually match it
1253.57s - 1255.89s |  against the CVS that are still on your network and
1256.29s - 1259.85s |  Then figure out what what works for your VM groups, right?
1259.85s - 1267.73s |  Because in some organizations 50 tickets to patch CVS might be nothing and in other organizations that might you know
1267.73s - 1269.89s |  Cripple a VM team for a month
1276.36s - 1282.20s |  yeah, I will put this at on my twitter account at jay gambling and I will share it with the and I will share it
1282.20s - 1283.40s |  with
1283.40s - 1287.12s |  The village and I think that they will put them all somewhere at 2 at the end of the thing
1288.96s - 1295.26s |  Yes
1295.26s - 1297.94s |  Yeah, so we we did
1298.86s - 1304.82s |  There's a couple of things about that CISA has stepped up and started providing fill-in CVSS scores
1305.18s - 1307.18s |  So we are leaning into those
1308.14s - 1313.06s |  We are also missing a bunch of data from NVD. So it does hurt the model a little bit
1313.58s - 1319.66s |  That's why we're having a new model come out at the end of the year that relies less on NVD and more on the CNA
1319.66s - 1325.86s |  Data, so you'll see a big push for us to to have the CVE publishers require more data
1326.58s - 1332.06s |  In the CVE records for the longest time all you needed to publish a CVE was three data points
1332.06s - 1336.62s |  And that's just not enough for people to make informed decisions in 2024
1340.00s - 1341.28s |  Yes, sir
1341.28s - 1360.22s |  Yeah, and I think that's where you just have to like really lean into the the exploited known exploitable, right?
1360.22s - 1363.82s |  Like no matter where your known exploitable is it's we took care of
1364.50s - 1369.54s |  95% of everything had a known exploitable and everything else gets pushed off into our large patching
1369.70s - 1376.98s |  Sections either quarterly or monthly or whenever they happen. But yeah, yeah, I if I ran a VM team right now, I would never ring
1377.50s - 1383.38s |  The firebell unless there was known exploit code on on the Internet actively being exploited, right?
1383.38s - 1387.10s |  Like I wouldn't trust CVSS. I wouldn't even trust an EPSS score
1387.10s - 1391.82s |  Right, like like before I make somebody work over a weekend. I would have to see see code
1392.42s - 1394.42s |  Somewhere that that made me do that
1404.17s - 1405.49s |  Just POC exploit
1405.49s - 1412.25s |  We try really hard on our model to be able to determine if we're seeing the exploit versus it just being POC code
1412.29s - 1414.29s |  We also lean really heavy on
1414.61s - 1421.37s |  We want the model to see if it's a network based POC code versus a local based POC code because a lot of times we
1421.37s - 1428.53s |  See POC code for network based vulnerabilities. They actually have to run on the system and and that never seems to make a lot of sense
1429.89s - 1440.55s |  Yes, ma'am. That's a good question
1441.27s - 1442.55s |  We don't know yet
1442.55s - 1447.63s |  But bias and CNAs is a whole nother talk because you become a CNA
1447.63s - 1452.03s |  So you get control over what CVEs you publish for your software or not?
1452.03s - 1459.77s |  So there's always some bias and CNA data at its root because that that's why most companies have become CNAs
1460.83s - 1466.15s |  All right with that. I think I will will call it my time and say thank you guys very much again for coming to the
1466.15s - 1469.11s |  AppSec village and to have a good rest of your DEF CON
1470.55s - 1472.55s |  Thank you