{
  "webpage_url": "local:1732052815:155c59a2:DEF CON 32 - IoT Village - Beyond Sunset - Exposing the Occultations Lurking in Large - Scale Off - Grid Solar Systems - Dan Berte  Alexandru Lazar.mp4",
  "title": "DEF CON 32 - IoT Village - Beyond Sunset - Exposing the Occultations Lurking in Large - Scale Off - Grid Solar Systems - Dan Berte  Alexandru Lazar.mp4",
  "description": "Local file",
  "channel_url": null,
  "duration": null,
  "channel": null,
  "uploader": null,
  "upload_date": null
}

0.00s - 2.00s | This text was transcribed using whisper model: large-v2

 It didn't warn me I was gonna be bright so
3.12s - 5.76s |  We still got people coming in. But so this is
6.84s - 12.60s |  Gonna start doing a little bit of the intro we're talking about. So while everybody comes in we'll get to the meat of it
12.60s - 13.60s |  so
13.60s - 20.12s |  Welcome. Oh, everybody's having a great great convention. Thanks for showing up. This is fantastic. We're really excited to talk about
21.16s - 25.12s |  Some of this stuff because it's fresh off the presses. So we're gonna be talking about
27.08s - 29.08s |  Photovoltaics
29.08s - 34.60s |  And some of the findings that are recent for us so I have here with me
35.28s - 37.28s |  Alexander Losser as one of a
38.48s - 44.52s |  Scenarios query researchers. We both work for a company called Bitdefender. You may have heard of I
45.64s - 51.38s |  Added a link here to our work so you can refer to it later some of the
53.20s - 55.20s |  Vulnerability research that we do so
55.36s - 57.32s |  We've been doing
57.32s - 62.08s |  Among other things we've been doing it vulnerability research for the last 10 plus years
62.96s - 64.32s |  on
64.32s - 69.68s |  Normally and typically consumer grade devices that are popular or interesting or something that we find
70.40s - 74.20s |  Just yeah interesting to look at so during this time. We've
75.04s - 82.72s |  Published over 25 high-profile cases and findings and we have dozens of white papers that came out of that research
83.36s - 85.56s |  this is a pretty small team, but
86.52s - 91.20s |  It's been it's been really lucrative and and exciting on our academic and
91.88s - 95.08s |  Educational side so I want to quote a couple of a couple of
95.84s - 102.20s |  High-profile cases that we we covered findings that we had so I'll say ring doorbell for example edge LG TVs
102.20s - 108.68s |  This is something that's as fresh as a month old. Maybe you know the fire stick from Amazon. Maybe the Agus August lock ring a bell
110.04s - 111.48s |  wise
111.48s - 114.48s |  I'll let you fight these of his cameras and more
114.92s - 120.80s |  What's interesting that through our research and what we found obviously besides vulnerabilities?
121.28s - 127.84s |  Is that more than 30% of the vendors never reply or they don't reply timely?
128.52s - 129.80s |  and
129.80s - 132.36s |  To our contact and we try to reach out to them and it takes
133.60s - 139.48s |  Often it takes them more than 180 days to do so and what's even more concerning is that?
140.48s - 147.52s |  20% of these people take more than a year to fix the vulnerabilities that we are trying to communicate to them or never actually patch
147.52s - 151.92s |  These sometimes or most of the times exceeding the end-of-life cycle of that product
151.92s - 157.44s |  So here's a PSA to all the vendors if you could pass on the word
158.04s - 163.28s |  Appoint a permanent contact set up a vulnerability disclosure program and a URL for it
163.64s - 168.96s |  Put a PG key PGP key on it and monitor that inbox. I can't stress that enough so
169.76s - 171.76s |  and
171.84s - 174.52s |  This is the has been for the last
175.48s - 182.44s |  Decade and a half or more the most haunted terrorist in the United States and abroad when it comes to the power grid
183.24s - 185.24s |  the squirrel
185.24s - 189.32s |  And it's called squirrel terrorism. There is a squirrel index
189.84s - 194.14s |  on Wikipedia and we have a couple of quotes here, for example, we have
195.02s - 200.42s |  A former deputy director of the NSA that said frankly the number one
201.46s - 204.38s |  threat today to the grid is squirrels and
205.06s - 206.54s |  then
206.54s - 211.50s |  The threat to the Internet infrastructure services post by squirrels make seed the one
212.30s - 216.66s |  Post by cyber attacks and so on so on. So basically the narrative here is in general
217.54s - 220.78s |  That cyber security is not really potential
221.46s - 226.14s |  Straight-up concern when it comes to the power grid because most of the actual
227.62s - 229.62s |  attacks were of natural causes
230.54s - 232.54s |  Squirrels fires, whatever have you in general?
232.58s - 236.74s |  The grid is really highly regulated and protected and secured
236.74s - 242.34s |  So a lot of the cyber attack woes don't really apply even though we have you know warnings from CIA
242.34s - 244.50s |  What examples and NSA and all this stuff so?
245.30s - 246.74s |  to that
246.74s - 248.74s |  enter solar
249.10s - 251.58s |  And this is what we're gonna talk quickly about today
251.58s - 257.58s |  So obviously green energy is the forefront of everything that we do. So as it's transforming the global landscape
257.58s - 259.90s |  We're seeing just you know last year
260.78s - 262.78s |  over 500 gigawatts of
264.14s - 266.14s |  Capacity added by solar
266.50s - 268.94s |  Just last year, which is three quarters
270.10s - 276.30s |  It's a it's an explosive growth, which obviously is fantastic for us. But at the same but at the same time brings
277.30s - 279.14s |  You know
279.14s - 286.74s |  They you know, the growing number of systems obviously brings more interest and more focus to the to them to potential attackers
286.74s - 291.78s |  So as the capacity increases, the question is, you know is security keeping up?
292.98s - 295.54s |  As both businesses and consumers are starting to add
296.66s - 299.42s |  solar panels to their to their portfolios now
300.26s - 306.50s |  Again this space solar is less hurdle hardened and regulated by as legacy
307.30s - 308.90s |  power generation
308.90s - 315.26s |  So to that point we investigated a manufacturer called day and a measurement platform called solar meant to find out
316.50s - 317.66s |  Why?
317.66s - 322.18s |  It's because these are smart systems and they can be obviously controlled remotely
323.30s - 325.30s |  someone in our office noted something that was
326.06s - 332.94s |  Interesting after installation so we decided to keep digging an inverter and I'll show you I'll show you a
335.46s - 340.22s |  Sketch just to see how the how the stuff works out could be added on both these platforms
341.22s - 346.34s |  Using their apps. You just needed the serial number. So it was interesting enough
346.66s - 351.22s |  So here's a diagram of a system and trying to understand how it works. This applies for both
352.38s - 354.38s |  residential customers, but also
354.94s - 356.94s |  larger platforms as well, so you have
357.58s - 362.22s |  You have the solar panels. Let's say you have solar panels on top, you know on your home
362.62s - 365.22s |  These connect to an inverter that feeds the grid
365.34s - 370.70s |  The grid is connected to the inverters connected to a data logger. That's a bridge between
371.30s - 372.94s |  all these systems
372.94s - 379.26s |  And the data logger sends information to a cloud platform that feeds into various application and management
379.74s - 382.62s |  Systems as well. So again the logger the
383.50s - 387.26s |  Is the conduit that connects everything to the Internet and isn't, you know
387.26s - 391.58s |  Responsible for the settings and the data collection and updates of the whole system
393.50s - 398.98s |  In general, it's these will be connected and they won't be because they won't work
398.98s - 400.82s |  Otherwise with a grant with a grid
400.82s - 401.50s |  so
401.50s - 408.58s |  Obviously end users can control the system from the Internet from their phones or just another platform and they can talk directly to the platform
408.58s - 410.58s |  and I'm gonna invite Alex to
410.62s - 413.42s |  Discuss and walk us through how we investigated the platform
416.90s - 421.54s |  Okay, so we started with a man-in-the-middle attack on the day cloud app
422.18s - 426.26s |  We only use the user certificate. No need to patch the application
427.06s - 431.78s |  Among the traffic we found a suspicion login request using hard-coded credentials
431.78s - 438.38s |  I don't know if you can see them, but it is smart configurator at solarmanpv.com and the password
438.94s - 440.94s |  1 2 3 4 5 6
441.18s - 443.18s |  first place on the rocky list
444.91s - 449.99s |  Okay, what is the account used for it gets information about a user's device?
450.31s - 453.95s |  For example the model the version and a password
454.71s - 461.07s |  This account is not linked to any user account. So it works for any device no matter who owns them
461.87s - 468.07s |  Now I mentioned the password a logger while it is running has an access point active
468.63s - 472.75s |  The SSID of the access point has a convenient naming scheme
472.87s - 474.87s |  It starts with a P
474.87s - 481.15s |  Underscore serial number. So if you have the serial number of the logger we can get into the access point
481.75s - 483.75s |  Let's see how an attack will look
484.39s - 488.39s |  First we find an access point that corresponds to the naming scheme
489.03s - 492.43s |  Then we get the serial number. We use the hard-coded account
493.45s - 495.45s |  To make the request and get the password
496.03s - 498.81s |  Connect to the access point and just profit
499.29s - 507.09s |  Okay, those question marks do some heavy lifting but it basically boils down to sending 80 commands to the logger to get
507.57s - 513.53s |  Access to the user interface to get access to the user's Wi-Fi network and just send
514.41s - 516.41s |  commands to
516.45s - 517.81s |  the logger
517.81s - 520.01s |  Now there are some downsides to this attack
520.17s - 526.37s |  First of all, you need physical proximity then you need to maintain said physical proximity
526.93s - 533.13s |  You also only get one device at a time and as much fun as war driving is it's not very efficient
533.13s - 535.13s |  I think we can do better
536.01s - 539.45s |  Now we looked at other platform features and
540.81s - 545.03s |  We saw that users can only view statistics and information about their system
545.77s - 550.49s |  To make changes they require to add a business account as a guest
551.29s - 554.25s |  How is this done? Well, there is a search API
554.89s - 558.81s |  That returns data about all users and organizations
559.33s - 563.57s |  In the front end, we only see the name of the business when you start when we search for them
564.09s - 569.05s |  But in the back end, we have emails phone numbers addresses user IDs
570.21s - 576.09s |  For example, we have a vote an endpoint for a business. We have the administration name the
577.09s - 583.73s |  Admins phone number and for the users we get the last login IP we get the their address if they put it there
585.25s - 589.49s |  By itself, it's not really exploitable at most being a privacy issue
590.21s - 597.73s |  But it gives us a ballpark for the total number of users about three and a half millions and the total number of businesses
598.37s - 600.37s |  over 300,000
600.73s - 603.93s |  We'll keep this in mind as it might be useful later
605.61s - 607.61s |  Now I talked about
608.33s - 615.57s |  Solomon and they then that's because until recently they was using the Solomon infrastructure to run his code
616.53s - 621.49s |  But recently they built its own data center and migrated its user to a new database
621.97s - 629.89s |  The code also runs on their new data center, but we wondered maybe the code is still pretty similar
630.77s - 632.05s |  and
632.05s - 634.13s |  it turns out it's very similar a
634.73s - 636.73s |  Token from there
636.73s - 644.29s |  We'll work on Solomon. It gives access to an account that has the same user ID, but the users were migrated. So now a
645.05s - 650.05s |  User from they has a different user ID from the one on Solomon
651.09s - 659.01s |  so the user IDs are also incremental a new account gets an idea of about 14 million on Solomon and it of about
659.49s - 661.49s |  13 million on day
661.53s - 667.45s |  This means that by creating new accounts on there you could take over over 1 million accounts
668.33s - 670.89s |  That's good, but I think we can do even better
672.49s - 676.97s |  Now I keep talking about the JVT tokens and let's see how they are obtained
677.57s - 679.57s |  For a normal user is pretty straightforward
680.61s - 689.09s |  You send the email address the password the hash password and you get back a JVT token containing your email and your user ID
689.61s - 691.01s |  A
691.01s - 693.01s |  Business account is a bit different
693.77s - 700.89s |  One account can manage multiple organizations and when logging in an admin will choose which business to manage
701.29s - 705.85s |  The server creates a token that specifies the organization's ID
707.85s - 710.25s |  Let's see the steps the first step is
711.33s - 716.69s |  Basically then identical to a normal user and I highlighted in the decoded token
716.73s - 720.65s |  The fields that pertain to the organization the organization ID and the group ID
722.13s - 725.25s |  At the second step using the token from the first one
725.85s - 731.81s |  We get a list of organizations. That's a business that an admin can manage and
732.93s - 737.05s |  In the third step, we have another login request
737.61s - 744.73s |  to the same endpoint, but this time it's it uses an authorization header with the barrier token we got from the first step and
745.73s - 750.65s |  In the post body, we also have the same token together with the organization ID
751.45s - 753.45s |  the server responds and
753.97s - 759.33s |  Completes the fields that I highlighted earlier and pertain to the user organization
760.21s - 763.17s |  Now, what is the issue in the third step?
763.69s - 765.69s |  The endpoint uses data
765.73s - 771.89s |  From the token we sent in the post body and creates the new token that has access to the organization
772.25s - 778.37s |  So we thought let's just change the user ID an email and the token we sent and it just worked
779.01s - 781.41s |  No signature checks. No errors
782.33s - 785.62s |  Didn't even need out none
785.62s - 789.22s |  The endpoint didn't even need the authorization header. We could use it
790.78s - 798.18s |  Just like that this is a request with a manufactured token that we sent and the one we received
799.18s - 804.38s |  The tokens here look pretty similar the one on the left is the one we manufactured and
804.90s - 809.74s |  The difference between them is that the one on the left has a bad signature because obviously we don't know the key
810.10s - 813.94s |  to sign the token, but the one on the right is signed by the server and
814.54s - 817.82s |  It gives us access to any account we want. I
819.34s - 825.78s |  Mentioned that we need the ID and email to create this token. But if you remember earlier we have some
826.62s - 830.22s |  Endpoint which gives us this information for all accounts
830.70s - 835.62s |  So this time all three and a half million accounts were risking takeover
837.30s - 841.26s |  Kudos to them they fixed this in 24 hours since we contacted them
842.54s - 846.26s |  Now I'll let Dan talk about the impact
849.03s - 851.03s |  Thanks Alex. So
851.55s - 855.95s |  This context I'll show this more in the timeline. So this is very fresh
855.95s - 859.27s |  We published the findings just a couple of days ago. So
861.43s - 862.83s |  Take this
862.83s - 869.91s |  List of vendors with a little bit of a grain of salt. It's mostly inferred, but it's a highly let's just say highly informed
870.63s - 874.95s |  Chance that these vendors were also impacted because they do share the solar moon
875.67s - 881.07s |  Platform and potentially is the same database and we can additionally infer
882.07s - 885.75s |  Their potential impact by the fact that we were seeing
887.87s - 891.27s |  Stuff like this popping up around the same time we
891.95s - 894.99s |  informed the vendors of the findings so
895.95s - 901.43s |  Some of these vendors also patched right away and informed the users about the existing patches now
903.03s - 905.03s |  Let's talk a little bit about
906.19s - 909.59s |  The actual impact in terms of you know users
910.19s - 912.19s |  So we were seeing
912.35s - 916.59s |  You were estimated about three and a half million users could have been impacted by the vulnerabilities
918.15s - 921.79s |  Exemplified here and more than three hundred thirty thousand businesses
922.67s - 924.67s |  All these control multiple systems
925.83s - 932.51s |  Of course, there's a PII component. So having access to the platform could enable a malicious actor to
933.35s - 935.35s |  obtain information
936.31s - 943.11s |  About the users and location and so on so forth. So that's bad in itself bad enough in itself, but but at the same time
943.71s - 947.03s |  Having access and controlling being able to control the inverters
948.43s - 954.95s |  Through the management platform could also either overload or under load the grid. So basically user imagination
955.95s - 960.99s |  Of what could it be done here? Also, it's worth mentioning that the platform
961.51s - 963.87s |  serves about a fifth of
964.51s - 969.75s |  World's total solar generation capacity, so it's quite a quite an impressive number
970.63s - 973.99s |  Kind of put that into perspective. It's larger than what the
974.55s - 975.71s |  US
975.71s - 978.87s |  generates through photovoltaics alone, so
979.99s - 983.27s |  The question is does this finally beat the squirrels now?
985.23s - 987.07s |  Because
987.07s - 990.03s |  And of course the echoes of national security
990.39s - 993.39s |  Follow the idea here being that
994.39s - 995.91s |  the
995.91s - 1002.11s |  Conversation generally around the grid is that as I said earlier, it's either the squirrels or natural or natural causes
1002.31s - 1004.67s |  We're not here to place FUD around
1006.43s - 1007.79s |  About
1007.79s - 1012.79s |  Solar but kind of trying to shine a light that the situation might be changing for the future
1012.79s - 1014.79s |  And I think it warrants a little more attention
1015.55s - 1019.23s |  I have the timeline here. We contacted the companies
1019.83s - 1025.19s |  Sometime in mid-may. They've been fairly responsive at both acknowledging and
1026.43s - 1028.43s |  Fixing the vulnerabilities
1028.47s - 1033.27s |  And we actually closed disclosure to the to these findings just a few days ago
1034.19s - 1038.39s |  With that said I'm inviting you to ask whatever questions there might be
1038.79s - 1041.95s |  You can also find us at the IT village
1041.95s - 1045.35s |  We have a we have a little table there, and we have a challenge
1046.11s - 1048.11s |  to hack a TV
1048.23s - 1052.59s |  And please do not forget if you know a vendor
1054.31s - 1058.23s |  Remind them to appoint a permanent contract a contact for a vulnerability
1060.11s - 1066.63s |  Findings to set up a program for vulnerabilities URL for it put a PGP key on it and monitor that inbox, please
1066.63s - 1068.63s |  So with that said thank you for coming
1068.67s - 1070.47s |  We're open for questions
1070.47s - 1078.26s |  And if there's no questions just come by
1078.74s - 1083.30s |  Come by the village and we can talk more so thanks so much for your time. I'll see you guys there. Thank you