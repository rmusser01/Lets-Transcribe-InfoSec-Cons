{
  "webpage_url": "https://www.youtube.com/watch?v=YFThifuJbMM",
  "title": "BlueHat 2024: S16: Three Decades of Network Security Evolution",
  "description": "BlueHat 2024: S16: Three Decades of Network Security Evolution Presented by Vern Paxson from Corelight\n\nAbstract: 30 years ago the Network Security landscape looked completely different, and subsequently at times it has evolved in quite striking ways. In the thick of the ongoing work of defending networks, it can be hard to step back to see the larger picture of how threats and defensive technologies change over time. How quickly do new threats arrive? How long does it take to actually deploy new security improvements? What do attackers probe for? How much encryption is actually in use, and how up-to-date is it?\n\nWe'll provide a look at this landscape by drawing upon years - and in some cases decades - of huge datasets from a dozen large operational environments, illustrating how some changes are lightning fast - and others, glacially slow.",
  "channel_url": "https://www.youtube.com/channel/UCKmzq2lAhDxLy36KtvVWpaQ",
  "duration": 2444,
  "channel": "Microsoft Security Response Center (MSRC)",
  "uploader": "Microsoft Security Response Center (MSRC)",
  "upload_date": "20241108"
}

0.00s - 10.68s | This text was transcribed using whisper model: large-v2

 So, this is a talk about data, and if you're a data fan, I think you'll find it quite stimulating
10.68s - 16.52s |  and illuminating, and if you're not, well, you can take your break.
16.52s - 22.68s |  The scope of what I want to look at is how do things change in the Internet, particularly
22.68s - 23.68s |  security-wise?
23.68s - 24.88s |  How should we think about that?
24.88s - 27.28s |  What are our good mental models?
27.28s - 30.80s |  And I have a whole ton of data to illustrate different facets of this, and I'm going to
30.80s - 35.44s |  walk through kind of chronologically, and we'll finish with the modern era.
35.44s - 36.48s |  Don't worry about that.
36.48s - 41.32s |  But we start way back in the day, 1990s.
41.32s - 47.56s |  Yesterday's talk was a great reminder for those of us who went through that whole trajectory
47.56s - 53.20s |  of vulnerability hunting, disclosures, that evolution.
53.20s - 54.20s |  That's its own evolution.
54.20s - 55.20s |  That's its own time scale.
55.20s - 58.24s |  It's really interesting.
58.24s - 60.88s |  Here we're going to talk about searching for invariants.
60.88s - 67.84s |  So I started my career as a Ph.D. student analyzing the Internet, and I picked a great
67.84s - 72.44s |  time for it, which was the early to mid-'90s, a lot of stuff happening.
72.44s - 75.96s |  And one thing you wanted to find, because everything changed so fast, is, well, what
75.96s - 78.68s |  are the things that don't change?
78.68s - 82.44s |  And sometimes the things that don't change are the rules about how things change, and
82.44s - 84.64s |  that's part of what we'll be covering today.
84.64s - 86.88s |  So let me start with data.
86.88s - 93.20s |  This is data gathered by Rick Adams, who was one of the founders of a company, UUNet.
93.20s - 95.16s |  You may or may not know.
95.16s - 100.60s |  And it is, what is the volume of data per day going through the Usenet bulletin board
100.60s - 102.88s |  system?
102.88s - 109.80s |  Old system, peer-to-peer delivery of newsgroups, kind of like Reddit is today, though more
109.80s - 110.80s |  decentralized.
110.80s - 113.80s |  And because it's peer-to-peer, you can measure the entire thing.
113.88s - 119.64s |  And UUNet ran one of the big nodes in the bulletin board network, and so he had this
119.64s - 120.64s |  data.
120.64s - 121.64s |  He was a data nerd, like I am.
121.64s - 124.08s |  And it goes way back, right?
124.08s - 128.32s |  We're talking 80s, not even the 90s.
128.32s - 134.60s |  And you look at this data, and at first you think, well, okay, nothing much happened for
134.60s - 140.00s |  the entire 80s, and then around 1992 maybe things started picking up.
140.00s - 142.56s |  And that might be how you look at it.
142.68s - 145.88s |  And if that's how you look at it, you're actually missing something really interesting about
145.88s - 146.88s |  the data.
146.88s - 151.24s |  And you see that if you plot it not linear, which is what this is, but log linear.
151.24s - 153.48s |  So that's this.
153.48s - 160.16s |  And suddenly we've gone from a curve that, you know, kind of picks up at the end to something
160.16s - 163.88s |  that looks like a straight line.
163.88s - 168.16s |  When you plot and you see straight lines, you learn the hard way you better fit a line
168.16s - 171.08s |  to it, because sometimes it's not a straight line.
171.08s - 172.54s |  So here's the fit.
172.54s - 174.42s |  This least squares fit.
174.42s - 178.94s |  And for real data across a decade, it's a very good fit.
178.94s - 184.66s |  In fact, there's those wonky dropouts pretty much exactly every 12 months, and that's the
184.66s - 186.70s |  end of year holidays.
186.70s - 192.98s |  So this is showing a log linear relationship.
192.98s - 196.62s |  And what does it mean when it's a straight line on a log scale plot?
196.62s - 200.16s |  It's exponential growth.
200.16s - 201.20s |  How fast is the growth?
201.20s - 202.76s |  It's the slope of the line.
203.12s - 204.12s |  Well, what is it?
204.12s - 206.92s |  It's 80% a year.
206.92s - 213.12s |  So this data is showing that this facet of the Internet not only was growing exponentially
213.12s - 217.64s |  in the 90s, but in the 80s it was growing exponentially.
217.64s - 224.12s |  And in fact, if you had to pick an invariant, it would be it grows 80% a year.
224.12s - 227.12s |  Really striking that it goes that far back.
227.12s - 228.12s |  And so I love this data.
228.12s - 231.84s |  I was working on characterizing Internet traffic in various ways.
231.84s - 238.88s |  And I really wanted to know what comes next.
238.88s - 240.66s |  What happened after 94?
240.66s - 245.02s |  Because that's the data Rick gave me was, you know, 84 to 94.
245.02s - 254.22s |  And unfortunately, from a sort of greedy researcher perspective, Rick had a hugely successful
254.22s - 255.44s |  company.
255.44s - 262.14s |  And it meant when his ox script broke in 1994 that generated this, he didn't ever bother
262.14s - 265.54s |  finding the time to fix it.
265.54s - 271.22s |  And that was like, oh, what a lost opportunity.
271.22s - 275.34s |  Because you want to know, that's crazy growth, 80% a year.
275.34s - 277.54s |  Could that be sustained?
277.54s - 284.34s |  And then two years later, a guy at Unionet got back to me and said, you know, I've got
284.34s - 290.40s |  a few data points from 1996.
290.40s - 292.24s |  What are they going to show?
292.32s - 295.40s |  Does that 80% a year start tailing off?
295.40s - 297.08s |  Seemed it had to.
297.08s - 298.08s |  Here's what he showed me.
298.08s - 301.00s |  It's those two extra points.
301.00s - 307.36s |  And now I have a real problem, because I really want to know, do I believe that?
307.36s - 315.08s |  Did the decade-long invariant of 86, 80% growth a year, change?
315.08s - 320.60s |  And if it did, how could it possibly have gone up, not down?
320.60s - 322.40s |  So this is a problem, right?
322.40s - 327.28s |  It's so easy to think that David Lawrence's data was just different.
327.28s - 334.32s |  And it would have remained a gnawing puzzle, except the fact there were two data sets.
334.32s - 338.16s |  One of them was bytes per day, which I'm showing you here, and one of them is articles per
338.16s - 339.16s |  day.
339.16s - 346.16s |  And if I plot articles per day, the data fits.
346.16s - 353.04s |  So that is a 75% year growth, which means articles slowly over time get bigger, kind
353.04s - 354.92s |  of what you'd expect.
354.92s - 359.36s |  And this is not, you know, proof of the pudding that the change is correct, you know, that
359.36s - 365.04s |  the new data is correct, but it's certainly plausible, because it kept the invariant.
365.04s - 373.32s |  Now once you've got one thing continues growing 75% a year, and another grows faster, well,
373.32s - 374.40s |  what happened?
374.40s - 376.64s |  Articles got bigger.
376.64s - 379.72s |  So this is the average size of articles.
379.72s - 384.40s |  And you can see that, you know, for a decade they were basically sitting there at two kilobytes,
384.40s - 389.28s |  and then suddenly they're, you know, 15, 20 kilobytes.
389.28s - 394.60s |  And where my career sort of shifted at this time, due to this and other things, too, is
394.60s - 398.14s |  that's abuse.
398.14s - 401.42s |  That extra change was driven by two things.
401.42s - 407.14s |  It was driven by porn, and it was driven by stolen software, wares.
407.14s - 414.66s |  And both of those are not what the people providing this system were doing it for.
414.66s - 417.94s |  They did not, this is not why they wanted to provide it.
417.94s - 420.26s |  It's definitely counter to their intent.
420.26s - 425.23s |  So it's abuse.
425.23s - 432.27s |  This shows you can get this big change over a small amount of time driven by security
432.27s - 433.39s |  things.
433.39s - 440.28s |  And it drove it counter to the direction we would have expected.
440.28s - 441.28s |  Okay.
441.28s - 444.28s |  That was the 1990s.
444.28s - 450.24s |  Let's move up to the 2000s, the aughts, whatever we want to call it.
450.24s - 454.52s |  And we're going to see things can change really quickly.
454.52s - 457.84s |  So here's some data at Lawrence Berkeley National Lab.
457.84s - 461.76s |  Now that's where I was working when I was in work study, PhD.
461.76s - 465.80s |  Whole bunch of the data we're going to see in this talk comes from Lawrence Berkeley
465.80s - 466.80s |  National Lab.
466.80s - 471.92s |  There was mention at the beginning of the ZEKE, open source ZEKE.
471.92s - 476.72s |  I developed that originally while working at Lawrence Berkeley Lab and a grad student
476.72s - 478.84s |  at Berkeley.
478.84s - 483.12s |  And the data, other than that first set of data, all the data we're going to see from
483.12s - 488.20s |  now on is derived from ZEKE deployments.
488.20s - 494.32s |  In a brief context for ZEKE, rich network monitoring tells you in detail all the activity
494.32s - 495.32s |  that's been seen.
495.84s - 498.28s |  That's essentially what you need to know about passive monitoring.
498.28s - 499.28s |  Okay.
499.28s - 508.40s |  So this is data at LBL that started in 1994 when I was first prototyping what turned into
508.40s - 509.40s |  ZEKE.
509.40s - 514.16s |  And it is how many hosts per day were scanning the lab.
514.16s - 517.48s |  And you look at the data and you say, well, you know, for six years it was, I don't know,
517.48s - 518.48s |  around 50.
518.48s - 520.60s |  It's a little hard to tell with that log scale.
520.60s - 523.36s |  And then it started going up a bit.
523.36s - 525.88s |  You've got growth.
525.88s - 532.34s |  And then it literally changed overnight.
532.34s - 536.62s |  July 19th, 2001, looked like that.
536.62s - 540.18s |  July 20th, it looked like that.
540.18s - 548.78s |  So in one day, this facet of how experience was, how security was experienced in Lawrence
548.78s - 553.22s |  Berkeley Lab changed by two orders of magnitude.
553.22s - 557.28s |  And it never went back.
558.00s - 563.04s |  And maybe some of you who were active back in the day recognized that date.
563.04s - 565.84s |  That is the beginning of the modern worm era.
565.84s - 569.80s |  That was code red, July 20th.
569.80s - 571.60s |  So suddenly we've got a global worm.
571.60s - 572.88s |  It's scanning globally.
572.88s - 581.96s |  And boom, tens of thousands of hosts are scanning every single day instead of 100 or 200.
581.96s - 588.64s |  And then it goes down a bit in over 2002 and three, and then back up to a peak, and then
588.76s - 591.68s |  we get the cybercrime era.
591.68s - 597.92s |  So this data is pretty fascinating as well, which shows these sort of both this abrupt
597.92s - 605.12s |  change and then these large swings that are over more time.
605.12s - 610.44s |  At the time, with colleagues, I found this data really interesting, and we analyzed what's
610.44s - 611.84s |  being scanned.
611.84s - 621.56s |  And here you see over 12 years how many scans are coming proportionally by the circle size
621.56s - 622.56s |  for different services.
622.56s - 624.84s |  And you see all sorts of wonky dynamics in this.
624.84s - 627.36s |  I'm not going to go into this in particular, though.
627.36s - 631.88s |  I really do like that 9898 Sasser backdoor.
631.88s - 636.56s |  That's parasitic malware looking for a backdoor left by other malware.
636.56s - 644.85s |  And you see that scanning just suddenly starts abruptly in 2004 and starts tailing off.
644.85s - 649.85s |  The question then, that was a view all the way up through 2006, so by now we've looked
649.85s - 652.33s |  at a couple decades.
652.33s - 654.85s |  What follows?
654.85s - 660.80s |  What's happened in the last 18 years?
660.80s - 667.68s |  And it turns out that Lawrence Berkeley Lab, which trained me well as a, you know, I'm
667.68s - 668.80s |  a data nerd.
668.80s - 669.80s |  They are data nerds.
670.36s - 673.24s |  They are data pack rats.
673.24s - 677.20s |  And so we're wondering, how does this evolve?
677.20s - 683.18s |  Now, here I've switched to connections per day, similar figure.
683.18s - 685.94s |  It's not conditioned on scanners.
685.94s - 686.94s |  And I have data.
686.94s - 691.82s |  And it's from these folks at Lawrence Berkeley Lab, and they're part of the security team.
691.82s - 692.94s |  And guess what?
692.94s - 697.42s |  They've recorded everything all the way back to 1984, and they still have it.
697.42s - 699.94s |  So here is what the data looks like.
699.94s - 703.86s |  And we're going to take a few looks at this, and then we'll start switching to evolution
703.86s - 706.46s |  security technology.
706.46s - 710.70s |  So first off, I don't know if you could see that little blue thing in the lower left.
710.70s - 714.28s |  That was this craziness.
714.28s - 716.24s |  There it is.
716.24s - 722.52s |  And if we look at this, you know, log scale, we can kind of break it down into a few regions.
722.52s - 725.00s |  By the way, those drop-offs, that's just measurement problem.
725.00s - 729.28s |  That's not some deep effect.
729.32s - 735.72s |  And if you fit least squares to some regions, you go, well, you know, from 94 up to, I don't
735.72s - 742.64s |  know, 2,006, 7 connections per day, we're growing 73% a year.
742.64s - 749.48s |  And then kind of slowed from 2010 to 2022, maybe, to 50-odd percent.
749.48s - 752.60s |  And lately, it's down to 12.
752.60s - 757.80s |  And before you dismiss those numbers too much, just keep in mind, we're talking years.
758.32s - 760.92s |  These are many years.
760.92s - 763.40s |  And continuous data.
763.40s - 767.48s |  So millions, billions of points go into that.
767.48s - 771.76s |  So it's actually pretty robust.
771.76s - 776.36s |  Let me switch a bit from connections to remote hosts.
776.36s - 779.16s |  So how many remote hosts are coming to the lab?
779.16s - 784.52s |  Here it is up through about 2008 linear scale.
784.52s - 786.56s |  And you know, it's not doing a lot.
786.56s - 788.56s |  And then there's a little bit of growth.
788.56s - 790.12s |  Interesting.
790.12s - 792.88s |  And then, you know, some kind of noisy craziness.
792.88s - 795.60s |  And then, boop.
795.60s - 801.80s |  So in 2023, it just jumps.
801.80s - 805.36s |  And you're kind of like, what on earth is that?
805.36s - 807.16s |  And you know, can it possibly be right?
807.16s - 810.20s |  And, you know, I'll give you a preview, yeah, it's correct.
810.20s - 811.20s |  And what does it mean?
811.20s - 812.88s |  And we'll get back to what it means in a minute.
812.88s - 816.36s |  But let me first draw your eye to that point.
816.36s - 825.80s |  So on that day, almost 1% of the entire IPv4 address space came to the lab.
825.80s - 828.72s |  And this is not backscatter and randomized addressees.
828.72s - 833.80s |  Because you can tell because they're going for well-known ports at the lab.
833.80s - 834.80s |  That's not what you see in backscatter.
834.80s - 840.20s |  You see it going to the ephemerals used for the backscatter.
840.20s - 845.72s |  And as part of thinking about how things change or don't change.
846.08s - 847.08s |  So let's reflect on that.
847.08s - 849.72s |  It was IPv4.
849.72s - 853.80s |  I like this quote a lot from William Gibson.
853.80s - 855.12s |  Future is already here.
855.12s - 856.56s |  It's just not evenly distributed.
856.56s - 859.16s |  And that's really the theme of what I'm talking about.
859.16s - 863.88s |  Is how do we think about what is the state of the world?
863.88s - 865.32s |  How is it distributed?
865.32s - 872.36s |  And it's going to turn out, unfortunately, that often the notion of it's typically this,
872.40s - 873.40s |  typically the average is that.
873.40s - 876.12s |  It's just not well-defined.
876.12s - 877.80s |  There is really no typical.
877.80s - 881.16s |  It depends hugely on how you want to slice it.
881.16s - 888.27s |  In this talk, I'm mainly going to slice it in terms of large enterprise networks.
888.27s - 889.59s |  That's what I have access to.
889.59s - 892.35s |  That's what we do mainly at Corlite.
892.35s - 893.35s |  Okay.
893.35s - 902.83s |  So hey, v6, standardized, late 90s.
902.83s - 905.99s |  How much of this is v6?
905.99s - 910.79s |  I'm going to show you in red how much is v6 and why don't you just picture in your head
910.79s - 911.79s |  what do you think it is?
911.79s - 915.47s |  So this is a national laboratory in California.
915.47s - 919.27s |  How much v6 out of all this?
919.27s - 921.39s |  Here it is.
921.39s - 930.60s |  Basically nothing until we get to the weirdos that started literally one day.
930.60s - 931.60s |  All right.
931.60s - 933.80s |  What are the weirdos?
933.80s - 940.64s |  That is what happens when you add NTP servers to the global NTP pool.
940.64s - 944.72s |  Suddenly everyone wants to talk to you.
944.72s - 946.88s |  And this one turns out not to be malice at all.
946.88s - 952.44s |  This is just you've offered a global service, the lab has big pipes, the lab is certainly
952.44s - 959.66s |  v6 capable, and a whole ton of v6 comes to the lab.
959.66s - 966.22s |  Looking at this in terms of how those hosts grow, now, that is not the world's most happy
966.50s - 970.70s |  linear fit, because obviously there's a whole bunch of action going on there, and this is
970.70s - 978.46s |  a lot of scale, but roughly 40% of your growth in the host, and it's, you know, it's over
978.46s - 981.32s |  more than 20 years.
981.32s - 986.06s |  And then it shifts for, you know, about eight years, starts declining.
986.06s - 988.26s |  Of course, a lot of these are scanners.
988.26s - 990.14s |  We'll get to that in just a sec.
990.14s - 994.50s |  And then, of course, we have the weirdos, and then the v6, if you take out the weirdos,
994.50s - 1002.44s |  the NTP, which is really quite singular, is growing about 20% a year.
1002.44s - 1003.44s |  All right.
1003.44s - 1010.08s |  So if you think about productive connections, those that transfer data in both directions,
1010.08s - 1014.12s |  so were you doing that to weed out scanners?
1014.12s - 1020.88s |  What proportion of the lab's productive connections in late 2023 were v6?
1020.88s - 1028.52s |  And it turns out, well, it's 62% most connections.
1028.52s - 1034.52s |  You take out NTP and DNS, and it falls to 2%.
1034.52s - 1040.28s |  And you take out QUIC, and it falls to 1 in 700.
1040.28s - 1045.52s |  So depending how you want to slice that figure, the mental model you have of v6 usage changes
1045.52s - 1046.52s |  hugely.
1046.52s - 1055.02s |  We're going to look a bit at some of the scanning patterns, because they illustrate both the
1055.02s - 1063.18s |  notion of steady growth and abrupt growth, and then we'll switch to security technology.
1063.18s - 1073.48s |  So here is, over that entire 30 years, scanning on Windows ports.
1073.48s - 1077.28s |  And here's the same thing log-scaled.
1077.28s - 1082.92s |  And you might be distracted by these horizontal lines you can see kind of embedded in the
1082.92s - 1083.92s |  points.
1083.92s - 1089.84s |  This is when somebody, some scanners come and hit the entire address space at the lab,
1089.84s - 1094.88s |  which is either 65K if they find one of the slash Bs, or twice that if they find the second
1094.88s - 1102.80s |  slash B. So it doesn't have a deep meaning other than it means comprehensive scanning.
1102.80s - 1104.44s |  But it's pretty high.
1104.44s - 1111.00s |  So you've got, once you're in 2005, you're talking a million a day for most of these.
1111.00s - 1116.16s |  Which means, you know, it's completely indiscriminate scanning, because there's not even a million
1116.16s - 1120.83s |  such addresses to scan.
1120.83s - 1124.39s |  Here's a web scanning.
1124.39s - 1127.83s |  And here you can see those horizontal lines I was mentioning better.
1127.83s - 1131.35s |  But you can kind of fit that to, yeah, it grows like 26% a year.
1131.35s - 1136.67s |  It's done that for ever since like 2003, maybe.
1136.67s - 1138.75s |  And here's some others that have this property.
1138.75s - 1144.51s |  You can't tell when you look at these linear plots, but if you go to log linear, you see
1144.51s - 1147.11s |  they're all plausibly growing exponentially.
1147.11s - 1149.59s |  I've mainly fit to the right-hand side.
1149.59s - 1150.59s |  Okay.
1150.59s - 1155.84s |  So that's a bunch of exponential growth.
1155.84s - 1159.08s |  Here's some that are a little striking, different.
1159.08s - 1166.48s |  So we've got remote shell, network management, SNMP, SIP for telephony, and charge-in, which
1166.48s - 1168.40s |  is just DDoS.
1169.40s - 1173.20s |  No good use for charge-in today.
1173.20s - 1175.64s |  And all of these just boom.
1175.64s - 1182.00s |  You know, along came a day, and the world shifted, and it never went back.
1182.00s - 1184.56s |  Different.
1184.56s - 1191.16s |  And likely the onset of that depends on what did some attackers suddenly get interested
1191.16s - 1201.68s |  in and gear up their immense botnets to go scan, and never lost interest.
1201.68s - 1203.00s |  Here's the last one we'll look at.
1203.00s - 1204.16s |  It's a combo.
1204.16s - 1206.52s |  Here's network time protocol.
1206.52s - 1213.00s |  You can see it gets really big in early 2020s.
1213.00s - 1220.36s |  Off-port TCP, and then, sorry, off-port Telnet, and then Telnet.
1221.16s - 1225.04s |  Those of you who have suffered through Mirai know what this is.
1225.04s - 1233.32s |  Namely, this is the Mirai botnet, which is very, very aggressive.
1233.32s - 1241.28s |  So you've got sudden onsets of these protocols, some of which, like 2323 is a strange.
1241.28s - 1243.32s |  Not really is.
1243.32s - 1254.80s |  And right there was the peak Mirai unhappiness of, hey, every 250 microseconds, a new scan
1254.80s - 1258.84s |  comes for Telnet.
1258.84s - 1262.28s |  4,000 every single second.
1262.28s - 1266.32s |  Within a minute, the entire address space has been scanned, and yet it goes on and on
1266.32s - 1269.98s |  and on and on.
1269.98s - 1270.98s |  Okay.
1270.98s - 1280.18s |  That's a look at sort of some of the dynamic patterns in scanning as perceived, mostly
1280.18s - 1283.94s |  indiscriminate scanning, as perceived by enterprise.
1283.94s - 1288.26s |  Let's shift gears, talk about the rise of encryption.
1288.26s - 1297.58s |  This is a topic that us folks who work in network security monitoring are really interested
1297.58s - 1304.26s |  in, because often there is a view of, well, it's all encrypted, so what's the use of
1304.26s - 1308.26s |  analyzing what's on the wire?
1308.26s - 1310.58s |  And there's a couple perspectives on that.
1310.58s - 1314.94s |  One is, well, maybe it's all encrypted, but there's a lot of metadata in the encryption,
1314.94s - 1317.78s |  so get a bunch of information that way.
1317.78s - 1321.14s |  And then maybe it's not all encrypted.
1321.14s - 1322.14s |  How do you get data?
1322.14s - 1326.82s |  And, in fact, that question is what drove this entire exploration for me.
1327.06s - 1331.66s |  I wanted to understand, via data, how to think about this.
1331.66s - 1335.38s |  So the rise of encryption, maybe.
1335.38s - 1339.66s |  And then I've got an asterisk, because, as I mentioned earlier, the perspective I'm going
1339.66s - 1347.30s |  to give here is large U.S. enterprises, and it's just going to be different elsewhere,
1347.30s - 1351.63s |  and I'm not making any claims about elsewhere.
1351.63s - 1352.63s |  Okay.
1352.63s - 1353.63s |  Let's start with QUIC.
1353.63s - 1354.63s |  All right?
1354.79s - 1359.83s |  We have this modern protocol, and it is encrypted.
1359.83s - 1366.71s |  And we are told in 2021 that, you know, this is just the way it's going, folks.
1366.71s - 1370.59s |  QUIC is going to completely consume the Internet.
1370.59s - 1376.43s |  And you've got that line at the bottom there, hey, in 2020, three-quarters of Facebook's
1376.43s - 1379.03s |  traffic is over this.
1379.03s - 1382.75s |  That's, you know, a few years ago now.
1382.75s - 1389.35s |  And I don't doubt it, but is that the view at a modern, large enterprise?
1389.35s - 1398.55s |  So looking at Lawrence Berkeley lab data, let's compare log lines per day.
1398.55s - 1405.43s |  So this is essentially what Zeke's able to identify as different connections that are
1405.43s - 1407.99s |  either TLS or QUIC.
1407.99s - 1412.75s |  And starting in 2021, how many do you see?
1412.75s - 1417.23s |  And black is TLS, and red is QUIC.
1417.23s - 1423.59s |  So it's clear at the lab that QUIC is not eating the lab.
1423.59s - 1426.47s |  It's not nothing.
1426.47s - 1427.95s |  But TLS grows.
1427.95s - 1431.75s |  Those are linear fits now, not exponential.
1431.75s - 1438.83s |  You know, nearly 5 million connections a year, and QUIC around 2.
1438.83s - 1446.63s |  So if we go to our table here of how many connections at the lab, you know, QUIC's 19%.
1446.63s - 1451.71s |  It's not nothing, but it does not rule the world.
1451.71s - 1452.71s |  Okay.
1452.71s - 1453.71s |  Let's look at another question.
1453.71s - 1454.71s |  TLS 1.3.
1454.71s - 1462.95s |  A whole lot of talk among those doing enterprise monitoring about TLS's evolution from 1.2
1462.95s - 1463.95s |  to 1.3.
1463.95s - 1466.31s |  Why does it matter?
1466.31s - 1476.27s |  Well, 1.3, you can no longer see the certificate as part of the exchange that's encrypted.
1476.27s - 1480.07s |  And that means you can't mine it for metadata.
1480.07s - 1485.79s |  The metadata can be really handy if you're trying to do detection.
1485.79s - 1493.23s |  And the SNI, the server name indicator, there are proposals to hide it as well.
1493.23s - 1497.79s |  But 1.3, it is visible.
1497.79s - 1503.43s |  So we've got this shift from TLS 1.2 to TLS 1.3.
1503.43s - 1511.47s |  And we've got work that's telling us in 2020, whoa, it is just exploding out there.
1511.47s - 1513.87s |  And I know the authors on this.
1513.87s - 1517.19s |  In fact, one of them works with us at Carlyte.
1517.19s - 1521.47s |  And the data they have for this is great, huge data at scale.
1521.47s - 1523.87s |  It's just not enterprise data at scale.
1523.87s - 1526.15s |  It's different.
1526.15s - 1533.39s |  And so you can see the rise there, what proportion of the connections are 1.3, in particular
1533.39s - 1535.67s |  TLS 1.3 clients.
1535.67s - 1542.63s |  Back in 2019, it was already more than half of the clients.
1542.63s - 1547.43s |  And they say, wow, this is just really surprisingly speedy.
1547.43s - 1552.83s |  This took 15 months, and it's already really dominant back in 2019.
1552.83s - 1554.15s |  So what does this look like?
1554.15s - 1556.91s |  Here's Lawrence Berkeley Lab again.
1556.91s - 1562.35s |  And this plot's a little busy, but I introduced four things to plot rather than two, because
1562.35s - 1564.03s |  an important consideration.
1564.03s - 1565.67s |  So first, what are we seeing?
1565.67s - 1571.47s |  We're seeing in black and green TLS 1.2.
1571.47s - 1576.94s |  And we're seeing in red and blue TLS 1.3.
1577.10s - 1584.98s |  The reason it's split is because there's a strong difference in inbound and outbound
1584.98s - 1588.10s |  traffic, which version of TLS it uses.
1588.10s - 1596.02s |  And you can understand that, because if you're using a phone to communicate out from the
1596.02s - 1608.46s |  lab, then it's whatever is in your Chrome on your phone or what's in your iOS browser
1608.46s - 1610.82s |  that's going to pick which TLS to use.
1610.82s - 1616.14s |  And so a single huge vendor can be strongly influential.
1616.14s - 1618.38s |  But for what's coming in, it's different.
1618.38s - 1622.54s |  It's what you run on your own servers plus whatever the clients remotely are.
1622.54s - 1624.50s |  And so how do we interpret this?
1625.06s - 1633.62s |  You see a lot of black and green all the way up till basically April-ish this year.
1633.62s - 1634.94s |  It predominated.
1634.94s - 1636.42s |  It was more popular.
1636.42s - 1640.74s |  And then there's clearly a big level shift happened, presumably, and I haven't done the
1640.74s - 1648.71s |  analysis, you know, Chrome pushed out TLS 1.3, something along those lines.
1648.71s - 1656.27s |  And so if we look at the ratio over time, how are we evolving from 1.2 to 1.3?
1656.27s - 1662.67s |  Putting aside that level shift at the end, 8% a year.
1662.67s - 1665.31s |  It's not hugely exploding.
1665.31s - 1668.59s |  It's not all going to be 1.3 next year, that's for sure.
1668.59s - 1670.99s |  It's a process.
1670.99s - 1676.67s |  And we're going to see that about some security technologies, other security technologies.
1676.67s - 1679.07s |  So back to our table.
1679.07s - 1680.07s |  What do we have?
1680.07s - 1682.91s |  How much 1.3 at the end of 2023?
1683.39s - 1686.19s |  I'm going to update this to 2024 in a minute.
1686.19s - 1687.35s |  39%.
1687.35s - 1692.77s |  So, you know, I'm definitely a player, but not the player.
1692.77s - 1696.13s |  Ah, what about SMB?
1696.13s - 1700.65s |  Encrypted SMB, SMB v3.
1700.65s - 1701.93s |  2012.
1701.93s - 1706.09s |  Hey, there is encrypted SMB.
1706.09s - 1709.01s |  We're calling it SMB 3 from now on.
1709.01s - 1711.69s |  By golly, you should use it.
1711.69s - 1714.17s |  Twelve years ago.
1714.29s - 1725.28s |  And then in 2016, we're like, just quit it with the SMB v1, folks.
1725.28s - 1726.80s |  It's almost 30 years old.
1726.80s - 1727.80s |  Get rid of it.
1727.80s - 1729.76s |  It is riddled with security issues.
1729.76s - 1736.32s |  At least use two, and you really ought to use three.
1736.32s - 1745.32s |  In 2023, how much SMB v3 do we see?
1745.32s - 1747.72s |  None.
1747.72s - 1751.40s |  Now, that zero, as opposed to none, because I'm going to fill out other things in this
1751.40s - 1752.40s |  table in a minute.
1752.64s - 1755.28s |  So there was actually a teeny bit.
1755.28s - 1762.60s |  It wasn't literally none, but it was well below 1 in 10,000, 1 in 100,000.
1762.60s - 1771.12s |  And then, actually in today, so this is the data there is 2023, except that footnote is
1771.12s - 1774.72s |  2024, measured in August.
1774.72s - 1778.48s |  There was more v1 than v3.
1778.48s - 1781.51s |  All right.
1781.55s - 1785.95s |  I've given you a whole bunch of enterprise perspective there.
1785.95s - 1789.43s |  It's just one data point.
1789.43s - 1796.03s |  And you would be completely right to just wonder, is it general?
1796.03s - 1798.27s |  I wondered that.
1798.27s - 1807.31s |  And here, I'm able to leverage something crucial we've done at Corelite, which is because we're
1807.31s - 1812.79s |  in the analyze traffic, infer stuff about it, detect attacks, stuff like that.
1812.79s - 1817.03s |  And I've done that for decades as a professor and the like.
1817.03s - 1822.95s |  And I know you cannot play that game without real data at scale.
1822.95s - 1824.23s |  You just can't.
1824.23s - 1830.79s |  Because whatever you create in your lab has no fidelity to the craziness of actual operational
1830.79s - 1831.79s |  data at scale.
1831.79s - 1833.65s |  And it is crazy.
1833.65s - 1837.69s |  And so, at Corelite, a number of years ago, we put together this program.
1837.69s - 1845.09s |  And in the program, we go to some of our customers and deploy alongside their production sensor
1845.09s - 1850.33s |  a research sensor that captures the same traffic.
1850.33s - 1855.29s |  And we ship another crunch box so that we can analyze all the data on prem, et cetera.
1855.29s - 1861.17s |  And so, the point of this is that we have data from multiple enterprises.
1861.17s - 1863.53s |  We have 10 of these partners.
1863.53s - 1864.85s |  And they see a whole lot of data.
1864.85s - 1872.85s |  And one of them is a PCAP pack rat has two petabytes of PCAP, which is just such a nice
1872.85s - 1873.85s |  resource.
1873.85s - 1881.49s |  So, we can use this to get some illumination more broadly than one national laboratory.
1881.49s - 1888.45s |  So, here is the data from late 2023.
1888.45s - 1892.09s |  And here it is with some of the Polaris sites.
1892.65s - 1893.69s |  Well, what do we see?
1893.69s - 1900.65s |  We see that v6 has very little inroads at them.
1900.65s - 1905.73s |  QUIC is a lot less at every single one of them than at LBL.
1905.73s - 1909.77s |  TLS 1.3 is less.
1909.77s - 1915.61s |  And we're kind of thin on the SMB v3, the encrypted SMB.
1915.61s - 1919.97s |  Only one of them has any appreciable traffic.
1919.97s - 1931.93s |  And then, those stars were last year more TLS 1.0, old protocol, than 1.3.
1931.93s - 1940.15s |  And those daggers mean, well, you know, they actually had v1.
1940.15s - 1941.75s |  Has this changed?
1941.75s - 1944.75s |  So, here is an update.
1944.75s - 1951.39s |  And one of the Polaris sites we didn't have earlier for reasons that don't really matter
1951.55s - 1954.11s |  is now included.
1954.11s - 1956.15s |  Here's the new v6.
1956.15s - 1957.95s |  I'm going to summarize this in a minute.
1957.95s - 1958.95s |  Well, here we go.
1958.95s - 1962.07s |  So, gee, still no v6.
1962.07s - 1965.95s |  Just don't bet long on that one for enterprises.
1965.95s - 1971.31s |  QUIC, yeah, some places it matters.
1971.31s - 1972.31s |  One of those, 54%.
1972.31s - 1975.51s |  So, there, it really is kind of predominant.
1975.51s - 1980.69s |  TLS 1.3 is increasing.
1980.69s - 1985.71s |  And SMB is not pretty.
1985.71s - 1990.51s |  And there's still, at a couple of them, more SMB v1 than encrypted.
1990.51s - 1991.51s |  That did shift.
1991.51s - 1998.10s |  The ones that last year didn't have that property, it's actually shifted.
1998.10s - 2003.70s |  And a bunch of v1 at others, even if it doesn't have the property that's more than the v3.
2003.70s - 2006.14s |  All right.
2006.14s - 2011.14s |  So, v6 going nowhere.
2011.14s - 2014.62s |  QUIC, yeah, it grew over the year.
2015.58s - 2019.18s |  But it's just not exploding in enterprises.
2019.18s - 2022.30s |  TLS 1.3 definitely is on the uptake.
2022.30s - 2026.46s |  That one is, you know, it's going to happen, but it's going to take a few years still.
2026.46s - 2030.38s |  And minor growth in encrypted SMB.
2030.38s - 2035.68s |  All right.
2035.68s - 2039.96s |  That's our look at sort of encryption.
2039.96s - 2044.75s |  Please can at least be mainly encrypted.
2044.75s - 2048.55s |  A reasonable question, right?
2048.91s - 2053.39s |  So, I'm going to show some telemetry here from our sensors.
2053.39s - 2056.83s |  So, a number of our...
2056.83s - 2061.19s |  We have deployed thousands of sensors at Coralight.
2061.19s - 2067.03s |  A number of them, a good chunk, are online and, you know, report telemetry to our cloud
2067.03s - 2069.91s |  service and then a whole bunch are not.
2069.91s - 2072.63s |  And so, for the ones that aren't, I have no data.
2072.63s - 2075.15s |  But the ones that are, I have data.
2075.15s - 2076.99s |  So this is aggregate data.
2076.99s - 2082.67s |  Log lines per week reported to the cloud service.
2082.67s - 2084.19s |  And you can see it's linear scaled.
2084.19s - 2087.15s |  It goes from up to about...
2087.15s - 2091.15s |  I always have to stop and do the math.
2091.15s - 2093.95s |  200 billion a week.
2093.95s - 2096.87s |  And black is HTTP and red is TLS.
2096.87s - 2100.15s |  And so, you look at this and you think, wait a minute.
2100.15s - 2101.15s |  That's not good.
2101.55s - 2107.27s |  There's more HTTP than TLS.
2107.27s - 2108.27s |  Really not good.
2108.27s - 2109.79s |  And didn't used to be the case.
2109.79s - 2114.07s |  And it turns out, and this is useful to, you know, useful...
2114.07s - 2117.23s |  Here's the same thing log scaled.
2117.23s - 2121.51s |  That is a single customer.
2121.51s - 2124.35s |  They're big and they have a lot of HTTP.
2124.35s - 2129.99s |  So, let's remove them from this analysis because they're obviously skewing it.
2129.99s - 2133.43s |  And there's what it looks like with them removed.
2133.43s - 2134.43s |  And so, you've got...
2134.43s - 2139.55s |  Yeah, I mean, there's more TLS than HTTP, but there's HTTP.
2139.55s - 2143.57s |  And let's look at this, then, as a ratio between the two.
2143.57s - 2144.57s |  And here it is.
2144.57s - 2145.91s |  And, yeah, it's noisy.
2145.91s - 2147.59s |  It's definitely noisy.
2147.59s - 2151.51s |  But if you're gonna fit a line to it, because we want some sort of growth trend, you would
2151.51s - 2154.83s |  say it goes down about .6% a year.
2154.83s - 2160.71s |  So, way back in 2017, I think, when the data starts, it was roughly...
2160.71s - 2167.65s |  The fit is, you know, 38%, and now it's down to, you know, 33% or something.
2167.65s - 2170.80s |  Plenty of HTTP out there.
2170.80s - 2175.16s |  And you might still wonder, well, okay, but there's just gonna be a few weirdos like that
2175.16s - 2181.92s |  one I showed, and they're completely full of HTTP, and, you know, that's skewing it
2181.92s - 2182.92s |  all.
2182.92s - 2186.68s |  And so, here's a different plot.
2186.68s - 2187.68s |  This is...
2187.68s - 2190.64s |  Every point on here is one of our sensors reporting.
2190.64s - 2196.24s |  And it had at least 100 million HTTP plus TLS.
2196.24s - 2201.92s |  And we're just plotting the ratio of how much HTTP, how much TLS, and put it on there.
2201.92s - 2203.28s |  That's a lot of points.
2203.28s - 2205.64s |  And you can see a huge dynamic spread.
2205.64s - 2209.04s |  You can see some clustering down in the lower right.
2209.04s - 2210.04s |  Good.
2210.04s - 2211.04s |  That's mostly TLS.
2211.16s - 2215.48s |  But you also see stuff well above it that's mostly HTTP.
2215.48s - 2219.96s |  And if you fit to this, least squares, you get about the same thing.
2219.96s - 2224.34s |  It goes down about half a percent a year.
2224.34s - 2233.42s |  So, the takeaway from this is that, boy, things don't always change so quickly.
2233.42s - 2239.74s |  So, let me summarize my view here that I've been sketching for you.
2239.74s - 2249.35s |  Here is this nice reminder of how malice, namely scanning, can explode.
2249.35s - 2250.47s |  Internet is exploding.
2250.47s - 2253.67s |  It's doing it way back to the left of the entire plot.
2253.67s - 2258.73s |  In the 80s, it's growing exponentially.
2258.73s - 2266.73s |  We get our savior of the Internet, v6, in 1996, I believe it is.
2266.73s - 2268.37s |  Remember that TLS 1.0 thing?
2268.37s - 2269.37s |  Yep.
2270.37s - 2273.45s |  Pre-2000.
2273.45s - 2274.81s |  The worm era begins.
2274.81s - 2279.13s |  You might see that little pixel that that thing points to.
2279.13s - 2283.93s |  That was the craziness of code red when it came out.
2283.93s - 2284.93s |  And this was...
2284.93s - 2285.93s |  Oh, wow.
2285.93s - 2286.93s |  It's even worse.
2286.93s - 2290.31s |  Completely crazy scanning.
2290.31s - 2294.91s |  There's our core technology today for TLS from 2008.
2294.91s - 2297.75s |  A little long in the tooth.
2297.75s - 2298.75s |  2009.
2299.07s - 2302.79s |  Google's like, hey, got to encrypt everywhere.
2302.79s - 2308.23s |  Here is the notions of zero trust.
2308.23s - 2309.31s |  Great notion.
2309.31s - 2310.31s |  Just hard.
2310.31s - 2313.87s |  I mean, if I want something to sink in...
2313.87s - 2315.47s |  Several things to sink in from this talk.
2315.47s - 2321.07s |  One is that the pace...
2321.07s - 2323.27s |  Multiple paces are really hard to track.
2323.27s - 2325.95s |  One of them is attacker evolution.
2325.95s - 2327.43s |  A lot of it's steady.
2327.43s - 2331.55s |  Some of it is just incredible bursts.
2331.55s - 2334.83s |  And then for our technology, it's really hard to know.
2334.83s - 2342.43s |  Is this tech, which maybe is just incredibly beneficial, actually going to make a difference
2342.43s - 2344.47s |  anytime soon?
2344.47s - 2346.71s |  The reality is the data speaks.
2346.71s - 2350.47s |  Enterprises find this tech difficult to deliver.
2350.47s - 2351.95s |  There is our...
2351.95s - 2354.07s |  Let's finally encrypt SMB.
2356.74s - 2362.99s |  Hey, let's get rid of the bug-ridden SMB.
2362.99s - 2373.93s |  Just a reminder of receiving a third of the billion scans from a botnet each day.
2373.93s - 2374.93s |  We get 1.3.
2374.93s - 2384.73s |  It's supposed to really sort of deploy and fix a bunch of TLS issues, make TLS more robust.
2384.73s - 2387.37s |  It's deploying really speedily.
2387.37s - 2390.45s |  Quick is just crazy and going to rule the world.
2390.45s - 2392.05s |  And then here we are.
2392.05s - 2395.05s |  Very little v6.
2395.05s - 2397.69s |  Some quick, but a lot of it's trickle.
2397.69s - 2400.25s |  1.2 still dominates.
2400.25s - 2405.41s |  It's going to lose that over the next few years, according to the data.
2405.41s - 2409.25s |  Boy, encrypted SMB, great idea.
2409.25s - 2415.17s |  It's a tough uphill battle to deploy.
2415.17s - 2420.65s |  And amazingly, you get lots of HTTP, and you still get some v1.
2420.65s - 2424.73s |  So that's where I'm going to end it.
2424.73s - 2430.89s |  I will be at the village for a bit, but not super long, because I have to get out to the
2430.89s - 2432.61s |  airport, head home.
2432.61s - 2436.23s |  So if you want to chat, catch me on the early side of the village.
2436.23s - 2437.23s |  And with that, I'm done.
2437.23s - 2437.73s |  Thank you.